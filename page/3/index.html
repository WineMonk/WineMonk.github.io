<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>WineMonk - shaozhy</title><meta name="keywords" content="WineMonk"><meta name="author" content="shaozhy,1361151272@qq.com"><meta name="copyright" content="shaozhy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="以感恩的心，开启每天的生活。">
<meta property="og:type" content="website">
<meta property="og:title" content="WineMonk">
<meta property="og:url" content="https://shaoshao.net.cn/page/3/index.html">
<meta property="og:site_name" content="WineMonk">
<meta property="og:description" content="以感恩的心，开启每天的生活。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg">
<meta property="article:author" content="shaozhy">
<meta property="article:tag" content="WineMonk">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg"><link rel="shortcut icon" href="/cover/head_portrait.jpg"><link rel="canonical" href="https://shaoshao.net.cn/page/3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WineMonk',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-03-29 17:01:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/discover/archives/"><div class="headline">文章</div><div class="length-num">186</div></a></div><div class="data-item"><a href="/discover/tags/"><div class="headline">标签</div><div class="length-num">115</div></a></div><div class="data-item"><a href="/discover/categories/"><div class="headline">分类</div><div class="length-num">83</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/home.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">WineMonk</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">WineMonk</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="tencent://message/?uin=1361151272&amp;Site=WineMonk&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:shaozhiyuan59@163.com" target="_blank" title="Email"><i class="fa fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/03/20230203170934000/" title="ArcGIS Pro Addin开发修改程序标题、加载界面、首页"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_19.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro Addin开发修改程序标题、加载界面、首页"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/03/20230203170934000/" title="ArcGIS Pro Addin开发修改程序标题、加载界面、首页">ArcGIS Pro Addin开发修改程序标题、加载界面、首页</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-03T09:09:34.000Z" title="发表于 2023-02-03 17:09:34">2023-02-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-Addin/">ArcGIS Pro Addin</a></span></div><div class="content">ArcGIS Pro Addin开发修改程序标题、加载界面、首页新建 ArcGIS Pro 管理配置 项目


安装生成的配置项插件后，通过快捷方式启动Pro，快捷方式需要加参数“config:配置项名称”。

官方文档：配置管理器类 - ArcGIS Pro
ConfigurationManager Class Members
The following tables list the members exposed by ConfigurationManager.
Public Constructors




Name
Description




ConfigurationManager Constructor



Protected Properties




Name
Description




ApplicationName
Gets the new application name for the configuration.



Icon
Gets the new application icon for the configuration.



Run ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/02/03/20230203165605000/" title="C#获取系统目录"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C#获取系统目录"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/03/20230203165605000/" title="C#获取系统目录">C#获取系统目录</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-03T08:56:05.000Z" title="发表于 2023-02-03 16:56:05">2023-02-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a></span></div><div class="content">C#获取系统目录1Environment.GetFolderPath(Environment.SpecialFolder specialFolder)




枚举项
值
说明



AdminTools
48
用于存储各个用户的管理工具的文件系统目录。 Microsoft Management Console (MMC) 会将自定义的控制台保存在此目录中，并且此目录将随用户一起漫游。


ApplicationData
26
用作当前漫游用户的应用程序特定数据的公共储存库的目录。 漫游用户在网络上的多台计算机上工作。 漫游用户的配置文件保留在网络服务器上，并在用户登录时加载到系统中。


CDBurning
59
充当等待写入 CD 的文件的临时区域的文件系统目录。


CommonAdminTools
47
包含计算机所有用户的管理工具的文件系统目录。


CommonApplicationData
35
用作所有用户使用的应用程序特定数据的公共储存库的目录。


CommonDesktopDirectory
25
包含在所有用户桌面上出现的文件和文件夹的文件系统目录。


Com ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/03/20230203164051000/" title="C#判断程序是否为管理员权限启动"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_17.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C#判断程序是否为管理员权限启动"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/03/20230203164051000/" title="C#判断程序是否为管理员权限启动">C#判断程序是否为管理员权限启动</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-03T08:40:51.000Z" title="发表于 2023-02-03 16:40:51">2023-02-03</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a></span></div><div class="content">C# 判断程序是否为管理员权限启动123456bool IsAdministrator()&#123;    WindowsIdentity current = WindowsIdentity.GetCurrent();    WindowsPrincipal windowsPrincipal = new WindowsPrincipal(current);    return windowsPrincipal.IsInRole(WindowsBuiltInRole.Administrator);&#125;

}


</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/02/02/20230202183231000/" title="C#创建快捷方式"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_16.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C#创建快捷方式"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/02/20230202183231000/" title="C#创建快捷方式">C#创建快捷方式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-02T10:32:31.000Z" title="发表于 2023-02-02 18:32:31">2023-02-02</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a></span></div><div class="content">C#创建快捷方式123456789101112131415161718192021222324252627282930//实例化WshShell对象WshShell shell = new WshShell();//通过该对象的 CreateShortcut 方法来创建 IWshShortcut 接口的实例对象IWshShortcut shortcut = (IWshShortcut)shell.CreateShortcut(    Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + &quot;//ShortCut.lnk&quot;);//设置快捷方式的目标所在的位置(源程序完整路径)shortcut.TargetPath = proInstallDir+ &quot;\\bin\\ArcGISPro.exe&quot;;//应用程序的工作目录//当用户没有指定一个具体的目录时，快捷方式的目标应用程序将使用该属性所指定的目录来装载或保存文件。shortcut.WorkingDirectory = proIns ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/01/31/20230131170611000/" title="RegistryKey 读取注册表信息"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_15.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="RegistryKey 读取注册表信息"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/31/20230131170611000/" title="RegistryKey 读取注册表信息">RegistryKey 读取注册表信息</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-31T09:06:11.000Z" title="发表于 2023-01-31 17:06:11">2023-01-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a></span></div><div class="content">RegistryKey 读取注册表信息RegistryKey读取注册表，明明看得到却读不到？
不要直接使用：
1var localMachineKey = Registry.LocalMachine;

而是使用如下与计算机位数相关的代码
12var useRegistryView = Environment.Is64BitOperatingSystem ? RegistryView.Registry64 : RegistryView.Registry32; var localMachineKey = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, useRegistryView);
);


</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/31/20230131114306000/" title="SkiaSharp 初探"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_14.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SkiaSharp 初探"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/31/20230131114306000/" title="SkiaSharp 初探">SkiaSharp 初探</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-31T03:43:06.000Z" title="发表于 2023-01-31 11:43:06">2023-01-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/SkiaSharp/">SkiaSharp</a></span></div><div class="content">SkiaSharp 初探有个 .Net Framework 4.x 的项目需要升级到 .Net 6，升级过后发现 System.Drawing.dll 库相关功能模块会报错：

Could not load file or assembly ‘System.Drawing.Common, Version&#x3D;7.0.0.0, Culture&#x3D;neutral,PublicKeyToken&#x3D;cc7b13ffcd2ddd51’.系统找不到指定文件。

因为 System.Drawing 对跨平台不支持，只支持Windows系统，.Net 6 貌似不再支持。
于是使用 SkiaSharp 代替。
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/01/18/20230118155635000/" title="Neo4j初探"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_13.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Neo4j初探"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/18/20230118155635000/" title="Neo4j初探">Neo4j初探</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-18T07:56:35.000Z" title="发表于 2023-01-18 15:56:35">2023-01-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/Neo4j/">Neo4j</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/Neo4j/">Neo4j</a></span></div><div class="content">Neo4j 初探Create下边是一个巨大的代码块，其中包含由多个 CREATE 子句组成的单个 Cypher 查询语句。这将创建电影图形。
123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/16/20230116102135000/" title="C#读写config配置文件"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_12.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C#读写config配置文件"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/16/20230116102135000/" title="C#读写config配置文件">C#读写config配置文件</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-16T02:21:35.000Z" title="发表于 2023-01-16 10:21:35">2023-01-16</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a></span></div><div class="content">C#读写config配置文件12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970public static class ConfigHelper&#123;    public static LocalConfig _LocalConfig = null;    static ConfigHelper()    &#123;        _LocalConfig = new LocalConfig();    &#125;&#125;public class ConfigBase&#123;    protected Configuration configObject;    public ConfigBase(string configFilePath)    &#123;        ExeConfigurationFileMap fileMap = new ExeCo ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/01/11/20230111173213000/" title="Git-报错 error: bad signature 0x00000000 fatal: index file corrupt"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_11.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git-报错 error: bad signature 0x00000000 fatal: index file corrupt"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/11/20230111173213000/" title="Git-报错 error: bad signature 0x00000000 fatal: index file corrupt">Git-报错 error: bad signature 0x00000000 fatal: index file corrupt</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-11T09:32:13.000Z" title="发表于 2023-01-11 17:32:13">2023-01-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/Git%E7%9B%B8%E5%85%B3/">Git相关</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/Git/">Git</a></span></div><div class="content">Git- 报错 error: bad signature 0x00000000 fatal: index file corrupt解决方案：
123rm -f .git/index  git reset



</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/06/20230106155206000/" title="WPF数据模板"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_10.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WPF数据模板"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/06/20230106155206000/" title="WPF数据模板">WPF数据模板</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-06T07:52:06.000Z" title="发表于 2023-01-06 15:52:06">2023-01-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/WPF/">WPF</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/WPF/">WPF</a></span></div><div class="content">DataGrid 数据模板12345678910111213141516171819&lt;DataGrid SelectedItem=&quot;&#123;Binding SelectHexoPost&#125;&quot; AutoGenerateColumns=&quot;False&quot; VerticalContentAlignment=&quot;Center&quot; IsReadOnly=&quot;True&quot; CanUserSortColumns=&quot;True&quot; CanUserAddRows=&quot;False&quot; ItemsSource=&quot;&#123;Binding HexoPosts&#125;&quot;&gt;    &lt;DataGrid.Columns&gt;        &lt;DataGridTextColumn Binding=&quot;&#123;Binding Id&#125;&quot; Width=&quot;0.3*&quot; Header=&quot;ID&quot;/&g ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/31/20221231205615000/" title="C#中Brush、Color、String相互转换"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_09.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C#中Brush、Color、String相互转换"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/31/20221231205615000/" title="C#中Brush、Color、String相互转换">C#中Brush、Color、String相互转换</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-31T12:56:15.000Z" title="发表于 2022-12-31 20:56:15">2022-12-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/">CSharp相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/CSharp/">CSharp</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a></span></div><div class="content">C#中Brush、Color、String相互转换1、String转换成Color
​      Color color &#x3D; (Color)ColorConverter.ConvertFromString(string);
2、String转换成Brush
​      BrushConverter brushConverter &#x3D; new BrushConverter();​      Brush brush &#x3D; (Brush)brushConverter.ConvertFromString(string);
3、Color转换成Brush
​      Brush brush &#x3D; new SolidColorBrush(color));
4、Brush转换成Color有两种方法：
（1）先将Brush转成string，再转成Color。
​      Color color&#x3D; (Color)ColorConverter.ConvertFromString(brush.ToString());
（2）将Brush转成SolidColo ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/31/20221231171113000/" title="ArcGIS Pro SDK 汇总"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 汇总"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/31/20221231171113000/" title="ArcGIS Pro SDK 汇总">ArcGIS Pro SDK 汇总</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-31T09:11:13.000Z" title="发表于 2022-12-31 17:11:13">2022-12-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">框架如何在停靠窗格可见或隐藏时订阅和取消订阅事件1234567891011121314151617181920private SubscriptionToken _eventToken = null;// Called when the visibility of the DockPane changes.protected override void OnShow(bool isVisible)&#123;  if (isVisible &amp;&amp; _eventToken == null) //Subscribe to event when dockpane is visible  &#123;    _eventToken = MapSelectionChangedEvent.Subscribe(OnMapSelectionChangedEvent);  &#125;  if (!isVisible &amp;&amp; _eventToken != null) //Unsubscribe as the dockpane closes.  &#123;    MapSel ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/28/20221228143257000/" title="ArcGIS Pro SDK 工作流管理器"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 工作流管理器"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228143257000/" title="ArcGIS Pro SDK 工作流管理器">ArcGIS Pro SDK 工作流管理器</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:32:57.000Z" title="发表于 2022-12-28 14:32:57">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">工作流管理器如何获取管理器对象12345// WorkflowModule.GetManager returns a manager of the type specified// keyword is currently just an empty stringvar wfCon = await WorkflowModule.ConnectAsync();var jobManager = wfCon.GetManager&lt;JobsManager&gt;();var configManager = wfCon.GetManager&lt;ConfigurationManager&gt;();

如何获取群组1234// GetAllGroups returns a list of Workflow Manager groupsvar wfCon = await WorkflowModule.ConnectAsync();var configManager = wfCon.GetManager&lt;ConfigurationManager&gt;();var allGroups  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/28/20221228143058000/" title="ArcGIS Pro SDK 任务"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 任务"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228143058000/" title="ArcGIS Pro SDK 任务">ArcGIS Pro SDK 任务</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:30:58.000Z" title="发表于 2022-12-28 14:30:58">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">任务检索项目中的所有任务项12345IEnumerable&lt;TaskProjectItem&gt; taskItems = Project.Current.GetItems&lt;TaskProjectItem&gt;();foreach (var item in taskItems)&#123;  // do something&#125;

打开任务文件 - .esriTasks 文件12345678910111213141516// Open a task filetry&#123;  // TODO - substitute your own .esriTasks file to be opened  string taskFile = @&quot;c:\Tasks\Get Started.esriTasks&quot;;  //At 2.x -  //System.Guid guid = await TaskAssistantModule.OpenTaskAsync(taskFile);  var guid = await TaskAssistantFactory.I ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/28/20221228142814000/" title="ArcGIS Pro SDK 实时要素类"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 实时要素类"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228142814000/" title="ArcGIS Pro SDK 实时要素类">ArcGIS Pro SDK 实时要素类</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:28:14.000Z" title="发表于 2022-12-28 14:28:14">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">实时要素类从实时数据存储连接到实时要素类12345678910111213141516171819202122var url = &quot;https://geoeventsample1.esri.com:6443/arcgis/rest/services/AirportTraffics/StreamServer&quot;;     await QueuedTask.Run(() =&gt;&#123;  var realtimeServiceConProp = new RealtimeServiceConnectionProperties(                                   new Uri(url),                                   RealtimeDatastoreType.StreamService                                );  using (var realtimeDatastore = new RealtimeDatastore(realtimeServiceCo ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/28/20221228142645000/" title="ArcGIS Pro SDK 订阅和搜索"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_04.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 订阅和搜索"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228142645000/" title="ArcGIS Pro SDK 订阅和搜索">ArcGIS Pro SDK 订阅和搜索</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:26:45.000Z" title="发表于 2022-12-28 14:26:45">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">订阅和搜索搜索和订阅流数据123456789101112131415161718192021222324252627282930313233343536373839404142434445464748await QueuedTask.Run(async () =&gt;&#123;  //query filter can be null to search and retrieve all rows  //true means recycling cursor  using (var rc = streamLayer.SearchAndSubscribe(qfilter, true))  &#123;    //waiting for new features to be streamed    //default is no cancellation    while (await rc.WaitForRowsAsync())    &#123;      while (rc.MoveNext())      &#123;        using (var row = rc.Cur ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/28/20221228142423000/" title="ArcGIS Pro SDK 渲染"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_03.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 渲染"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228142423000/" title="ArcGIS Pro SDK 渲染">ArcGIS Pro SDK 渲染</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:24:23.000Z" title="发表于 2022-12-28 14:24:23">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">渲染定义唯一值呈现器定义1234567891011var uvrDef = new UniqueValueRendererDefinition()&#123;  ValueFields = new List&lt;string&gt; &#123; &quot;ACTYPE&quot; &#125;,  SymbolTemplate = SymbolFactory.Instance.ConstructPointSymbol(    ColorFactory.Instance.RedRGB, 10, SimpleMarkerStyle.Hexagon)      .MakeSymbolReference(),  ValuesLimit = 5&#125;;//Note: CreateRenderer can only create value classes based on//the current events it has receivedstreamLayer.SetRenderer(streamLayer.CreateRenderer(uvrDef));

为最新观测值设置唯一 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/28/20221228142312000/" title="ArcGIS Pro SDK 流图层"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_02.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 流图层"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228142312000/" title="ArcGIS Pro SDK 流图层">ArcGIS Pro SDK 流图层</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:23:12.000Z" title="发表于 2022-12-28 14:23:12">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">流图层创建流图层使用 URI 创建流图层123456789101112//Must be on the QueuedTaskvar url = &quot;https://geoeventsample1.esri.com:6443/arcgis/rest/services/AirportTraffics/StreamServer&quot;;var createParam = new FeatureLayerCreationParams(new Uri(url))&#123;  IsVisible = false //turned off by default&#125;;var streamLayer = LayerFactory.Instance.CreateLayer&lt;StreamLayer&gt;(createParam, map);//or use &quot;original&quot; create layer (will be visible by default)Uri uri = new Uri(url);streamLayer = LayerFactory. ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/28/20221228142125000/" title="ArcGIS Pro SDK 场景图层"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_01.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 场景图层"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228142125000/" title="ArcGIS Pro SDK 场景图层">ArcGIS Pro SDK 场景图层</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:21:25.000Z" title="发表于 2022-12-28 14:21:25">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">场景图层创建场景图层123456789101112131415161718192021var sceneLayerUrl = @&quot;https://myportal.com/server/rest/services/Hosted/SceneLayerServiceName/SceneServer&quot;;//portal items also ok as long as the portal is the current active portal...//var sceneLayerUrl = @&quot;https://myportal.com/home/item.html?id=123456789abcdef1234567890abcdef0&quot;;await QueuedTask.Run(() =&gt;&#123;  //Create with initial visibility set to false. Add to current scene  var createparams = new LayerCreationParams(new Uri(s ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/28/20221228141910000/" title="ArcGIS Pro SDK 光栅"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 光栅"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228141910000/" title="ArcGIS Pro SDK 光栅">ArcGIS Pro SDK 光栅</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:19:10.000Z" title="发表于 2022-12-28 14:19:10">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">光栅在文件夹中打开栅格数据集123456// Create a FileSystemConnectionPath using the folder path.FileSystemConnectionPath connectionPath = new FileSystemConnectionPath(new System.Uri(@&quot;C:\Temp&quot;), FileSystemDatastoreType.Raster);// Create a new FileSystemDatastore using the FileSystemConnectionPath.FileSystemDatastore dataStore = new FileSystemDatastore(connectionPath);// Open the raster dataset.RasterDataset fileRasterDataset = dataStore.OpenDataset&lt;RasterDataset&gt;(&quot;Sample.tif&quot;);

在地理数据库中 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/28/20221228141707000/" title="ArcGIS Pro SDK 宗地结构"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_19.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 宗地结构"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228141707000/" title="ArcGIS Pro SDK 宗地结构">ArcGIS Pro SDK 宗地结构</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:17:07.000Z" title="发表于 2022-12-28 14:17:07">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">宗地结构获取活动记录1234567891011121314151617181920string errorMessage = await QueuedTask.Run(() =&gt;&#123;  try  &#123;    var myParcelFabricLayer = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;ParcelLayer&gt;().FirstOrDefault();    //if there is no fabric in the map then bail    if (myParcelFabricLayer == null)      return &quot;There is no fabric in the map.&quot;;    var theActiveRecord = myParcelFabricLayer.GetActiveRecord();    if (theActiveRecord == null)      return &quot;There is no A ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/12/28/20221228141417000/" title="ArcGIS Pro SDK 公共设施网络"><img class="post_bg" src="https://shaoshao.net.cn/images/blog/cover/current/post_18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro SDK 公共设施网络"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/28/20221228141417000/" title="ArcGIS Pro SDK 公共设施网络">ArcGIS Pro SDK 公共设施网络</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-28T06:14:17.000Z" title="发表于 2022-12-28 14:14:17">2022-12-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/discover/tags/CSharp/">CSharp</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="content">公共设施网络获取公共设施网络从表中获取公共设施网络1234567891011121314151617181920212223public static UtilityNetwork GetUtilityNetworkFromTable(Table table)&#123;  UtilityNetwork utilityNetwork = null;  if (table.IsControllerDatasetSupported())  &#123;    // Tables can belong to multiple controller datasets, but at most one of them will be a UtilityNetwork    IReadOnlyList&lt;Dataset&gt; controllerDatasets = table.GetControllerDatasets();    foreach (Dataset controllerDataset in controllerDatasets)    &#123;      if (con ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">shaozhy</div><div class="author-info__description">以感恩的心，开启每天的生活。</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/discover/archives/"><div class="headline">文章</div><div class="length-num">186</div></a></div><div class="card-info-data-item"><a href="/discover/tags/"><div class="headline">标签</div><div class="length-num">115</div></a></div><div class="card-info-data-item"><a href="/discover/categories/"><div class="headline">分类</div><div class="length-num">83</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="tencent://message/?uin=1361151272&amp;Site=WineMonk&amp;Menu=yes" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="mailto:shaozhiyuan59@163.com" target="_blank" title="Email"><i class="fa fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎光临~~~</div></div><div class="card-widget map-card" id="map-card"><div class="item-headline"><i class="fas fa-heartbeat"></i><span>访客地图</span></div><div class="item-content"><a target="_blank" rel="noopener" href="https://mapmyvisitors.com/web/1bvrp"  title="Visit tracker"><img src="https://mapmyvisitors.com/map.png?d=td042LGKp67JrdGc0DBcR-YVYpXTard9mux1DaVepA8&cl=ffffff" /></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/29/20240329164244970/" title="Arcpy 登录Portal：Unable to connect ArcGIS Online."><img src="https://shaoshao.net.cn/images/blog/cover/current/post_01.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Arcpy 登录Portal：Unable to connect ArcGIS Online."/></a><div class="content"><a class="title" href="/2024/03/29/20240329164244970/" title="Arcpy 登录Portal：Unable to connect ArcGIS Online.">Arcpy 登录Portal：Unable to connect ArcGIS Online.</a><time datetime="2024-03-29T08:42:48.000Z" title="发表于 2024-03-29 16:42:48">2024-03-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/26/20240326154807303/" title="ArcGIS Pro DAML ID Reference"><img src="https://shaoshao.net.cn/images/blog/cover/current/post_20.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ArcGIS Pro DAML ID Reference"/></a><div class="content"><a class="title" href="/2024/03/26/20240326154807303/" title="ArcGIS Pro DAML ID Reference">ArcGIS Pro DAML ID Reference</a><time datetime="2024-03-26T07:48:11.000Z" title="发表于 2024-03-26 15:48:11">2024-03-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/21/20240321182024927/" title="Nlog 配置文件说明"><img src="https://shaoshao.net.cn/images/blog/cover/current/post_19.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Nlog 配置文件说明"/></a><div class="content"><a class="title" href="/2024/03/21/20240321182024927/" title="Nlog 配置文件说明">Nlog 配置文件说明</a><time datetime="2024-03-21T10:20:27.000Z" title="发表于 2024-03-21 18:20:27">2024-03-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/12/20240312180429281/" title="方向分布（标准差椭圆）算法"><img src="https://shaoshao.net.cn/images/blog/cover/current/post_18.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="方向分布（标准差椭圆）算法"/></a><div class="content"><a class="title" href="/2024/03/12/20240312180429281/" title="方向分布（标准差椭圆）算法">方向分布（标准差椭圆）算法</a><time datetime="2024-03-12T10:04:33.000Z" title="发表于 2024-03-12 18:04:33">2024-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/05/20240305094327571/" title="Prism（八） 导航"><img src="https://shaoshao.net.cn/images/blog/cover/current/post_17.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Prism（八） 导航"/></a><div class="content"><a class="title" href="/2024/03/05/20240305094327571/" title="Prism（八） 导航">Prism（八） 导航</a><time datetime="2024-03-05T01:43:29.000Z" title="发表于 2024-03-05 09:43:29">2024-03-05</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/discover/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/Android%E7%9B%B8%E5%85%B3/"><span class="card-category-list-name">Android相关</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/Android%E7%9B%B8%E5%85%B3/UI/"><span class="card-category-list-name">UI</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/Blog%E7%9B%B8%E5%85%B3/"><span class="card-category-list-name">Blog相关</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/Blog%E7%9B%B8%E5%85%B3/Hexo/"><span class="card-category-list-name">Hexo</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/Book/"><span class="card-category-list-name">Book</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/Book/Programmer/"><span class="card-category-list-name">Programmer</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/"><span class="card-category-list-name">CSharp相关</span><span class="card-category-list-count">68</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/discover/categories/CSharp%E7%9B%B8%E5%85%B3/Access/"><span class="card-category-list-name">Access</span><span class="card-category-list-count">2</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/discover/tags/Beginning/" style="font-size: 1.15em; color: rgb(103, 107, 118)">Beginning</a><a href="/discover/tags/CSharp/" style="font-size: 1.45em; color: rgb(72, 73, 116)">CSharp</a><a href="/discover/tags/Office-API/" style="font-size: 1.15em; color: rgb(139, 62, 49)">Office-API</a><a href="/discover/tags/Winform/" style="font-size: 1.36em; color: rgb(46, 3, 107)">Winform</a><a href="/discover/tags/Wine/" style="font-size: 1.15em; color: rgb(184, 154, 137)">Wine</a><a href="/discover/tags/NPOI/" style="font-size: 1.18em; color: rgb(67, 15, 7)">NPOI</a><a href="/discover/tags/Html%E7%9B%B8%E5%85%B3/" style="font-size: 1.18em; color: rgb(139, 152, 128)">Html相关</a><a href="/discover/tags/QQ/" style="font-size: 1.15em; color: rgb(67, 36, 75)">QQ</a><a href="/discover/tags/Lsdmsystem/" style="font-size: 1.18em; color: rgb(164, 79, 29)">Lsdmsystem</a><a href="/discover/tags/%E6%AD%A3%E5%88%99/" style="font-size: 1.15em; color: rgb(81, 78, 46)">正则</a><a href="/discover/tags/Email/" style="font-size: 1.15em; color: rgb(168, 39, 106)">Email</a><a href="/discover/tags/VisualStudio/" style="font-size: 1.21em; color: rgb(93, 88, 106)">VisualStudio</a><a href="/discover/tags/InstallShield/" style="font-size: 1.15em; color: rgb(100, 200, 178)">InstallShield</a><a href="/discover/tags/Python/" style="font-size: 1.33em; color: rgb(125, 165, 184)">Python</a><a href="/discover/tags/%E7%88%AC%E8%99%AB/" style="font-size: 1.3em; color: rgb(23, 43, 170)">爬虫</a><a href="/discover/tags/Essay/" style="font-size: 1.24em; color: rgb(34, 79, 119)">Essay</a><a href="/discover/tags/CSS3/" style="font-size: 1.15em; color: rgb(184, 4, 105)">CSS3</a><a href="/discover/tags/Tools/" style="font-size: 1.15em; color: rgb(102, 96, 137)">Tools</a><a href="/discover/tags/Book/" style="font-size: 1.15em; color: rgb(78, 100, 78)">Book</a><a href="/discover/tags/CleanCode/" style="font-size: 1.15em; color: rgb(104, 193, 55)">CleanCode</a><a href="/discover/tags/Android/" style="font-size: 1.15em; color: rgb(130, 151, 10)">Android</a><a href="/discover/tags/UI/" style="font-size: 1.15em; color: rgb(193, 156, 152)">UI</a><a href="/discover/tags/DataRecovery/" style="font-size: 1.15em; color: rgb(117, 124, 185)">DataRecovery</a><a href="/discover/tags/Cpp/" style="font-size: 1.15em; color: rgb(100, 35, 45)">Cpp</a><a href="/discover/tags/JDK/" style="font-size: 1.15em; color: rgb(23, 144, 119)">JDK</a><a href="/discover/tags/Keyboardshortcuts/" style="font-size: 1.15em; color: rgb(181, 5, 69)">Keyboardshortcuts</a><a href="/discover/tags/Git/" style="font-size: 1.18em; color: rgb(83, 91, 13)">Git</a><a href="/discover/tags/Windows/" style="font-size: 1.33em; color: rgb(63, 173, 76)">Windows</a><a href="/discover/tags/Bat%E6%89%B9%E5%A4%84%E7%90%86/" style="font-size: 1.18em; color: rgb(61, 27, 140)">Bat批处理</a><a href="/discover/tags/Java/" style="font-size: 1.42em; color: rgb(129, 166, 25)">Java</a><a href="/discover/tags/GIS/" style="font-size: 1.27em; color: rgb(186, 112, 39)">GIS</a><a href="/discover/tags/MapGIS/" style="font-size: 1.18em; color: rgb(96, 150, 166)">MapGIS</a><a href="/discover/tags/MySQL/" style="font-size: 1.27em; color: rgb(52, 28, 117)">MySQL</a><a href="/discover/tags/%E7%AE%97%E6%B3%95%E9%A2%98/" style="font-size: 1.15em; color: rgb(16, 1, 73)">算法题</a><a href="/discover/tags/WindowsSever/" style="font-size: 1.15em; color: rgb(119, 16, 8)">WindowsSever</a><a href="/discover/tags/FileSystemWatcher/" style="font-size: 1.15em; color: rgb(67, 93, 170)">FileSystemWatcher</a><a href="/discover/tags/Ini/" style="font-size: 1.15em; color: rgb(49, 16, 176)">Ini</a><a href="/discover/tags/WebService/" style="font-size: 1.15em; color: rgb(57, 109, 149)">WebService</a><a href="/discover/tags/%E7%BD%91%E9%A1%B5ts%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD/" style="font-size: 1.15em; color: rgb(49, 54, 122)">网页ts视频下载</a><a href="/discover/tags/Spring/" style="font-size: 1.39em; color: rgb(35, 139, 50)">Spring</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/discover/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2023/12/"><span class="card-archive-list-date">十二月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/discover/archives/2023/06/"><span class="card-archive-list-date">六月 2023</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">186</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2020-06-28T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">492.1k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-03-29T09:01:22.989Z"></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/home.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By shaozhy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="/img/icp.png"><span>冀ICP备2023009991号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["你的故事也许没有一个快乐的开始，可这并不能决定你的人生。你想要成为什么样的人，全看你自己的选择。"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '你的故事也许没有一个快乐的开始，可这并不能决定你的人生。你想要成为什么样的人，全看你自己的选择。'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const findTrueUrl = (array) => {
    Promise.all(array.map(item =>
      fetch(item.url).then(resp => resp.json()).then(data => {
        const urlArray = data.body.match(/(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?/ig)
        if (data.user.login === 'utterances-bot') {
          return urlArray.pop()
        } else {
          return urlArray.shift()
        }
      })
    )).then(res => {
        array = array.map((i,index)=> {
          return {
            ...i,
            url: res[index]
          }
        })

        saveToLocal.set('github-newest-comments', JSON.stringify(array), 1/(60*24))
        generateHtml(array)
    });
  }

  const getComment = () => {
    fetch('https://api.github.com/repos/WineMonk/WineMonk.github.io/issues/comments?sort=updated&direction=desc&per_page=6&page=1',{
      "headers": {
        Accept: 'application/vnd.github.v3.html+json'
      }
    })
      .then(response => response.json())
      .then(data => {
        const githubArray = data.map(item => {
          return {
            'avatar': item.user.avatar_url,
            'content': changeContent(item.body_html),
            'nick': item.user.login,
            'url': item.issue_url,
            'date': item.updated_at,
            'githubUrl': item.html_url
          }
        })
        findTrueUrl(githubArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('github-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="茶飘香,酒罢去,聚朋友,再回楼" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>