<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ArcGIS Pro SDK 几何 | WineMonk</title><meta name="keywords" content="CSharp,ArcGIS Pro SDK"><meta name="author" content="shaozhy,1361151272@qq.com"><meta name="copyright" content="shaozhy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="几何空间参考构造空间参考 - 从已知 ID123456789101112131415&#x2F;&#x2F; Use a builder convenience method or use a builder constructor.&#x2F;&#x2F; Builder convenience methods don&amp;#x27;t need to run on the MCT.SpatialReference sr3857 &#x3D; Sp">
<meta property="og:type" content="article">
<meta property="og:title" content="ArcGIS Pro SDK 几何">
<meta property="og:url" content="https://shaoshao.net.cn/2022/12/28/20221228135428000/index.html">
<meta property="og:site_name" content="WineMonk">
<meta property="og:description" content="几何空间参考构造空间参考 - 从已知 ID123456789101112131415&#x2F;&#x2F; Use a builder convenience method or use a builder constructor.&#x2F;&#x2F; Builder convenience methods don&amp;#x27;t need to run on the MCT.SpatialReference sr3857 &#x3D; Sp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_09.jpg">
<meta property="article:published_time" content="2022-12-28T05:54:28.000Z">
<meta property="article:modified_time" content="2023-04-14T01:28:34.000Z">
<meta property="article:author" content="shaozhy">
<meta property="article:tag" content="CSharp">
<meta property="article:tag" content="ArcGIS Pro SDK">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_09.jpg"><link rel="shortcut icon" href="/cover/head_portrait.jpg"><link rel="canonical" href="https://shaoshao.net.cn/2022/12/28/20221228135428000/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ArcGIS Pro SDK 几何',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-14 09:28:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/discover/archives/"><div class="headline">文章</div><div class="length-num">165</div></a></div><div class="data-item"><a href="/discover/tags/"><div class="headline">标签</div><div class="length-num">106</div></a></div><div class="data-item"><a href="/discover/categories/"><div class="headline">分类</div><div class="length-num">79</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_09.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">WineMonk</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ArcGIS Pro SDK 几何</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-28T05:54:28.000Z" title="发表于 2022-12-28 13:54:28">2022-12-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-14T01:28:34.000Z" title="更新于 2023-04-14 09:28:34">2023-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">28.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>173分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ArcGIS Pro SDK 几何"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="几何"><a href="#几何" class="headerlink" title="几何"></a>几何</h1><h2 id="空间参考"><a href="#空间参考" class="headerlink" title="空间参考"></a>空间参考</h2><h3 id="构造空间参考-从已知-ID"><a href="#构造空间参考-从已知-ID" class="headerlink" title="构造空间参考 - 从已知 ID"></a>构造空间参考 - 从已知 ID</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">SpatialReference sr3857 = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">3857</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder constructors need to run on the MCT.</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> (SpatialReferenceBuilder srBuilder = <span class="keyword">new</span> SpatialReferenceBuilder(<span class="number">3857</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">    sr3857 = srBuilder.ToSpatialReference();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="构造空间引用-从字符串"><a href="#构造空间引用-从字符串" class="headerlink" title="构造空间引用 - 从字符串"></a>构造空间引用 - 从字符串</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> wkt = <span class="string">&quot;GEOGCS[\&quot;MyGCS84\&quot;,DATUM[\&quot;D_WGS_1984\&quot;,SPHEROID[\&quot;WGS_1984\&quot;,6378137.0,298.257223563]],PRIMEM[\&quot;Greenwich\&quot;,0.0],UNIT[\&quot;Radian\&quot;,1.0]]&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">SpatialReference sr = SpatialReferenceBuilder.CreateSpatialReference(wkt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder constructors need to run on the MCT.</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> (SpatialReferenceBuilder builder = <span class="keyword">new</span> SpatialReferenceBuilder(wkt))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">    SpatialReference anotherSR = builder.ToSpatialReference();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用-WGS84-空间参考"><a href="#使用-WGS84-空间参考" class="headerlink" title="使用 WGS84 空间参考"></a>使用 WGS84 空间参考</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference wgs84 = SpatialReferences.WGS84;</span><br><span class="line"><span class="built_in">bool</span> isProjected = wgs84.IsProjected;     <span class="comment">// false</span></span><br><span class="line"><span class="built_in">bool</span> isGeographic = wgs84.IsGeographic;   <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h3 id="使用垂直坐标系构造空间参考-从已知-ID"><a href="#使用垂直坐标系构造空间参考-从已知-ID" class="headerlink" title="使用垂直坐标系构造空间参考 - 从已知 ID"></a>使用垂直坐标系构造空间参考 - 从已知 ID</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// see a list of vertical coordinate systems at http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#/Vertical_coordinate_systems/02r3000000rn000000/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line"><span class="comment">// 4326 = GCS_WGS_1984</span></span><br><span class="line"><span class="comment">// 115700 = vertical WGS_1984</span></span><br><span class="line">SpatialReference sr4326_115700 = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>, <span class="number">115700</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder constructors need to run on the MCT.</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> (SpatialReferenceBuilder sb = <span class="keyword">new</span> SpatialReferenceBuilder(<span class="number">4326</span>, <span class="number">115700</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// SpatialReferenceBuilder properties</span></span><br><span class="line">    <span class="comment">//   sb.wkid == 4326</span></span><br><span class="line">    <span class="comment">//   sb.Wkt == &quot;GEOGCS[&quot;MyGCS84&quot;,DATUM[&quot;D_WGS_1984&quot;,SPHEROID[&quot;WGS_1984&quot;,6378137.0,298.257223563]],PRIMEM[&quot;Greenwich&quot;,0.0],UNIT[\&quot;Radian\&quot;,1.0]]&quot;</span></span><br><span class="line">    <span class="comment">//   sb.name == GCS_WGS_1984</span></span><br><span class="line">    <span class="comment">//   sb.vcsWkid == 115700</span></span><br><span class="line">    <span class="comment">//   sb.VcsWkt == &quot;VERTCS[&quot;WGS_1984&quot;,DATUM[&quot;D_WGS_1984&quot;,SPHEROID[&quot;WGS_1984&quot;,6378137.0,298.257223563]],PARAMETER[&quot;Vertical_Shift&quot;,0.0],PARAMETER[&quot;Direction&quot;,1.0],UNIT[&quot;Meter&quot;,1.0]]</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">    sr4326_115700 = sb.ToSpatialReference();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用垂直坐标系构造空间参考-从字符串"><a href="#使用垂直坐标系构造空间参考-从字符串" class="headerlink" title="使用垂直坐标系构造空间参考 - 从字符串"></a>使用垂直坐标系构造空间参考 - 从字符串</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// custom VCS - use vertical shift of -1.23 instead of 0</span></span><br><span class="line"><span class="built_in">string</span> custom_vWkt = <span class="string">@&quot;VERTCS[&quot;&quot;SHD_height&quot;&quot;,VDATUM[&quot;&quot;Singapore_Height_Datum&quot;&quot;],PARAMETER[&quot;&quot;Vertical_Shift&quot;&quot;,-1.23],PARAMETER[&quot;&quot;Direction&quot;&quot;,-1.0],UNIT[&quot;&quot;Meter&quot;&quot;,1.0]]&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">SpatialReference sr4326_customVertical = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>, custom_vWkt);</span><br><span class="line"><span class="comment">// SpatialReferenceBuilder properties</span></span><br><span class="line"><span class="comment">//   sr4326_customVertical.wkid == 4326</span></span><br><span class="line"><span class="comment">//   sr4326_customVertical.vert_wkid == 0</span></span><br><span class="line"><span class="comment">//   sr4326_customVertical.vert_wkt == custom_vWkt</span></span><br><span class="line"><span class="comment">//   sr4326_customVertical.hasVcs == true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder constructors need to run on the MCT.</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> (SpatialReferenceBuilder sb = <span class="keyword">new</span> SpatialReferenceBuilder(<span class="number">4326</span>, custom_vWkt))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">    sr4326_customVertical = sb.ToSpatialReference();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用自定义-PCS-构造空间参考-从字符串"><a href="#使用自定义-PCS-构造空间参考-从字符串" class="headerlink" title="使用自定义 PCS 构造空间参考 - 从字符串"></a>使用自定义 PCS 构造空间参考 - 从字符串</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom PCS, Predefined GCS</span></span><br><span class="line"><span class="built_in">string</span> customWkt = <span class="string">&quot;PROJCS[\&quot;WebMercatorMile\&quot;,GEOGCS[\&quot;GCS_WGS_1984\&quot;,DATUM[\&quot;D_WGS_1984\&quot;,SPHEROID[\&quot;WGS_1984\&quot;,6378137.0,298.257223563]],PRIMEM[\&quot;Greenwich\&quot;,0.0],UNIT[\&quot;Degree\&quot;,0.0174532925199433]],PROJECTION[\&quot;Mercator_Auxiliary_Sphere\&quot;],PARAMETER[\&quot;False_Easting\&quot;,0.0],PARAMETER[\&quot;False_Northing\&quot;,0.0],PARAMETER[\&quot;Central_Meridian\&quot;,0.0],PARAMETER[\&quot;Standard_Parallel_1\&quot;,0.0],PARAMETER[\&quot;Auxiliary_Sphere_Type\&quot;,0.0],UNIT[\&quot;Mile\&quot;,1609.344000614692]]&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">SpatialReference spatialReference = SpatialReferenceBuilder.CreateSpatialReference(customWkt);</span><br><span class="line"><span class="comment">// SpatialReferenceBuilder properties</span></span><br><span class="line"><span class="comment">//   spatialReference.Wkt == customWkt</span></span><br><span class="line"><span class="comment">//   spatialReference.Wkid == 0</span></span><br><span class="line"><span class="comment">//   spatialReference.VcsWkid == 0</span></span><br><span class="line"><span class="comment">//   spatialReference.GcsWkid == 4326</span></span><br><span class="line"></span><br><span class="line">SpatialReference gcs = spatialReference.Gcs;</span><br><span class="line"><span class="comment">// gcs.Wkid == 4326</span></span><br><span class="line"><span class="comment">// gcs.IsGeographic == true</span></span><br><span class="line"><span class="comment">// spatialReference.GcsWkt == gcs.Wkt</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder constructors need to run on the MCT.</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">using</span> (SpatialReferenceBuilder sb = <span class="keyword">new</span> SpatialReferenceBuilder(customWkt))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">    spatialReference = sb.ToSpatialReference();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="空间参考属性"><a href="#空间参考属性" class="headerlink" title="空间参考属性"></a>空间参考属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Builder constructors need to run on the MCT.</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// use the builder constructor</span></span><br><span class="line">  <span class="keyword">using</span> (SpatialReferenceBuilder srBuilder = <span class="keyword">new</span> SpatialReferenceBuilder(<span class="number">3857</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// spatial reference builder properties</span></span><br><span class="line">    <span class="built_in">int</span> builderWkid = srBuilder.Wkid;</span><br><span class="line">    <span class="built_in">string</span> builderWkt = srBuilder.Wkt;</span><br><span class="line">    <span class="built_in">string</span> builderName = srBuilder.Name;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> xyScale = srBuilder.XYScale;</span><br><span class="line">    <span class="built_in">double</span> xyTolerance = srBuilder.XYTolerance;</span><br><span class="line">    <span class="built_in">double</span> xyResolution = srBuilder.XYResolution;</span><br><span class="line">    Unit unit = srBuilder.Unit;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> zScale = srBuilder.ZScale;</span><br><span class="line">    <span class="built_in">double</span> zTolerance = srBuilder.ZTolerance;</span><br><span class="line">    Unit zUnit = srBuilder.ZUnit;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> mScale = srBuilder.MScale;</span><br><span class="line">    <span class="built_in">double</span> mTolerance = srBuilder.MTolerance;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> falseX = srBuilder.FalseX;</span><br><span class="line">    <span class="built_in">double</span> falseY = srBuilder.FalseY;</span><br><span class="line">    <span class="built_in">double</span> falseZ = srBuilder.FalseZ;</span><br><span class="line">    <span class="built_in">double</span> falseM = srBuilder.FalseM;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get the spatial reference</span></span><br><span class="line">    SpatialReference sr3857 = srBuilder.ToSpatialReference();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// spatial reference properties</span></span><br><span class="line">    <span class="built_in">int</span> srWkid = sr3857.Wkid;</span><br><span class="line">    <span class="built_in">string</span> srWkt = sr3857.Wkt;</span><br><span class="line">    <span class="built_in">string</span> srName = sr3857.Name;</span><br><span class="line"></span><br><span class="line">    xyScale = sr3857.XYScale;</span><br><span class="line">    xyTolerance = sr3857.XYTolerance;</span><br><span class="line">    xyResolution = sr3857.XYResolution;</span><br><span class="line">    unit = sr3857.Unit;</span><br><span class="line"></span><br><span class="line">    zScale = sr3857.ZScale;</span><br><span class="line">    zTolerance = sr3857.ZTolerance;</span><br><span class="line">    zUnit = sr3857.ZUnit;</span><br><span class="line"></span><br><span class="line">    mScale = sr3857.MScale;</span><br><span class="line">    mTolerance = sr3857.MTolerance;</span><br><span class="line"></span><br><span class="line">    falseX = sr3857.FalseX;</span><br><span class="line">    falseY = sr3857.FalseY;</span><br><span class="line">    falseZ = sr3857.FalseZ;</span><br><span class="line">    falseM = sr3857.FalseM;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">bool</span> hasVcs = sr3857.HasVcs;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="导入和导出空间参考"><a href="#导入和导出空间参考" class="headerlink" title="导入和导出空间参考"></a>导入和导出空间参考</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference srWithVertical = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>, <span class="number">6916</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> xml = srWithVertical.ToXml();</span><br><span class="line">SpatialReference importedSR = SpatialReferenceBuilder.FromXml(xml);</span><br><span class="line"><span class="comment">// importedSR.Wkid = 4326</span></span><br><span class="line"><span class="comment">// importedSR.VcsWkid = 6916</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> json = srWithVertical.ToJson();</span><br><span class="line">importedSR = SpatialReferenceBuilder.FromJson(json);</span><br><span class="line"><span class="comment">// importedSR.Wkid = 4326</span></span><br><span class="line"><span class="comment">// importedSR.VcsWkid = 6916</span></span><br></pre></td></tr></table></figure>

<h3 id="确定给定点处空间参考的格网收敛"><a href="#确定给定点处空间参考的格网收敛" class="headerlink" title="确定给定点处空间参考的格网收敛"></a>确定给定点处空间参考的格网收敛</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Coordinate2D coordinate = <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">30</span>);</span><br><span class="line"><span class="built_in">double</span> angle = SpatialReferences.WGS84.GetConvergenceAngle(coordinate);</span><br><span class="line"><span class="comment">// angle = 0</span></span><br><span class="line"></span><br><span class="line">SpatialReference srUTM30N = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">32630</span>);</span><br><span class="line">coordinate.X = <span class="number">500000</span>;</span><br><span class="line">coordinate.Y = <span class="number">550000</span>;</span><br><span class="line">angle = srUTM30N.GetConvergenceAngle(coordinate);</span><br><span class="line"><span class="comment">// angle = 0</span></span><br><span class="line"></span><br><span class="line">MapPoint pointWGS84 = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">50</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint pointUTM30N = GeometryEngine.Instance.Project(</span><br><span class="line">  pointWGS84, srUTM30N) <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line">coordinate = (Coordinate2D)pointUTM30N;</span><br><span class="line"><span class="comment">// get convergence angle and convert to degrees</span></span><br><span class="line">angle = srUTM30N.GetConvergenceAngle(coordinate) * <span class="number">180</span> / Math.PI;</span><br><span class="line"><span class="comment">// angle = 10.03</span></span><br></pre></td></tr></table></figure>

<h3 id="基准"><a href="#基准" class="headerlink" title="基准"></a>基准</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cimMapDefinition = MapView.Active.Map.GetDefinition();</span><br><span class="line"><span class="comment">// use if map&#x27;s sr does not have a vertical coordinate system</span></span><br><span class="line"><span class="keyword">var</span> datumTransformations = cimMapDefinition.DatumTransforms;</span><br><span class="line"><span class="comment">// use if map&#x27;s sr has a vertical coordinate system</span></span><br><span class="line"><span class="keyword">var</span> hvDatumTransformations = cimMapDefinition.HVDatumTransforms;</span><br></pre></td></tr></table></figure>

<h3 id="空间参照基准和基准属性"><a href="#空间参照基准和基准属性" class="headerlink" title="空间参照基准和基准属性"></a>空间参照基准和基准属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Get datum of a spatial reference</span></span><br><span class="line">SpatialReference srWgs84 = SpatialReferences.WGS84;</span><br><span class="line">Datum datum = srWgs84.Datum;</span><br><span class="line"><span class="comment">// datum.Name = &quot;D_WGS_1984&quot;</span></span><br><span class="line"><span class="comment">// datum.Wkid = 6326</span></span><br><span class="line"><span class="comment">// datum.SpheroidName = &quot;WGS_1984&quot;</span></span><br><span class="line"><span class="comment">// datum.SpheroidWkid = 7030</span></span><br><span class="line"><span class="comment">// datum.SpheroidFlattening = 0.0033528106647474805</span></span><br><span class="line"><span class="comment">// datum.SpheroidSemiMajorAxis = 6378137.0</span></span><br><span class="line"><span class="comment">// datum.SpheroidSemiMinorAxis = 6356752.3142451793</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Custom WKT</span></span><br><span class="line"><span class="built_in">string</span> wyomingWkt = <span class="string">&quot;PROJCS[\&quot;Wyoming_State_Pl_NAD_1927\&quot;,GEOGCS[\&quot;GCS_North_American_1927\&quot;,DATUM[\&quot;D_North_American_1927_Perry\&quot;,SPHEROID[\&quot;Clarke_1866_Chase\&quot;,6378210.0,250.0]],PRIMEM[\&quot;Greenwich\&quot;,0.0],UNIT[\&quot;Degree\&quot;,0.0174532925199433]],PROJECTION[\&quot;Transverse_Mercator\&quot;],PARAMETER[\&quot;false_easting\&quot;,500000.0],PARAMETER[\&quot;false_northing\&quot;,0.0],PARAMETER[\&quot;central_meridian\&quot;,-107.3333333],PARAMETER[\&quot;scale_factor\&quot;,0.9999412],PARAMETER[\&quot;latitude_of_origin\&quot;,40.66666667],UNIT[\&quot;Foot_US\&quot;,0.3048006096012192]]&quot;</span>;</span><br><span class="line">SpatialReference srFromWkt = SpatialReferenceBuilder.CreateSpatialReference(wyomingWkt);</span><br><span class="line">datum = srWgs84.Datum;</span><br><span class="line"><span class="comment">// datum.Name = &quot;D_North_American_1927_Perry&quot;</span></span><br><span class="line"><span class="comment">// datum.Wkid = 0</span></span><br><span class="line"><span class="comment">// datum.SpheroidName = &quot;Clarke_1866_Chase&quot;</span></span><br><span class="line"><span class="comment">// datum.SpheroidWkid = 0</span></span><br><span class="line"><span class="comment">// datum.SpheroidFlattening = 0.004</span></span><br><span class="line"><span class="comment">// datum.SpheroidSemiMajorAxis = 6378210.0</span></span><br><span class="line"><span class="comment">// datum.SpheroidSemiMinorAxis = 6352697.16</span></span><br></pre></td></tr></table></figure>

<h2 id="坐标3D"><a href="#坐标3D" class="headerlink" title="坐标3D"></a>坐标3D</h2><h3 id="矢量极坐标"><a href="#矢量极坐标" class="headerlink" title="矢量极坐标"></a>矢量极坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Coordinate3D polarVector = <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>);</span><br><span class="line">Tuple&lt;<span class="built_in">double</span>, <span class="built_in">double</span>, <span class="built_in">double</span>&gt; polarComponents = polarVector.QueryPolarComponents();</span><br><span class="line"><span class="comment">// polarComponents.Item1 = 0  (azimuth)</span></span><br><span class="line"><span class="comment">// polarComponents.Item2 = 0 (inclination)</span></span><br><span class="line"><span class="comment">// polarComponents.Item3 = 7 (magnitude)</span></span><br><span class="line"></span><br><span class="line">polarVector.SetPolarComponents(Math.PI / <span class="number">4</span>, Math.PI / <span class="number">2</span>, <span class="number">8</span>);</span><br><span class="line">polarComponents = polarVector.QueryComponents();</span><br><span class="line"><span class="comment">// polarComponents.Item1 = 0 (x)</span></span><br><span class="line"><span class="comment">// polarComponents.Item2 = 0 (y)</span></span><br><span class="line"><span class="comment">// polarComponents.Item3 = 7 (z)</span></span><br></pre></td></tr></table></figure>

<h3 id="获取矢量倾角"><a href="#获取矢量倾角" class="headerlink" title="获取矢量倾角"></a>获取矢量倾角</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Coordinate3D v = <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line"><span class="built_in">double</span> inclination = v.Inclination;         <span class="comment">// inclination = PI/2</span></span><br><span class="line"></span><br><span class="line">v.SetComponents(<span class="number">-2</span>, <span class="number">-3</span>, <span class="number">0</span>);</span><br><span class="line">inclination = v.Inclination;                <span class="comment">// inclination = 0</span></span><br><span class="line"></span><br><span class="line">v.SetComponents(<span class="number">0</span>, <span class="number">0</span>, <span class="number">-2</span>);</span><br><span class="line">inclination = v.Inclination;                <span class="comment">// inclination = -PI/2</span></span><br></pre></td></tr></table></figure>

<h3 id="获取矢量方位角"><a href="#获取矢量方位角" class="headerlink" title="获取矢量方位角"></a>获取矢量方位角</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Coordinate3D vector = <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">double</span> azimuth = vector.Azimuth;      <span class="comment">// azimuth = 0</span></span><br><span class="line"></span><br><span class="line">vector.SetComponents(<span class="number">1</span>, <span class="number">1</span>, <span class="number">42</span>);</span><br><span class="line">azimuth = vector.Azimuth;</span><br><span class="line"><span class="built_in">double</span> degrees = AngularUnit.Degrees.ConvertFromRadians(azimuth);       <span class="comment">// degrees = 45</span></span><br><span class="line"></span><br><span class="line">vector.SetComponents(<span class="number">-8</span>, <span class="number">8</span>, <span class="number">2</span>);</span><br><span class="line">azimuth = vector.Azimuth;</span><br><span class="line">degrees = AngularUnit.Degrees.ConvertFromRadians(azimuth);              <span class="comment">// degrees = 315</span></span><br></pre></td></tr></table></figure>

<h3 id="向量运算"><a href="#向量运算" class="headerlink" title="向量运算"></a>向量运算</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Easy 3D vectors</span></span><br><span class="line">Coordinate3D v = <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// v.Magnitude = 1</span></span><br><span class="line"></span><br><span class="line">Coordinate3D other = <span class="keyword">new</span> Coordinate3D(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// other.Magnitude = -1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> dotProduct = v.DotProduct(other);      <span class="comment">// dotProduct = 0</span></span><br><span class="line"></span><br><span class="line">Coordinate3D crossProduct = v.CrossProduct(other);</span><br><span class="line"><span class="comment">// crossProduct.X = 0</span></span><br><span class="line"><span class="comment">// crossProduct.Y = 0</span></span><br><span class="line"><span class="comment">// crossProduct.Z = 1</span></span><br><span class="line"></span><br><span class="line">Coordinate3D addVector = v.AddCoordinate3D(other);</span><br><span class="line"><span class="comment">// addVector.X = -1</span></span><br><span class="line"><span class="comment">// addVector.Y = 1</span></span><br><span class="line"><span class="comment">// addVector.Z = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Rotate around x-axis</span></span><br><span class="line">Coordinate3D w = v;</span><br><span class="line">w.Rotate(Math.PI, other);</span><br><span class="line"><span class="comment">// w.X = 0</span></span><br><span class="line"><span class="comment">// w.Y = -1</span></span><br><span class="line"><span class="comment">// w.Z = 0</span></span><br><span class="line"></span><br><span class="line">w.Scale(<span class="number">0.5</span>);</span><br><span class="line"><span class="comment">// w.X = 0</span></span><br><span class="line"><span class="comment">// w.Y = -0.5</span></span><br><span class="line"><span class="comment">// w.Z = 0</span></span><br><span class="line"></span><br><span class="line">w.Scale(<span class="number">-4</span>);</span><br><span class="line"><span class="comment">// w.X = 0</span></span><br><span class="line"><span class="comment">// ww.Y = 2</span></span><br><span class="line"><span class="comment">// w.Z = 0</span></span><br><span class="line"><span class="comment">// w.Magnitude = 2</span></span><br><span class="line"></span><br><span class="line">w.Move(<span class="number">3</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// w.X = 3</span></span><br><span class="line"><span class="comment">// w.Y = 4</span></span><br><span class="line"><span class="comment">// w.Z = 0</span></span><br><span class="line"><span class="comment">// w.Magnitude = 5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Coordinate3D emptyVector = <span class="keyword">new</span> Coordinate3D();</span><br><span class="line"><span class="comment">// emptyVector = (0, 0, 0)</span></span><br><span class="line">emptyVector.SetEmpty();</span><br><span class="line"><span class="comment">// emptyVector = (Nan, Nan, Nan)</span></span><br><span class="line"></span><br><span class="line">Coordinate3D c1 = <span class="keyword">new</span> Coordinate3D(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">Coordinate3D c2 = <span class="keyword">new</span> Coordinate3D(<span class="number">9</span>, <span class="number">-1</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> result_add = c1 + c2;</span><br><span class="line"><span class="comment">// result_add = (11, 2, 7)</span></span><br><span class="line"><span class="keyword">var</span> result_sub = c1 - c2;</span><br><span class="line"><span class="comment">// result_sub = (-7, 4, 1)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = result_sub != result_add;</span><br><span class="line"><span class="comment">// b = true</span></span><br><span class="line"></span><br><span class="line">result_add = emptyVector + c1;</span><br><span class="line"><span class="comment">// result_add = (Nan, Nan, Nan)</span></span><br><span class="line"></span><br><span class="line">b = result_add == emptyVector;</span><br><span class="line"><span class="comment">// b = true</span></span><br></pre></td></tr></table></figure>

<h3 id="2D-矢量操作"><a href="#2D-矢量操作" class="headerlink" title="2D 矢量操作"></a>2D 矢量操作</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">Coordinate2D v = <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// v.Magnitude = 1</span></span><br><span class="line"></span><br><span class="line">Coordinate2D other = <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">double</span> dotProduct = v.DotProduct(other);</span><br><span class="line"><span class="comment">// dotProduct = 0</span></span><br><span class="line"></span><br><span class="line">Coordinate2D w = v + other;</span><br><span class="line"><span class="comment">// w = (-1, 1)</span></span><br><span class="line"></span><br><span class="line">w += other;</span><br><span class="line"><span class="comment">// w = (-2, 1)</span></span><br><span class="line"></span><br><span class="line">w -= other;</span><br><span class="line"><span class="comment">// w = (-1, 1)</span></span><br><span class="line"></span><br><span class="line">w = v;</span><br><span class="line">w.Rotate(Math.PI, other);</span><br><span class="line"><span class="comment">// w = (-2, -1)</span></span><br><span class="line"></span><br><span class="line">w = other;</span><br><span class="line"></span><br><span class="line">w.Scale(<span class="number">-4</span>);</span><br><span class="line"><span class="comment">// w = (4, 0)</span></span><br><span class="line"><span class="comment">// w.Magnitude = 4</span></span><br><span class="line"></span><br><span class="line">w.Move(<span class="number">-1</span>, <span class="number">4</span>);</span><br><span class="line"><span class="comment">// w = (3, 4)</span></span><br><span class="line"><span class="comment">// w.Magnitude = 5</span></span><br><span class="line"></span><br><span class="line">w.Move(<span class="number">-6</span>, <span class="number">-1</span>);</span><br><span class="line">Tuple&lt;<span class="built_in">double</span>, <span class="built_in">double</span>&gt; components = w.QueryComponents();</span><br><span class="line"><span class="comment">// components = (-3, 3)</span></span><br><span class="line"><span class="comment">// w.Magnitude = 3 * Math.Sqrt(2)</span></span><br><span class="line"></span><br><span class="line">Coordinate2D unitVector = w.GetUnitVector();</span><br><span class="line"><span class="comment">// w = (-Math.Sqrt(2) / 2, Math.Sqrt(2) / 2)</span></span><br><span class="line"><span class="comment">// w.Magnitude = 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">w.SetComponents(<span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<h2 id="生成器属性"><a href="#生成器属性" class="headerlink" title="生成器属性"></a>生成器属性</h2><h3 id="生成器属性-1"><a href="#生成器属性-1" class="headerlink" title="生成器属性"></a>生成器属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// list of points</span></span><br><span class="line">List&lt;MapPoint&gt; points = <span class="keyword">new</span> List&lt;MapPoint&gt;</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// will have attributes because it is created with convenience method</span></span><br><span class="line">Polyline polylineWithAttrs = PolylineBuilderEx.CreatePolyline(points);</span><br><span class="line"><span class="built_in">bool</span> hasZ = polylineWithAttrs.HasZ;          <span class="comment">// hasZ = true</span></span><br><span class="line"><span class="built_in">bool</span> hasM = polylineWithAttrs.HasM;          <span class="comment">// hasM = true</span></span><br><span class="line"><span class="built_in">bool</span> hasID = polylineWithAttrs.HasID;        <span class="comment">// hasID = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will not have attributes because it is specified as a parameter</span></span><br><span class="line">Polyline polylineWithoutAttrs = </span><br><span class="line">  PolylineBuilderEx.CreatePolyline(points, AttributeFlags.None);</span><br><span class="line">hasZ = polylineWithoutAttrs.HasZ;          <span class="comment">// hasZ = false</span></span><br><span class="line">hasM = polylineWithoutAttrs.HasM;          <span class="comment">// hasM = false</span></span><br><span class="line">hasID = polylineWithoutAttrs.HasID;        <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will have attributes because it is created with convenience method</span></span><br><span class="line">Polygon polygonWithAttrs = PolygonBuilderEx.CreatePolygon(points);</span><br><span class="line">hasZ = polygonWithAttrs.HasZ;               <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = polygonWithAttrs.HasM;               <span class="comment">// hasM = true</span></span><br><span class="line">hasID = polygonWithAttrs.HasID;             <span class="comment">// hasID = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will not have attributes because it is specified as a parameter</span></span><br><span class="line">Polygon polygonWithoutAttrs = </span><br><span class="line">      PolygonBuilderEx.CreatePolygon(points, AttributeFlags.None);</span><br><span class="line">hasZ = polygonWithoutAttrs.HasZ;               <span class="comment">// hasZ = false</span></span><br><span class="line">hasM = polygonWithoutAttrs.HasM;               <span class="comment">// hasM = false</span></span><br><span class="line">hasID = polygonWithoutAttrs.HasID;             <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will not have attributes because it is specified as a parameter</span></span><br><span class="line">PolylineBuilderEx polylineB = </span><br><span class="line">           <span class="keyword">new</span> PolylineBuilderEx(points, AttributeFlags.None);</span><br><span class="line">hasZ = polylineB.HasZ;                      <span class="comment">// hasZ = false</span></span><br><span class="line">hasM = polylineB.HasM;                      <span class="comment">// hasM = false</span></span><br><span class="line">hasID = polylineB.HasID;                    <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will have attributes because it is passed an attributed polyline</span></span><br><span class="line">polylineB = <span class="keyword">new</span> PolylineBuilderEx(polylineWithAttrs);</span><br><span class="line">hasZ = polylineB.HasZ;                      <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = polylineB.HasM;                      <span class="comment">// hasM = true</span></span><br><span class="line">hasID = polylineB.HasID;                    <span class="comment">// hasID = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will not have attributes because it is passed a non-attributed polyline</span></span><br><span class="line">polylineB = <span class="keyword">new</span> PolylineBuilderEx(polylineWithoutAttrs);</span><br><span class="line">hasZ = polylineB.HasZ;                      <span class="comment">// hasZ = false</span></span><br><span class="line">hasM = polylineB.HasM;                      <span class="comment">// hasM = false</span></span><br><span class="line">hasID = polylineB.HasID;                    <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will not have attributes because it is specified as a parameter</span></span><br><span class="line">PolygonBuilderEx polygonB = <span class="keyword">new</span> PolygonBuilderEx(points, AttributeFlags.None);</span><br><span class="line">hasZ = polygonB.HasZ;                       <span class="comment">// hasZ = false</span></span><br><span class="line">hasM = polygonB.HasM;                       <span class="comment">// hasM = false</span></span><br><span class="line">hasID = polygonB.HasID;                     <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will have attributes because it is passed an attributed polygon</span></span><br><span class="line">polygonB = <span class="keyword">new</span> PolygonBuilderEx(polygonWithAttrs);</span><br><span class="line">hasZ = polygonB.HasZ;                       <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = polygonB.HasM;                       <span class="comment">// hasM = true</span></span><br><span class="line">hasID = polygonB.HasID;                     <span class="comment">// hasID = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// will not have attributes because it is passed a non-attributed polygon</span></span><br><span class="line">polygonB = <span class="keyword">new</span> PolygonBuilderEx(polygonWithoutAttrs);</span><br><span class="line">hasZ = polygonB.HasZ;                       <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = polygonB.HasM;                       <span class="comment">// hasM = true</span></span><br><span class="line">hasID = polygonB.HasID;                     <span class="comment">// hasID = true</span></span><br></pre></td></tr></table></figure>

<h2 id="地图点"><a href="#地图点" class="headerlink" title="地图点"></a>地图点</h2><h3 id="构造地图点"><a href="#构造地图点" class="headerlink" title="构造地图点"></a>构造地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a 3d point with M</span></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx constructors don&#x27;t need to run on the MCT.</span></span><br><span class="line">MapPointBuilderEx mb = <span class="keyword">new</span> MapPointBuilderEx(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>);</span><br><span class="line"><span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">MapPoint ptWithM = mb.ToGeometry();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MapPoint clone = ptWithM.Clone() <span class="keyword">as</span> MapPoint;</span><br><span class="line">MapPoint anotherM = MapPointBuilderEx.CreateMapPoint(ptWithM);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MapPointBuilderEx builderEx = <span class="keyword">new</span> MapPointBuilderEx(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>);</span><br><span class="line">builderEx.HasM = <span class="literal">true</span>;</span><br><span class="line">builderEx.M = <span class="number">4.0</span>;</span><br><span class="line"></span><br><span class="line">pt = builderEx.ToGeometry() <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// or another alternative with builderEx constructor</span></span><br><span class="line">builderEx = <span class="keyword">new</span> MapPointBuilderEx(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="literal">true</span>, <span class="number">3.0</span>, <span class="literal">true</span>, <span class="number">4.0</span>, <span class="literal">false</span>, <span class="number">0</span>);</span><br><span class="line">pt = builderEx.ToGeometry() <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// or use a builderEx convenience method</span></span><br><span class="line">pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>);</span><br></pre></td></tr></table></figure>

<h3 id="地图点生成器属性"><a href="#地图点生成器属性" class="headerlink" title="地图点生成器属性"></a>地图点生成器属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or a builderEx constructor.</span></span><br><span class="line"><span class="comment">//  neither need to run on the MCT.</span></span><br><span class="line"></span><br><span class="line">MapPoint point1 = <span class="literal">null</span>;</span><br><span class="line">MapPoint point2 = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">MapPointBuilderEx mb = <span class="keyword">new</span> MapPointBuilderEx(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>);</span><br><span class="line"><span class="built_in">bool</span> bhasZ = mb.HasZ;          <span class="comment">// hasZ = true</span></span><br><span class="line"><span class="built_in">bool</span> bhasM = mb.HasM;          <span class="comment">// hasM = false</span></span><br><span class="line"><span class="built_in">bool</span> bhasID = mb.HasID;        <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">point1 = mb.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="comment">// change some of the builder properties</span></span><br><span class="line">mb.X = <span class="number">11</span>;</span><br><span class="line">mb.Y = <span class="number">22</span>;</span><br><span class="line">mb.HasZ = <span class="literal">false</span>;</span><br><span class="line">mb.HasM = <span class="literal">true</span>;</span><br><span class="line">mb.M = <span class="number">44</span>;</span><br><span class="line"><span class="comment">// create another point</span></span><br><span class="line">point2 = mb.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> x = point1.X;                  <span class="comment">// x = 1.0</span></span><br><span class="line"><span class="built_in">double</span> y = point1.Y;                  <span class="comment">// y = 2.0</span></span><br><span class="line"><span class="built_in">double</span> z = point1.Z;                  <span class="comment">// z = 3.0</span></span><br><span class="line"><span class="built_in">double</span> m = point1.M;                  <span class="comment">// m = Nan</span></span><br><span class="line"><span class="built_in">int</span> ID = point1.ID;                   <span class="comment">// ID = 0</span></span><br><span class="line"><span class="built_in">bool</span> hasZ = point1.HasZ;              <span class="comment">// hasZ = true</span></span><br><span class="line"><span class="built_in">bool</span> hasM = point1.HasM;              <span class="comment">// hasM = false</span></span><br><span class="line"><span class="built_in">bool</span> hasID = point1.HasID;            <span class="comment">// hasID = false</span></span><br><span class="line"><span class="built_in">bool</span> isEmpty = point1.IsEmpty;        <span class="comment">// isEmpty = false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> isEqual = point1.IsEqual(point2);    <span class="comment">// isEqual = false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods </span></span><br><span class="line">MapPoint point3 = MapPointBuilderEx.CreateMapPoint(point1);</span><br><span class="line">x = point3.X;                   <span class="comment">// x = 1.0</span></span><br><span class="line">y = point3.Y;                   <span class="comment">// y = 2.0</span></span><br><span class="line">z = point3.Z;                   <span class="comment">// z = 3.0</span></span><br><span class="line">m = point3.M;                   <span class="comment">// m = Nan</span></span><br><span class="line">ID = point3.ID;                 <span class="comment">// ID = 0</span></span><br><span class="line">hasZ = point3.HasZ;             <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = point3.HasM;             <span class="comment">// hasM = false</span></span><br><span class="line">hasID = point3.HasID;           <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MapPointBuilderEx builderEx = <span class="keyword">new</span> MapPointBuilderEx(point1);</span><br><span class="line">x = builderEx.X;              <span class="comment">// x = 1.0</span></span><br><span class="line">y = builderEx.Y;              <span class="comment">// y = 2.0</span></span><br><span class="line">z = builderEx.Z;              <span class="comment">// z = 3.0</span></span><br><span class="line">m = builderEx.M;              <span class="comment">// m = Nan</span></span><br><span class="line">ID = builderEx.ID;            <span class="comment">// ID = 0</span></span><br><span class="line">hasZ = builderEx.HasZ;        <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = builderEx.HasM;        <span class="comment">// hasM = false</span></span><br><span class="line">hasID = builderEx.HasID;      <span class="comment">// hasID = false</span></span><br><span class="line">isEmpty = builderEx.IsEmpty;     <span class="comment">// isEmpty = false</span></span><br><span class="line"></span><br><span class="line">MapPoint point4 = builderEx.ToGeometry() <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MapPoint point5 = MapPointBuilderEx.CreateMapPoint(point1);</span><br><span class="line">x = point5.X;              <span class="comment">// x = 1.0</span></span><br><span class="line">y = point5.Y;              <span class="comment">// y = 2.0</span></span><br><span class="line">z = point5.Z;              <span class="comment">// z = 3.0</span></span><br><span class="line">m = point5.M;              <span class="comment">// m = Nan</span></span><br><span class="line">ID = point5.ID;            <span class="comment">// ID = 0</span></span><br><span class="line">hasZ = point5.HasZ;        <span class="comment">// hasZ = true</span></span><br><span class="line">hasM = point5.HasM;        <span class="comment">// hasM = false</span></span><br><span class="line">hasID = point5.HasID;      <span class="comment">// hasID = false</span></span><br><span class="line">isEmpty = point5.IsEmpty;     <span class="comment">// isEmpty = false</span></span><br></pre></td></tr></table></figure>

<h3 id="地图点是平等的"><a href="#地图点是平等的" class="headerlink" title="地图点是平等的"></a>地图点是平等的</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line"><span class="built_in">int</span> ID = pt1.ID;           <span class="comment">// ID = 5</span></span><br><span class="line"><span class="built_in">bool</span> hasID = pt1.HasID;     <span class="comment">// hasID = true</span></span><br><span class="line"></span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">0</span>);</span><br><span class="line">ID = pt2.ID;        <span class="comment">// ID = 0</span></span><br><span class="line">hasID = pt2.HasID;  <span class="comment">// hasID = true</span></span><br><span class="line"></span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">ID = pt3.ID;          <span class="comment">// ID = 0</span></span><br><span class="line">hasID = pt3.HasID;    <span class="comment">// hasID = false</span></span><br><span class="line"></span><br><span class="line">MapPoint pt4 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">44</span>);</span><br><span class="line">ID = pt4.ID;          <span class="comment">// ID = 0</span></span><br><span class="line">hasID = pt4.HasID;    <span class="comment">// hasID = false</span></span><br><span class="line"><span class="built_in">bool</span> hasM = pt4.HasM; <span class="comment">// hasM = true</span></span><br><span class="line"></span><br><span class="line">MapPoint pt5 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">ID = pt5.ID;          <span class="comment">// ID = 0</span></span><br><span class="line">hasID = pt5.HasID;    <span class="comment">// hasID = false</span></span><br><span class="line">hasM = pt5.HasM;      <span class="comment">// hasM = false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> isEqual = pt1.IsEqual(pt2);   <span class="comment">// isEqual = false, different IDs</span></span><br><span class="line">isEqual = pt2.IsEqual(pt3);        <span class="comment">// isEqual = false, HasId is different</span></span><br><span class="line">isEqual = pt4.IsEqual(pt3);        <span class="comment">// isEqual = false, different Ms</span></span><br><span class="line">isEqual = pt1.IsEqual(pt5);        <span class="comment">// isEqual = false, pt has M, id but pt5 does not.  </span></span><br></pre></td></tr></table></figure>

<h3 id="缩放至指定点"><a href="#缩放至指定点" class="headerlink" title="缩放至指定点"></a>缩放至指定点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a point</span></span><br><span class="line"><span class="keyword">var</span> pt = MapPointBuilderEx.CreateMapPoint(x, y, </span><br><span class="line">               SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>));</span><br><span class="line"><span class="comment">//Buffer it - for purpose of zoom</span></span><br><span class="line"><span class="keyword">var</span> poly = GeometryEngine.Instance.Buffer(pt, buffer_size);</span><br><span class="line"></span><br><span class="line"><span class="comment">//do we need to project the buffer polygon?</span></span><br><span class="line"><span class="keyword">if</span> (!MapView.Active.Map.SpatialReference.IsEqual(poly.SpatialReference))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//project the polygon</span></span><br><span class="line">  poly = GeometryEngine.Instance.Project(poly, MapView.Active.Map.SpatialReference);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Must run on MCT.</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Zoom - add in a delay for animation effect</span></span><br><span class="line">  MapView.Active.ZoomTo(poly, <span class="keyword">new</span> TimeSpan(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="折线"><a href="#折线" class="headerlink" title="折线"></a>折线</h2><h3 id="构造折线-从映射点的枚举"><a href="#构造折线-从映射点的枚举" class="headerlink" title="构造折线 - 从映射点的枚举"></a>构造折线 - 从映射点的枚举</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or a builderEx constructor.</span></span><br><span class="line"><span class="comment">// neither need to run on the MCT</span></span><br><span class="line"></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(startPt);</span><br><span class="line">list.Add(endPt);</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(list, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// use AttributeFlags.None since we only have 2D points in the list</span></span><br><span class="line">PolylineBuilderEx pb = <span class="keyword">new</span> PolylineBuilderEx(list, AttributeFlags.None);</span><br><span class="line">pb.SpatialReference = SpatialReferences.WGS84;</span><br><span class="line">Polyline polyline2 = pb.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="comment">//     use AttributeFlags.NoAttributes because we only have 2d points in the list</span></span><br><span class="line">Polyline polyline4 = PolylineBuilderEx.CreatePolyline(list, AttributeFlags.None);</span><br></pre></td></tr></table></figure>

<h3 id="获取折线的点"><a href="#获取折线的点" class="headerlink" title="获取折线的点"></a>获取折线的点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the points as a readonly Collection</span></span><br><span class="line">ReadOnlyPointCollection pts = polyline.Points;</span><br><span class="line"><span class="built_in">int</span> numPts = polyline.PointCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// OR   get an enumeration of the points</span></span><br><span class="line">IEnumerator&lt;MapPoint&gt; enumPts = polyline.Points.GetEnumerator();</span><br><span class="line"></span><br><span class="line"><span class="comment">// OR   get the point coordinates as a readonly list of Coordinate2D</span></span><br><span class="line">IReadOnlyList&lt;Coordinate2D&gt; coordinates = polyline.Copy2DCoordinatesToList();</span><br><span class="line"></span><br><span class="line"><span class="comment">// OR   get the point coordinates as a readonly list of Coordinate3D</span></span><br><span class="line">IReadOnlyList&lt;Coordinate3D&gt; coordinates3D = polyline.Copy3DCoordinatesToList();</span><br><span class="line"></span><br><span class="line"><span class="comment">// OR   get a subset of the collection as Coordinate2D using preallocated memory</span></span><br><span class="line"></span><br><span class="line">IList&lt;Coordinate2D&gt; coordinate2Ds = <span class="keyword">new</span> List&lt;Coordinate2D&gt;(<span class="number">10</span>);   <span class="comment">// allocate some space</span></span><br><span class="line">ICollection&lt;Coordinate2D&gt; subsetCoordinates2D = coordinate2Ds;    <span class="comment">// assign</span></span><br><span class="line">pts.Copy2DCoordinatesToList(<span class="number">1</span>, <span class="number">2</span>, <span class="keyword">ref</span> subsetCoordinates2D);       <span class="comment">// copy 2 elements from index 1 into the allocated list</span></span><br><span class="line">                                                                  <span class="comment">// coordinate2Ds.Count = 2</span></span><br><span class="line">                                                                  <span class="comment">// do something with the coordinate2Ds</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// without allocating more space, obtain a different set of coordinates</span></span><br><span class="line">pts.Copy2DCoordinatesToList(<span class="number">5</span>, <span class="number">9</span>, <span class="keyword">ref</span> subsetCoordinates2D);       <span class="comment">// copy 9 elements from index 5 into the allocated list</span></span><br><span class="line">                                                                  <span class="comment">// coordinate2Ds.Count = 9</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// OR   get a subset of the collection as Coordinate3D using preallocated memory</span></span><br><span class="line"></span><br><span class="line">IList&lt;Coordinate3D&gt; coordinate3Ds = <span class="keyword">new</span> List&lt;Coordinate3D&gt;(<span class="number">15</span>);   <span class="comment">// allocate some space</span></span><br><span class="line">ICollection&lt;Coordinate3D&gt; subsetCoordinates3D = coordinate3Ds;    <span class="comment">// assign</span></span><br><span class="line">pts.Copy3DCoordinatesToList(<span class="number">3</span>, <span class="number">5</span>, <span class="keyword">ref</span> subsetCoordinates3D);       <span class="comment">// copy 5 elements from index 3 into the allocated list</span></span><br><span class="line">                                                                  <span class="comment">// coordinate3Ds.Count = 5</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// OR   get a subset of the collection as MapPoint using preallocated memory</span></span><br><span class="line"></span><br><span class="line">IList&lt;MapPoint&gt; mapPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;(<span class="number">7</span>);   <span class="comment">// allocate some space</span></span><br><span class="line">ICollection&lt;MapPoint&gt; subsetMapPoint = mapPoints;    <span class="comment">// assign</span></span><br><span class="line">pts.CopyPointsToList(<span class="number">1</span>, <span class="number">4</span>, <span class="keyword">ref</span> subsetMapPoint);      <span class="comment">// copy 4 elements from index 1 into the allocated list</span></span><br><span class="line">                                                     <span class="comment">// mapPoints.Count = 4</span></span><br></pre></td></tr></table></figure>

<h3 id="获取折线的各个部分"><a href="#获取折线的各个部分" class="headerlink" title="获取折线的各个部分"></a>获取折线的各个部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> numParts = polyline.PartCount;</span><br><span class="line"><span class="comment">// get the parts as a readonly collection</span></span><br><span class="line">ReadOnlyPartCollection parts = polyline.Parts;</span><br></pre></td></tr></table></figure>

<h3 id="枚举折线的各个部分"><a href="#枚举折线的各个部分" class="headerlink" title="枚举折线的各个部分"></a>枚举折线的各个部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">ReadOnlyPartCollection polylineParts = polyline.Parts;</span><br><span class="line"></span><br><span class="line"><span class="comment">// enumerate the segments to get the length</span></span><br><span class="line"><span class="built_in">double</span> len = <span class="number">0</span>;</span><br><span class="line">IEnumerator&lt;ReadOnlySegmentCollection&gt; segments = polylineParts.GetEnumerator();</span><br><span class="line"><span class="keyword">while</span> (segments.MoveNext())</span><br><span class="line">&#123;</span><br><span class="line">  ReadOnlySegmentCollection seg = segments.Current;</span><br><span class="line">  <span class="keyword">foreach</span> (Segment s <span class="keyword">in</span> seg)</span><br><span class="line">  &#123;</span><br><span class="line">    len += s.Length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// perhaps do something specific per segment type</span></span><br><span class="line">    <span class="keyword">switch</span> (s.SegmentType)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> SegmentType.Line:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> SegmentType.Bezier:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> SegmentType.EllipticArc:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// or use foreach pattern</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> part <span class="keyword">in</span> polyline.Parts)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> segment <span class="keyword">in</span> part)</span><br><span class="line">  &#123;</span><br><span class="line">    len += segment.Length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// perhaps do something specific per segment type</span></span><br><span class="line">    <span class="keyword">switch</span> (segment.SegmentType)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> SegmentType.Line:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> SegmentType.Bezier:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> SegmentType.EllipticArc:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="反转折线中点的顺序"><a href="#反转折线中点的顺序" class="headerlink" title="反转折线中点的顺序"></a>反转折线中点的顺序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> polylineBuilder = <span class="keyword">new</span> PolylineBuilderEx(polyline);</span><br><span class="line">polylineBuilder.ReverseOrientation();</span><br><span class="line">Polyline reversedPolyline = polylineBuilder.ToGeometry();</span><br></pre></td></tr></table></figure>

<h3 id="获取折线的段"><a href="#获取折线的段" class="headerlink" title="获取折线的段"></a>获取折线的段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ICollection&lt;Segment&gt; collection = <span class="keyword">new</span> List&lt;Segment&gt;();</span><br><span class="line">polyline.GetAllSegments(<span class="keyword">ref</span> collection);</span><br><span class="line"><span class="built_in">int</span> numSegments = collection.Count;    <span class="comment">// = 10</span></span><br><span class="line"></span><br><span class="line">IList&lt;Segment&gt; iList = collection <span class="keyword">as</span> IList&lt;Segment&gt;;</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; numSegments; i++)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// do something with iList[i]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// use the segments to build another polyline</span></span><br><span class="line">Polyline polylineFromSegments = PolylineBuilderEx.CreatePolyline(collection);</span><br></pre></td></tr></table></figure>

<h3 id="构建多部分折线"><a href="#构建多部分折线" class="headerlink" title="构建多部分折线"></a>构建多部分折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MapPoint&gt; firstPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">firstPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">firstPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">firstPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">firstPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; nextPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">nextPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">11.0</span>, <span class="number">1.0</span>));</span><br><span class="line">nextPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">11.0</span>, <span class="number">2.0</span>));</span><br><span class="line">nextPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">12.0</span>, <span class="number">2.0</span>));</span><br><span class="line">nextPoints.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">12.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// use AttributeFlags.None since we have 2D points in the list</span></span><br><span class="line">PolylineBuilderEx pBuilder = <span class="keyword">new</span> PolylineBuilderEx(firstPoints, AttributeFlags.None);</span><br><span class="line">pBuilder.AddPart(nextPoints);</span><br><span class="line"></span><br><span class="line">Polyline polyline = pBuilder.ToGeometry();</span><br><span class="line"><span class="comment">// polyline has 2 parts</span></span><br><span class="line"></span><br><span class="line">pBuilder.RemovePart(<span class="number">0</span>);</span><br><span class="line">polyline = pBuilder.ToGeometry();</span><br><span class="line"><span class="comment">// polyline has 1 part</span></span><br></pre></td></tr></table></figure>

<h3 id="折线的起点"><a href="#折线的起点" class="headerlink" title="折线的起点"></a>折线的起点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Method 1: Get the start point of the polyline by converting the polyline </span></span><br><span class="line"><span class="comment">//    into a collection of points and getting the first point</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// sketchGeometry is a Polyline</span></span><br><span class="line"><span class="comment">// get the sketch as a point collection</span></span><br><span class="line"><span class="keyword">var</span> pointCol = ((Multipart)sketchGeometry).Points;</span><br><span class="line"><span class="comment">// Get the start point of the line</span></span><br><span class="line"><span class="keyword">var</span> firstPoint = pointCol[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Method 2: Convert polyline into a collection of line segments </span></span><br><span class="line"><span class="comment">//   and get the &quot;StartPoint&quot; of the first line segment.</span></span><br><span class="line"><span class="keyword">var</span> polylineGeom = sketchGeometry <span class="keyword">as</span> ArcGIS.Core.Geometry.Polyline;</span><br><span class="line"><span class="keyword">var</span> polyLineParts = polylineGeom.Parts;</span><br><span class="line"></span><br><span class="line">ReadOnlySegmentCollection polylineSegments = polyLineParts.First();</span><br><span class="line"></span><br><span class="line"><span class="comment">//get the first segment as a LineSegment</span></span><br><span class="line"><span class="keyword">var</span> firsLineSegment = polylineSegments.First() <span class="keyword">as</span> LineSegment;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Now get the start Point</span></span><br><span class="line"><span class="keyword">var</span> startPoint = firsLineSegment.StartPoint;</span><br></pre></td></tr></table></figure>

<h3 id="按角度构造布料"><a href="#按角度构造布料" class="headerlink" title="按角度构造布料"></a>按角度构造布料</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MapPoint startPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">double</span> tangentDirection = Math.PI / <span class="number">6</span>;</span><br><span class="line">ArcOrientation orientation = ArcOrientation.ArcCounterClockwise;</span><br><span class="line"><span class="built_in">double</span> startRadius = <span class="built_in">double</span>.PositiveInfinity;</span><br><span class="line"><span class="built_in">double</span> endRadius = <span class="number">0.2</span>;</span><br><span class="line">ClothoidCreateMethod createMethod = ClothoidCreateMethod.ByAngle;</span><br><span class="line"><span class="built_in">double</span> angle = Math.PI / <span class="number">2</span>;</span><br><span class="line">CurveDensifyMethod densifyMethod = CurveDensifyMethod.ByLength;</span><br><span class="line"><span class="built_in">double</span> densifyParameter = <span class="number">0.1</span>;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(startPoint, tangentDirection, startRadius, endRadius, orientation, createMethod, angle, densifyMethod, densifyParameter, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> numPoints = polyline.PointCount;</span><br><span class="line">MapPoint queryPoint = polyline.Points[numPoints - <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">MapPoint pointOnPath;</span><br><span class="line"><span class="built_in">double</span> radiusCalculated, tangentDirectionCalculated, lengthCalculated, angleCalculated;</span><br><span class="line"></span><br><span class="line">PolylineBuilderEx.QueryClothoidParameters(queryPoint, startPoint, tangentDirection, startRadius, endRadius, orientation, createMethod, angle, <span class="keyword">out</span> pointOnPath, <span class="keyword">out</span> radiusCalculated, <span class="keyword">out</span> tangentDirectionCalculated, <span class="keyword">out</span> lengthCalculated, <span class="keyword">out</span> angleCalculated, SpatialReferences.WGS84);</span><br></pre></td></tr></table></figure>

<h3 id="按长度构造布料"><a href="#按长度构造布料" class="headerlink" title="按长度构造布料"></a>按长度构造布料</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">MapPoint startPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">MapPoint queryPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">3.8</span>, <span class="number">1</span>);</span><br><span class="line"><span class="built_in">double</span> tangentDirection = <span class="number">0</span>;</span><br><span class="line">ArcOrientation orientation = ArcOrientation.ArcCounterClockwise;</span><br><span class="line"><span class="built_in">double</span> startRadius = <span class="built_in">double</span>.PositiveInfinity;</span><br><span class="line"><span class="built_in">double</span> endRadius = <span class="number">1</span>;</span><br><span class="line">ClothoidCreateMethod createMethod = ClothoidCreateMethod.ByLength;</span><br><span class="line"><span class="built_in">double</span> curveLength = <span class="number">10</span>;</span><br><span class="line">MapPoint pointOnPath;</span><br><span class="line"><span class="built_in">double</span> radiusCalculated, tangentDirectionCalculated, lengthCalculated, angleCalculated;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PolylineBuilderEx.QueryClothoidParameters(queryPoint, startPoint, tangentDirection, startRadius, endRadius, orientation, createMethod, curveLength, <span class="keyword">out</span> pointOnPath, <span class="keyword">out</span> radiusCalculated, <span class="keyword">out</span> tangentDirectionCalculated, <span class="keyword">out</span> lengthCalculated, <span class="keyword">out</span> angleCalculated, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">pointOnPath = MapPointBuilderEx.CreateMapPoint(<span class="number">3.7652656620171379</span>, <span class="number">1.0332006103128575</span>);</span><br><span class="line">radiusCalculated = <span class="number">2.4876382887687227</span>;</span><br><span class="line">tangentDirectionCalculated = <span class="number">0.80797056423543978</span>;</span><br><span class="line">lengthCalculated = <span class="number">4.0198770235802987</span>;</span><br><span class="line">angleCalculated = <span class="number">0.80797056423544011</span>;</span><br><span class="line"></span><br><span class="line">queryPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">1.85</span>, <span class="number">2.6</span>);</span><br><span class="line"></span><br><span class="line">PolylineBuilderEx.QueryClothoidParameters(queryPoint, startPoint, tangentDirection, startRadius, endRadius, orientation, createMethod, curveLength, <span class="keyword">out</span> pointOnPath, <span class="keyword">out</span> radiusCalculated, <span class="keyword">out</span> tangentDirectionCalculated, <span class="keyword">out</span> lengthCalculated, <span class="keyword">out</span> angleCalculated, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">pointOnPath = MapPointBuilderEx.CreateMapPoint(<span class="number">1.8409964973501549</span>, <span class="number">2.6115979967308132</span>);</span><br><span class="line">radiusCalculated = <span class="number">1</span>;</span><br><span class="line">tangentDirectionCalculated = <span class="number">-1.2831853071795867</span>;</span><br><span class="line">lengthCalculated = <span class="number">10</span>;</span><br><span class="line">angleCalculated = <span class="number">5</span>;</span><br><span class="line"> </span><br><span class="line">tangentDirection = Math.PI / <span class="number">4</span>;</span><br><span class="line">orientation = ArcOrientation.ArcClockwise;</span><br><span class="line">startRadius = <span class="built_in">double</span>.PositiveInfinity;</span><br><span class="line">endRadius = <span class="number">0.8</span>;</span><br><span class="line">createMethod = ClothoidCreateMethod.ByLength;</span><br><span class="line">curveLength = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(startPoint, tangentDirection, startRadius, endRadius, orientation, createMethod, curveLength, CurveDensifyMethod.ByLength, <span class="number">0.5</span>, SpatialReferences.WGS84);</span><br></pre></td></tr></table></figure>

<h3 id="远距离分割折线"><a href="#远距离分割折线" class="headerlink" title="远距离分割折线"></a>远距离分割折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create list of points</span></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(startPt);</span><br><span class="line">list.Add(endPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors don&#x27;t need to run on the MCT.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the PolylineBuilder as we wish to manipulate the geometry</span></span><br><span class="line"><span class="comment">// use AttributeFlags.None as we have 2D points</span></span><br><span class="line">PolylineBuilderEx polylineBuilder = <span class="keyword">new</span> PolylineBuilderEx(list, AttributeFlags.None);</span><br><span class="line"><span class="comment">// split at a distance 0.75</span></span><br><span class="line">polylineBuilder.SplitAtDistance(<span class="number">0.75</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// get the polyline</span></span><br><span class="line">Polyline p = polylineBuilder.ToGeometry();</span><br><span class="line"><span class="comment">// polyline p should have 3 points  (1,1), (1.75, 1), (2,1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// add another path</span></span><br><span class="line">MapPoint p1 = MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint p2 = MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint p3 = MapPointBuilderEx.CreateMapPoint(<span class="number">7.0</span>, <span class="number">1.0</span>);</span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(p1);</span><br><span class="line">pts.Add(p2);</span><br><span class="line">pts.Add(p3);</span><br><span class="line"></span><br><span class="line">polylineBuilder.AddPart(pts);</span><br><span class="line">p = polylineBuilder.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline p has 2 parts.  Each part has 3 points</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// split the 2nd path half way - dont create a new path</span></span><br><span class="line">polylineBuilder.SplitPartAtDistance(<span class="number">1</span>, <span class="number">0.5</span>, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">p = polylineBuilder.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline p still has 2 parts; but now has 7 points </span></span><br></pre></td></tr></table></figure>

<h2 id="多边形"><a href="#多边形" class="headerlink" title="多边形"></a>多边形</h2><h3 id="构造多边形-从映射点的枚举"><a href="#构造多边形-从映射点的枚举" class="headerlink" title="构造多边形 - 从映射点的枚举"></a>构造多边形 - 从映射点的枚举</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>);</span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line">MapPoint pt4 = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; pt1, pt2, pt3, pt4 &#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list, SpatialReferences.WGS84);</span><br><span class="line"><span class="comment">// polygon.HasZ will be false - it is determined by the HasZ flag of the points in the list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// or specifically use AttributeFlags.NoAttributes</span></span><br><span class="line">polygon = PolygonBuilderEx.CreatePolygon(list, AttributeFlags.None);</span><br><span class="line"></span><br><span class="line"><span class="comment">// use AttributeFlags.None as we have 2D points</span></span><br><span class="line">PolygonBuilderEx polygonBuilder = <span class="keyword">new</span> PolygonBuilderEx(list, AttributeFlags.None);</span><br><span class="line">polygonBuilder.SpatialReference = SpatialReferences.WGS84;</span><br><span class="line">polygon = polygonBuilder.ToGeometry();</span><br></pre></td></tr></table></figure>

<h3 id="构造多边形-从信封"><a href="#构造多边形-从信封" class="headerlink" title="构造多边形 - 从信封"></a>构造多边形 - 从信封</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint minPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint maxPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create an envelope</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(minPt, maxPt);</span><br><span class="line"></span><br><span class="line">Polygon polygonFromEnv = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line"></span><br><span class="line">PolygonBuilderEx polygonBuilderEx = <span class="keyword">new</span> PolygonBuilderEx(env);</span><br><span class="line">polygonBuilderEx.SpatialReference = SpatialReferences.WGS84;</span><br><span class="line">polygonFromEnv = polygonBuilderEx.ToGeometry() <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="获取多边形的点"><a href="#获取多边形的点" class="headerlink" title="获取多边形的点"></a>获取多边形的点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the points as a readonly Collection</span></span><br><span class="line">ReadOnlyPointCollection pts = polygon.Points;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get an enumeration of the points</span></span><br><span class="line">IEnumerator&lt;MapPoint&gt; enumPts = polygon.Points.GetEnumerator();</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the point coordinates as a readonly list of Coordinate2D</span></span><br><span class="line">IReadOnlyList&lt;Coordinate2D&gt; coordinates = polygon.Copy2DCoordinatesToList();</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the point coordinates as a readonly list of Coordinate3D</span></span><br><span class="line">IReadOnlyList&lt;Coordinate3D&gt; coordinates3D = polygon.Copy3DCoordinatesToList();</span><br></pre></td></tr></table></figure>

<h3 id="获取多边形的各个部分"><a href="#获取多边形的各个部分" class="headerlink" title="获取多边形的各个部分"></a>获取多边形的各个部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the parts as a readonly collection</span></span><br><span class="line">ReadOnlyPartCollection parts = polygon.Parts;</span><br></pre></td></tr></table></figure>

<h3 id="枚举多边形的各个部分"><a href="#枚举多边形的各个部分" class="headerlink" title="枚举多边形的各个部分"></a>枚举多边形的各个部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> numSegments = <span class="number">0</span>;</span><br><span class="line">IEnumerator&lt;ReadOnlySegmentCollection&gt; segments = polygon.Parts.GetEnumerator();</span><br><span class="line"><span class="keyword">while</span> (segments.MoveNext())</span><br><span class="line">&#123;</span><br><span class="line">  ReadOnlySegmentCollection seg = segments.Current;</span><br><span class="line">  numSegments += seg.Count;</span><br><span class="line">  <span class="keyword">foreach</span> (Segment s <span class="keyword">in</span> seg)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something with the segment</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取多边形的线段"><a href="#获取多边形的线段" class="headerlink" title="获取多边形的线段"></a>获取多边形的线段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Segment&gt; segmentList = <span class="keyword">new</span> List&lt;Segment&gt;(<span class="number">30</span>);</span><br><span class="line">ICollection&lt;Segment&gt; collection = segmentList;</span><br><span class="line">polygon.GetAllSegments(<span class="keyword">ref</span> collection);</span><br><span class="line"><span class="comment">// segmentList.Count = 4</span></span><br><span class="line"><span class="comment">// segmentList.Capacity = 30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the segments to build another polygon</span></span><br><span class="line">Polygon polygonFromSegments = PolygonBuilderEx.CreatePolygon(collection);</span><br></pre></td></tr></table></figure>

<h3 id="构建圆环多边形"><a href="#构建圆环多边形" class="headerlink" title="构建圆环多边形"></a>构建圆环多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; outerCoordinates = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">outerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">10.0</span>, <span class="number">10.0</span>));</span><br><span class="line">outerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">10.0</span>, <span class="number">20.0</span>));</span><br><span class="line">outerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">20.0</span>, <span class="number">20.0</span>));</span><br><span class="line">outerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">20.0</span>, <span class="number">10.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// define the inner polygon as anti-clockwise</span></span><br><span class="line">List&lt;Coordinate2D&gt; innerCoordinates = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">innerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">13.0</span>, <span class="number">13.0</span>));</span><br><span class="line">innerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">17.0</span>, <span class="number">13.0</span>));</span><br><span class="line">innerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">17.0</span>, <span class="number">17.0</span>));</span><br><span class="line">innerCoordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">13.0</span>, <span class="number">17.0</span>));</span><br><span class="line"></span><br><span class="line">PolygonBuilderEx pbEx = <span class="keyword">new</span> PolygonBuilderEx(outerCoordinates);</span><br><span class="line">Polygon donutEx = pbEx.ToGeometry() <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="built_in">double</span> areaEx = donutEx.Area;       <span class="comment">// area = 100</span></span><br><span class="line"></span><br><span class="line">pbEx.AddPart(innerCoordinates);</span><br><span class="line">donutEx = pbEx.ToGeometry() <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line">areaEx = donutEx.Area;    <span class="comment">// area = 84.0</span></span><br><span class="line"></span><br><span class="line">areaEx = GeometryEngine.Instance.Area(donutEx);    <span class="comment">// area = 84.0</span></span><br></pre></td></tr></table></figure>

<h3 id="创建-N-侧正多边形"><a href="#创建-N-侧正多边形" class="headerlink" title="创建 N 侧正多边形"></a>创建 N 侧正多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">// Create an N-sided regular polygon.  A regular sided polygon is a polygon that is equiangular (all angles are equal in measure) </span></span><br><span class="line"><span class="comment">// and equilateral (all sides are equal in length).  See https://en.wikipedia.org/wiki/Regular_polygon</span></span><br><span class="line"><span class="comment">// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;numSides&quot;&gt;The number of sides in the polygon.&lt;/param&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;center&quot;&gt;The center of the polygon.&lt;/param&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;radius&quot;&gt;The distance from the center of the polygon to a vertex.&lt;/param&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;rotation&quot;&gt;The rotation angle in radians of the start point of the polygon. The start point will be</span></span><br><span class="line"><span class="comment">// rotated counterclockwise from the positive x-axis.&lt;/param&gt;</span></span><br><span class="line"><span class="comment">// &lt;returns&gt;N-sided regular polygon.&lt;/returns&gt;</span></span><br><span class="line"><span class="comment">// &lt;exception cref=&quot;ArgumentException&quot;&gt;Number of sides is less than 3.&lt;/exception&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Polygon <span class="title">CreateRegularPolygon</span>(<span class="params"><span class="built_in">int</span> numSides, Coordinate2D center, <span class="built_in">double</span> radius, <span class="built_in">double</span> rotation</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (numSides &lt; <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> ArgumentException();</span><br><span class="line"></span><br><span class="line">  Coordinate2D[] coords = <span class="keyword">new</span> Coordinate2D[numSides + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">  <span class="built_in">double</span> centerX = center.X;</span><br><span class="line">  <span class="built_in">double</span> centerY = center.Y;</span><br><span class="line">  <span class="built_in">double</span> x = radius * Math.Cos(rotation) + centerX;</span><br><span class="line">  <span class="built_in">double</span> y = radius * Math.Sin(rotation) + centerY;</span><br><span class="line">  Coordinate2D start = <span class="keyword">new</span> Coordinate2D(x, y);</span><br><span class="line">  coords[<span class="number">0</span>] = start;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">double</span> da = <span class="number">2</span> * Math.PI / numSides;</span><br><span class="line">  <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; numSides; i++)</span><br><span class="line">  &#123;</span><br><span class="line">    x = radius * Math.Cos(i * da + rotation) + centerX;</span><br><span class="line">    y = radius * Math.Sin(i * da + rotation) + centerY;</span><br><span class="line"></span><br><span class="line">    coords[i] = <span class="keyword">new</span> Coordinate2D(x, y);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  coords[numSides] = start;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> PolygonBuilderEx.CreatePolygon(coords);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取多边形的外环-多边形。获取外部环"><a href="#获取多边形的外环-多边形。获取外部环" class="headerlink" title="获取多边形的外环 - 多边形。获取外部环"></a>获取多边形的外环 - 多边形。获取外部环</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetExteriorRings</span>(<span class="params">Polygon inputPolygon</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (inputPolygon == <span class="literal">null</span> || inputPolygon.IsEmpty)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// polygon part count</span></span><br><span class="line">  <span class="built_in">int</span> partCount = inputPolygon.PartCount;</span><br><span class="line">  <span class="comment">// polygon exterior ring count</span></span><br><span class="line">  <span class="built_in">int</span> numExtRings = inputPolygon.ExteriorRingCount;</span><br><span class="line">  <span class="comment">// get set of exterior rings for the polygon</span></span><br><span class="line">  IList&lt;Polygon&gt; extRings = inputPolygon.GetExteriorRings();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// test each part for &quot;exterior ring&quot;</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="built_in">int</span> idx = <span class="number">0</span>; idx &lt; partCount; idx++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">bool</span> isExteriorRing = inputPolygon.IsExteriorRing(idx);</span><br><span class="line">    <span class="keyword">var</span> ring = inputPolygon.GetExteriorRing(idx);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="信封"><a href="#信封" class="headerlink" title="信封"></a>信封</h2><h3 id="构造封套"><a href="#构造封套" class="headerlink" title="构造封套"></a>构造封套</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint minPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint maxPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line">Envelope envelope = EnvelopeBuilderEx.CreateEnvelope(minPt, maxPt);</span><br><span class="line"></span><br><span class="line">EnvelopeBuilderEx builderEx = <span class="keyword">new</span> EnvelopeBuilderEx(minPt, maxPt);</span><br><span class="line">envelope = builderEx.ToGeometry() <span class="keyword">as</span> Envelope;</span><br></pre></td></tr></table></figure>

<h3 id="构造信封-从-JSON-字符串"><a href="#构造信封-从-JSON-字符串" class="headerlink" title="构造信封 - 从 JSON 字符串"></a>构造信封 - 从 JSON 字符串</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> jsonString = <span class="string">&quot;&#123; \&quot;xmin\&quot; : 1, \&quot;ymin\&quot; : 2,\&quot;xmax\&quot;:3,\&quot;ymax\&quot;:4,\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line">Envelope envFromJson = EnvelopeBuilderEx.FromJson(jsonString);</span><br></pre></td></tr></table></figure>

<h3 id="合并两个信封"><a href="#合并两个信封" class="headerlink" title="合并两个信封"></a>合并两个信封</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// use the convenience builders</span></span><br><span class="line">Envelope env1 = EnvelopeBuilderEx.CreateEnvelope(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line">Envelope env2 = EnvelopeBuilderEx.CreateEnvelope(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">1.5</span>, <span class="number">1.5</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">Envelope env3 = env1.Union(env2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> area = env3.Area;</span><br><span class="line"><span class="built_in">double</span> depth = env3.Depth;</span><br><span class="line"><span class="built_in">double</span> height = env3.Height;</span><br><span class="line"><span class="built_in">double</span> width = env3.Width;</span><br><span class="line"><span class="built_in">double</span> len = env3.Length;</span><br><span class="line"></span><br><span class="line">MapPoint centerPt = env3.Center;</span><br><span class="line">Coordinate2D coord = env3.CenterCoordinate;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> isEmpty = env3.IsEmpty;</span><br><span class="line"><span class="built_in">int</span> pointCount = env3.PointCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinates</span></span><br><span class="line"><span class="comment">//env3.XMin, env3.XMax, env3.YMin, env3.YMax</span></span><br><span class="line"><span class="comment">//env3.ZMin, env3.ZMax, env3.MMin, env3.MMax</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> isEqual = env1.IsEqual(env2);    <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// or use the builderEx constructors = don&#x27;t need to run on the MCT.</span></span><br><span class="line">EnvelopeBuilderEx builderEx = <span class="keyword">new</span> EnvelopeBuilderEx(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line">builderEx.Union(env2);      <span class="comment">// builder is updated to the result</span></span><br><span class="line"></span><br><span class="line">depth = builderEx.Depth;</span><br><span class="line">height = builderEx.Height;</span><br><span class="line">width = builderEx.Width;</span><br><span class="line"></span><br><span class="line">centerPt = builderEx.Center;</span><br><span class="line">coord = builderEx.CenterCoordinate;</span><br><span class="line"></span><br><span class="line">isEmpty = builderEx.IsEmpty;</span><br><span class="line"></span><br><span class="line">env3 = builderEx.ToGeometry() <span class="keyword">as</span> Envelope;</span><br></pre></td></tr></table></figure>

<h3 id="与两个信封相交"><a href="#与两个信封相交" class="headerlink" title="与两个信封相交"></a>与两个信封相交</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// use the convenience builders</span></span><br><span class="line">Envelope env1 = EnvelopeBuilderEx.CreateEnvelope(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line">Envelope env2 = EnvelopeBuilderEx.CreateEnvelope(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">1.5</span>, <span class="number">1.5</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> intersects = env1.Intersects(env2); <span class="comment">// true</span></span><br><span class="line">Envelope env3 = env1.Intersection(env2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// or use the builderEx constructors = don&#x27;t need to run on the MCT.</span></span><br><span class="line">EnvelopeBuilderEx builderEx = <span class="keyword">new</span> EnvelopeBuilderEx(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line">intersects = builderEx.Intersects(env2);</span><br><span class="line">builderEx.Intersection(env2);   <span class="comment">// note this sets the builder to the intersection</span></span><br><span class="line">env3 = builderEx.ToGeometry() <span class="keyword">as</span> Envelope;</span><br></pre></td></tr></table></figure>

<h3 id="展开信封"><a href="#展开信封" class="headerlink" title="展开信封"></a>展开信封</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">Envelope envelope = EnvelopeBuilderEx.CreateEnvelope(<span class="number">100.0</span>, <span class="number">100.0</span>, <span class="number">500.0</span>, <span class="number">500.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// shrink the envelope by 50%</span></span><br><span class="line">Envelope result = envelope.Expand(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx constructors don&#x27;t need to run on the MCT.</span></span><br><span class="line">EnvelopeBuilderEx builderEx = <span class="keyword">new</span> EnvelopeBuilderEx(<span class="number">100.0</span>, <span class="number">100.0</span>, <span class="number">500.0</span>, <span class="number">500.0</span>);</span><br><span class="line">builderEx.Expand(<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="literal">true</span>);</span><br><span class="line">envelope = builderEx.ToGeometry() <span class="keyword">as</span> Envelope;</span><br></pre></td></tr></table></figure>

<h3 id="更新封套的坐标"><a href="#更新封套的坐标" class="headerlink" title="更新封套的坐标"></a>更新封套的坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">Coordinate2D minCoord = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">Coordinate2D maxCoord = <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">Coordinate2D c1 = <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">Coordinate2D c2 = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the EnvelopeBuilderEx.  This constructor doesn&#x27;t need to run on the MCT.</span></span><br><span class="line"></span><br><span class="line">EnvelopeBuilderEx builderEx = <span class="keyword">new</span> EnvelopeBuilderEx(minCoord, maxCoord);</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, Zmin, MMin  = 1, 3, 0, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 2, 4, 0, double.Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set XMin.  if XMin &gt; XMax; both XMin and XMax change</span></span><br><span class="line">builderEx.XMin = <span class="number">6</span>;</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 6, 3, 0, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 6, 4, 0, double.Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set XMax</span></span><br><span class="line">builderEx.XMax = <span class="number">8</span>;</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 6, 3, 0, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 8, 4, 0, double.Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set XMax.  if XMax &lt; XMin, both XMin and XMax change</span></span><br><span class="line">builderEx.XMax = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 3, 3, 0, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 3, 4, 0, double.Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set YMin</span></span><br><span class="line">builderEx.YMin = <span class="number">2</span>;</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 3, 2, 0, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 3, 4, 0, double.Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set ZMin.  if ZMin &gt; ZMax, both ZMin and ZMax change</span></span><br><span class="line">builderEx.ZMin = <span class="number">3</span>;</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 3, 2, 3, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 3, 4, 3, double.Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set ZMax.  if ZMax &lt; ZMin. both ZMin and ZMax change</span></span><br><span class="line">builderEx.ZMax = <span class="number">-1</span>;</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 3, 2, -1, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 3, 4, -1, double.Nan</span></span><br><span class="line"></span><br><span class="line">builderEx.SetZCoords(<span class="number">8</span>, <span class="number">-5</span>);</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 3, 2, -5, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 3, 4, 8, double.Nan</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">builderEx.SetXYCoords(c1, c2);</span><br><span class="line"><span class="comment">// builderEx.XMin, YMin, ZMin, MMin  = 0, 3, -5, double.Nan</span></span><br><span class="line"><span class="comment">// builderEx.XMax, YMax, ZMax, MMax = 1, 5, 8, double.Nan</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">builderEx.HasM = <span class="literal">true</span>;</span><br><span class="line">builderEx.SetMCoords(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> geomEx = builderEx.ToGeometry();</span><br></pre></td></tr></table></figure>

<h2 id="多点"><a href="#多点" class="headerlink" title="多点"></a>多点</h2><h3 id="构造多点-从映射点的枚举"><a href="#构造多点-从映射点的枚举" class="headerlink" title="构造多点 - 从映射点的枚举"></a>构造多点 - 从映射点的枚举</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// use the builderEx constructors - don&#x27;t need to run on the MCT.</span></span><br><span class="line"><span class="comment">//  use AttributeFlags.NoAttributes - we have 2d points in the list</span></span><br><span class="line">MultipointBuilderEx builderEx = <span class="keyword">new</span> MultipointBuilderEx(list, AttributeFlags.None);</span><br><span class="line">Multipoint multiPoint = builderEx.ToGeometry() <span class="keyword">as</span> Multipoint;</span><br><span class="line"><span class="built_in">int</span> ptCount = builderEx.PointCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx convenience methods dont need to run on the MCT</span></span><br><span class="line">multiPoint = MultipointBuilderEx.CreateMultipoint(list);</span><br><span class="line"><span class="comment">// multiPoint.HasZ, HasM, HasID will be false - the attributes are determined </span></span><br><span class="line"><span class="comment">//    based on the attribute state of the points in the list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// or specifically set the state</span></span><br><span class="line">multiPoint = MultipointBuilderEx.CreateMultipoint(list, AttributeFlags.None);</span><br><span class="line"><span class="comment">// multiPoint.HasM = false</span></span><br><span class="line"></span><br><span class="line">multiPoint = MultipointBuilderEx.CreateMultipoint(list, AttributeFlags.HasM);</span><br><span class="line"><span class="comment">// multiPoint.HasM = true</span></span><br><span class="line"></span><br><span class="line">ptCount = multiPoint.PointCount;</span><br></pre></td></tr></table></figure>

<h3 id="构造多点-使用-MultipointBuilderEx"><a href="#构造多点-使用-MultipointBuilderEx" class="headerlink" title="构造多点 - 使用 MultipointBuilderEx"></a>构造多点 - 使用 MultipointBuilderEx</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">Coordinate2D[] coordinate2Ds = <span class="keyword">new</span> Coordinate2D[] &#123; <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">-2</span>) &#125;;</span><br><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">MultipointBuilderEx builder = <span class="keyword">new</span> MultipointBuilderEx(coordinate2Ds, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// builder.PointCount = 2</span></span><br><span class="line"></span><br><span class="line">builder.HasZ = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// builder.Zs.Count = 2</span></span><br><span class="line"><span class="comment">// builder.Zs[0] = 0</span></span><br><span class="line"><span class="comment">// builder.Zs[1] = 0</span></span><br><span class="line"></span><br><span class="line">builder.HasM = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// builder.Ms.Count = 2</span></span><br><span class="line"><span class="comment">// builder.Ms[0] = NaN</span></span><br><span class="line"><span class="comment">// builder.Ms[1] = NaN</span></span><br><span class="line"></span><br><span class="line">builder.HasID = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// builder.IDs.Count = 2</span></span><br><span class="line"><span class="comment">// builder.IDs[0] = 0</span></span><br><span class="line"><span class="comment">// builder.IDs[1] = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set it empty</span></span><br><span class="line">builder.SetEmpty();</span><br><span class="line"><span class="comment">// builder.Coords.Count = 0</span></span><br><span class="line"><span class="comment">// builder.Zs.Count = 0</span></span><br><span class="line"><span class="comment">// builder.Ms.Count = 0</span></span><br><span class="line"><span class="comment">// builder.IDs.Count = 0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// reset coordinates</span></span><br><span class="line">List&lt;Coordinate2D&gt; inCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;() &#123; <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">4</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">6</span>) &#125;;</span><br><span class="line">builder.Coordinate2Ds = inCoords;</span><br><span class="line"><span class="comment">// builder.Coords.Count = 3</span></span><br><span class="line"><span class="comment">// builder.HasZ = true</span></span><br><span class="line"><span class="comment">// builder.HasM = true</span></span><br><span class="line"><span class="comment">// builder.HasID = true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span>[] zs = <span class="keyword">new</span> <span class="built_in">double</span>[] &#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span> &#125;;</span><br><span class="line">builder.Zs = zs;   </span><br><span class="line"><span class="comment">// builder.Zs.Count = 6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span>[] ms = <span class="keyword">new</span> <span class="built_in">double</span>[] &#123; <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line">builder.Ms = ms;   </span><br><span class="line"><span class="comment">// builder.Ms.Count = 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinates are now   (x, y, z, m, id)</span></span><br><span class="line"><span class="comment">//  (1, 2, 1, 0, 0), (3, 4, 2, 1, 0) (5, 6, 1, NaN, 0)</span></span><br><span class="line"></span><br><span class="line">MapPoint mapPoint = builder.GetPoint(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// mapPoint.HasZ = true</span></span><br><span class="line"><span class="comment">// mapPoint.HasM = true</span></span><br><span class="line"><span class="comment">// mapPoint.HasID = true</span></span><br><span class="line"><span class="comment">// mapPoint.Z  = 1</span></span><br><span class="line"><span class="comment">// mapPoint.M = NaN</span></span><br><span class="line"><span class="comment">// mapPoint.ID = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// add an M to the list</span></span><br><span class="line">builder.Ms.Add(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// builder.Ms.count = 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinates are now   (x, y, z, m, id)</span></span><br><span class="line"><span class="comment">//  (1, 2, 1, 0, 0), (3, 4, 2, 1, 0) (5, 6, 1, 2, 0)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// now get the 2nd point again; it will now have an M value</span></span><br><span class="line">mapPoint = builder.GetPoint(<span class="number">2</span>);</span><br><span class="line"><span class="comment">// mapPoint.M = 2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span>[] ids = <span class="keyword">new</span> <span class="built_in">int</span>[] &#123; <span class="number">-1</span>, <span class="number">-2</span>, <span class="number">-3</span> &#125;;</span><br><span class="line"><span class="comment">// assign ID values</span></span><br><span class="line">builder.IDs = ids;</span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinates are now   (x, y, z, m, id)</span></span><br><span class="line"><span class="comment">//  (1, 2, 1, 0, -1), (3, 4, 2, 1, -2) (5, 6, 1, 2, -3)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a new point</span></span><br><span class="line">MapPoint point = MapPointBuilderEx.CreateMapPoint(<span class="number">-300</span>, <span class="number">400</span>, <span class="number">4</span>);</span><br><span class="line">builder.SetPoint(<span class="number">2</span>, point);</span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinates are now   (x, y, z, m, id)</span></span><br><span class="line"><span class="comment">//  (1, 2, 1, 0, -1), (3, 4, 2, 1, -2) (-300, 400, 4, NaN, 0)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">builder.RemovePoints(<span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// builder.PointCount = 1</span></span><br></pre></td></tr></table></figure>

<h3 id="修改多点的点"><a href="#修改多点的点" class="headerlink" title="修改多点的点"></a>修改多点的点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// assume a multiPoint has been built from 4 points</span></span><br><span class="line"><span class="comment">// the modified multiPoint will have the first point removed and the last point moved</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the builderEx constructors = don&#x27;t need to run on the MCT.</span></span><br><span class="line">MultipointBuilderEx builderEx = <span class="keyword">new</span> MultipointBuilderEx(multipoint);</span><br><span class="line"><span class="comment">// remove the first point</span></span><br><span class="line">builderEx.RemovePoint(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// modify the coordinates of the last point</span></span><br><span class="line"><span class="keyword">var</span> ptEx = builderEx.GetPoint(builderEx.PointCount - <span class="number">1</span>);</span><br><span class="line">builderEx.RemovePoint(builderEx.PointCount - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newPtEx = MapPointBuilderEx.CreateMapPoint(ptEx.X + <span class="number">1.0</span>, ptEx.Y + <span class="number">2.0</span>);</span><br><span class="line">builderEx.AddPoint(newPtEx);</span><br><span class="line">Multipoint modifiedMultiPointEx = builderEx.ToGeometry() <span class="keyword">as</span> Multipoint;</span><br></pre></td></tr></table></figure>

<h3 id="从多点检索点、2D-坐标、3D-坐标"><a href="#从多点检索点、2D-坐标、3D-坐标" class="headerlink" title="从多点检索点、2D 坐标、3D 坐标"></a>从多点检索点、2D 坐标、3D 坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ReadOnlyPointCollection points = multipoint.Points;</span><br><span class="line">IReadOnlyList&lt;Coordinate2D&gt; coords2d = multipoint.Copy2DCoordinatesToList();</span><br><span class="line">IReadOnlyList&lt;Coordinate3D&gt; coords3d = multipoint.Copy3DCoordinatesToList();</span><br></pre></td></tr></table></figure>

<h2 id="线段"><a href="#线段" class="headerlink" title="线段"></a>线段</h2><h3 id="使用两个地图点构造线段"><a href="#使用两个地图点构造线段" class="headerlink" title="使用两个地图点构造线段"></a>使用两个地图点构造线段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">LineSegment lineFromMapPoint = LineBuilderEx.CreateLineSegment(startPt, endPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinate2D</span></span><br><span class="line">Coordinate2D start2d = (Coordinate2D)startPt;</span><br><span class="line">Coordinate2D end2d = (Coordinate2D)endPt;</span><br><span class="line"></span><br><span class="line">LineSegment lineFromCoordinate2D = LineBuilderEx.CreateLineSegment(start2d, end2d);</span><br><span class="line"></span><br><span class="line"><span class="comment">// coordinate3D</span></span><br><span class="line">Coordinate3D start3d = (Coordinate3D)startPt;</span><br><span class="line">Coordinate3D end3d = (Coordinate3D)endPt;</span><br><span class="line"></span><br><span class="line">LineSegment lineFromCoordinate3D = LineBuilderEx.CreateLineSegment(start3d, end3d);</span><br><span class="line"></span><br><span class="line"><span class="comment">// lineSegment</span></span><br><span class="line">LineSegment anotherLineFromLineSegment = LineBuilderEx.CreateLineSegment(lineFromCoordinate3D);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx constructors don&#x27;t need to run on the MCT</span></span><br><span class="line">LineBuilderEx lbEx = <span class="keyword">new</span> LineBuilderEx(startPt, endPt);</span><br><span class="line">lineFromMapPoint = lbEx.ToSegment() <span class="keyword">as</span> LineSegment;</span><br><span class="line"></span><br><span class="line">lbEx = <span class="keyword">new</span> LineBuilderEx(start2d, end2d);</span><br><span class="line">lineFromCoordinate2D = lbEx.ToSegment() <span class="keyword">as</span> LineSegment;</span><br><span class="line"></span><br><span class="line">lbEx = <span class="keyword">new</span> LineBuilderEx(start3d, end3d);</span><br><span class="line">lineFromCoordinate3D = lbEx.ToSegment() <span class="keyword">as</span> LineSegment;</span><br><span class="line"></span><br><span class="line">lbEx = <span class="keyword">new</span> LineBuilderEx(startPt, endPt);</span><br><span class="line">lineFromMapPoint = lbEx.ToSegment() <span class="keyword">as</span> LineSegment;</span><br><span class="line"></span><br><span class="line">lbEx = <span class="keyword">new</span> LineBuilderEx(lineFromCoordinate3D);</span><br><span class="line">anotherLineFromLineSegment = lbEx.ToSegment() <span class="keyword">as</span> LineSegment;</span><br></pre></td></tr></table></figure>

<h3 id="更改线段坐标"><a href="#更改线段坐标" class="headerlink" title="更改线段坐标"></a>更改线段坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// builderEx constructors don&#x27;t need to run on the MCT</span></span><br><span class="line">LineBuilderEx lbuilderEx = <span class="keyword">new</span> LineBuilderEx(lineSegment);</span><br><span class="line"><span class="comment">// find the existing coordinates</span></span><br><span class="line">lbuilderEx.QueryCoords(<span class="keyword">out</span> startPt, <span class="keyword">out</span> endPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or use </span></span><br><span class="line"><span class="comment">//startPt = lbuilderEx.StartPoint;</span></span><br><span class="line"><span class="comment">//endPt = lbuilderEx.EndPoint;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// update the coordinates</span></span><br><span class="line">lbuilderEx.SetCoords(GeometryEngine.Instance.Move(startPt, <span class="number">10</span>, <span class="number">10</span>) <span class="keyword">as</span> MapPoint, GeometryEngine.Instance.Move(endPt, <span class="number">-10</span>, <span class="number">-10</span>) <span class="keyword">as</span> MapPoint);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or use </span></span><br><span class="line"><span class="comment">//lbuilderEx.StartPoint = GeometryEngine.Instance.Move(startPt, 10, 10) as MapPoint;</span></span><br><span class="line"><span class="comment">//lbuilderEx.EndPoint = GeometryEngine.Instance.Move(endPt, -10, -10) as MapPoint;</span></span><br><span class="line"></span><br><span class="line">LineSegment segment2 = lbuilderEx.ToSegment() <span class="keyword">as</span> LineSegment;</span><br></pre></td></tr></table></figure>

<h2 id="立方贝塞尔"><a href="#立方贝塞尔" class="headerlink" title="立方贝塞尔"></a>立方贝塞尔</h2><h3 id="构建三次方贝塞尔-从坐标"><a href="#构建三次方贝塞尔-从坐标" class="headerlink" title="构建三次方贝塞尔 - 从坐标"></a>构建三次方贝塞尔 - 从坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>);</span><br><span class="line"></span><br><span class="line">Coordinate2D ctrl1Pt = <span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">2.0</span>);</span><br><span class="line">Coordinate2D ctrl2Pt = <span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT</span></span><br><span class="line">CubicBezierSegment bezier = CubicBezierBuilderEx.CreateCubicBezierSegment(startPt, ctrl1Pt, ctrl2Pt, endPt, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// without a SR</span></span><br><span class="line">bezier = CubicBezierBuilderEx.CreateCubicBezierSegment(startPt, ctrl1Pt, ctrl2Pt, endPt);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx constructors dont need to run on the MCT</span></span><br><span class="line">CubicBezierBuilderEx cbbEx = <span class="keyword">new</span> CubicBezierBuilderEx(startPt, ctrl1Pt, ctrl2Pt, endPt);</span><br><span class="line">bezier = cbbEx.ToSegment() <span class="keyword">as</span> CubicBezierSegment;</span><br><span class="line"></span><br><span class="line"><span class="comment">// another alternative</span></span><br><span class="line">cbbEx = <span class="keyword">new</span> CubicBezierBuilderEx(startPt, ctrl1Pt.ToMapPoint(), ctrl2Pt.ToMapPoint(), endPt);</span><br><span class="line">bezier = cbbEx.ToSegment() <span class="keyword">as</span> CubicBezierSegment;</span><br></pre></td></tr></table></figure>

<h3 id="构建立方贝塞尔-从地图点"><a href="#构建立方贝塞尔-从地图点" class="headerlink" title="构建立方贝塞尔 - 从地图点"></a>构建立方贝塞尔 - 从地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builderEx convenience method or a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">MapPoint ctrl1Pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint ctrl2Pt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT</span></span><br><span class="line">CubicBezierSegment bezier = CubicBezierBuilderEx.CreateCubicBezierSegment(startPt, ctrl1Pt, ctrl2Pt, endPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx constructors dont need to run on the MCT</span></span><br><span class="line">CubicBezierBuilderEx cbbEx = <span class="keyword">new</span> CubicBezierBuilderEx(startPt, ctrl1Pt, ctrl2Pt, endPt);</span><br><span class="line">bezier = cbbEx.ToSegment() <span class="keyword">as</span> CubicBezierSegment;</span><br></pre></td></tr></table></figure>

<h3 id="构造三次贝塞尔-从映射点的枚举"><a href="#构造三次贝塞尔-从映射点的枚举" class="headerlink" title="构造三次贝塞尔 - 从映射点的枚举"></a>构造三次贝塞尔 - 从映射点的枚举</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a buildeExr convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">MapPoint ctrl1Pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint ctrl2Pt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; listMapPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">listMapPoints.Add(startPt);</span><br><span class="line">listMapPoints.Add(ctrl1Pt);</span><br><span class="line">listMapPoints.Add(ctrl2Pt);</span><br><span class="line">listMapPoints.Add(endPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT</span></span><br><span class="line">CubicBezierSegment bezier = CubicBezierBuilderEx.CreateCubicBezierSegment(listMapPoints);</span><br><span class="line"></span><br><span class="line"><span class="comment">// builderEx constructors dont need to run on the MCT</span></span><br><span class="line">CubicBezierBuilderEx cbbEx = <span class="keyword">new</span> CubicBezierBuilderEx(listMapPoints);</span><br><span class="line">bezier = cbbEx.ToSegment() <span class="keyword">as</span> CubicBezierSegment;</span><br></pre></td></tr></table></figure>

<h3 id="立方贝塞尔生成器属性"><a href="#立方贝塞尔生成器属性" class="headerlink" title="立方贝塞尔生成器属性"></a>立方贝塞尔生成器属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retrieve the bezier curve&#x27;s control points</span></span><br><span class="line"></span><br><span class="line">CubicBezierBuilderEx cbbEx = <span class="keyword">new</span> CubicBezierBuilderEx(bezierSegment);</span><br><span class="line">MapPoint startPtEx = cbbEx.StartPoint;</span><br><span class="line">Coordinate2D ctrlPt1Ex = cbbEx.ControlPoint1;</span><br><span class="line">Coordinate2D ctrlPt2Ex = cbbEx.ControlPoint2;</span><br><span class="line">MapPoint endPtEx = cbbEx.EndPoint;</span><br><span class="line">     </span><br><span class="line"><span class="comment">// or use the QueryCoords method</span></span><br><span class="line">cbbEx.QueryCoords(<span class="keyword">out</span> startPtEx, <span class="keyword">out</span> ctrlPt1Ex, <span class="keyword">out</span> ctrlPt2Ex, <span class="keyword">out</span> endPtEx);</span><br></pre></td></tr></table></figure>

<h3 id="立方贝塞尔属性"><a href="#立方贝塞尔属性" class="headerlink" title="立方贝塞尔属性"></a>立方贝塞尔属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retrieve the bezier curve&#x27;s control points</span></span><br><span class="line">CubicBezierSegment cb = CubicBezierBuilderEx.CreateCubicBezierSegment(bezierSegment);</span><br><span class="line">MapPoint startPt = cb.StartPoint;</span><br><span class="line">Coordinate2D ctrlPt1 = cb.ControlPoint1;</span><br><span class="line">Coordinate2D ctrlPt2 = cb.ControlPoint2;</span><br><span class="line">MapPoint endPt = cb.EndPoint;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> isCurve = cb.IsCurve;</span><br><span class="line"><span class="built_in">double</span> len = cb.Length;</span><br></pre></td></tr></table></figure>

<h3 id="构造折线-从三次贝塞尔"><a href="#构造折线-从三次贝塞尔" class="headerlink" title="构造折线 - 从三次贝塞尔"></a>构造折线 - 从三次贝塞尔</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(bezierSegment);</span><br></pre></td></tr></table></figure>

<h2 id="弧"><a href="#弧" class="headerlink" title="弧"></a>弧</h2><h3 id="构造圆弧-使用内部点"><a href="#构造圆弧-使用内部点" class="headerlink" title="构造圆弧 - 使用内部点"></a>构造圆弧 - 使用内部点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct a circular arc from (2, 1) to (1, 2) with interior pt (1 + sqrt(2)/2, 1 + sqrt(2)/2).</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint fromPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">MapPoint toPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">Coordinate2D interiorPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>, <span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(fromPt, toPt, interiorPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors dont need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx eab = <span class="keyword">new</span> EllipticArcBuilderEx(fromPt, toPt, interiorPt);</span><br><span class="line"><span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">EllipticArcSegment anotherCircularArc = eab.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构造圆弧-使用弦长度和方位"><a href="#构造圆弧-使用弦长度和方位" class="headerlink" title="构造圆弧 - 使用弦长度和方位"></a>构造圆弧 - 使用弦长度和方位</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct a circular arc counterclockwise from (2, 1) to (1, 2) such that the embedded </span></span><br><span class="line"><span class="comment">// circle has center point at (1, 1) and radius = 1.</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint fromPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line"><span class="built_in">double</span> chordLength = Math.Sqrt(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">double</span> chordBearing = <span class="number">3</span> * Math.PI / <span class="number">4</span>;</span><br><span class="line"><span class="built_in">double</span> radius = <span class="number">1</span>;</span><br><span class="line">ArcOrientation orientation = ArcOrientation.ArcCounterClockwise;</span><br><span class="line">MinorOrMajor minorOrMajor = MinorOrMajor.Minor;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuildeExr convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(fromPt, chordLength, chordBearing, radius, orientation, minorOrMajor);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx cab = <span class="keyword">new</span> EllipticArcBuilderEx(fromPt, chordLength, chordBearing, radius, orientation, minorOrMajor);</span><br><span class="line"><span class="comment">// do something with the builder</span></span><br><span class="line"></span><br><span class="line">EllipticArcSegment anotherCircularArc = cab.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构建圆弧-使用中心点、角度和半径"><a href="#构建圆弧-使用中心点、角度和半径" class="headerlink" title="构建圆弧 - 使用中心点、角度和半径"></a>构建圆弧 - 使用中心点、角度和半径</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct a circular arc with center point at (0, 0), from angle = 0, </span></span><br><span class="line"><span class="comment">// central angle = pi/2, radius = 1.</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">SpatialReference sr4326 = SpatialReferences.WGS84;</span><br><span class="line">Coordinate2D centerPt = <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">double</span> fromAngle = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">double</span> centralAngle = Math.PI / <span class="number">2</span>;</span><br><span class="line"><span class="built_in">double</span> radius = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(fromAngle, centralAngle, centerPt, radius, sr4326);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors dont need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx cab = <span class="keyword">new</span> EllipticArcBuilderEx(fromAngle, centralAngle, centerPt, radius, sr4326);</span><br><span class="line">EllipticArcSegment otherCircularArc = cab.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构造椭圆弧-使用中心点和旋转角度"><a href="#构造椭圆弧-使用中心点和旋转角度" class="headerlink" title="构造椭圆弧 - 使用中心点和旋转角度"></a>构造椭圆弧 - 使用中心点和旋转角度</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct an elliptic arc centered at (1,1), startAngle = 0, centralAngle = PI/2, </span></span><br><span class="line"><span class="comment">// rotationAngle = 0, semiMajorAxis = 1, minorMajorRatio = 0.5.</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">Coordinate2D centerPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateEllipticArcSegment(centerPt, <span class="number">0</span>, Math.PI / <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.5</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> semiMajor;</span><br><span class="line"><span class="built_in">double</span> semiMinor;</span><br><span class="line">circularArc.GetAxes(<span class="keyword">out</span> semiMajor, <span class="keyword">out</span> semiMinor);</span><br><span class="line"><span class="comment">// semiMajor = 1, semiMinor = 0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors dont need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx cab = <span class="keyword">new</span> EllipticArcBuilderEx(centerPt, <span class="number">0</span>, Math.PI / <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.5</span>);</span><br><span class="line">cab.GetAxes(<span class="keyword">out</span> semiMajor, <span class="keyword">out</span> semiMinor);</span><br><span class="line">EllipticArcSegment otherCircularArc = cab.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构造圆弧-使用中心点和方向"><a href="#构造圆弧-使用中心点和方向" class="headerlink" title="构造圆弧 - 使用中心点和方向"></a>构造圆弧 - 使用中心点和方向</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct a circular arc from (2, 1) to (1, 2) </span></span><br><span class="line"><span class="comment">// with center point at (1, 1) and orientation counterclockwise.</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint toPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">MapPoint fromPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">Coordinate2D centerPtCoord = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(fromPt, toPt, centerPtCoord, ArcOrientation.ArcCounterClockwise);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx cab = <span class="keyword">new</span> EllipticArcBuilderEx(fromPt, toPt, centerPtCoord, ArcOrientation.ArcCounterClockwise);</span><br><span class="line">EllipticArcSegment otherCircularArc = cab.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构造圆弧-使用两个线段和半径"><a href="#构造圆弧-使用两个线段和半径" class="headerlink" title="构造圆弧 - 使用两个线段和半径"></a>构造圆弧 - 使用两个线段和半径</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct a segment from (100, 100) to (50, 50) and another segment from (100, 100) to (150, 50).</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">LineSegment segment1 = LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">100</span>, <span class="number">100</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">50</span>, <span class="number">50</span>));</span><br><span class="line">LineSegment segment2 = LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">100</span>, <span class="number">100</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">150</span>, <span class="number">50</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Construct the hint point to determine where the arc will be constructed.</span></span><br><span class="line">Coordinate2D hintPoint = <span class="keyword">new</span> Coordinate2D(<span class="number">100</span>, <span class="number">75</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Call QueryFilletRadius to get the minimum and maximum radii that can be used with these segments.</span></span><br><span class="line"><span class="keyword">var</span> minMaxRadii = EllipticArcBuilderEx.QueryFilletRadiusRange(segment1, segment2, hintPoint);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use the maximum radius to create the arc.</span></span><br><span class="line"><span class="built_in">double</span> maxRadius = minMaxRadii.Item2;</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line"><span class="comment">//At 2.x - EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateEllipticArcSegment(segment1, segment2, maxRadius, hintPoint);</span></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(</span><br><span class="line">                    segment1, segment2, maxRadius, hintPoint);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx cab = <span class="keyword">new</span> EllipticArcBuilderEx(segment1, segment2, maxRadius, hintPoint);</span><br><span class="line">EllipticArcSegment otherCircularArc = cab.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构造一个圆"><a href="#构造一个圆" class="headerlink" title="构造一个圆"></a>构造一个圆</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct a circle with center at (-1,-1), radius = 2, and oriented clockwise.</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">Coordinate2D centerPtCoord = <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment circle = EllipticArcBuilderEx.CreateCircle(centerPtCoord, <span class="number">2</span>, ArcOrientation.ArcClockwise);</span><br><span class="line"><span class="comment">// circle.IsCircular = true</span></span><br><span class="line"><span class="comment">// circle.IsCounterClockwise = false</span></span><br><span class="line"><span class="comment">// circle.IsMinor = false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> startAngle, rotationAngle, centralAngle, semiMajor, semiMinor;</span><br><span class="line">Coordinate2D actualCenterPt;</span><br><span class="line">circle.QueryCoords(<span class="keyword">out</span> actualCenterPt, <span class="keyword">out</span> startAngle, <span class="keyword">out</span> centralAngle, <span class="keyword">out</span> rotationAngle, <span class="keyword">out</span> semiMajor, <span class="keyword">out</span> semiMinor);</span><br><span class="line"></span><br><span class="line"><span class="comment">// semiMajor = 2.0</span></span><br><span class="line"><span class="comment">// semiMinor = 2.0</span></span><br><span class="line"><span class="comment">// startAngle = PI/2</span></span><br><span class="line"><span class="comment">// centralAngle = -2*PI</span></span><br><span class="line"><span class="comment">// rotationAngle = 0</span></span><br><span class="line"><span class="comment">// endAngle = PI/2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx builder = <span class="keyword">new</span> EllipticArcBuilderEx(centerPtCoord, <span class="number">2</span>, ArcOrientation.ArcClockwise);</span><br><span class="line">EllipticArcSegment otherCircle = builder.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="构造椭圆"><a href="#构造椭圆" class="headerlink" title="构造椭圆"></a>构造椭圆</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Construct an ellipse centered at (1, 2) with rotationAngle = -pi/6,  </span></span><br><span class="line"><span class="comment">// semiMajorAxis = 5, minorMajorRatio = 0.2, oriented clockwise.</span></span><br><span class="line"><span class="comment">// Use a builderEx convenience method or use a builderEx constructor.</span></span><br><span class="line"></span><br><span class="line">Coordinate2D centerPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line">EllipticArcSegment ellipse = EllipticArcBuilderEx.CreateEllipse(centerPt, <span class="number">-1</span> * Math.PI / <span class="number">6</span>, <span class="number">5</span>, <span class="number">0.2</span>, ArcOrientation.ArcClockwise);</span><br><span class="line"></span><br><span class="line"><span class="comment">// BuilderEx constructors need to run on the MCT.</span></span><br><span class="line">EllipticArcBuilderEx builder = <span class="keyword">new</span> EllipticArcBuilderEx(centerPt, <span class="number">-1</span> * Math.PI / <span class="number">6</span>, <span class="number">5</span>, <span class="number">0.2</span>, ArcOrientation.ArcClockwise);</span><br><span class="line">EllipticArcSegment anotherEllipse = builder.ToSegment();</span><br></pre></td></tr></table></figure>

<h3 id="Elliptic-Arc-Builder-Properties"><a href="#Elliptic-Arc-Builder-Properties" class="headerlink" title="Elliptic Arc Builder Properties"></a>Elliptic Arc Builder Properties</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retrieve the curve&#x27;s properties</span></span><br><span class="line">EllipticArcBuilderEx builder = <span class="keyword">new</span> EllipticArcBuilderEx(arcSegment);</span><br><span class="line">MapPoint startPt = builder.StartPoint;</span><br><span class="line">MapPoint endPt = builder.EndPoint;</span><br><span class="line">Coordinate2D centerPt = builder.CenterPoint;</span><br><span class="line"><span class="built_in">bool</span> isCircular = builder.IsCircular;</span><br><span class="line"><span class="built_in">bool</span> isMinor = builder.IsMinor;</span><br><span class="line"><span class="built_in">double</span> startAngle = builder.StartAngle;</span><br><span class="line"><span class="built_in">double</span> endAngle = builder.EndAngle;</span><br><span class="line"><span class="built_in">double</span> centralAngle = builder.CentralAngle;</span><br><span class="line"><span class="built_in">double</span> rotationAngle = builder.RotationAngle;</span><br><span class="line">ArcOrientation orientation = builder.Orientation;</span><br></pre></td></tr></table></figure>

<h3 id="椭圆弧属性"><a href="#椭圆弧属性" class="headerlink" title="椭圆弧属性"></a>椭圆弧属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// retrieve the curve&#x27;s control points</span></span><br><span class="line">EllipticArcSegment arc = EllipticArcBuilderEx.CreateEllipticArcSegment(arcSegment);</span><br><span class="line">MapPoint startPt = arc.StartPoint;</span><br><span class="line">MapPoint endPt = arc.EndPoint;</span><br><span class="line">Coordinate2D centerPt = arc.CenterPoint;</span><br><span class="line"><span class="built_in">bool</span> isCircular = arc.IsCircular;</span><br><span class="line"><span class="built_in">bool</span> isMinor = arc.IsMinor;</span><br><span class="line"><span class="built_in">bool</span> isCounterClockwise = arc.IsCounterClockwise;</span><br><span class="line"><span class="built_in">bool</span> isCurve = arc.IsCurve;</span><br><span class="line"><span class="built_in">double</span> len = arc.Length;</span><br><span class="line"><span class="built_in">double</span> ratio = arc.MinorMajorRatio;</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> semiMajorAxis, semiMinorAxis;</span><br><span class="line"><span class="comment">// get the axes</span></span><br><span class="line">arc.GetAxes(<span class="keyword">out</span> semiMajorAxis, <span class="keyword">out</span> semiMinorAxis);</span><br><span class="line"><span class="comment">// or use the properties</span></span><br><span class="line"><span class="comment">// semiMajorAxis = arc.SemiMajorAxis;</span></span><br><span class="line"><span class="comment">// semiMinorAxis = arc.SemiMinorAxis;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> startAngle, centralAngle, rotationAngle;</span><br><span class="line"><span class="comment">// or use QueryCoords to get complete information</span></span><br><span class="line">arc.QueryCoords(<span class="keyword">out</span> centerPt, <span class="keyword">out</span> startAngle, <span class="keyword">out</span> centralAngle, <span class="keyword">out</span> rotationAngle, <span class="keyword">out</span> semiMajorAxis, <span class="keyword">out</span> semiMinorAxis);</span><br><span class="line"></span><br><span class="line"><span class="comment">// use properties to get angle information</span></span><br><span class="line"><span class="comment">//double endAngle = arc.EndAngle;</span></span><br><span class="line"><span class="comment">//centralAngle = arc.CentralAngle;</span></span><br><span class="line"><span class="comment">//rotationAngle = arc.RotationAngle;</span></span><br><span class="line"><span class="comment">//startAngle = arc.StartAngle;</span></span><br></pre></td></tr></table></figure>

<h2 id="几何袋"><a href="#几何袋" class="headerlink" title="几何袋"></a>几何袋</h2><h3 id="构造几何包"><a href="#构造几何包" class="headerlink" title="构造几何包"></a>构造几何包</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">MapPoint point = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; coords2D = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(coords2D, SpatialReferences.WGS84);</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords2D, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line">GeometryBagBuilderEx builder = <span class="keyword">new</span> GeometryBagBuilderEx(SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">GeometryBag emptyBag = builder.ToGeometry();</span><br><span class="line"><span class="comment">// emptyBag.IsEmpty = true</span></span><br><span class="line"></span><br><span class="line">builder.AddGeometry(point);</span><br><span class="line"><span class="comment">// builder.GeometryCount = 1</span></span><br><span class="line"></span><br><span class="line">GeometryBag geometryBag = builder.ToGeometry();</span><br><span class="line"><span class="comment">// geometryBag.PartCount = 1</span></span><br><span class="line"><span class="comment">// geometryBag.PointCount = 1</span></span><br><span class="line"><span class="comment">// geometryBag.IsEmpty = false</span></span><br><span class="line"></span><br><span class="line">IReadOnlyList&lt;Geometry&gt; geometries = geometryBag.Geometries;</span><br><span class="line"><span class="comment">// geometries.Count = 1</span></span><br><span class="line"><span class="comment">// geometries[0] is MapPoint with a sr of WGS84</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> isEqual = geometryBag.IsEqual(emptyBag);   <span class="comment">// isEqual = false</span></span><br><span class="line"></span><br><span class="line">builder.InsertGeometry(<span class="number">0</span>, multipoint);</span><br><span class="line">geometryBag = builder.ToGeometry();</span><br><span class="line"><span class="comment">// geometryBag.PartCount = 2</span></span><br><span class="line"></span><br><span class="line">geometries = geometryBag.Geometries;</span><br><span class="line"><span class="comment">// geometries.Count = 2</span></span><br><span class="line"><span class="comment">// geometries[0] is Multipoint</span></span><br><span class="line"><span class="comment">// geometries[1] is MapPoint</span></span><br><span class="line"></span><br><span class="line">builder.AddGeometry(polyline);</span><br><span class="line">builder.RemoveGeometry(<span class="number">1</span>);</span><br><span class="line">geometryBag = builder.ToGeometry();</span><br><span class="line"><span class="comment">// geometryBag.PartCount = 2</span></span><br><span class="line"></span><br><span class="line">geometries = geometryBag.Geometries;</span><br><span class="line"><span class="comment">// geometries.Count = 2</span></span><br><span class="line"><span class="comment">// geometries[0] is Multipoint</span></span><br><span class="line"><span class="comment">// geometries[1] is Polyline          </span></span><br></pre></td></tr></table></figure>

<h3 id="构造几何包-从几何枚举"><a href="#构造几何包-从几何枚举" class="headerlink" title="构造几何包 - 从几何枚举"></a>构造几何包 - 从几何枚举</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use a builder convenience method or use a builder constructor.</span></span><br><span class="line"></span><br><span class="line">MapPoint point = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;() &#123; <span class="keyword">new</span> Coordinate2D(<span class="number">50</span>, <span class="number">60</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">-120</span>, <span class="number">-70</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">40</span>, <span class="number">60</span>) &#125;;</span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(coords, SpatialReferences.WebMercator);</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;rings\&quot;:[[[0,0],[0,1],[1,1],[1,0],[0,0]],[[3,0],[3,1],[4,1],[4,0],[3,0]]]&#125;&quot;</span>;</span><br><span class="line">Polygon polygon = PolygonBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> geometries = <span class="keyword">new</span> List&lt;Geometry&gt;() &#123; point, multipoint, polyline, polygon &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Builder convenience methods don&#x27;t need to run on the MCT.</span></span><br><span class="line"><span class="comment">//At 2.x - GeometryBag bag = GeometryBagBuilder.CreateGeometryBag(geometries, SpatialReferences.WGS84);</span></span><br><span class="line"><span class="keyword">var</span> bag = GeometryBagBuilderEx.CreateGeometryBag(geometries, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">//At 2.x - using (var builder = new GeometryBagBuilder(geometries, SpatialReferences.WGS84)) </span></span><br><span class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> GeometryBagBuilderEx(geometries, SpatialReferences.WGS84);</span><br><span class="line"><span class="comment">// do something with the builder</span></span><br><span class="line">bag = builder.ToGeometry();</span><br></pre></td></tr></table></figure>

<h3 id="ConstructingGeometryBag-来自-JSON、Xml"><a href="#ConstructingGeometryBag-来自-JSON、Xml" class="headerlink" title="ConstructingGeometryBag - 来自 JSON、Xml"></a>ConstructingGeometryBag - 来自 JSON、Xml</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">string</span> jsonString = <span class="string">&quot;&#123;\&quot;geometries\&quot;:[&#123;\&quot;x\&quot;:1,\&quot;y\&quot;:2&#125;,&#123;\&quot;rings\&quot;:[[[0,0],[0,4],[3,4],[3,0],[0,0]]]&#125;],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326,\&quot;latestWkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line"><span class="comment">//At 2.x - GeometryBag geometryBag = GeometryBagBuilder.FromJson(jsonString);</span></span><br><span class="line"><span class="keyword">var</span> geometryBag = GeometryBagBuilderEx.FromJson(jsonString);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> xml = geometryBag.ToXml();</span><br><span class="line"><span class="comment">//At 2.x - GeometryBag xmlString = GeometryBagBuilder.FromXML(xml);</span></span><br><span class="line"><span class="keyword">var</span> xmlString = GeometryBagBuilderEx.FromXml(xml);</span><br></pre></td></tr></table></figure>

<h3 id="构造几何包-添加或插入几何枚举"><a href="#构造几何包-添加或插入几何枚举" class="headerlink" title="构造几何包 - 添加或插入几何枚举"></a>构造几何包 - 添加或插入几何枚举</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">MapPoint point = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">20</span>);</span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;() &#123; <span class="keyword">new</span> Coordinate2D(<span class="number">50</span>, <span class="number">60</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">-120</span>, <span class="number">-70</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">40</span>, <span class="number">60</span>) &#125;;</span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(coords, SpatialReferences.WebMercator);</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords);</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;rings\&quot;:[[[0,0],[0,1],[1,1],[1,0],[0,0]],[[3,0],[3,1],[4,1],[4,0],[3,0]]]&#125;&quot;</span>;</span><br><span class="line">Polygon polygon = PolygonBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> geometries = <span class="keyword">new</span> List&lt;Geometry&gt;() &#123; point, multipoint, polyline, polygon &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//At 2.x - using (var builder = new GeometryBagBuilder(SpatialReferences.WGS84))</span></span><br><span class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> GeometryBagBuilderEx(SpatialReferences.WGS84);</span><br><span class="line">builder.AddGeometries(geometries);</span><br><span class="line"></span><br><span class="line">GeometryBag geomBag = builder.ToGeometry();</span><br><span class="line"><span class="comment">// geomBag.PartCount == 4    (point, multipoint, polyline, polygon)</span></span><br><span class="line"></span><br><span class="line">geometries = <span class="keyword">new</span> List&lt;Geometry&gt;() &#123; point, polyline &#125;;</span><br><span class="line">builder.InsertGeometries(<span class="number">1</span>, geometries);</span><br><span class="line"><span class="comment">// builder.GeometryCount == 6</span></span><br><span class="line">geomBag = builder.ToGeometry();</span><br><span class="line"><span class="comment">// geomBag.PartCount == 6    (point, point, polyline, multipoint, polyline, polygon)</span></span><br></pre></td></tr></table></figure>

<h2 id="多面体"><a href="#多面体" class="headerlink" title="多面体"></a>多面体</h2><h3 id="通过拉伸多边形或折线构建多面体"><a href="#通过拉伸多边形或折线构建多面体" class="headerlink" title="通过拉伸多边形或折线构建多面体"></a>通过拉伸多边形或折线构建多面体</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// build a polygon</span></span><br><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasZ\&quot;:true,\&quot;rings\&quot;:[[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,0]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line">Polygon polygon = PolygonBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extrude the polygon by an offset to create a multipatch</span></span><br><span class="line">Multipatch multipatch = GeometryEngine.Instance.ConstructMultipatchExtrude(polygon, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// a different polygon</span></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasZ\&quot;:true,\&quot;rings\&quot;:[[[0,0,1],[0,1,2],[1,1,3],[1,0,4],[0,0,1]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line">polygon = PolygonBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extrude between z values to create a multipatch</span></span><br><span class="line">multipatch = GeometryEngine.Instance.ConstructMultipatchExtrudeFromToZ(polygon, <span class="number">-10</span>, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extrude along the axis defined by the coordinate to create a multipatch</span></span><br><span class="line">Coordinate3D coord = <span class="keyword">new</span> Coordinate3D(<span class="number">10</span>, <span class="number">18</span>, <span class="number">-10</span>);</span><br><span class="line">multipatch = GeometryEngine.Instance.ConstructMultipatchExtrudeAlongVector3D(polygon, coord);</span><br><span class="line"></span><br><span class="line"><span class="comment">// build a polyline</span></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasZ\&quot;:true,\&quot;paths\&quot;:[[[400,800,1000],[800,1400,1500],[1200,800,2000],[1800,1800,2500],[2200,800,3000]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extrude to a specific z value to create a multipatch</span></span><br><span class="line">multipatch = GeometryEngine.Instance.ConstructMultipatchExtrudeToZ(polyline, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">Coordinate3D fromCoord = <span class="keyword">new</span> Coordinate3D(<span class="number">50</span>, <span class="number">50</span>, <span class="number">-500</span>);</span><br><span class="line">Coordinate3D toCoord = <span class="keyword">new</span> Coordinate3D(<span class="number">200</span>, <span class="number">50</span>, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extrude between two coordinates to create a multipatch</span></span><br><span class="line">multipatch = GeometryEngine.Instance.ConstructMultipatchExtrudeAlongLine(polyline, fromCoord, toCoord);</span><br></pre></td></tr></table></figure>

<h3 id="多面体属性"><a href="#多面体属性" class="headerlink" title="多面体属性"></a>多面体属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// standard geometry properties</span></span><br><span class="line"><span class="built_in">bool</span> hasZ = multipatch.HasZ;</span><br><span class="line"><span class="built_in">bool</span> hasM = multipatch.HasM;</span><br><span class="line"><span class="built_in">bool</span> hasID = multipatch.HasID;</span><br><span class="line"><span class="built_in">bool</span> isEmpty = multipatch.IsEmpty;</span><br><span class="line"><span class="keyword">var</span> sr = multipatch.SpatialReference;</span><br><span class="line"></span><br><span class="line"><span class="comment">// number of patches (parts)</span></span><br><span class="line"><span class="built_in">int</span> patchCount = multiPatch.PartCount;</span><br><span class="line"><span class="comment">// number of points</span></span><br><span class="line"><span class="built_in">int</span> pointCount = multiPatch.PointCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// retrieve the points as MapPoints</span></span><br><span class="line">ReadOnlyPointCollection points = multipatch.Points;</span><br><span class="line"><span class="comment">// or as 3D Coordinates</span></span><br><span class="line">IReadOnlyList&lt;Coordinate3D&gt; coordinates = multipatch.Copy3DCoordinatesToList();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// multipatch materials</span></span><br><span class="line"><span class="built_in">bool</span> hasMaterials = multiPatch.HasMaterials;</span><br><span class="line"><span class="built_in">int</span> materialCount = multiPatch.MaterialCount;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// multipatch textures</span></span><br><span class="line"><span class="built_in">bool</span> hasTextures = multiPatch.HasTextures;</span><br><span class="line"><span class="built_in">int</span> textureVertexCount = multiPatch.TextureVertexCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// normals</span></span><br><span class="line"><span class="built_in">bool</span> hasNormals = multiPatch.HasNormals;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// properties for an individual patch (if multipatch.PartCount &gt; 0)</span></span><br><span class="line"><span class="built_in">int</span> patchPriority = multiPatch.GetPatchPriority(patchIndex);</span><br><span class="line">PatchType patchType = multiPatch.GetPatchType(patchIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// patch points</span></span><br><span class="line"><span class="built_in">int</span> patchPointCount = multiPatch.GetPatchPointCount(patchIndex);</span><br><span class="line"><span class="built_in">int</span> pointStartIndex = multiPatch.GetPatchStartPointIndex(patchIndex);</span><br><span class="line"><span class="comment">// the patch Points are then the points in multipatch.Points from pointStartIndex to pointStartIndex + patchPointCount </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// if the multipatch has materials </span></span><br><span class="line"><span class="keyword">if</span> (hasMaterials)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// does the patch have a material?  </span></span><br><span class="line">  <span class="comment">//   materialIndex = -1 if the patch does not have a material; </span></span><br><span class="line">  <span class="comment">//   0 &lt;= materialIndex &lt; materialCount if the patch does have materials</span></span><br><span class="line">  <span class="built_in">int</span> materialIndex = multipatch.GetPatchMaterialIndex(patchIndex);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// properties for an individual material (if multipatch.MaterialCount &gt; 0)</span></span><br><span class="line">  <span class="keyword">var</span> color = multipatch.GetMaterialColor(materialIndex);</span><br><span class="line">  <span class="keyword">var</span> edgeColor = multipatch.GetMaterialEdgeColor(materialIndex);</span><br><span class="line">  <span class="keyword">var</span> edgeWidth = multipatch.GetMaterialEdgeWidth(materialIndex);</span><br><span class="line">  <span class="keyword">var</span> shiness = multipatch.GetMaterialShininess(materialIndex);</span><br><span class="line">  <span class="keyword">var</span> percent = multipatch.GetMaterialTransparencyPercent(materialIndex);</span><br><span class="line">  <span class="keyword">var</span> cullBackFace = multipatch.IsMaterialCullBackFace(materialIndex);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// texture properties</span></span><br><span class="line">  <span class="built_in">bool</span> isTextured = multipatch.IsMaterialTextured(materialIndex);</span><br><span class="line">  <span class="keyword">if</span> (isTextured)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">int</span> columnCount = multipatch.GetMaterialTextureColumnCount(materialIndex);</span><br><span class="line">    <span class="built_in">int</span> rowCount = multipatch.GetMaterialTextureRowCount(materialIndex);</span><br><span class="line">    <span class="built_in">int</span> bpp = multipatch.GetMaterialTextureBytesPerPixel(materialIndex);</span><br><span class="line">    TextureCompressionType compressionType = multipatch.GetMaterialTextureCompressionType(materialIndex);</span><br><span class="line">    <span class="keyword">var</span> texture = multipatch.GetMaterialTexture(materialIndex);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// texture coordinates (if multipatch.HasTextures = true)</span></span><br><span class="line"><span class="keyword">if</span> (hasTextures)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> numPatchTexturePoints = multiPatch.GetPatchTextureVertexCount(patchIndex);</span><br><span class="line">  <span class="keyword">var</span> coordinate2D = multiPatch.GetPatchTextureCoordinate(patchIndex, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  ICollection&lt;Coordinate2D&gt; textureCoordinates = <span class="keyword">new</span> List&lt;Coordinate2D&gt;(numPatchTexturePoints);</span><br><span class="line">  multiPatch.GetPatchTextureCoordinates(patchIndex, <span class="keyword">ref</span> textureCoordinates);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// patch normals (if multipatch.HasNormals = true)</span></span><br><span class="line"><span class="keyword">if</span> (hasNormals)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//  number of normal coordinates = multipatch.GetPatchPointCount(patchIndex)</span></span><br><span class="line">  Coordinate3D patchNormal = multipatch.GetPatchNormal(patchIndex, <span class="number">0</span>);</span><br><span class="line">  ICollection&lt;Coordinate3D&gt; normalCoordinates = <span class="keyword">new</span> List&lt;Coordinate3D&gt;(patchPointCount);</span><br><span class="line">  multipatch.GetPatchNormals(patchIndex, <span class="keyword">ref</span> normalCoordinates);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="构建多面体"><a href="#构建多面体" class="headerlink" title="构建多面体"></a>构建多面体</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// export to binary xml</span></span><br><span class="line"><span class="built_in">string</span> binaryXml = multiPatch.ToBinaryXml();</span><br><span class="line"></span><br><span class="line"><span class="comment">// import from binaryXML - methods need to run on the MCT</span></span><br><span class="line">Multipatch binaryMultipatch = MultipatchBuilderEx.FromBinaryXml(binaryXml);</span><br><span class="line"></span><br><span class="line"><span class="comment">// xml export / import</span></span><br><span class="line"><span class="built_in">string</span> xml = multiPatch.ToXml();</span><br><span class="line">Multipatch xmlMultipatch = MultipatchBuilderEx.FromXml(xml);</span><br><span class="line"></span><br><span class="line"><span class="comment">// esriShape export/import</span></span><br><span class="line"><span class="built_in">byte</span>[] buffer = multiPatch.ToEsriShape();</span><br><span class="line">Multipatch esriPatch = MultipatchBuilderEx.FromEsriShape(buffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// or use GeometryEngine</span></span><br><span class="line">Multipatch patchImport = GeometryEngine.Instance.ImportFromEsriShape(EsriShapeImportFlags.EsriShapeImportDefaults, buffer, multiPatch.SpatialReference) <span class="keyword">as</span> Multipatch;</span><br></pre></td></tr></table></figure>

<h3 id="通过MultipatchBuilderEx构建多面体"><a href="#通过MultipatchBuilderEx构建多面体" class="headerlink" title="通过MultipatchBuilderEx构建多面体"></a>通过MultipatchBuilderEx构建多面体</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> coords_face1 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>,<span class="number">41.902603910000039</span>,<span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>,<span class="number">41.902603910000039</span>,<span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>,<span class="number">41.902576344000067</span>,<span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>,<span class="number">41.902603910000039</span>,<span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>,<span class="number">41.902576344000067</span>,<span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>,<span class="number">41.902576344000067</span>,<span class="number">62.552700000000186</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coords_face2 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coords_face3 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coords_face4 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coords_face5 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">59.504700000004959</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> coords_face6 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902603910000039</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495461061000071</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">12.495488442000067</span>, <span class="number">41.902576344000067</span>, <span class="number">62.552700000000186</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// materials</span></span><br><span class="line"><span class="keyword">var</span> materialRed = <span class="keyword">new</span> BasicMaterial();</span><br><span class="line">materialRed.Color = System.Windows.Media.Colors.Red;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> materialTransparent = <span class="keyword">new</span> BasicMaterial();</span><br><span class="line">materialTransparent.Color = System.Windows.Media.Colors.White;</span><br><span class="line">materialTransparent.TransparencyPercent = <span class="number">80</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> blueTransparent = <span class="keyword">new</span> BasicMaterial(materialTransparent);</span><br><span class="line">blueTransparent.Color = System.Windows.Media.Colors.SkyBlue;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a list of patch objects</span></span><br><span class="line"><span class="keyword">var</span> patches = <span class="keyword">new</span> List&lt;Patch&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// create the multipatchBuilderEx object</span></span><br><span class="line"><span class="keyword">var</span> mpb = <span class="keyword">new</span> ArcGIS.Core.Geometry.MultipatchBuilderEx();</span><br><span class="line"></span><br><span class="line"><span class="comment">// make each patch using the appropriate coordinates and add to the patch list</span></span><br><span class="line"><span class="keyword">var</span> patch = mpb.MakePatch(PatchType.Triangles);</span><br><span class="line">patch.Coords = coords_face1;</span><br><span class="line">patches.Add(patch);</span><br><span class="line"></span><br><span class="line">patch = mpb.MakePatch(PatchType.Triangles);</span><br><span class="line">patch.Coords = coords_face2;</span><br><span class="line">patches.Add(patch);</span><br><span class="line"></span><br><span class="line">patch = mpb.MakePatch(PatchType.Triangles);</span><br><span class="line">patch.Coords = coords_face3;</span><br><span class="line">patches.Add(patch);</span><br><span class="line"></span><br><span class="line">patch = mpb.MakePatch(PatchType.Triangles);</span><br><span class="line">patch.Coords = coords_face4;</span><br><span class="line">patches.Add(patch);</span><br><span class="line"></span><br><span class="line">patch = mpb.MakePatch(PatchType.Triangles);</span><br><span class="line">patch.Coords = coords_face5;</span><br><span class="line">patches.Add(patch);</span><br><span class="line"></span><br><span class="line">patch = mpb.MakePatch(PatchType.Triangles);</span><br><span class="line">patch.Coords = coords_face6;</span><br><span class="line">patches.Add(patch);</span><br><span class="line"></span><br><span class="line">patches[<span class="number">0</span>].Material = materialRed;</span><br><span class="line">patches[<span class="number">1</span>].Material = materialTransparent;</span><br><span class="line">patches[<span class="number">2</span>].Material = materialRed;</span><br><span class="line">patches[<span class="number">3</span>].Material = materialRed;</span><br><span class="line">patches[<span class="number">4</span>].Material = materialRed;</span><br><span class="line">patches[<span class="number">5</span>].Material = blueTransparent;</span><br><span class="line"></span><br><span class="line"><span class="comment">// assign the patches to the multipatchBuilder</span></span><br><span class="line">mpb.Patches = patches;</span><br><span class="line"></span><br><span class="line"><span class="comment">// check which patches currently contain the material</span></span><br><span class="line"><span class="keyword">var</span> red = mpb.QueryPatchIndicesWithMaterial(materialRed);</span><br><span class="line"><span class="comment">//   red should be [0, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// call ToGeometry to get the multipatch</span></span><br><span class="line">multipatch = mpb.ToGeometry() <span class="keyword">as</span> Multipatch;</span><br></pre></td></tr></table></figure>

<h3 id="从另一个多面体构建多面体"><a href="#从另一个多面体构建多面体" class="headerlink" title="从另一个多面体构建多面体"></a>从另一个多面体构建多面体</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create the multipatchBuilderEx object</span></span><br><span class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> ArcGIS.Core.Geometry.MultipatchBuilderEx(multipatch);</span><br><span class="line"></span><br><span class="line"><span class="comment">// check some properties</span></span><br><span class="line"><span class="built_in">bool</span> hasM = builder.HasM;</span><br><span class="line"><span class="built_in">bool</span> hasZ = builder.HasZ;</span><br><span class="line"><span class="built_in">bool</span> hasID = builder.HasID;</span><br><span class="line"><span class="built_in">bool</span> isEmpty = builder.IsEmpty;</span><br><span class="line"><span class="built_in">bool</span> hasNormals = builder.HasNormals;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> patches = builder.Patches;</span><br><span class="line"><span class="built_in">int</span> patchCount = patches.Count;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if there&#x27;s some patches</span></span><br><span class="line"><span class="keyword">if</span> (patchCount &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> pointCount = builder.GetPatchPointCount(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// replace the first point in the first patch</span></span><br><span class="line">  <span class="keyword">if</span> (pointCount &gt; <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// get the first point</span></span><br><span class="line">    <span class="keyword">var</span> pt = builder.GetPoint(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    builder.SetPoint(<span class="number">0</span>, <span class="number">0</span>, newPoint);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// check which patches currently contain the texture</span></span><br><span class="line">  <span class="keyword">var</span> texture = builder.QueryPatchIndicesWithTexture(brickTextureResource);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// assign a texture material</span></span><br><span class="line">  patches[<span class="number">0</span>].Material = brickMaterialTexture;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// update the builder for M awareness</span></span><br><span class="line">builder.HasM = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// synchronize the patch attributes to match the builder attributes</span></span><br><span class="line"><span class="comment">//   in this instance because we just set HasM to true on the builder, each patch will now get a default M value for it&#x27;s set of coordinates</span></span><br><span class="line">builder.SynchronizeAttributeAwareness();</span><br><span class="line"></span><br><span class="line"><span class="comment">// call ToGeometry to get the multipatch</span></span><br><span class="line">multipatch = builder.ToGeometry() <span class="keyword">as</span> Multipatch;</span><br><span class="line"></span><br><span class="line"><span class="comment">// multipatch.HasM will be true</span></span><br></pre></td></tr></table></figure>

<h3 id="从-3D-模型文件构建多面体"><a href="#从-3D-模型文件构建多面体" class="headerlink" title="从 3D 模型文件构建多面体"></a>从 3D 模型文件构建多面体</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> model = ArcGIS.Core.Geometry.MultipatchBuilderEx.From3DModelFile(<span class="string">@&quot;c:\Temp\My3dModelFile.dae&quot;</span>);</span><br><span class="line">  <span class="built_in">bool</span> modelIsEmpty = model.IsEmpty;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (FileNotFoundException)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// file not found</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (ArgumentException)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// File extension is unsupported or cannot read the file</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="构建-3D-特殊多面体形状"><a href="#构建-3D-特殊多面体形状" class="headerlink" title="构建 3D 特殊多面体形状"></a>构建 3D 特殊多面体形状</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sr = MapView.Active.Map.SpatialReference;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> extent = MapView.Active.Extent;</span><br><span class="line"><span class="keyword">var</span> center = extent.Center;</span><br><span class="line"><span class="keyword">var</span> centerZ = MapPointBuilderEx.CreateMapPoint(center.X, center.Y, <span class="number">500</span>, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// cube</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Cube, centerZ, <span class="number">200</span>, sr);</span><br><span class="line"><span class="comment">// tetrahedron</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Tetrahedron, centerZ, <span class="number">200</span>, sr);</span><br><span class="line"><span class="comment">// diamond</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Diamond, centerZ, <span class="number">200</span>, sr);</span><br><span class="line"><span class="comment">// hexagon</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Hexagon, centerZ, <span class="number">200</span>, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// sphere frame</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.SphereFrame, centerZ, <span class="number">200</span>, <span class="number">0.8</span>, sr);</span><br><span class="line"><span class="comment">// sphere</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Sphere, centerZ, <span class="number">200</span>, <span class="number">0.8</span>, sr);</span><br><span class="line"><span class="comment">// cylinder</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Cylinder, centerZ, <span class="number">200</span>, <span class="number">0.8</span>, sr);</span><br><span class="line"><span class="comment">// cone</span></span><br><span class="line">multipatch = ArcGIS.Core.Geometry.MultipatchBuilderEx.CreateMultipatch(MultipatchConstructType.Cone, centerZ, <span class="number">200</span>, <span class="number">0.8</span>, sr);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the builder to add materials or textures</span></span><br><span class="line"><span class="comment">//   - create a cone with a material</span></span><br><span class="line">builder = <span class="keyword">new</span> MultipatchBuilderEx(MultipatchConstructType.Cone, centerZ, <span class="number">200</span>, <span class="number">0.8</span>, sr);</span><br><span class="line"></span><br><span class="line">BasicMaterial faceMaterial = <span class="keyword">new</span> BasicMaterial();</span><br><span class="line">faceMaterial.Color = System.Windows.Media.Color.FromRgb(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">faceMaterial.Shininess = <span class="number">150</span>;</span><br><span class="line">faceMaterial.TransparencyPercent = <span class="number">50</span>;</span><br><span class="line">faceMaterial.EdgeWidth = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> patch <span class="keyword">in</span> builder.Patches)</span><br><span class="line">  patch.Material = faceMaterial;</span><br><span class="line"></span><br><span class="line">multipatch = builder.ToGeometry() <span class="keyword">as</span> Multipatch;</span><br></pre></td></tr></table></figure>

<h3 id="创建基本材料"><a href="#创建基本材料" class="headerlink" title="创建基本材料"></a>创建基本材料</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create BasicMaterial with default values</span></span><br><span class="line">BasicMaterial material = <span class="keyword">new</span> BasicMaterial();</span><br><span class="line">System.Windows.Media.Color color = material.Color;         <span class="comment">// color = Colors.Black</span></span><br><span class="line">System.Windows.Media.Color edgeColor = material.EdgeColor; <span class="comment">// edgeColor = Colors.Black</span></span><br><span class="line"><span class="built_in">int</span> edgeWidth = material.EdgeWidth;                        <span class="comment">// edgeWidth = 0</span></span><br><span class="line"><span class="built_in">int</span> transparency = material.TransparencyPercent;           <span class="comment">// transparency = 0</span></span><br><span class="line"><span class="built_in">int</span> shininess = material.Shininess;                        <span class="comment">// shininess = 0</span></span><br><span class="line"><span class="built_in">bool</span> cullBackFace = material.IsCullBackFace;               <span class="comment">// cullBackFace = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Modify the properties</span></span><br><span class="line">material.Color = System.Windows.Media.Colors.Red;</span><br><span class="line">material.EdgeColor = System.Windows.Media.Colors.Blue;</span><br><span class="line">material.EdgeWidth = <span class="number">10</span>;</span><br><span class="line">material.TransparencyPercent = <span class="number">50</span>;</span><br><span class="line">material.Shininess = <span class="number">25</span>;</span><br><span class="line">material.IsCullBackFace = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<h3 id="使用-JPEG-纹理创建基本材质"><a href="#使用-JPEG-纹理创建基本材质" class="headerlink" title="使用 JPEG 纹理创建基本材质"></a>使用 JPEG 纹理创建基本材质</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// read the jpeg into a buffer</span></span><br><span class="line"><span class="comment">//At 3.0 you need https://www.nuget.org/packages/Microsoft.Windows.Compatibility</span></span><br><span class="line"><span class="comment">//System.Drawing</span></span><br><span class="line">System.Drawing.Image image = System.Drawing.Image.FromFile(<span class="string">@&quot;C:\temp\myImageFile.jpg&quot;</span>);</span><br><span class="line">MemoryStream memoryStream = <span class="keyword">new</span> MemoryStream();</span><br><span class="line"></span><br><span class="line">System.Drawing.Imaging.ImageFormat format = System.Drawing.Imaging.ImageFormat.Jpeg;</span><br><span class="line">image.Save(memoryStream, format);</span><br><span class="line"><span class="built_in">byte</span>[] imageBuffer = memoryStream.ToArray();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> jpgTexture = <span class="keyword">new</span> JPEGTexture(imageBuffer);</span><br><span class="line"></span><br><span class="line"><span class="comment">// texture properties</span></span><br><span class="line"><span class="built_in">int</span> bpp = jpgTexture.BytesPerPixel;</span><br><span class="line"><span class="built_in">int</span> columnCount = jpgTexture.ColumnCount;</span><br><span class="line"><span class="built_in">int</span> rowCount = jpgTexture.RowCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// build the textureResource and the material</span></span><br><span class="line">BasicMaterial material = <span class="keyword">new</span> BasicMaterial();</span><br><span class="line">material.TextureResource = <span class="keyword">new</span> TextureResource(jpgTexture);</span><br></pre></td></tr></table></figure>

<h3 id="使用未压缩纹理创建基本材质"><a href="#使用未压缩纹理创建基本材质" class="headerlink" title="使用未压缩纹理创建基本材质"></a>使用未压缩纹理创建基本材质</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">UncompressedTexture uncompressedTexture1 = <span class="keyword">new</span> UncompressedTexture(<span class="keyword">new</span> <span class="built_in">byte</span>[<span class="number">10</span> * <span class="number">12</span> * <span class="number">3</span>], <span class="number">10</span>, <span class="number">12</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// texture properties</span></span><br><span class="line"><span class="built_in">int</span> bpp = uncompressedTexture1.BytesPerPixel;</span><br><span class="line"><span class="built_in">int</span> columnCount = uncompressedTexture1.ColumnCount;</span><br><span class="line"><span class="built_in">int</span> rowCount = uncompressedTexture1.RowCount;</span><br><span class="line"></span><br><span class="line"><span class="comment">// build the textureResource and the material</span></span><br><span class="line">TextureResource tr = <span class="keyword">new</span> TextureResource(uncompressedTexture1);</span><br><span class="line">BasicMaterial material = <span class="keyword">new</span> BasicMaterial();</span><br><span class="line">material.TextureResource = tr;</span><br></pre></td></tr></table></figure>

<h3 id="获取多面体的纹理图像"><a href="#获取多面体的纹理图像" class="headerlink" title="获取多面体的纹理图像"></a>获取多面体的纹理图像</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">// This method gets the material texture image of a multipatch.</span></span><br><span class="line"><span class="comment">// This method must be called on the MCT. Use QueuedTask.Run.</span></span><br><span class="line"><span class="comment">// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;multipatch&quot;&gt;The input multipatch.&lt;/param&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;patchIndex&quot;&gt;The index of the patch (part) for which to get the material texture.&lt;/param&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetMultipatchTextureImage</span>(<span class="params">Multipatch multipatch, <span class="built_in">int</span> patchIndex</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> materialIndex = multipatch.GetPatchMaterialIndex(patchIndex);</span><br><span class="line">  <span class="keyword">if</span> (!multipatch.IsMaterialTextured(materialIndex))</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  TextureCompressionType compressionType = </span><br><span class="line">    multipatch.GetMaterialTextureCompressionType(materialIndex);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">string</span> ext = compressionType == TextureCompressionType.CompressionJPEG ? <span class="string">&quot;.jpg&quot;</span> : <span class="string">&quot;.dat&quot;</span>;</span><br><span class="line">  <span class="built_in">byte</span>[] textureBuffer = multipatch.GetMaterialTexture(materialIndex);</span><br><span class="line"></span><br><span class="line">  Stream imageStream = <span class="keyword">new</span> MemoryStream(textureBuffer);</span><br><span class="line">  System.Drawing.Image image = System.Drawing.Image.FromStream(imageStream);</span><br><span class="line">  image.Save(<span class="string">@&quot;C:\temp\myImage&quot;</span> + ext);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取多面体的法线坐标"><a href="#获取多面体的法线坐标" class="headerlink" title="获取多面体的法线坐标"></a>获取多面体的法线坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">// This method gets the normal coordinate of a multipatch and does something with it.</span></span><br><span class="line"><span class="comment">// This method must be called on the MCT. Use QueuedTask.Run.</span></span><br><span class="line"><span class="comment">// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;multipatch&quot;&gt;The input multipatch.&lt;/param&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;patchIndex&quot;&gt;The index of the patch (part) for which to get the normal.&lt;/param&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoSomethingWithNormalCoordinate</span>(<span class="params">Multipatch multipatch, <span class="built_in">int</span> patchIndex</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (multipatch.HasNormals)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// If the multipatch has normals, then the number of normals is equal to the number of points.</span></span><br><span class="line">    <span class="built_in">int</span> numNormals = multipatch.GetPatchPointCount(patchIndex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> pointIndex = <span class="number">0</span>; pointIndex &lt; numNormals; pointIndex++)</span><br><span class="line">    &#123;</span><br><span class="line">      Coordinate3D normal = multipatch.GetPatchNormal(patchIndex, pointIndex);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Do something with the normal coordinate.</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取多面体的法线"><a href="#获取多面体的法线" class="headerlink" title="获取多面体的法线"></a>获取多面体的法线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;summary&gt;</span></span><br><span class="line"><span class="comment">// This method gets the normal coordinate of a multipatch and does something with it.</span></span><br><span class="line"><span class="comment">// This method must be called on the MCT. Use QueuedTask.Run.</span></span><br><span class="line"><span class="comment">// &lt;/summary&gt;</span></span><br><span class="line"><span class="comment">// &lt;param name=&quot;multipatch&quot;&gt;The input multipatch.&lt;/param&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">DoSomethingWithNormalCoordinates</span>(<span class="params">Multipatch multipatch</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (multipatch.HasNormals)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Allocate the list only once</span></span><br><span class="line">    <span class="built_in">int</span> numPoints = multipatch.PointCount;</span><br><span class="line">    ICollection&lt;Coordinate3D&gt; normals = <span class="keyword">new</span> List&lt;Coordinate3D&gt;(numPoints);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The parts of a multipatch are also called patches</span></span><br><span class="line">    <span class="built_in">int</span> numPatches = multipatch.PartCount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> patchIndex = <span class="number">0</span>; patchIndex &lt; numPatches; patchIndex++)</span><br><span class="line">    &#123;</span><br><span class="line">      multipatch.GetPatchNormals(patchIndex, <span class="keyword">ref</span> normals);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Do something with the normals for this patch.</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取多面体的材质属性"><a href="#获取多面体的材质属性" class="headerlink" title="获取多面体的材质属性"></a>获取多面体的材质属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetMaterialProperties</span>(<span class="params">Multipatch multipatch, <span class="built_in">int</span> patchIndex</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (multipatch.HasMaterials)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Get the material index for the specified patch.</span></span><br><span class="line">    <span class="built_in">int</span> materialIndex = multipatch.GetPatchMaterialIndex(patchIndex);</span><br><span class="line"></span><br><span class="line">    System.Windows.Media.Color color = multipatch.GetMaterialColor(materialIndex);</span><br><span class="line">    <span class="built_in">int</span> tranparencyPercent = multipatch.GetMaterialTransparencyPercent(materialIndex);</span><br><span class="line">    <span class="built_in">bool</span> isBackCulled = multipatch.IsMaterialCullBackFace(materialIndex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (multipatch.IsMaterialTextured(materialIndex))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">int</span> bpp = multipatch.GetMaterialTextureBytesPerPixel(materialIndex);</span><br><span class="line">      <span class="built_in">int</span> columnCount = multipatch.GetMaterialTextureColumnCount(materialIndex);</span><br><span class="line">      <span class="built_in">int</span> rowCount = multipatch.GetMaterialTextureRowCount(materialIndex);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多部件"><a href="#多部件" class="headerlink" title="多部件"></a>多部件</h2><h3 id="获取多部分要素的各个部分"><a href="#获取多部分要素的各个部分" class="headerlink" title="获取多部分要素的各个部分"></a>获取多部分要素的各个部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> IEnumerable&lt;Geometry&gt; <span class="title">MultipartToSinglePart</span>(<span class="params">Geometry inputGeometry</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// list holding the part(s) of the input geometry</span></span><br><span class="line">  List&lt;Geometry&gt; singleParts = <span class="keyword">new</span> List&lt;Geometry&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// check if the input is a null pointer or if the geometry is empty</span></span><br><span class="line">  <span class="keyword">if</span> (inputGeometry == <span class="literal">null</span> || inputGeometry.IsEmpty)</span><br><span class="line">    <span class="keyword">return</span> singleParts;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// based on the type of geometry, take the parts/points and add them individually into a list</span></span><br><span class="line">  <span class="keyword">switch</span> (inputGeometry.GeometryType)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Envelope:</span><br><span class="line">      singleParts.Add(inputGeometry.Clone() <span class="keyword">as</span> Envelope);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Multipatch:</span><br><span class="line">      singleParts.Add(inputGeometry.Clone() <span class="keyword">as</span> Multipatch);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Multipoint:</span><br><span class="line">      <span class="keyword">var</span> multiPoint = inputGeometry <span class="keyword">as</span> Multipoint;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">foreach</span> (<span class="keyword">var</span> point <span class="keyword">in</span> multiPoint.Points)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// add each point of collection as a standalone point into the list</span></span><br><span class="line">        singleParts.Add(point);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Point:</span><br><span class="line">      singleParts.Add(inputGeometry.Clone() <span class="keyword">as</span> MapPoint);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Polygon:</span><br><span class="line">      <span class="keyword">var</span> polygon = inputGeometry <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">foreach</span> (<span class="keyword">var</span> polygonPart <span class="keyword">in</span> polygon.Parts)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// use the PolygonBuilderEx turning the segments into a standalone </span></span><br><span class="line">        <span class="comment">// polygon instance</span></span><br><span class="line">        singleParts.Add(PolygonBuilderEx.CreatePolygon(polygonPart));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Polyline:</span><br><span class="line">      <span class="keyword">var</span> polyline = inputGeometry <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">foreach</span> (<span class="keyword">var</span> polylinePart <span class="keyword">in</span> polyline.Parts)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// use the PolylineBuilderEx turning the segments into a standalone</span></span><br><span class="line">        <span class="comment">// polyline instance</span></span><br><span class="line">        singleParts.Add(PolylineBuilderEx.CreatePolyline(polylinePart));</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> GeometryType.Unknown:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="literal">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> singleParts;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取多边形的最外层环"><a href="#获取多边形的最外层环" class="headerlink" title="获取多边形的最外层环"></a>获取多边形的最外层环</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Polygon <span class="title">GetOutermostRings</span>(<span class="params">Polygon inputPolygon</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (inputPolygon == <span class="literal">null</span> || inputPolygon.IsEmpty)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  List&lt;Polygon&gt; internalRings = <span class="keyword">new</span> List&lt;Polygon&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// explode the parts of the polygon into a list of individual geometries</span></span><br><span class="line">  <span class="comment">// see the &quot;Get the individual parts of a multipart feature&quot;</span></span><br><span class="line">  <span class="comment">// snippet for MultipartToSinglePart</span></span><br><span class="line">  <span class="keyword">var</span> parts = MultipartToSinglePart(inputPolygon);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get an enumeration of clockwise geometries (area &gt; 0) ordered by the area</span></span><br><span class="line">  <span class="keyword">var</span> clockwiseParts = parts.Where(geom =&gt; ((Polygon)geom).Area &gt; <span class="number">0</span>)</span><br><span class="line">                        .OrderByDescending(geom =&gt; ((Polygon)geom).Area);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// for each of the exterior rings</span></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> part <span class="keyword">in</span> clockwiseParts)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// add the first (the largest) ring into the internal collection</span></span><br><span class="line">    <span class="keyword">if</span> (internalRings.Count == <span class="number">0</span>)</span><br><span class="line">      internalRings.Add(part <span class="keyword">as</span> Polygon);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// use flag to indicate if current part is within the already selection polygons</span></span><br><span class="line">    <span class="built_in">bool</span> isWithin = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> internalRings)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (GeometryEngine.Instance.Within(part, item))</span><br><span class="line">        isWithin = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if the current polygon is not within any polygon of the internal collection</span></span><br><span class="line">    <span class="comment">// then it is disjoint and needs to be added to </span></span><br><span class="line">    <span class="keyword">if</span> (isWithin == <span class="literal">false</span>)</span><br><span class="line">      internalRings.Add(part <span class="keyword">as</span> Polygon);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  PolygonBuilderEx outerRings = <span class="keyword">new</span> PolygonBuilderEx();</span><br><span class="line">  <span class="comment">// now assemble a new polygon geometry based on the internal polygon collection</span></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> ring <span class="keyword">in</span> internalRings)</span><br><span class="line">  &#123;</span><br><span class="line">    outerRings.AddParts(ring.Parts);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// return the final geometry of the outer rings</span></span><br><span class="line">  <span class="keyword">return</span> outerRings.ToGeometry();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="从地理数据库检索几何"><a href="#从地理数据库检索几何" class="headerlink" title="从地理数据库检索几何"></a>从地理数据库检索几何</h2><h3 id="从地理数据库检索几何-1"><a href="#从地理数据库检索几何-1" class="headerlink" title="从地理数据库检索几何"></a>从地理数据库检索几何</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// methods need to run on the MCT</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// open a gdb</span></span><br><span class="line">    <span class="keyword">using</span> (ArcGIS.Core.Data.Geodatabase gdb = </span><br><span class="line">              <span class="keyword">new</span> ArcGIS.Core.Data.Geodatabase(</span><br><span class="line">                  <span class="keyword">new</span> FileGeodatabaseConnectionPath(<span class="keyword">new</span> Uri(<span class="string">@&quot;c:\Temp\MyDatabase.gdb&quot;</span>))))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//Open a featureClass </span></span><br><span class="line">      <span class="keyword">using</span> (ArcGIS.Core.Data.FeatureClass featureClass = </span><br><span class="line">                     gdb.OpenDataset&lt;ArcGIS.Core.Data.FeatureClass&gt;(<span class="string">&quot;Polygon&quot;</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        </span><br><span class="line">        ArcGIS.Core.Data.QueryFilter filter = </span><br><span class="line">                   <span class="keyword">new</span> ArcGIS.Core.Data.QueryFilter()</span><br><span class="line">                    &#123;</span><br><span class="line">                      WhereClause = <span class="string">&quot;OBJECTID = 6&quot;</span></span><br><span class="line">                    &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// get the row</span></span><br><span class="line">        <span class="keyword">using</span> (ArcGIS.Core.Data.RowCursor rowCursor = </span><br><span class="line">                               featureClass.Search(filter, <span class="literal">false</span>))</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">while</span> (rowCursor.MoveNext())</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">using</span> (<span class="keyword">var</span> row = rowCursor.Current)</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="built_in">long</span> oid = row.GetObjectID();</span><br><span class="line"></span><br><span class="line">              <span class="comment">// get the shape from the row</span></span><br><span class="line">              ArcGIS.Core.Data.Feature feature = row <span class="keyword">as</span> ArcGIS.Core.Data.Feature;</span><br><span class="line">              Polygon polygon = feature.GetShape() <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line">              <span class="comment">// do something here</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// error - handle appropriately</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="导入、导出几何图形"><a href="#导入、导出几何图形" class="headerlink" title="导入、导出几何图形"></a>导入、导出几何图形</h2><h3 id="将几何图形导入和导出为已知文本"><a href="#将几何图形导入和导出为已知文本" class="headerlink" title="将几何图形导入和导出为已知文本"></a>将几何图形导入和导出为已知文本</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a point with z, m</span></span><br><span class="line">MapPoint point = MapPointBuilderEx.CreateMapPoint(</span><br><span class="line">         <span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span>, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line"><span class="comment">// set the flags</span></span><br><span class="line">WktExportFlags wktExportFlags = WktExportFlags.WktExportDefaults;</span><br><span class="line">WktImportFlags wktImportFlags = WktImportFlags.WktImportDefaults;</span><br><span class="line"></span><br><span class="line"><span class="comment">// export and import</span></span><br><span class="line"><span class="built_in">string</span> wktString = GeometryEngine.Instance.ExportToWKT(wktExportFlags, point);</span><br><span class="line">MapPoint importPoint = GeometryEngine.Instance.ImportFromWKT(</span><br><span class="line">      wktImportFlags, wktString, SpatialReferences.WebMercator) <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> x = importPoint.X;       <span class="comment">// x = 100</span></span><br><span class="line"><span class="built_in">double</span> y = importPoint.Y;       <span class="comment">// y = 200</span></span><br><span class="line"><span class="built_in">bool</span> hasZ = importPoint.HasZ;   <span class="comment">// hasZ = true</span></span><br><span class="line"><span class="built_in">double</span> z = importPoint.Z;       <span class="comment">// z = 300</span></span><br><span class="line"><span class="built_in">bool</span> hasM = importPoint.HasM;   <span class="comment">// hasM = true</span></span><br><span class="line"><span class="built_in">double</span> m = importPoint.M;       <span class="comment">// m = 400</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export without z</span></span><br><span class="line">WktExportFlags exportFlagsNoZ = WktExportFlags.WktExportStripZs;</span><br><span class="line">wktString = GeometryEngine.Instance.ExportToWKT(exportFlagsNoZ, point);</span><br><span class="line">importPoint = GeometryEngine.Instance.ImportFromWKT(</span><br><span class="line">  wktImportFlags, wktString, SpatialReferences.WebMercator) <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line">x = importPoint.X;        <span class="comment">// x = 100</span></span><br><span class="line">y = importPoint.Y;        <span class="comment">// y = 200</span></span><br><span class="line">hasZ = importPoint.HasZ;  <span class="comment">// hasZ = false</span></span><br><span class="line">z = importPoint.Z;        <span class="comment">// z = 0</span></span><br><span class="line">hasM = importPoint.HasM;  <span class="comment">// hasM = true</span></span><br><span class="line">m = importPoint.M;        <span class="comment">// m = 400</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export without m</span></span><br><span class="line">WktExportFlags exportFlagsNoM = WktExportFlags.WktExportStripMs;</span><br><span class="line">wktString = GeometryEngine.Instance.ExportToWKT(exportFlagsNoM, point);</span><br><span class="line">importPoint = GeometryEngine.Instance.ImportFromWKT(</span><br><span class="line">  wktImportFlags, wktString, SpatialReferences.WebMercator) <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line">x = importPoint.X;        <span class="comment">// x = 100</span></span><br><span class="line">y = importPoint.Y;        <span class="comment">// y = 200</span></span><br><span class="line">hasZ = importPoint.HasZ;  <span class="comment">// hasZ = true</span></span><br><span class="line">z = importPoint.Z;        <span class="comment">// z = 300</span></span><br><span class="line">hasM = importPoint.HasM;  <span class="comment">// hasM = false</span></span><br><span class="line">m = importPoint.M;        <span class="comment">// m = Nan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export without z, m</span></span><br><span class="line">wktString = GeometryEngine.Instance.ExportToWKT(</span><br><span class="line">  exportFlagsNoZ | exportFlagsNoM, point);</span><br><span class="line">importPoint = GeometryEngine.Instance.ImportFromWKT(</span><br><span class="line">  wktImportFlags, wktString, SpatialReferences.WebMercator) <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line">x = importPoint.X;        <span class="comment">// x = 100</span></span><br><span class="line">y = importPoint.Y;        <span class="comment">// y = 200</span></span><br><span class="line">hasZ = importPoint.HasZ;  <span class="comment">// hasZ = false</span></span><br><span class="line">z = importPoint.Z;        <span class="comment">// z = 0</span></span><br><span class="line">hasM = importPoint.HasM;  <span class="comment">// hasM = false</span></span><br><span class="line">m = importPoint.M;        <span class="comment">// m = Nan</span></span><br></pre></td></tr></table></figure>

<h3 id="将几何图形导入和导出到众所周知的二进制"><a href="#将几何图形导入和导出到众所周知的二进制" class="headerlink" title="将几何图形导入和导出到众所周知的二进制"></a>将几何图形导入和导出到众所周知的二进制</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a polyline</span></span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(</span><br><span class="line">            coords, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">WkbExportFlags wkbExportFlags = WkbExportFlags.WkbExportDefaults;</span><br><span class="line">WkbImportFlags wkbImportFlags = WkbImportFlags.WkbImportDefaults;</span><br><span class="line"></span><br><span class="line"><span class="comment">// export and import</span></span><br><span class="line"><span class="built_in">byte</span>[] buffer = GeometryEngine.Instance.ExportToWKB(wkbExportFlags, polyline);</span><br><span class="line">Geometry geometry = GeometryEngine.Instance.ImportFromWKB(</span><br><span class="line">               wkbImportFlags, buffer, SpatialReferences.WGS84);</span><br><span class="line">Polyline importPolyline = geometry <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// alternatively, determine the size for the buffer</span></span><br><span class="line"><span class="built_in">int</span> bufferSize = GeometryEngine.Instance.GetWKBSize(wkbExportFlags, polyline);</span><br><span class="line">buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[bufferSize];</span><br><span class="line"><span class="comment">// export</span></span><br><span class="line">bufferSize = GeometryEngine.Instance.ExportToWKB(</span><br><span class="line">                wkbExportFlags, polyline, <span class="keyword">ref</span> buffer);</span><br><span class="line"><span class="comment">// import</span></span><br><span class="line">importPolyline = GeometryEngine.Instance.ImportFromWKB(</span><br><span class="line">         wkbImportFlags, buffer, SpatialReferences.WGS84) <span class="keyword">as</span> Polyline;</span><br></pre></td></tr></table></figure>

<h3 id="将几何导入和导出到-EsriShape"><a href="#将几何导入和导出到-EsriShape" class="headerlink" title="将几何导入和导出到 EsriShape"></a>将几何导入和导出到 EsriShape</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create an envelope</span></span><br><span class="line">List&lt;MapPoint&gt; coordsZM = <span class="keyword">new</span> List&lt;MapPoint&gt;</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1001</span>, <span class="number">1002</span>, <span class="number">1003</span>, <span class="number">1004</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">2001</span>, <span class="number">2002</span>, Double.NaN, <span class="number">2004</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">3001</span>, <span class="number">-3002</span>, <span class="number">3003</span>, <span class="number">3004</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1001</span>, <span class="number">-4002</span>, <span class="number">4003</span>, <span class="number">4004</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Envelope envelope = EnvelopeBuilderEx.CreateEnvelope(</span><br><span class="line">           coordsZM[<span class="number">0</span>], coordsZM[<span class="number">2</span>], SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// export and import</span></span><br><span class="line">EsriShapeExportFlags exportFlags = EsriShapeExportFlags.EsriShapeExportDefaults;</span><br><span class="line">EsriShapeImportFlags importFlags = EsriShapeImportFlags.EsriShapeImportDefaults;</span><br><span class="line"><span class="built_in">byte</span>[] buffer = GeometryEngine.Instance.ExportToEsriShape(exportFlags, envelope);</span><br><span class="line">Polygon importedPolygon = GeometryEngine.Instance.ImportFromEsriShape(</span><br><span class="line">               importFlags, buffer, envelope.SpatialReference) <span class="keyword">as</span> Polygon;</span><br><span class="line">Envelope importedEnvelope = importedPolygon.Extent;</span><br><span class="line"></span><br><span class="line"><span class="comment">// export without z,m</span></span><br><span class="line">buffer = GeometryEngine.Instance.ExportToEsriShape(</span><br><span class="line">        EsriShapeExportFlags.EsriShapeExportStripZs | </span><br><span class="line">        EsriShapeExportFlags.EsriShapeExportStripMs, envelope);</span><br><span class="line">importedPolygon = GeometryEngine.Instance.ImportFromEsriShape(</span><br><span class="line">        importFlags, buffer, SpatialReferences.WGS84) <span class="keyword">as</span> Polygon;</span><br><span class="line">importedEnvelope = importedPolygon.Extent;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> hasZ = importedEnvelope.HasZ;      <span class="comment">// hasZ = false</span></span><br><span class="line"><span class="built_in">bool</span> hasM = importedEnvelope.HasM;      <span class="comment">// hasM = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export with shapeSize</span></span><br><span class="line"><span class="built_in">int</span> bufferSize = GeometryEngine.Instance.GetEsriShapeSize(</span><br><span class="line">                                       exportFlags, envelope);</span><br><span class="line">buffer = <span class="keyword">new</span> <span class="built_in">byte</span>[bufferSize];</span><br><span class="line"></span><br><span class="line">bufferSize = GeometryEngine.Instance.ExportToEsriShape(</span><br><span class="line">                             exportFlags, envelope, <span class="keyword">ref</span> buffer);</span><br><span class="line">importedPolygon = GeometryEngine.Instance.ImportFromEsriShape(</span><br><span class="line">                    importFlags, buffer, envelope.SpatialReference) <span class="keyword">as</span> Polygon;</span><br><span class="line">importedEnvelope = importedPolygon.Extent;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// or use the envelope and envelopeBuilderEx classes</span></span><br><span class="line">buffer = envelope.ToEsriShape();</span><br><span class="line"><span class="comment">// buffer represents a polygon as there is not an envelope Esri shape buffer</span></span><br><span class="line"><span class="comment">// EnvelopeBuilderEx.FromEsriShape takes a polygon Esri shape buffer and returns the extent of the polygon.</span></span><br><span class="line">importedEnvelope = EnvelopeBuilderEx.FromEsriShape(buffer);</span><br></pre></td></tr></table></figure>

<h3 id="将几何图形导入和导出为-JSON"><a href="#将几何图形导入和导出为-JSON" class="headerlink" title="将几何图形导入和导出为 JSON"></a>将几何图形导入和导出为 JSON</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MapPoint</span></span><br><span class="line"><span class="built_in">string</span> inputString = </span><br><span class="line">  <span class="string">&quot;&#123;\&quot;x\&quot;:1,\&quot;y\&quot;:2,\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326,\&quot;latestWkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line">Geometry geometry = GeometryEngine.Instance.ImportFromJson(</span><br><span class="line">  JsonImportFlags.JsonImportDefaults, inputString);</span><br><span class="line"></span><br><span class="line">MapPoint importPoint = geometry <span class="keyword">as</span> MapPoint;</span><br><span class="line"><span class="comment">// importPoint = 1, 2</span></span><br><span class="line"><span class="comment">// importPoint.SpatialReference.WKid = 4326</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the MapPointBuilderEx convenience method</span></span><br><span class="line">MapPoint importPoint2 = MapPointBuilderEx.FromJson(inputString);</span><br><span class="line"><span class="comment">// importPoint2 = 1, 2</span></span><br><span class="line"><span class="comment">// impointPoint2.SpatialReference.Wkid = 4326</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> outputString = GeometryEngine.Instance.ExportToJson(</span><br><span class="line">  JsonExportFlags.JsonExportDefaults, importPoint);</span><br><span class="line"><span class="comment">// outputString =</span></span><br><span class="line"><span class="comment">//   &quot;&#123;\&quot;x\&quot;:1,\&quot;y\&quot;:2,\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326,\&quot;latestWkid\&quot;:4326&#125;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> outputString2 = importPoint.ToJson();</span><br><span class="line"></span><br><span class="line">inputString = </span><br><span class="line">  <span class="string">&quot;&#123;\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326&#125;,\&quot;z\&quot;:3,\&quot;m\&quot;:4,\&quot;x\&quot;:1,\&quot;y\&quot;:2&#125;&quot;</span>;</span><br><span class="line">importPoint = GeometryEngine.Instance.ImportFromJson(</span><br><span class="line">  JsonImportFlags.JsonImportDefaults, inputString) <span class="keyword">as</span> MapPoint;</span><br><span class="line"><span class="comment">// importPoint.HasM = true</span></span><br><span class="line"><span class="comment">// importPoint.HasZ = true</span></span><br><span class="line"><span class="comment">// importPoint.X = 1</span></span><br><span class="line"><span class="comment">// importPoint.Y = 2</span></span><br><span class="line"><span class="comment">// importPoint.M = 4</span></span><br><span class="line"><span class="comment">// importPoint.Z = 3</span></span><br><span class="line"></span><br><span class="line">importPoint2 = MapPointBuilderEx.FromJson(inputString);</span><br><span class="line"></span><br><span class="line"><span class="comment">// export to json - skip spatial reference</span></span><br><span class="line">outputString = GeometryEngine.Instance.ExportToJson(</span><br><span class="line">              JsonExportFlags.JsonExportSkipCRS, importPoint);</span><br><span class="line"><span class="comment">// outputString = &quot;&#123;\&quot;x\&quot;:1,\&quot;y\&quot;:2,\&quot;z\&quot;:3,\&quot;m\&quot;:4&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export from mappoint, skipping the sr - same as GeometryEngine.Instance.ExportToJson w JsonExportFlags.JsonExportSkipCRS</span></span><br><span class="line">outputString2 = importPoint.ToJson(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Multipoint</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">100</span>, <span class="number">200</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">201</span>, <span class="number">300</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">301</span>, <span class="number">400</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">401</span>, <span class="number">500</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(</span><br><span class="line">  coords, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line">inputString = </span><br><span class="line">  <span class="string">&quot;&#123;\&quot;points\&quot;:[[100,200],[201,300],[301,400],[401,500]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Multipoint importMultipoint = </span><br><span class="line">  GeometryEngine.Instance.ImportFromJson(</span><br><span class="line">         JsonImportFlags.JsonImportDefaults, inputString) <span class="keyword">as</span> Multipoint;</span><br><span class="line"><span class="comment">// importMultipoint.IsEqual(multipoint) = true</span></span><br><span class="line"></span><br><span class="line">ReadOnlyPointCollection points = importMultipoint.Points;</span><br><span class="line"><span class="comment">// points.Count = 4</span></span><br><span class="line"><span class="comment">// points[0] = 100, 200</span></span><br><span class="line"><span class="comment">// points[1] = 201, 300</span></span><br><span class="line"><span class="comment">// points[2] = 301, 400</span></span><br><span class="line"><span class="comment">// points[3] = 401, 500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the MultipointbuilderEx convenience method</span></span><br><span class="line">Multipoint importMultipoint2 = MultipointBuilderEx.FromJson(inputString);</span><br><span class="line"><span class="comment">// importMultipoint2.IsEqual(multipoint) = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export to json</span></span><br><span class="line">outputString = GeometryEngine.Instance.ExportToJson(</span><br><span class="line">                JsonExportFlags.JsonExportDefaults, multipoint);</span><br><span class="line"><span class="comment">// outputString = inputString</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// or use the multipoint itself</span></span><br><span class="line">outputString2 = multipoint.ToJson();</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Polyline</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(</span><br><span class="line">                         coords, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line"><span class="comment">// export without the spatial reference</span></span><br><span class="line">outputString = GeometryEngine.Instance.ExportToJson(</span><br><span class="line">                        JsonExportFlags.JsonExportSkipCRS, polyline);</span><br><span class="line"><span class="comment">// import</span></span><br><span class="line">geometry = GeometryEngine.Instance.ImportFromJson(</span><br><span class="line">             JsonImportFlags.JsonImportDefaults, outputString);</span><br><span class="line">Polyline importPolyline = geometry <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// importPolyline.SpatialReference = null</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">points = importPolyline.Points;</span><br><span class="line"><span class="comment">// points.Count = 4</span></span><br><span class="line"><span class="comment">// points[0] = 100, 200</span></span><br><span class="line"><span class="comment">// points[1] = 201, 300</span></span><br><span class="line"><span class="comment">// points[2] = 301, 400</span></span><br><span class="line"><span class="comment">// points[3] = 401, 500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the polylineBuilderEx convenience method </span></span><br><span class="line">Polyline importPolyline2 = PolylineBuilderEx.FromJson(outputString);</span><br><span class="line"><span class="comment">// importPolyline2 = importPolyline</span></span><br><span class="line"></span><br><span class="line">outputString2 = importPolyline2.ToJson();</span><br><span class="line"><span class="comment">// outputString2 = outputString</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(</span><br><span class="line">                              coords, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line"><span class="comment">// export without the spatial reference</span></span><br><span class="line">outputString = GeometryEngine.Instance.ExportToJson(</span><br><span class="line">                          JsonExportFlags.JsonExportSkipCRS, polygon);</span><br><span class="line"><span class="comment">// import</span></span><br><span class="line">geometry = GeometryEngine.Instance.ImportFromJson(</span><br><span class="line">                     JsonImportFlags.JsonImportDefaults, outputString);</span><br><span class="line"></span><br><span class="line">Polygon importPolygon = geometry <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// importPolygon.SpatialReference = null</span></span><br><span class="line">points = importPolygon.Points;</span><br><span class="line"><span class="comment">// points.Count = 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polygonBuilderEx convenience method</span></span><br><span class="line">Polygon importPolyon2 = PolygonBuilderEx.FromJson(outputString);</span><br><span class="line"><span class="comment">// importPolygon2 = importPolygon</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// export from the polygon</span></span><br><span class="line">outputString2 = importPolyon2.ToJson(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Empty polygon</span></span><br><span class="line">polygon = PolygonBuilderEx.CreatePolygon(SpatialReferences.WebMercator);</span><br><span class="line">outputString = GeometryEngine.Instance.ExportToJson(</span><br><span class="line">                               JsonExportFlags.JsonExportDefaults, polygon);</span><br><span class="line">importPolygon = GeometryEngine.Instance.ImportFromJson(</span><br><span class="line">                    JsonImportFlags.JsonImportDefaults, outputString) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// importPolygon.IsEmpty = true</span></span><br><span class="line"><span class="comment">// importPolygon.SpatialReference.Wkid = 3857</span></span><br></pre></td></tr></table></figure>

<h3 id="将几何图形导入和导出为-XML"><a href="#将几何图形导入和导出为-XML" class="headerlink" title="将几何图形导入和导出为 XML"></a>将几何图形导入和导出为 XML</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">MapPoint minPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>);</span><br><span class="line">MapPoint maxPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">//  MapPoint</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="built_in">string</span> xml = minPoint.ToXml();</span><br><span class="line">MapPoint minPointImport = MapPointBuilderEx.FromXml(xml);</span><br><span class="line"><span class="comment">// minPointImport = minPoint</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Envelope</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Envelope envelopeWithID = EnvelopeBuilderEx.CreateEnvelope(minPoint, maxPoint);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Envelopes don&#x27;t have IDs</span></span><br><span class="line"><span class="comment">// envelopeWithID.HasID = false</span></span><br><span class="line"><span class="comment">// envelopeWithID.HasM = true</span></span><br><span class="line"><span class="comment">// envelopeWithID.HasZ = true</span></span><br><span class="line"></span><br><span class="line">xml = envelopeWithID.ToXml();</span><br><span class="line">Envelope envelopeImport = EnvelopeBuilderEx.FromXml(xml);</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Multipoint</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(minPoint);</span><br><span class="line">list.Add(maxPoint);</span><br><span class="line"></span><br><span class="line">Multipoint multiPoint = MultipointBuilderEx.CreateMultipoint(list);</span><br><span class="line"></span><br><span class="line">xml = multiPoint.ToXml();</span><br><span class="line">Multipoint multipointImport = MultipointBuilderEx.FromXml(xml);</span><br><span class="line"><span class="comment">// multipointImport.PointCount == 2</span></span><br><span class="line"><span class="comment">// multipointImport.HasID = true</span></span><br><span class="line"><span class="comment">// multipointImport.HasM = true</span></span><br><span class="line"><span class="comment">// multipointImport.HasZ= true</span></span><br></pre></td></tr></table></figure>

<h2 id="转换"><a href="#转换" class="headerlink" title="转换"></a>转换</h2><h3 id="创建地理转换"><a href="#创建地理转换" class="headerlink" title="创建地理转换"></a>创建地理转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create from wkid</span></span><br><span class="line">GeographicTransformation gt1478 = </span><br><span class="line">  ArcGIS.Core.Geometry.GeographicTransformation.Create(<span class="number">1478</span>);</span><br><span class="line"><span class="built_in">string</span> name = gt1478.Name;</span><br><span class="line"><span class="built_in">string</span> wkt = gt1478.Wkt;</span><br><span class="line"><span class="built_in">int</span> wkid = gt1478.Wkid;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create from wkt</span></span><br><span class="line">GeographicTransformation another_gt1478 = </span><br><span class="line">     ArcGIS.Core.Geometry.GeographicTransformation.Create(wkt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// inverse</span></span><br><span class="line">GeographicTransformation inverse_gt148 = </span><br><span class="line">               another_gt1478.GetInverse() <span class="keyword">as</span> GeographicTransformation;</span><br><span class="line"><span class="built_in">bool</span> isForward = inverse_gt148.IsForward;</span><br></pre></td></tr></table></figure>

<h3 id="创建复合地理变换"><a href="#创建复合地理变换" class="headerlink" title="创建复合地理变换"></a>创建复合地理变换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create singleton from wkid</span></span><br><span class="line">CompositeGeographicTransformation cgt = </span><br><span class="line">    ArcGIS.Core.Geometry.CompositeGeographicTransformation.Create(<span class="number">108272</span>);</span><br><span class="line"><span class="built_in">int</span> count = cgt.Count;    <span class="comment">// count = 1</span></span><br><span class="line"></span><br><span class="line">IList&lt;GeographicTransformation&gt; gts = cgt.Transformations </span><br><span class="line">                                <span class="keyword">as</span> IList&lt;GeographicTransformation&gt;;</span><br><span class="line">gts.Add(ArcGIS.Core.Geometry.GeographicTransformation.Create(<span class="number">1437</span>, <span class="literal">false</span>));</span><br><span class="line">count = cgt.Count;        <span class="comment">// count = 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create from an enumeration</span></span><br><span class="line">CompositeGeographicTransformation another_cgt = </span><br><span class="line">              ArcGIS.Core.Geometry.CompositeGeographicTransformation.Create(gts);</span><br><span class="line">GeographicTransformation gt0 = another_cgt[<span class="number">0</span>];</span><br><span class="line">GeographicTransformation gt1 = another_cgt[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the inverse</span></span><br><span class="line">CompositeGeographicTransformation inversed_cgt = another_cgt.GetInverse() <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line"><span class="comment">// inversed_cgt[0] is same as gt1</span></span><br><span class="line"><span class="comment">// inversed_cgt[1] is same as gt0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> wkt = gt0.Wkt;</span><br><span class="line"><span class="comment">// create from string </span></span><br><span class="line">CompositeGeographicTransformation third_cgt = </span><br><span class="line">   ArcGIS.Core.Geometry.CompositeGeographicTransformation.Create(wkt, gt0.IsForward);</span><br><span class="line">count = third_cgt.Count;        <span class="comment">// count = 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// create from josn</span></span><br><span class="line"><span class="built_in">string</span> json = cgt.ToJson();</span><br><span class="line">CompositeGeographicTransformation joson_cgt = </span><br><span class="line">  DatumTransformation.CreateFromJson(json) <span class="keyword">as</span> CompositeGeographicTransformation;</span><br></pre></td></tr></table></figure>

<h3 id="创建投影转换"><a href="#创建投影转换" class="headerlink" title="创建投影转换"></a>创建投影转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// methods need to be on the MCT</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  SpatialReference sr4267 = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4267</span>);</span><br><span class="line">  SpatialReference sr4326 = SpatialReferences.WGS84;</span><br><span class="line">  SpatialReference sr3857 = SpatialReferences.WebMercator;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create transformation from  4267 -&gt; 3857</span></span><br><span class="line">  ProjectionTransformation projTransFromSRs = </span><br><span class="line">       ArcGIS.Core.Geometry.ProjectionTransformation.Create(sr4267, sr3857);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// create an envelope</span></span><br><span class="line">  Envelope env = EnvelopeBuilderEx.CreateEnvelope(</span><br><span class="line">             <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">2</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">3</span>), sr4267);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Project with one geo transform 4267 -&gt; 3857</span></span><br><span class="line">  Envelope projectedEnvEx = GeometryEngine.Instance.ProjectEx(</span><br><span class="line">                                 env, projTransFromSRs) <span class="keyword">as</span> Envelope;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create inverse transformation, 3857 -&gt; 4267</span></span><br><span class="line">  ProjectionTransformation projTransFromSRsInverse = </span><br><span class="line">      ArcGIS.Core.Geometry.ProjectionTransformation.Create(sr3857, sr4267);</span><br><span class="line">  <span class="comment">// Project the projected envelope back using the inverse transformation</span></span><br><span class="line">  Envelope projectedEnvBack = </span><br><span class="line">         GeometryEngine.Instance.ProjectEx(</span><br><span class="line">           projectedEnvEx, projTransFromSRsInverse) <span class="keyword">as</span> Envelope;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> isEqual = env.IsEqual(projectedEnvBack);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建高压基准变换"><a href="#创建高压基准变换" class="headerlink" title="创建高压基准变换"></a>创建高压基准变换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create from wkid</span></span><br><span class="line">HVDatumTransformation hv110018 = HVDatumTransformation.Create(<span class="number">110018</span>);</span><br><span class="line"><span class="built_in">int</span> wkid = hv110018.Wkid;</span><br><span class="line"><span class="built_in">bool</span> isForward = hv110018.IsForward;    <span class="comment">// isForward = true</span></span><br><span class="line"><span class="built_in">string</span> name = hv110018.Name;            <span class="comment">// Name = WGS_1984_To_WGS_1984_EGM2008_1x1_Height</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Create from wkt</span></span><br><span class="line"><span class="built_in">string</span> wkt = hv110018.Wkt;</span><br><span class="line">HVDatumTransformation hv110018FromWkt = HVDatumTransformation.Create(wkt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Get the inverse</span></span><br><span class="line">HVDatumTransformation hv110018Inverse = </span><br><span class="line">   hv110018.GetInverse() <span class="keyword">as</span> HVDatumTransformation;</span><br><span class="line"><span class="comment">// hv110018Inverse.IsForward = false</span></span><br></pre></td></tr></table></figure>

<h3 id="创建复合高压基准变换"><a href="#创建复合高压基准变换" class="headerlink" title="创建复合高压基准变换"></a>创建复合高压基准变换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">HVDatumTransformation hv1 = HVDatumTransformation.Create(<span class="number">108034</span>);</span><br><span class="line">HVDatumTransformation hv2 = HVDatumTransformation.Create(<span class="number">108033</span>, <span class="literal">false</span>);</span><br><span class="line">List&lt;HVDatumTransformation&gt; hvs = <span class="keyword">new</span> List&lt;HVDatumTransformation&gt;() &#123; hv1, hv2 &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create from enumeration</span></span><br><span class="line">CompositeHVDatumTransformation compositehv = </span><br><span class="line">                CompositeHVDatumTransformation.Create(hvs);</span><br><span class="line"><span class="built_in">int</span> count = compositehv.Count;      <span class="comment">// count = 2</span></span><br><span class="line"></span><br><span class="line">List&lt;HVDatumTransformation&gt; transforms = </span><br><span class="line">               compositehv.Transformations <span class="keyword">as</span> List&lt;HVDatumTransformation&gt;;</span><br><span class="line">HVDatumTransformation tranform = transforms[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// transform.Wkid = 108034</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get inverse</span></span><br><span class="line">CompositeHVDatumTransformation inverse_compositehv = </span><br><span class="line">       compositehv.GetInverse() <span class="keyword">as</span> CompositeHVDatumTransformation;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create from xml</span></span><br><span class="line"><span class="built_in">string</span> xml = compositehv.ToXml();</span><br><span class="line"><span class="comment">//At 2.x - CompositeHVDatumTransformation xml_compositehv =</span></span><br><span class="line"><span class="comment">//      CompositeHVDatumTransformation.CreateFromXML(xml);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xml_compositehv = CompositeHVDatumTransformation.CreateFromXml(xml);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create from json</span></span><br><span class="line"><span class="built_in">string</span> json = compositehv.ToJson();</span><br><span class="line">CompositeHVDatumTransformation json_compositehv = </span><br><span class="line">    DatumTransformation.CreateFromJson(json) <span class="keyword">as</span> CompositeHVDatumTransformation;</span><br></pre></td></tr></table></figure>

<h3 id="确定转换"><a href="#确定转换" class="headerlink" title="确定转换"></a>确定转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// methods need to run on the MCT</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// find the first transformation used between spatial references 4267 and 4326</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  SpatialReference sr4267 = </span><br><span class="line">       SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4267</span>);</span><br><span class="line">  SpatialReference sr4326 = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">  List&lt;ProjectionTransformation&gt; transformations = </span><br><span class="line">         ProjectionTransformation.FindTransformations(sr4267, sr4326);</span><br><span class="line">  <span class="comment">// transformations.Count = 1</span></span><br><span class="line">  ProjectionTransformation projTrans = transformations[<span class="number">0</span>];</span><br><span class="line">  CompositeGeographicTransformation compositeGT = </span><br><span class="line">       projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  GeographicTransformation gt = compositeGT[<span class="number">0</span>];</span><br><span class="line">  <span class="comment">// gt.Wkid = 15851</span></span><br><span class="line">  <span class="comment">// gt.Name = &quot;NAD_1927_To_WGS_1984_79_CONUS&quot;</span></span><br><span class="line">  <span class="comment">// gt.IsForward = true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// find the first five transformation used between spatial references 4267 and 4326</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  transformations = ProjectionTransformation.FindTransformations(</span><br><span class="line">                                     sr4267, sr4326, numResults: <span class="number">5</span>);</span><br><span class="line">  <span class="comment">// transformations.Count = 5</span></span><br><span class="line">  projTrans = transformations[<span class="number">0</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 1</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 15851</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;NAD_1927_To_WGS_1984_79_CONUS&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  projTrans = transformations[<span class="number">1</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 1</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 1173</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;NAD_1927_To_WGS_1984_4&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  projTrans = transformations[<span class="number">2</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 1</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 1172</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;NAD_1927_To_WGS_1984_3&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  projTrans = transformations[<span class="number">3</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 2</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 1241</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;NAD_1927_To_NAD_1983_NADCON&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// compositeGT[1].Wkid = 108190</span></span><br><span class="line">  <span class="comment">// compositeGT[1].Name = &quot;WGS_1984_(ITRF00)_To_NAD_1983&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[1].IsForward = false</span></span><br><span class="line"></span><br><span class="line">  projTrans = transformations[<span class="number">4</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 2</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 1241</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;NAD_1927_To_NAD_1983_NADCON&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// compositeGT[1].Wkid = 1515</span></span><br><span class="line">  <span class="comment">// compositeGT[1].Name = &quot;NAD_1983_To_WGS_1984_5&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[1].IsForward = true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// find the first transformation used between spatial</span></span><br><span class="line">  <span class="comment">// references 4267 and 4326 within Alaska</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Alaska</span></span><br><span class="line">  Envelope envelope = EnvelopeBuilderEx.CreateEnvelope(<span class="number">-161</span>, <span class="number">61</span>, <span class="number">-145</span>, <span class="number">69</span>);</span><br><span class="line">  transformations = ProjectionTransformation.FindTransformations(</span><br><span class="line">                                              sr4267, sr4326, envelope);</span><br><span class="line">  <span class="comment">// transformations.Count = 1</span></span><br><span class="line">  projTrans = transformations[<span class="number">0</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 2</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 1243</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;NAD_1927_To_NAD_1983_Alaska&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// compositeGT[1].Wkid = 108190</span></span><br><span class="line">  <span class="comment">// compositeGT[1].Name = &quot;WGS_1984_(ITRF00)_To_NAD_1983&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[1].IsForward = false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// find the first geographic transformation used between two spatial references with VCS  (use vertical = false)</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  SpatialReference inSR = </span><br><span class="line">                  SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4269</span>, <span class="number">115702</span>);</span><br><span class="line">  SpatialReference outSR = </span><br><span class="line">                  SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>, <span class="number">3855</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Even though each spatial reference has a VCS,</span></span><br><span class="line">  <span class="comment">// vertical = false should return geographic transformations.</span></span><br><span class="line">  transformations = ProjectionTransformation.FindTransformations(inSR, outSR);</span><br><span class="line">  <span class="comment">// transformations.Count = 1</span></span><br><span class="line">  projTrans = transformations[<span class="number">0</span>];</span><br><span class="line">  compositeGT = projTrans.Transformation <span class="keyword">as</span> CompositeGeographicTransformation;</span><br><span class="line">  <span class="comment">// compositeGT.Count = 1</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Wkid = 108190</span></span><br><span class="line">  <span class="comment">// compositeGT[0].Name = &quot;&quot;WGS_1984_(ITRF00)_To_NAD_1983&quot;</span></span><br><span class="line">  <span class="comment">// compositeGT[0].IsForward = false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// find the first vertical transformation used between two spatial references with VCS  (use vertical = true)</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">  transformations = </span><br><span class="line">            ProjectionTransformation.FindTransformations(</span><br><span class="line">                                    inSR, outSR, vertical: <span class="literal">true</span>);</span><br><span class="line">  <span class="comment">// transformations.Count = 1</span></span><br><span class="line">  projTrans = transformations[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  CompositeHVDatumTransformation compositeHV = </span><br><span class="line">          projTrans.Transformation <span class="keyword">as</span> CompositeHVDatumTransformation;</span><br><span class="line">  <span class="comment">// compositeHV.Count = 2</span></span><br><span class="line">  <span class="comment">// compositeHV[0].Wkid = 1188</span></span><br><span class="line">  <span class="comment">// compositeHV[0].Name = &quot;NAD_1983_To_WGS_1984_1&quot;</span></span><br><span class="line">  <span class="comment">// compositeHV[0].IsForward = true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// compositeHV[1].Wkid = 110019</span></span><br><span class="line">  <span class="comment">// compositeHV[1].Name = &quot;WGS_1984_To_WGS_1984_EGM2008_2.5x2.5_Height&quot;</span></span><br><span class="line">  <span class="comment">// compositeHV[1].IsForward = true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="地图点地理坐标字符串"><a href="#地图点地理坐标字符串" class="headerlink" title="地图点地理坐标字符串"></a>地图点地理坐标字符串</h2><h3 id="地图点-地理坐标字符串转换"><a href="#地图点-地理坐标字符串转换" class="headerlink" title="地图点 - 地理坐标字符串转换"></a>地图点 - 地理坐标字符串转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line">SpatialReference sr2 = SpatialReferences.WebMercator;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create some points</span></span><br><span class="line">MapPoint point0 = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, sr);</span><br><span class="line">MapPoint point1 = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">20</span>, sr);</span><br><span class="line">MapPoint point2 = GeometryEngine.Instance.Project(point1, sr2) <span class="keyword">as</span> MapPoint;</span><br><span class="line">MapPoint pointEmpty = MapPointBuilderEx.CreateMapPoint(sr);</span><br><span class="line">MapPoint pointwithNoSR = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">MapPoint pointZM = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert to MGRS</span></span><br><span class="line">ToGeoCoordinateParameter mgrsParam = </span><br><span class="line">         <span class="keyword">new</span> ToGeoCoordinateParameter(GeoCoordinateType.MGRS);</span><br><span class="line"><span class="comment">// 31NAA6602100000</span></span><br><span class="line"><span class="built_in">string</span> geoCoordString = point0.ToGeoCoordinateString(mgrsParam);</span><br><span class="line"></span><br><span class="line"><span class="comment">// use the builder to create a new point from the string.</span></span><br><span class="line"><span class="comment">// Coordinates are the same </span></span><br><span class="line"><span class="comment">// outPoint.x = 0; outPoint.Y = 0</span></span><br><span class="line">MapPoint outPoint = </span><br><span class="line">      MapPointBuilderEx.FromGeoCoordinateString(</span><br><span class="line">                geoCoordString, sr, GeoCoordinateType.MGRS);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 32QPH0460911794</span></span><br><span class="line"><span class="comment">// outPoint.X = 10; outPoint.Y = 20</span></span><br><span class="line">geoCoordString = point1.ToGeoCoordinateString(mgrsParam);             </span><br><span class="line">outPoint = MapPointBuilderEx.FromGeoCoordinateString(</span><br><span class="line">           geoCoordString, sr, GeoCoordinateType.MGRS);</span><br><span class="line"></span><br><span class="line"><span class="comment">// z, m are not transformed</span></span><br><span class="line"><span class="comment">// outPoint.X = 1; outPoint.Y = 2; outPoint.Z = Nan; outPoint.M = Nan;</span></span><br><span class="line">geoCoordString = pointZM.ToGeoCoordinateString(mgrsParam);</span><br><span class="line">outPoint = MapPointBuilderEx.FromGeoCoordinateString(</span><br><span class="line">  geoCoordString, sr, GeoCoordinateType.MGRS);</span><br><span class="line"></span><br><span class="line"><span class="comment">// set the number of digits to 2 and convert</span></span><br><span class="line"><span class="comment">// 32QPH0512</span></span><br><span class="line"><span class="comment">// outPoint.X = 10; outPoint.Y = 20</span></span><br><span class="line">mgrsParam.NumDigits = <span class="number">2</span>;</span><br><span class="line">geoCoordString = point1.ToGeoCoordinateString(mgrsParam);             </span><br><span class="line">outPoint = MapPointBuilderEx.FromGeoCoordinateString(</span><br><span class="line">  geoCoordString, sr, GeoCoordinateType.MGRS);     </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// convert to UTM</span></span><br><span class="line">ToGeoCoordinateParameter utmParam = </span><br><span class="line">     <span class="keyword">new</span> ToGeoCoordinateParameter(GeoCoordinateType.UTM);</span><br><span class="line"><span class="comment">// 31N 166021 0000000</span></span><br><span class="line">geoCoordString = point0.ToGeoCoordinateString(utmParam);</span><br><span class="line"><span class="comment">// 32Q 604609 2211793</span></span><br><span class="line">geoCoordString = point1.ToGeoCoordinateString(utmParam);        </span><br><span class="line"></span><br><span class="line"><span class="comment">// convert to DMS</span></span><br><span class="line">ToGeoCoordinateParameter dmsParam = </span><br><span class="line">  <span class="keyword">new</span> ToGeoCoordinateParameter(GeoCoordinateType.DMS);</span><br><span class="line"><span class="comment">// 00 00 00.00N 000 00 00.00E</span></span><br><span class="line">geoCoordString = point0.ToGeoCoordinateString(dmsParam);</span><br><span class="line"><span class="comment">// 20 00 00.00N 010 00 00.00E</span></span><br><span class="line">geoCoordString = point1.ToGeoCoordinateString(dmsParam);        </span><br><span class="line"></span><br><span class="line"><span class="comment">// convert to DDM</span></span><br><span class="line">ToGeoCoordinateParameter ddmParam = </span><br><span class="line">  <span class="keyword">new</span> ToGeoCoordinateParameter(GeoCoordinateType.DDM);</span><br><span class="line"><span class="comment">// 00 00.0000N 000 00.0000E</span></span><br><span class="line">geoCoordString = point0.ToGeoCoordinateString(ddmParam);</span><br><span class="line"><span class="comment">// 20 00.0000N 010 00.0000E</span></span><br><span class="line">geoCoordString = point1.ToGeoCoordinateString(ddmParam);        </span><br><span class="line"></span><br><span class="line"><span class="comment">// convert to DD</span></span><br><span class="line">ToGeoCoordinateParameter ddParam = </span><br><span class="line">  <span class="keyword">new</span> ToGeoCoordinateParameter(GeoCoordinateType.DD);</span><br><span class="line"><span class="comment">// 00.000000N 000.000000E</span></span><br><span class="line">geoCoordString = point0.ToGeoCoordinateString(ddParam);</span><br><span class="line"><span class="comment">// 20.000000N 010.000000E</span></span><br><span class="line">geoCoordString = point1.ToGeoCoordinateString(ddParam);       </span><br></pre></td></tr></table></figure>

<h2 id="角度单元"><a href="#角度单元" class="headerlink" title="角度单元"></a>角度单元</h2><h3 id="角度单位-在度和弧度之间转换"><a href="#角度单位-在度和弧度之间转换" class="headerlink" title="角度单位 - 在度和弧度之间转换"></a>角度单位 - 在度和弧度之间转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert 45 degrees to radians</span></span><br><span class="line"><span class="built_in">double</span> radians = AngularUnit.Degrees.ConvertToRadians(<span class="number">45</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert PI to degrees</span></span><br><span class="line"><span class="built_in">double</span> degrees = AngularUnit.Degrees.ConvertFromRadians(Math.PI);</span><br></pre></td></tr></table></figure>

<h3 id="角度单位-使用工厂代码创建角度单位"><a href="#角度单位-使用工厂代码创建角度单位" class="headerlink" title="角度单位 - 使用工厂代码创建角度单位"></a>角度单位 - 使用工厂代码创建角度单位</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// create a Grad unit</span></span><br><span class="line">  <span class="keyword">var</span> grad = AngularUnit.CreateAngularUnit(<span class="number">9105</span>);</span><br><span class="line">  <span class="built_in">string</span> unitName = grad.Name;                        <span class="comment">// Grad</span></span><br><span class="line">  <span class="built_in">double</span> conversionFactor = grad.ConversionFactor;    <span class="comment">// 0.015708</span></span><br><span class="line">  <span class="built_in">double</span> radiansPerUnit = grad.RadiansPerUnit;</span><br><span class="line">  <span class="built_in">int</span> factoryCode = grad.FactoryCode;                 <span class="comment">// 9105</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// convert 10 grads to degrees</span></span><br><span class="line">  <span class="built_in">double</span> val = grad.ConvertTo(<span class="number">10</span>, AngularUnit.Degrees);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// convert 10 radians to grads</span></span><br><span class="line">  val = grad.ConvertFromRadians(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (ArgumentException)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ArgumentException will be thrown by CreateAngularUnit in</span></span><br><span class="line">  <span class="comment">// the following scenarios:</span></span><br><span class="line">  <span class="comment">// - if the factory code used is a non-angular factory code</span></span><br><span class="line">  <span class="comment">//   (i.e. it corresponds to square meters which is an area unit code)</span></span><br><span class="line">  <span class="comment">// - if the factory code used is invalid</span></span><br><span class="line">  <span class="comment">//   (i.e. it is negative or doesn&#x27;t correspond to any factory code)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="角度单位-创建自定义角度单位"><a href="#角度单位-创建自定义角度单位" class="headerlink" title="角度单位 - 创建自定义角度单位"></a>角度单位 - 创建自定义角度单位</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// custom unit - 3 radians per unit</span></span><br><span class="line"><span class="keyword">var</span> myAngularUnit = AngularUnit.CreateAngularUnit(<span class="string">&quot;myCustomAngularUnit&quot;</span>, <span class="number">3</span>);</span><br><span class="line"><span class="built_in">string</span> Name = myAngularUnit.Name;                   <span class="comment">// myCustomAngularUnit</span></span><br><span class="line"><span class="built_in">double</span> Factor = myAngularUnit.ConversionFactor;     <span class="comment">// 3</span></span><br><span class="line"><span class="built_in">int</span> Code = myAngularUnit.FactoryCode;               <span class="comment">// 0 because it is a custom angular unit</span></span><br><span class="line"><span class="built_in">double</span> radiansUnit = myAngularUnit.RadiansPerUnit;  <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// convert 10 degrees to my unit</span></span><br><span class="line"><span class="built_in">double</span> converted = AngularUnit.Degrees.ConvertTo(<span class="number">10</span>, myAngularUnit);</span><br><span class="line"><span class="comment">// convert it back to degrees</span></span><br><span class="line">converted = myAngularUnit.ConvertTo(converted, AngularUnit.Degrees);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert 1 radian into my angular units</span></span><br><span class="line">converted = myAngularUnit.ConvertFromRadians(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the wkt</span></span><br><span class="line"><span class="built_in">string</span> wkt = myAngularUnit.Wkt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an angular unit from this wkt</span></span><br><span class="line"><span class="keyword">var</span> anotherAngularUnit = AngularUnit.CreateAngularUnit(wkt);</span><br><span class="line"><span class="comment">// anotherAngularUnit.ConversionFactor = 3</span></span><br><span class="line"><span class="comment">// anotherAngularUnit.FactoryCode = 0    </span></span><br><span class="line"><span class="comment">// anotherAngularUnit.RadiansPerUnit = 3</span></span><br></pre></td></tr></table></figure>

<h2 id="线性单位"><a href="#线性单位" class="headerlink" title="线性单位"></a>线性单位</h2><h3 id="线性单位-在英尺和米之间转换"><a href="#线性单位-在英尺和米之间转换" class="headerlink" title="线性单位 - 在英尺和米之间转换"></a>线性单位 - 在英尺和米之间转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert 10 feet to meters</span></span><br><span class="line"><span class="built_in">double</span> metres = LinearUnit.Feet.ConvertToMeters(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert 20 meters to feet</span></span><br><span class="line"><span class="built_in">double</span> feet = LinearUnit.Feet.ConvertFromMeters(<span class="number">20.0</span>);</span><br></pre></td></tr></table></figure>

<h3 id="线性单位-在厘米和毫米之间转换"><a href="#线性单位-在厘米和毫米之间转换" class="headerlink" title="线性单位 - 在厘米和毫米之间转换"></a>线性单位 - 在厘米和毫米之间转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert 11 centimeters to millimeters</span></span><br><span class="line"><span class="built_in">double</span> mm = LinearUnit.Centimeters.ConvertTo(<span class="number">11</span>, LinearUnit.Millimeters);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert the result back to centimeters</span></span><br><span class="line"><span class="built_in">double</span> cm = LinearUnit.Millimeters.ConvertTo(mm, LinearUnit.Centimeters);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert the millimeter result back to meters</span></span><br><span class="line"><span class="built_in">double</span> meters = LinearUnit.Millimeters.ConvertToMeters(mm);</span><br></pre></td></tr></table></figure>

<h3 id="线性单位-使用工厂代码创建线性单位"><a href="#线性单位-使用工厂代码创建线性单位" class="headerlink" title="线性单位 - 使用工厂代码创建线性单位"></a>线性单位 - 使用工厂代码创建线性单位</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// create a british 1936 foot</span></span><br><span class="line">  <span class="keyword">var</span> britFoot = LinearUnit.CreateLinearUnit(<span class="number">9095</span>);</span><br><span class="line">  <span class="built_in">string</span> unitName = britFoot.Name;                        <span class="comment">//  &quot;Foot_British_1936&quot;</span></span><br><span class="line">  <span class="built_in">double</span> conversionFactor = britFoot.ConversionFactor;    <span class="comment">// 0.3048007491</span></span><br><span class="line">  <span class="built_in">double</span> metersPerUnit = britFoot.MetersPerUnit;</span><br><span class="line">  <span class="built_in">int</span> factoryCode = britFoot.FactoryCode;                 <span class="comment">// 9095</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// convert 10 british 1936 feet to centimeters</span></span><br><span class="line">  <span class="built_in">double</span> val = britFoot.ConvertTo(<span class="number">10</span>, LinearUnit.Centimeters);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// convert 10 m to british 1936 feet</span></span><br><span class="line">  val = britFoot.ConvertFromMeters(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (ArgumentException)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ArgumentException will be thrown by CreateLinearUnit</span></span><br><span class="line">  <span class="comment">// in the following scenarios:</span></span><br><span class="line">  <span class="comment">// - if the factory code used is a non-linear factory code</span></span><br><span class="line">  <span class="comment">//   (i.e. it corresponds to square meters which is an area unit code)</span></span><br><span class="line">  <span class="comment">// - if the factory code used is invalid</span></span><br><span class="line">  <span class="comment">//   (i.e. it is negative or doesn&#x27;t correspond to any factory code)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="线性单位-创建自定义线性单位"><a href="#线性单位-创建自定义线性单位" class="headerlink" title="线性单位 - 创建自定义线性单位"></a>线性单位 - 创建自定义线性单位</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a custom linear unit - there are 0.33 meters per myLinearUnit</span></span><br><span class="line"><span class="keyword">var</span> myLinearUnit = LinearUnit.CreateLinearUnit(<span class="string">&quot;myCustomLinearUnit&quot;</span>, <span class="number">0.33</span>);</span><br><span class="line"><span class="built_in">string</span> name = myLinearUnit.Name;                          <span class="comment">// myCustomLinearUnit</span></span><br><span class="line"><span class="built_in">double</span> convFactor = myLinearUnit.ConversionFactor;        <span class="comment">// 0.33</span></span><br><span class="line"><span class="built_in">int</span> code = myLinearUnit.FactoryCode;                      <span class="comment">// 0 for custom units</span></span><br><span class="line"><span class="built_in">double</span> metersUnit = myLinearUnit.MetersPerUnit;           <span class="comment">// 0.33</span></span><br><span class="line"><span class="built_in">string</span> toString = myLinearUnit.ToString();                <span class="comment">// same as Name - myCustomLinearUnit</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// convert 10 centimeters to myLinearUnit </span></span><br><span class="line"><span class="built_in">double</span> convertedVal = LinearUnit.Centimeters.ConvertTo(<span class="number">10</span>, myLinearUnit);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// get the wkt</span></span><br><span class="line"><span class="built_in">string</span> lu_wkt = myLinearUnit.Wkt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an angular unit from this wkt</span></span><br><span class="line"><span class="keyword">var</span> anotherLinearUnit = LinearUnit.CreateLinearUnit(lu_wkt);</span><br><span class="line"><span class="comment">// anotherLinearUnit.ConversionFactor = 0.33</span></span><br><span class="line"><span class="comment">// anotherLinearUnit.FactoryCode = 0    </span></span><br><span class="line"><span class="comment">// anotherLinearUnit.MetersPerUnit = 0.33</span></span><br></pre></td></tr></table></figure>

<h2 id="面积单位"><a href="#面积单位" class="headerlink" title="面积单位"></a>面积单位</h2><h3 id="面积单位-在平方英尺和平方米之间转换"><a href="#面积单位-在平方英尺和平方米之间转换" class="headerlink" title="面积单位 - 在平方英尺和平方米之间转换"></a>面积单位 - 在平方英尺和平方米之间转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert 700 square meters to square feet</span></span><br><span class="line"><span class="built_in">double</span> sqFeet = AreaUnit.SquareFeet.ConvertFromSquareMeters(<span class="number">700</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// convert 1100 square feet to square meters</span></span><br><span class="line"><span class="built_in">double</span> sqMeters = AreaUnit.SquareFeet.ConvertToSquareMeters(<span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="面积单位-在公顷和英亩之间转换"><a href="#面积单位-在公顷和英亩之间转换" class="headerlink" title="面积单位 - 在公顷和英亩之间转换"></a>面积单位 - 在公顷和英亩之间转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert 2 hectares to acres</span></span><br><span class="line"><span class="built_in">double</span> acres = AreaUnit.Hectares.ConvertTo(<span class="number">2</span>, AreaUnit.Acres);</span><br></pre></td></tr></table></figure>

<h3 id="面积单位-在公顷和平方英里之间转换"><a href="#面积单位-在公顷和平方英里之间转换" class="headerlink" title="面积单位 - 在公顷和平方英里之间转换"></a>面积单位 - 在公顷和平方英里之间转换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// convert 300 hectares to square miles</span></span><br><span class="line"><span class="built_in">double</span> sqMiles = AreaUnit.Hectares.ConvertTo(<span class="number">300</span>, AreaUnit.SquareMiles);</span><br></pre></td></tr></table></figure>

<h3 id="面积单位-各种单位的平方米数"><a href="#面积单位-各种单位的平方米数" class="headerlink" title="面积单位 - 各种单位的平方米数"></a>面积单位 - 各种单位的平方米数</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">double</span> sqMetersPerUnit = AreaUnit.Acres.SquareMetersPerUnit;</span><br><span class="line">sqMetersPerUnit = AreaUnit.Ares.SquareMetersPerUnit;</span><br><span class="line">sqMetersPerUnit = AreaUnit.Hectares.SquareMetersPerUnit;</span><br><span class="line">sqMetersPerUnit = AreaUnit.SquareKilometers.SquareMetersPerUnit;</span><br><span class="line">sqMetersPerUnit = AreaUnit.SquareMiles.SquareMetersPerUnit;</span><br><span class="line">sqMetersPerUnit = AreaUnit.SquareYards.SquareMetersPerUnit;</span><br></pre></td></tr></table></figure>

<h3 id="面积单位-创建面积单位"><a href="#面积单位-创建面积单位" class="headerlink" title="面积单位 - 创建面积单位"></a>面积单位 - 创建面积单位</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> myFactoryCodeInit = AreaUnit.CreateAreaUnit(<span class="number">109439</span>);     <span class="comment">// 109439 is the factory code for square miles</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> myWktUnit = AreaUnit.CreateAreaUnit(<span class="string">&quot;HECTARE_AREAUNIT[\&quot;H\&quot;,10000.0]&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> myCustomUnit = AreaUnit.CreateAreaUnit(<span class="string">&quot;myAreaUnit&quot;</span>, <span class="number">12</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (ArgumentException)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ArgumentException will be thrown by CreateAreaUnit in the following scenarios</span></span><br><span class="line">  <span class="comment">// - if the factory code used is a non-areal factory code  (i.e. it corresponds to degrees which is an angular unit code)</span></span><br><span class="line">  <span class="comment">// - if the factory code used is invalid (i.e. it is negative or doesn&#x27;t correspond to any factory code)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="几何引擎函数"><a href="#几何引擎函数" class="headerlink" title="几何引擎函数"></a>几何引擎函数</h2><h3 id="加速几何图形"><a href="#加速几何图形" class="headerlink" title="加速几何图形"></a>加速几何图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use acceleration to speed up relational operations.  Accelerate your source geometry only if you are going to test many other geometries against it. </span></span><br><span class="line"><span class="comment">// Acceleration is applicable for polylines and polygons only. Note that accelerated geometries take more memory so if you aren&#x27;t going to get any</span></span><br><span class="line"><span class="comment">// benefit from accelerating it, don&#x27;t do it. </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The performance of the following GeometryEngine functions are the only ones which can be improved with an accelerated geometry.</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Contains</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Crosses</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Disjoint</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Disjoint3D</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Equals</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Intersects</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Relate</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Touches</span></span><br><span class="line"><span class="comment">//    GeometryEngine.Instance.Within</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// methods need to run on the MCT</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// accelerate the geometry to test</span></span><br><span class="line">  <span class="keyword">var</span> acceleratedPoly = GeometryEngine.Instance.AccelerateForRelationalOperations(polygon);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// loop through all the geometries to test against</span></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> testPolygon <span class="keyword">in</span> testPolygons)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">bool</span> contains = GeometryEngine.Instance.Contains(acceleratedPoly, testPolygon);</span><br><span class="line">    <span class="built_in">bool</span> within = GeometryEngine.Instance.Within(acceleratedPoly, testPolygon);</span><br><span class="line">    <span class="built_in">bool</span> crosses = GeometryEngine.Instance.Crosses(acceleratedPoly, testPolygon);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="确定面的面积"><a href="#确定面的面积" class="headerlink" title="确定面的面积"></a>确定面的面积</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g1 = PolygonBuilderEx.FromJson(<span class="string">&quot;&#123;\&quot;rings\&quot;: [ [ [0, 0], [10, 0], [10, 10], [0, 10] ] ] &#125;&quot;</span>);</span><br><span class="line"><span class="built_in">double</span> d = GeometryEngine.Instance.Area(g1);</span><br><span class="line"><span class="comment">// d = -100.0         //negative due to wrong ring orientation</span></span><br><span class="line">d = GeometryEngine.Instance.Area(GeometryEngine.Instance.SimplifyAsFeature(g1));</span><br><span class="line"><span class="comment">// d = 100.0        // feature has been simplifed; ring orientation is correct</span></span><br></pre></td></tr></table></figure>

<h3 id="确定多部分多边形的边界"><a href="#确定多部分多边形的边界" class="headerlink" title="确定多部分多边形的边界"></a>确定多部分多边形的边界</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a donut polygon.  Must use the PolygonBuilderEx object</span></span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; outerPts = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">outerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">10.0</span>, <span class="number">10.0</span>));</span><br><span class="line">outerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">10.0</span>, <span class="number">20.0</span>));</span><br><span class="line">outerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">20.0</span>, <span class="number">20.0</span>));</span><br><span class="line">outerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">20.0</span>, <span class="number">10.0</span>));</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; innerPts = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">innerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">13.0</span>, <span class="number">13.0</span>));</span><br><span class="line">innerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">17.0</span>, <span class="number">13.0</span>));</span><br><span class="line">innerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">17.0</span>, <span class="number">17.0</span>));</span><br><span class="line">innerPts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">13.0</span>, <span class="number">17.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon donut = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// add the outer points</span></span><br><span class="line">PolygonBuilderEx pb = <span class="keyword">new</span> PolygonBuilderEx(outerPts);</span><br><span class="line"><span class="comment">// add the inner points (note they are defined anticlockwise)</span></span><br><span class="line">pb.AddPart(innerPts);</span><br><span class="line"><span class="comment">// get the polygon</span></span><br><span class="line">donut = pb.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the boundary </span></span><br><span class="line">Geometry g = GeometryEngine.Instance.Boundary(donut);</span><br><span class="line">Polyline boundary = g <span class="keyword">as</span> Polyline;</span><br></pre></td></tr></table></figure>

<h3 id="缓冲地图点"><a href="#缓冲地图点" class="headerlink" title="缓冲地图点"></a>缓冲地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// buffer a point</span></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84);</span><br><span class="line">Geometry ptBuffer = GeometryEngine.Instance.Buffer(pt, <span class="number">5.0</span>);</span><br><span class="line">Polygon buffer = ptBuffer <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="缓冲圆弧"><a href="#缓冲圆弧" class="headerlink" title="缓冲圆弧"></a>缓冲圆弧</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create the circular arc</span></span><br><span class="line">MapPoint fromPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">MapPoint toPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">Coordinate2D interiorPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>, <span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(fromPt, toPt, interiorPt);</span><br><span class="line"></span><br><span class="line"><span class="comment">// buffer the arc</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(circularArc);</span><br><span class="line">Geometry lineBuffer = GeometryEngine.Instance.Buffer(polyline, <span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<h3 id="缓冲多个地图点"><a href="#缓冲多个地图点" class="headerlink" title="缓冲多个地图点"></a>缓冲多个地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// creates a buffer around each MapPoint</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Geometry ptsBuffer = GeometryEngine.Instance.Buffer(pts, <span class="number">0.25</span>);</span><br><span class="line">Polygon bufferResult = ptsBuffer <span class="keyword">as</span> Polygon;      <span class="comment">// bufferResult will have 4 parts</span></span><br></pre></td></tr></table></figure>

<h3 id="缓冲多种不同的几何类型"><a href="#缓冲多种不同的几何类型" class="headerlink" title="缓冲多种不同的几何类型"></a>缓冲多种不同的几何类型</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">4</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">4</span>, <span class="number">2</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">6</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">7</span>, <span class="number">8</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">9</span>, <span class="number">10</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">11</span>, <span class="number">12</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">12</span>, <span class="number">8</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">8</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">12</span>, <span class="number">12</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">14</span>, <span class="number">10</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List&lt;Geometry&gt; manyGeometries = <span class="keyword">new</span> List&lt;Geometry&gt;</span><br><span class="line">&#123;</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint(coords[<span class="number">9</span>]),</span><br><span class="line">    PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">0</span>], coords[<span class="number">1</span>], coords[<span class="number">2</span>]&#125;, SpatialReferences.WGS84),</span><br><span class="line">    PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">3</span>], coords[<span class="number">4</span>], coords[<span class="number">5</span>]&#125;),</span><br><span class="line">    PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">6</span>], coords[<span class="number">7</span>], coords[<span class="number">8</span>]&#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Geometry manyGeomBuffer = GeometryEngine.Instance.Buffer(manyGeometries, <span class="number">0.25</span>);</span><br></pre></td></tr></table></figure>

<h3 id="在折线上插值-Z-值"><a href="#在折线上插值-Z-值" class="headerlink" title="在折线上插值 Z 值"></a>在折线上插值 Z 值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate3D&gt; coords2 = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">1000</span>, <span class="built_in">double</span>.NaN),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1000</span>, <span class="number">1000</span>, <span class="number">50</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1000</span>, <span class="number">1000</span>, <span class="number">76</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">1000</span>, <span class="built_in">double</span>.NaN),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WebMercator;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords2, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline.HasZ = true</span></span><br><span class="line"><span class="comment">// polyline.Points[1].HasZ = true</span></span><br><span class="line"><span class="comment">// polyline.Points[1].Z  = NaN   </span></span><br><span class="line"><span class="comment">// polyline.Points[4].HasZ = true</span></span><br><span class="line"><span class="comment">// polyline.Points[4].Z  = NaN   </span></span><br><span class="line"></span><br><span class="line">Polyline polylineNoNaNZs = GeometryEngine.Instance.CalculateNonSimpleZs(polyline, <span class="number">0</span>) <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"><span class="comment">// polylineNoNaNZs.Points[1].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineNoNaNZs.Points[1].Z = 25  (halfway between 0 and 50)</span></span><br><span class="line"><span class="comment">// polylineNoNaNZs.Points[4].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineNoNaNZs.Points[4].Z = 38  (halfway between 76 and 0)</span></span><br></pre></td></tr></table></figure>

<h3 id="在多边形上插值-M-值"><a href="#在多边形上插值-M-值" class="headerlink" title="在多边形上插值 M 值"></a>在多边形上插值 M 值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MapPoint&gt; coords = <span class="keyword">new</span> List&lt;MapPoint&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">1000</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1000</span>, <span class="number">1000</span>, <span class="number">10</span>, <span class="number">50</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WebMercator;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coords, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon.HasM = true</span></span><br><span class="line"><span class="comment">// polygon.Points[1].HasM = true</span></span><br><span class="line"><span class="comment">// polygon.Points[1].M = NaN</span></span><br><span class="line"></span><br><span class="line">Polygon polygonNoNaNMs = GeometryEngine.Instance.CalculateNonSimpleMs(polygon, <span class="number">0</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// polygonNoNaNMs.Points[1].HasM = true</span></span><br><span class="line"><span class="comment">// polygonNoNaNMs.Points[1].M = 25  (halfway between 0 and 50)</span></span><br></pre></td></tr></table></figure>

<h3 id="将封套在-X，Y-周围居中"><a href="#将封套在-X，Y-周围居中" class="headerlink" title="将封套在 X，Y 周围居中"></a>将封套在 X，Y 周围居中</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">5.0</span>, <span class="number">5.0</span>);</span><br><span class="line">Envelope centered = GeometryEngine.Instance.CenterAt(env, <span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// centered.Center.X = 2.0</span></span><br><span class="line"><span class="comment">// centered.Center.Y = 2.0</span></span><br><span class="line"><span class="comment">// centered.XMin = 0</span></span><br><span class="line"><span class="comment">// centered.YMin = 0</span></span><br><span class="line"><span class="comment">// centered.XMax = 4</span></span><br><span class="line"><span class="comment">// centered.YMax = 4</span></span><br><span class="line"></span><br><span class="line">centered = env.CenterAt(<span class="number">4.0</span>, <span class="number">3.0</span>);</span><br><span class="line"><span class="comment">// centered.Center.X == 4.0</span></span><br><span class="line"><span class="comment">// centered.Center.Y == 3.0</span></span><br><span class="line"><span class="comment">// centered.XMin == 2.0</span></span><br><span class="line"><span class="comment">// centered.YMin == 1.0</span></span><br><span class="line"><span class="comment">// centered.XMax == 6.0</span></span><br><span class="line"><span class="comment">// centered.YMax == 5.0</span></span><br></pre></td></tr></table></figure>

<h3 id="查找几何体的质心"><a href="#查找几何体的质心" class="headerlink" title="查找几何体的质心"></a>查找几何体的质心</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// simple polygon</span></span><br><span class="line">List&lt;Coordinate2D&gt; list2D = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">2</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">2</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list2D, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// verify it is simple</span></span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polygon);</span><br><span class="line"><span class="comment">// find the centroid</span></span><br><span class="line">MapPoint centroid = GeometryEngine.Instance.Centroid(polygon);</span><br><span class="line"><span class="comment">// centroid.X = 1</span></span><br><span class="line"><span class="comment">// centroid.Y = 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// map Point</span></span><br><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">2</span>, <span class="built_in">double</span>.NaN, <span class="number">7</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// pt1.HasZ = true</span></span><br><span class="line"><span class="comment">// pt1.HasM = true</span></span><br><span class="line">centroid = GeometryEngine.Instance.Centroid(pt1);</span><br><span class="line"><span class="comment">// centroid.HasZ = true</span></span><br><span class="line"><span class="comment">// centroid.HasM = true</span></span><br><span class="line"><span class="comment">// pt1.IsEqual(centroid) = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// multipoint</span></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; pt1, pt2 &#125;;</span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(list);</span><br><span class="line"><span class="comment">// multipoint.HasZ = true</span></span><br><span class="line"><span class="comment">// multipoint.HasM = true</span></span><br><span class="line"></span><br><span class="line">centroid = GeometryEngine.Instance.Centroid(multipoint);</span><br><span class="line"><span class="comment">// centroid.X = 3</span></span><br><span class="line"><span class="comment">// centroid.Y = 2</span></span><br><span class="line"><span class="comment">// centroid.HasZ = false</span></span><br><span class="line"><span class="comment">// centroid.HasM = false</span></span><br></pre></td></tr></table></figure>

<h3 id="剪裁折线"><a href="#剪裁折线" class="headerlink" title="剪裁折线"></a>剪裁折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clip a polyline by an envelope</span></span><br><span class="line"></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(<span class="number">2.0</span>, <span class="number">2.0</span>, <span class="number">4.0</span>, <span class="number">4.0</span>);</span><br><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">3</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(line);</span><br><span class="line"></span><br><span class="line">Geometry clipGeom = GeometryEngine.Instance.Clip(polyline, env);</span><br></pre></td></tr></table></figure>

<h3 id="按多边形裁剪折线"><a href="#按多边形裁剪折线" class="headerlink" title="按多边形裁剪折线"></a>按多边形裁剪折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clip a polyline by a polygon</span></span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; list = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">list.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">4.0</span>));</span><br><span class="line">list.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">4.0</span>));</span><br><span class="line">list.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">LineSegment crossingLine = LineBuilderEx.CreateLineSegment(MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">3</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line">Polyline p = PolylineBuilderEx.CreatePolyline(crossingLine);</span><br><span class="line">Geometry geometry = GeometryEngine.Instance.Clip(p, polygon.Extent);</span><br></pre></td></tr></table></figure>

<h3 id="构建具有指定距离和方位角的大地测量线"><a href="#构建具有指定距离和方位角的大地测量线" class="headerlink" title="构建具有指定距离和方位角的大地测量线"></a>构建具有指定距离和方位角的大地测量线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sr = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>);</span><br><span class="line"><span class="keyword">var</span> mapPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">15</span>, <span class="number">60</span>, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// calculate</span></span><br><span class="line"><span class="keyword">var</span> polylineGeodetic = GeometryEngine.Instance.ConstructGeodeticLineFromDistance(GeodeticCurveType.Loxodrome, mapPoint, <span class="number">5000000</span>, <span class="number">45</span>, <span class="literal">null</span>, CurveDensifyMethod.ByLength, <span class="number">300000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="构建连接点的大地测量线"><a href="#构建连接点的大地测量线" class="headerlink" title="构建连接点的大地测量线"></a>构建连接点的大地测量线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sr = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">4326</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">60</span>, <span class="number">180</span>, sr);</span><br><span class="line"><span class="keyword">var</span> pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">60</span>, <span class="number">0</span>, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// densify by length</span></span><br><span class="line"><span class="keyword">var</span> gl = GeometryEngine.Instance.ConstructGeodeticLineFromPoints(GeodeticCurveType.Geodesic, pt1, pt2, <span class="literal">null</span>, CurveDensifyMethod.ByLength, <span class="number">-3.356</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// densify by deviation</span></span><br><span class="line">gl = GeometryEngine.Instance.ConstructGeodeticLineFromPoints(GeodeticCurveType.Geodesic, pt1, pt2, <span class="literal">null</span>, CurveDensifyMethod.ByDeviation, <span class="number">-0.0026</span>);</span><br></pre></td></tr></table></figure>

<h3 id="在距现有点一定距离和一定角度处构造点"><a href="#在距现有点一定距离和一定角度处构造点" class="headerlink" title="在距现有点一定距离和一定角度处构造点"></a>在距现有点一定距离和一定角度处构造点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">MapPoint inPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line"><span class="built_in">double</span> angle = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">double</span> distance = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">MapPoint outPoint = GeometryEngine.Instance.ConstructPointFromAngleDistance(inPoint, angle, distance);</span><br><span class="line"><span class="comment">// outPoint.X = 13</span></span><br><span class="line"><span class="comment">// outPoint.Y = 4</span></span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line">inPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, sr);</span><br><span class="line">angle = Math.PI;</span><br><span class="line">distance = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">outPoint = GeometryEngine.Instance.ConstructPointFromAngleDistance(inPoint, angle, distance, sr);</span><br><span class="line"><span class="comment">// outPoint.X = -1</span></span><br><span class="line"><span class="comment">// outPoint.Y = 0</span></span><br></pre></td></tr></table></figure>

<h3 id="从一组折线构造多边形"><a href="#从一组折线构造多边形" class="headerlink" title="从一组折线构造多边形"></a>从一组折线构造多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; firstLinePts = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">firstLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">firstLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">4.0</span>));</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; secondLinePts = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">secondLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">4.0</span>));</span><br><span class="line">secondLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; thirdLinePts = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">thirdLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0.0</span>, <span class="number">2.0</span>));</span><br><span class="line">thirdLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">5.0</span>, <span class="number">2.0</span>));</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; fourthLinePts = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">fourthLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0.0</span>, <span class="number">3.0</span>));</span><br><span class="line">fourthLinePts.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// build the polylines</span></span><br><span class="line">List&lt;Polyline&gt; polylines = <span class="keyword">new</span> List&lt;Polyline&gt;();</span><br><span class="line">polylines.Add(PolylineBuilderEx.CreatePolyline(firstLinePts));</span><br><span class="line">polylines.Add(PolylineBuilderEx.CreatePolyline(secondLinePts));</span><br><span class="line">polylines.Add(PolylineBuilderEx.CreatePolyline(thirdLinePts));</span><br><span class="line">polylines.Add(PolylineBuilderEx.CreatePolyline(fourthLinePts));</span><br><span class="line"></span><br><span class="line"><span class="comment">// construct polygons from the polylines</span></span><br><span class="line"><span class="keyword">var</span> polygons = GeometryEngine.Instance.ConstructPolygonsFromPolylines(polylines);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polygons.Count = 1</span></span><br><span class="line"><span class="comment">// polygon coordinates are (1.0, 2.0), (1.0, 3.0), (4.0, 3.0), (4.0, 2.0)</span></span><br></pre></td></tr></table></figure>

<h3 id="多边形包含地图点、折线、多边形"><a href="#多边形包含地图点、折线、多边形" class="headerlink" title="多边形包含地图点、折线、多边形"></a>多边形包含地图点、折线、多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// build a polygon      </span></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(pts);</span><br><span class="line"></span><br><span class="line"><span class="comment">// test if an inner point is contained</span></span><br><span class="line">MapPoint innerPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>);</span><br><span class="line"><span class="built_in">bool</span> contains = GeometryEngine.Instance.Contains(poly, innerPt);   <span class="comment">// contains = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// test a point on a boundary</span></span><br><span class="line">contains = GeometryEngine.Instance.Contains(poly, poly.Points[<span class="number">0</span>]);     <span class="comment">// contains = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// test an interior line</span></span><br><span class="line">MapPoint innerPt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.25</span>, <span class="number">1.75</span>);</span><br><span class="line">List&lt;MapPoint&gt; innerLinePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">innerLinePts.Add(innerPt);</span><br><span class="line">innerLinePts.Add(innerPt2);</span><br><span class="line"></span><br><span class="line"><span class="comment">// test an inner polyline</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(innerLinePts);</span><br><span class="line">contains = GeometryEngine.Instance.Contains(poly, polyline);   <span class="comment">// contains = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// test a line that crosses the boundary</span></span><br><span class="line">MapPoint outerPt = MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">1.5</span>);</span><br><span class="line">List&lt;MapPoint&gt; crossingLinePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">crossingLinePts.Add(innerPt);</span><br><span class="line">crossingLinePts.Add(outerPt);</span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(crossingLinePts);</span><br><span class="line">contains = GeometryEngine.Instance.Contains(poly, polyline);     <span class="comment">// contains = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// test a polygon in polygon</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(innerPt, innerPt2);</span><br><span class="line">contains = GeometryEngine.Instance.Contains(poly, env);      <span class="comment">// contains = true</span></span><br></pre></td></tr></table></figure>

<h3 id="确定凸包"><a href="#确定凸包" class="headerlink" title="确定凸包"></a>确定凸包</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// convex hull around a point - returns a point</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line">Geometry hull = GeometryEngine.Instance.ConvexHull(pt);</span><br><span class="line">MapPoint hullPt = hull <span class="keyword">as</span> MapPoint;</span><br><span class="line"><span class="comment">// nullPt.X = 2</span></span><br><span class="line"><span class="comment">// hullPt.Y = 2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// convex hull around a multipoint - returns a polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// build a multiPoint</span></span><br><span class="line">Multipoint multiPoint = MultipointBuilderEx.CreateMultipoint(list);</span><br><span class="line"></span><br><span class="line">hull = GeometryEngine.Instance.ConvexHull(multiPoint);</span><br><span class="line">Polygon hullPoly = hull <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// hullPoly.Area = 1</span></span><br><span class="line"><span class="comment">// hullPoly.PointCount = 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// convex hull around a line - returns a polyline or polygon</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; polylineList = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polylineList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">polylineList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 point straight line</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(polylineList);</span><br><span class="line">hull = GeometryEngine.Instance.ConvexHull(polyline);</span><br><span class="line">Polyline hullPolyline = hull <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// hullPolyline.Length = Math.Sqrt(2)</span></span><br><span class="line"><span class="comment">// hullPolyline.PointCount = 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 point angular line</span></span><br><span class="line">polylineList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(polylineList);</span><br><span class="line">hull = GeometryEngine.Instance.ConvexHull(polyline);</span><br><span class="line">hullPoly = hull <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// hullPoly.Length = 2 + Math.Sqrt(2)</span></span><br><span class="line"><span class="comment">// hullPoly.Area = 0.5</span></span><br><span class="line"><span class="comment">// hullPoly.PointCount = 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// convex hull around a polygon - returns a polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// simple polygon</span></span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(list);</span><br><span class="line">hull = GeometryEngine.Instance.ConvexHull(poly);</span><br><span class="line">hullPoly = hull <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// hullPoly.Length = 4.0</span></span><br><span class="line"><span class="comment">// hullPoly.Area = 1.0</span></span><br><span class="line"><span class="comment">// hullPoly.PointCount = 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon with concave angles</span></span><br><span class="line">List&lt;MapPoint&gt; funkyList = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>));</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>));</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line">funkyList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon funkyPoly = PolygonBuilderEx.CreatePolygon(funkyList);</span><br><span class="line">hull = GeometryEngine.Instance.ConvexHull(funkyPoly);</span><br><span class="line">hullPoly = hull <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// hullPoly.Length = 4.0</span></span><br><span class="line"><span class="comment">// hullPoly.Area = 1.0</span></span><br><span class="line"><span class="comment">// hullPoly.PointCount = 5</span></span><br><span class="line"><span class="comment">// hullPoly.Points[0] = 1.0, 1.0</span></span><br><span class="line"><span class="comment">// hullPoly.Points[1] = 1.0, 2.0</span></span><br><span class="line"><span class="comment">// hullPoly.Points[2] = 2.0, 2.0</span></span><br><span class="line"><span class="comment">// hullPoly.Points[3] = 2.0, 1.0</span></span><br><span class="line"><span class="comment">// hullPoly.Points[4] = 1.0, 1.0</span></span><br></pre></td></tr></table></figure>

<h3 id="确定两个几何图形是否相交"><a href="#确定两个几何图形是否相交" class="headerlink" title="确定两个几何图形是否相交"></a>确定两个几何图形是否相交</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt on pt</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> crosses = GeometryEngine.Instance.Crosses(pt, pt2);         <span class="comment">// crosses = false</span></span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(pt, pt);               <span class="comment">// crosses = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// pt and line</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line1 = PolylineBuilderEx.CreatePolyline(list);</span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(line1, pt2);           <span class="comment">// crosses = false</span></span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(pt2, line1);           <span class="comment">// crosses = false</span></span><br><span class="line">                                                                 <span class="comment">// end pt of line</span></span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(line1, pt);            <span class="comment">// crosses = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; polyPts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">2.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">2.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon poly1 = PolygonBuilderEx.CreatePolygon(polyPts);</span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(poly1, pt);              <span class="comment">// crosses = false</span></span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(pt, poly1);              <span class="comment">// crosses = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// line and line</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; list2 = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line2 = PolylineBuilderEx.CreatePolyline(list2);</span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(line1, line2);           <span class="comment">// crosses = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// line and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(poly1, line1);           <span class="comment">// crosses = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// polygon and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">4</span>));</span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line">crosses = GeometryEngine.Instance.Crosses(poly1, poly2);           <span class="comment">// crosses = false</span></span><br></pre></td></tr></table></figure>

<h3 id="使用折线切割几何图形"><a href="#使用折线切割几何图形" class="headerlink" title="使用折线切割几何图形"></a>使用折线切割几何图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, sr));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">4.0</span>, sr));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">4.0</span>, sr));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">1.0</span>, sr));</span><br><span class="line"></span><br><span class="line">List&lt;Geometry&gt; cutGeometries;</span><br><span class="line"></span><br><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, sr), MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">6</span>, sr));</span><br><span class="line">Polyline cutter = PolylineBuilderEx.CreatePolyline(line);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(list);</span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polyline);</span><br><span class="line">cutGeometries = GeometryEngine.Instance.Cut(polyline, cutter) <span class="keyword">as</span> List&lt;Geometry&gt;;</span><br><span class="line"></span><br><span class="line">Polyline leftPolyline = cutGeometries[<span class="number">0</span>] <span class="keyword">as</span> Polyline;</span><br><span class="line">Polyline rightPolyline = cutGeometries[<span class="number">1</span>] <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"><span class="comment">// leftPolyline.Points[0] = 1, 2</span></span><br><span class="line"><span class="comment">// leftPolyline.Points[1] = 1, 4</span></span><br><span class="line"><span class="comment">// leftPolyline.Points[2] = 2, 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// rightPolyline.Points.Count = 5</span></span><br><span class="line"><span class="comment">// rightPolyline.Parts.Count = 2</span></span><br><span class="line"></span><br><span class="line">ReadOnlySegmentCollection segments0 = rightPolyline.Parts[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// segments0[0].StartCoordinate = 1, 1</span></span><br><span class="line"><span class="comment">// segments0[0].EndCoordinate = 1, 2</span></span><br><span class="line"></span><br><span class="line">ReadOnlySegmentCollection segments1 = rightPolyline.Parts[<span class="number">1</span>];</span><br><span class="line"><span class="comment">// segments1.Count = 2</span></span><br><span class="line"><span class="comment">// segments1[0].StartCoordinate = 2, 4</span></span><br><span class="line"><span class="comment">// segments1[0].EndCoordinate = 4, 4</span></span><br><span class="line"><span class="comment">// segments1[1].StartCoordinate = 4, 4</span></span><br><span class="line"><span class="comment">// segments1[1].EndCoordinate = 4, 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon </span></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list);</span><br><span class="line">isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polygon);</span><br><span class="line">cutGeometries = GeometryEngine.Instance.Cut(polygon, cutter) <span class="keyword">as</span> List&lt;Geometry&gt;;</span><br></pre></td></tr></table></figure>

<h3 id="按长度致密"><a href="#按长度致密" class="headerlink" title="按长度致密"></a>按长度致密</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// densify a line segment</span></span><br><span class="line">MapPoint startPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint endPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">21</span>);</span><br><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(startPt, endPt);</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(line);</span><br><span class="line"></span><br><span class="line">Geometry geom = GeometryEngine.Instance.DensifyByLength(polyline, <span class="number">2</span>);</span><br><span class="line">Polyline result = geom <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// densify a circular arc</span></span><br><span class="line">MapPoint fromPt = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">MapPoint toPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">Coordinate2D interiorPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>, <span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">EllipticArcBuilderEx cab = <span class="keyword">new</span> EllipticArcBuilderEx(fromPt, toPt, interiorPt);</span><br><span class="line">EllipticArcSegment circularArc = cab.ToSegment();</span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(circularArc);</span><br><span class="line">geom = GeometryEngine.Instance.DensifyByLength(polyline, <span class="number">2</span>);</span><br><span class="line">result = geom <span class="keyword">as</span> Polyline;</span><br></pre></td></tr></table></figure>

<h3 id="两个多边形之间的差异"><a href="#两个多边形之间的差异" class="headerlink" title="两个多边形之间的差异"></a>两个多边形之间的差异</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MapPoint&gt; polyPts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">2.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">2.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon poly1 = PolygonBuilderEx.CreatePolygon(polyPts);</span><br><span class="line"></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">4</span>));</span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line"></span><br><span class="line">Geometry result = GeometryEngine.Instance.Difference(poly1, poly2);</span><br><span class="line">Polygon polyResult = result <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// polyResult.Area = 10.0</span></span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.Difference(poly2, poly1);</span><br><span class="line">polyResult = result <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// polyResult.Area = 7.0</span></span><br></pre></td></tr></table></figure>

<h3 id="确定两个几何是否不相交"><a href="#确定两个几何是否不相交" class="headerlink" title="确定两个几何是否不相交"></a>确定两个几何是否不相交</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt on pt</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.5</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> disjoint = GeometryEngine.Instance.Disjoint(pt, pt2);       <span class="comment">// result is true</span></span><br><span class="line"></span><br><span class="line">MultipointBuilderEx mpb = <span class="keyword">new</span> MultipointBuilderEx();</span><br><span class="line">mpb.AddPoint(pt);</span><br><span class="line">mpb.AddPoint(pt2);</span><br><span class="line">Multipoint multiPoint = mpb.ToGeometry();</span><br><span class="line"></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(multiPoint, pt);     <span class="comment">// result is false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// pt and line</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line1 = PolylineBuilderEx.CreatePolyline(list);</span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(line1, pt2);       <span class="comment">// result is true</span></span><br><span class="line"></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(pt2, line1);       <span class="comment">// result is true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// end pt of line</span></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(line1, pt);        <span class="comment">// result is false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; polyPts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">2.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">2.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon poly1 = PolygonBuilderEx.CreatePolygon(polyPts);</span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(poly1, pt);          <span class="comment">// result is true</span></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(pt, poly1);          <span class="comment">// result is true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// line and line</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list2 = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line2 = PolylineBuilderEx.CreatePolyline(list2);</span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(line1, line2);         <span class="comment">// result is false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// line and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(poly1, line1);         <span class="comment">// result is false</span></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(line1, poly1);         <span class="comment">// result is false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// polygon and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">4</span>));</span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line"></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint(poly1, poly2);         <span class="comment">// result is false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// disjoint3D</span></span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">MapPoint pt3D_1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, sr);</span><br><span class="line">MapPoint pt3D_2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, sr);</span><br><span class="line">MapPoint pt3D_3 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, sr);</span><br><span class="line"></span><br><span class="line">MultipointBuilderEx mpbEx = <span class="keyword">new</span> MultipointBuilderEx();</span><br><span class="line">mpbEx.AddPoint(pt3D_1);</span><br><span class="line">mpbEx.AddPoint(pt3D_2);</span><br><span class="line">mpbEx.HasZ = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">multiPoint = mpbEx.ToGeometry();</span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint3D(multiPoint, pt3D_2);     <span class="comment">// disjoint = false</span></span><br><span class="line">disjoint = GeometryEngine.Instance.Disjoint3D(multiPoint, pt3D_3);     <span class="comment">// disjoint = true</span></span><br></pre></td></tr></table></figure>

<h3 id="确定两个几何之间的距离"><a href="#确定两个几何之间的距离" class="headerlink" title="确定两个几何之间的距离"></a>确定两个几何之间的距离</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>);</span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">2.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and pt </span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="built_in">double</span> d = GeometryEngine.Instance.Distance(pt1, pt2);         <span class="comment">// d = Math.Sqrt(2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and multipoint</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; multiPts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">multiPts.Add(pt2);</span><br><span class="line">multiPts.Add(pt3);</span><br><span class="line">Multipoint multiPoint = MultipointBuilderEx.CreateMultipoint(multiPts);</span><br><span class="line">d = GeometryEngine.Instance.Distance(pt1, multiPoint);         <span class="comment">// d = Math.Sqrt(2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and envelope</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(pt1, pt2);</span><br><span class="line">d = GeometryEngine.Instance.Distance(pt1, env);                <span class="comment">// d = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and polyline</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; polylinePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polylinePts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line">polylinePts.Add(pt2);</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(polylinePts);</span><br><span class="line"></span><br><span class="line">d = GeometryEngine.Instance.Distance(pt1, polyline);             <span class="comment">// d = 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Envelope env2 = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">5.0</span>));</span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(env2);</span><br><span class="line">d = GeometryEngine.Instance.Distance(pt1, poly);                 <span class="comment">// d = Math.Sqrt(8)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// envelope and polyline</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">d = GeometryEngine.Instance.Distance(env, polyline);             <span class="comment">// d = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// polyline and polyline</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; polylineList = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polylineList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">3</span>));</span><br><span class="line">polylineList.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">4</span>));</span><br><span class="line">Polyline polyline2 = PolylineBuilderEx.CreatePolyline(polylineList);</span><br><span class="line"></span><br><span class="line">d = GeometryEngine.Instance.Distance(polyline, polyline2);           <span class="comment">// d = Math.Sqrt(5)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// polygon and polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line">d = GeometryEngine.Instance.Distance(poly, poly2);                 <span class="comment">// d = Math.Sqrt(2)</span></span><br></pre></td></tr></table></figure>

<h3 id="确定两个几何体之间的-3D-距离"><a href="#确定两个几何体之间的-3D-距离" class="headerlink" title="确定两个几何体之间的 3D 距离"></a>确定两个几何体之间的 3D 距离</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// between points </span></span><br><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// pt1 to pt2</span></span><br><span class="line"><span class="built_in">double</span> d = GeometryEngine.Instance.Distance3D(pt1, pt2);        <span class="comment">// d = Math.Sqrt(3)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// pt1 to pt3</span></span><br><span class="line">d = GeometryEngine.Instance.Distance3D(pt1, pt3);        <span class="comment">// d = Math.Sqrt(82)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// pt2 to pt3</span></span><br><span class="line">d = GeometryEngine.Instance.Distance3D(pt2, pt3);        <span class="comment">// d = Math.Sqrt(65)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// intersecting lines</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line1 = PolylineBuilderEx.CreatePolyline(list);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; list2 = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">3.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line2 = PolylineBuilderEx.CreatePolyline(list2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> intersects = GeometryEngine.Instance.Intersects(line1, line2);    <span class="comment">// intersects = true</span></span><br><span class="line">d = GeometryEngine.Instance.Distance3D(line1, line2);                  <span class="comment">// d = 0   (distance is 0 when geomtries intersect)</span></span><br></pre></td></tr></table></figure>

<h3 id="展开信封-1"><a href="#展开信封-1" class="headerlink" title="展开信封"></a>展开信封</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(<span class="number">100.0</span>, <span class="number">100.0</span>, <span class="number">500.0</span>, <span class="number">500.0</span>);</span><br><span class="line"><span class="comment">// env.HasZ = false</span></span><br><span class="line"></span><br><span class="line">Envelope result = GeometryEngine.Instance.Expand(env, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">// result.Center = 300, 300</span></span><br><span class="line"><span class="comment">// result.XMin = 200</span></span><br><span class="line"><span class="comment">// result.YMin = 200</span></span><br><span class="line"><span class="comment">// result.XMax = 400</span></span><br><span class="line"><span class="comment">// result.YMax = 400</span></span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.Expand(env, <span class="number">100</span>, <span class="number">200</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// result.Center = 300, 300</span></span><br><span class="line"><span class="comment">// result.XMin = 0</span></span><br><span class="line"><span class="comment">// result.YMin = -100</span></span><br><span class="line"><span class="comment">// result.XMax = 600</span></span><br><span class="line"><span class="comment">// result.YMax = 700</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// expand in 3 dimensions</span></span><br><span class="line">  result = GeometryEngine.Instance.Expand(env, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (InvalidOperationException e)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// the geometry is not Z-Aware</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// expand a 3d envelope</span></span><br><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">200</span>, <span class="number">200</span>, <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">env = EnvelopeBuilderEx.CreateEnvelope(pt1, pt2);</span><br><span class="line"><span class="comment">// env.HasZ = true</span></span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.Expand(env, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// result.Center = 150, 150, 150</span></span><br><span class="line"><span class="comment">// result.XMin = 125</span></span><br><span class="line"><span class="comment">// result.YMin = 125</span></span><br><span class="line"><span class="comment">// result.ZMin = 125</span></span><br><span class="line"><span class="comment">// result.XMax = 175</span></span><br><span class="line"><span class="comment">// result.YMax = 175</span></span><br><span class="line"><span class="comment">// result.ZMax = 175</span></span><br></pre></td></tr></table></figure>

<h3 id="扩展折线"><a href="#扩展折线" class="headerlink" title="扩展折线"></a>扩展折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// build a polyline</span></span><br><span class="line"><span class="keyword">var</span> polyline = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">20</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">20</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">-1</span>, <span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// build the extender line</span></span><br><span class="line"><span class="keyword">var</span> extender = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">-2</span>),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extend</span></span><br><span class="line"><span class="keyword">var</span> result = GeometryEngine.Instance.Extend(polyline, extender, ExtendFlags.KeepEndAttributes);</span><br><span class="line">Polyline extendedLine = result <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// result.Parts[0].Points[0] = 2, 2, 10, 20</span></span><br><span class="line"><span class="comment">// result.parts[0].Points[1] = 1, 1, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[2] = 0, 0, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[3] = 1, -1, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[4] = 2, -2, 10, 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// change the flags</span></span><br><span class="line">result = GeometryEngine.Instance.Extend(polyline, extender, ExtendFlags.NoEndAttributes);</span><br><span class="line">extendedLine = result <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// result.Parts[0].Points[0] = 2, 2, 0</span></span><br><span class="line"><span class="comment">// result.parts[0].Points[1] = 1, 1, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[2] = 0, 0, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[3] = 1, -1, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[4] = 2, -2, 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// extend</span></span><br><span class="line">result = GeometryEngine.Instance.Extend(polyline, extender, ExtendFlags.KeepEndAttributes | ExtendFlags.NoExtendAtTo);</span><br><span class="line">extendedLine = result <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// result.Parts[0].Points[0] = 2, 2, 10, 20</span></span><br><span class="line"><span class="comment">// result.parts[0].Points[1] = 1, 1, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[2] = 0, 0, 10, 20</span></span><br><span class="line"><span class="comment">// result.Parts[0].Points[3] = 1, -1, 10, 20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// extend with no intersection </span></span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">1</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">extender = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">4</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.Extend(polyline, extender, ExtendFlags.Default);</span><br><span class="line"><span class="comment">// result = null</span></span><br></pre></td></tr></table></figure>

<h3 id="概括"><a href="#概括" class="headerlink" title="概括"></a>概括</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Polyline generalizedPolyline = GeometryEngine.Instance.Generalize(polylineWithZ, <span class="number">200</span>) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// generalizedPolyline.HasZ = true</span></span><br><span class="line"></span><br><span class="line">Polygon generalized3DPolyline = GeometryEngine.Instance.Generalize3D(polylineWithZ, <span class="number">200</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// generalized3DPolyline.HasZ = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// note that generalized3DPolyline and generalizedPolyline will have different definitions</span></span><br><span class="line"><span class="comment">//  ie generalizedPolyline.IsEqual(generalized3DPolyline) = false</span></span><br></pre></td></tr></table></figure>

<h3 id="计算面的测地线面积"><a href="#计算面的测地线面积" class="headerlink" title="计算面的测地线面积"></a>计算面的测地线面积</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> polygon = PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-10018754.1713946</span>, <span class="number">10018754.1713946</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">10018754.1713946</span>, <span class="number">10018754.1713946</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">10018754.1713946</span>, <span class="number">-10018754.1713946</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-10018754.1713946</span>, <span class="number">-10018754.1713946</span>)</span><br><span class="line">&#125;, SpatialReferences.WebMercator);</span><br><span class="line"><span class="keyword">var</span> area = GeometryEngine.Instance.GeodesicArea(polygon);</span><br><span class="line"></span><br><span class="line"><span class="comment">// area is close to 255032810857732.31</span></span><br><span class="line"></span><br><span class="line">area = GeometryEngine.Instance.GeodesicArea(polygon, AreaUnit.SquareKilometers);</span><br><span class="line"><span class="comment">// area is close to 255032810.85953, </span></span><br></pre></td></tr></table></figure>

<h3 id="在指定的测地线距离处创建缓冲区面"><a href="#在指定的测地线距离处创建缓冲区面" class="headerlink" title="在指定的测地线距离处创建缓冲区面"></a>在指定的测地线距离处创建缓冲区面</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// buffer a point</span></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84);</span><br><span class="line">Polygon outPolygon = GeometryEngine.Instance.GeodesicBuffer(pt, <span class="number">5</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> delta = SpatialReferences.WGS84.XYTolerance * <span class="number">2</span> * Math.Sqrt(<span class="number">2</span>);</span><br><span class="line">ReadOnlyPointCollection points = outPolygon.Points;</span><br><span class="line"><span class="keyword">foreach</span> (MapPoint p <span class="keyword">in</span> points)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">double</span> d = GeometryEngine.Instance.GeodesicDistance(pt, p);</span><br><span class="line">  <span class="comment">// d = 5 (+- delta)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// specify a unit for the distance</span></span><br><span class="line">outPolygon = GeometryEngine.Instance.GeodesicBuffer(pt, <span class="number">5000</span>, LinearUnit.Millimeters) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// buffer of 0 distance produces an empty geometry</span></span><br><span class="line">Geometry g = GeometryEngine.Instance.GeodesicBuffer(pt, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// g.IsEmpty = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// buffer many points</span></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">10.0</span>, <span class="number">20.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">40.0</span>, <span class="number">40.0</span>));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">60.0</span>, <span class="number">60.0</span>));</span><br><span class="line"></span><br><span class="line">outPolygon = GeometryEngine.Instance.GeodesicBuffer(list, <span class="number">10000</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// outPolygon.PartCount = 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// buffer different geometry types</span></span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">20</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">20</span>, <span class="number">30</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">50</span>, <span class="number">60</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">70</span>, <span class="number">80</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">80</span>, <span class="number">40</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">90</span>, <span class="number">10</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">110</span>, <span class="number">15</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">120</span>, <span class="number">30</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">40</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">-10</span>, <span class="number">40</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">-10</span>, <span class="number">50</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List&lt;Geometry&gt; manyGeometries = <span class="keyword">new</span> List&lt;Geometry&gt;</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84),</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">0</span>], coords[<span class="number">1</span>], coords[<span class="number">2</span>]&#125;, SpatialReferences.WGS84),</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">3</span>], coords[<span class="number">4</span>], coords[<span class="number">5</span>]&#125;),</span><br><span class="line">  PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">9</span>], coords[<span class="number">10</span>], coords[<span class="number">11</span>]&#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">outPolygon = GeometryEngine.Instance.GeodesicBuffer(manyGeometries, <span class="number">20000</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// specify unit types</span></span><br><span class="line">outPolygon = GeometryEngine.Instance.GeodesicBuffer(manyGeometries, <span class="number">20</span>, LinearUnit.Miles) <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="确定两个几何之间的测地线距离"><a href="#确定两个几何之间的测地线距离" class="headerlink" title="确定两个几何之间的测地线距离"></a>确定两个几何之间的测地线距离</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> point1 = MapPointBuilderEx.CreateMapPoint(<span class="number">-170</span>, <span class="number">45</span>, SpatialReferences.WGS84);</span><br><span class="line"><span class="keyword">var</span> point2 = MapPointBuilderEx.CreateMapPoint(<span class="number">170</span>, <span class="number">45</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> distances_meters = GeometryEngine.Instance.GeodesicDistance(point1, point2);</span><br><span class="line"><span class="comment">// distance is approximately 1572912.2066940258 in meters</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> distance_feet = GeometryEngine.Instance.GeodesicDistance(point1, point2, LinearUnit.Feet);</span><br><span class="line"><span class="comment">// distance is approximately  5160473.11904786 in feet</span></span><br></pre></td></tr></table></figure>

<h3 id="测地线椭圆"><a href="#测地线椭圆" class="headerlink" title="测地线椭圆"></a>测地线椭圆</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">GeodesicEllipseParameter param = <span class="keyword">new</span> GeodesicEllipseParameter();</span><br><span class="line">param.AxisDirection = <span class="number">4</span> * Math.PI / <span class="number">3</span>;</span><br><span class="line">param.Center = <span class="keyword">new</span> Coordinate2D(<span class="number">-120</span>, <span class="number">60</span>);</span><br><span class="line">param.LinearUnit = LinearUnit.Meters;</span><br><span class="line">param.OutGeometryType = GeometryType.Polyline;</span><br><span class="line">param.SemiAxis1Length = <span class="number">6500000</span>;</span><br><span class="line">param.SemiAxis2Length = <span class="number">1500000</span>;</span><br><span class="line">param.VertexCount = <span class="number">800</span>;</span><br><span class="line"></span><br><span class="line">Geometry geometry = GeometryEngine.Instance.GeodesicEllipse(param, SpatialReferences.WGS84);</span><br><span class="line"><span class="comment">// geometry.IsEmpty = false</span></span><br><span class="line"></span><br><span class="line">Polyline polyline = geometry <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// polyline.PointCount = 801</span></span><br><span class="line"><span class="comment">// polyline.PartCount = 1</span></span><br></pre></td></tr></table></figure>

<h3 id="确定线的测地线长度"><a href="#确定线的测地线长度" class="headerlink" title="确定线的测地线长度"></a>确定线的测地线长度</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> polyline = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint(<span class="number">-10018754.1713946</span>, <span class="number">10018754.1713946</span>),</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint(<span class="number">10018754.1713946</span>, <span class="number">10018754.1713946</span>)</span><br><span class="line">&#125;, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> length = GeometryEngine.Instance.GeodesicLength(polyline);</span><br><span class="line"><span class="comment">// length is approx 5243784.5551844323 in meters</span></span><br><span class="line"></span><br><span class="line">length = GeometryEngine.Instance.GeodesicLength(polyline, LinearUnit.Miles);</span><br><span class="line"><span class="comment">// length is approx 3258.33666089067 in miles</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> polyline2 = GeometryEngine.Instance.Project(polyline, SpatialReferences.WGS84);</span><br><span class="line">length = GeometryEngine.Instance.GeodesicLength(polyline2);</span><br><span class="line"><span class="comment">// length is approx 5243784.55518443 in meters after projecting</span></span><br></pre></td></tr></table></figure>

<h3 id="测地线扇区"><a href="#测地线扇区" class="headerlink" title="测地线扇区"></a>测地线扇区</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GeodesicSectorParameter param = <span class="keyword">new</span> GeodesicSectorParameter();</span><br><span class="line">param.ArcVertexCount = <span class="number">50</span>;</span><br><span class="line">param.AxisDirection = Math.PI / <span class="number">4</span>;</span><br><span class="line">param.Center = <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">param.LinearUnit = LinearUnit.Meters;</span><br><span class="line">param.OutGeometryType = GeometryType.Polygon;</span><br><span class="line">param.RadiusVertexCount = <span class="number">10</span>;</span><br><span class="line">param.SectorAngle = <span class="number">5</span> * Math.PI / <span class="number">3</span>;</span><br><span class="line">param.SemiAxis1Length = <span class="number">100000</span>;</span><br><span class="line">param.SemiAxis2Length = <span class="number">20000</span>;</span><br><span class="line">param.StartDirection = <span class="number">11</span> * Math.PI / <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">Geometry geometry = GeometryEngine.Instance.GeodesicSector(param, SpatialReferences.WGS84);</span><br><span class="line"><span class="comment">// geometry.IsEmpty = false</span></span><br><span class="line"></span><br><span class="line">Polygon polygon = geometry <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// polygon.PointCount = 68</span></span><br><span class="line"><span class="comment">// polygon.PartCount = 1</span></span><br></pre></td></tr></table></figure>

<h3 id="大地测量致密化偏差-折线"><a href="#大地测量致密化偏差-折线" class="headerlink" title="大地测量致密化偏差 - 折线"></a>大地测量致密化偏差 - 折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-80</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-20</span>, <span class="number">60</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">40</span>, <span class="number">20</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">-20</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-80</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a polyline</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// densify in km</span></span><br><span class="line">Polyline geodesicPolyline = GeometryEngine.Instance.GeodeticDensifyByDeviation(polyline, <span class="number">200</span>, LinearUnit.Kilometers, GeodeticCurveType.Geodesic) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// densify in m</span></span><br><span class="line">geodesicPolyline = GeometryEngine.Instance.GeodeticDensifyByDeviation(polyline, <span class="number">200</span>, LinearUnit.Meters, GeodeticCurveType.Geodesic) <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Change curve type to Loxodrome</span></span><br><span class="line">Polyline loxodromePolyline = GeometryEngine.Instance.GeodeticDensifyByDeviation(polyline, <span class="number">200</span>, LinearUnit.Meters, GeodeticCurveType.Loxodrome) <span class="keyword">as</span> Polyline;</span><br></pre></td></tr></table></figure>

<h3 id="大地测量致密按长度-多边形"><a href="#大地测量致密按长度-多边形" class="headerlink" title="大地测量致密按长度 - 多边形"></a>大地测量致密按长度 - 多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-80</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-20</span>, <span class="number">60</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">40</span>, <span class="number">20</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">-20</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-80</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create a polygon</span></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coords, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the geodesic lengths of the polygon segments</span></span><br><span class="line">ReadOnlySegmentCollection segments = polygon.Parts[<span class="number">0</span>];</span><br><span class="line">List&lt;Double&gt; geoLengths = <span class="keyword">new</span> List&lt;Double&gt;(segments.Count);</span><br><span class="line"><span class="keyword">foreach</span> (Segment s <span class="keyword">in</span> segments)</span><br><span class="line">&#123;</span><br><span class="line">  Polyline line = PolylineBuilderEx.CreatePolyline(s, sr);</span><br><span class="line">  <span class="built_in">double</span> geoLen = GeometryEngine.Instance.GeodesicLength(line);</span><br><span class="line">  geoLengths.Add(geoLen);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// find the max length</span></span><br><span class="line">geoLengths.Sort();</span><br><span class="line"><span class="built_in">double</span> maxLen = geoLengths[geoLengths.Count - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// densify the polygon (in meters)</span></span><br><span class="line">Polygon densifiedPoly = GeometryEngine.Instance.GeodeticDensifyByLength(polygon, maxLen, LinearUnit.Meters, GeodeticCurveType.Geodesic) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// densify the polygon (in km)</span></span><br><span class="line"><span class="built_in">double</span> maxSegmentLength = maxLen / <span class="number">10000</span>;</span><br><span class="line">densifiedPoly = GeometryEngine.Instance.GeodeticDensifyByLength(polygon, maxSegmentLength, LinearUnit.Kilometers, GeodeticCurveType.Geodesic) <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="计算大地测量距离，两点之间的方位角"><a href="#计算大地测量距离，两点之间的方位角" class="headerlink" title="计算大地测量距离，两点之间的方位角"></a>计算大地测量距离，两点之间的方位角</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">MapPoint p1 = MapPointBuilderEx.CreateMapPoint(<span class="number">111</span>, <span class="number">55</span>, sr);</span><br><span class="line">MapPoint p2 = MapPointBuilderEx.CreateMapPoint(<span class="number">95.5845</span>, <span class="number">64.2285</span>, sr);</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> distance, az12, az21;</span><br><span class="line"></span><br><span class="line">distance = GeometryEngine.Instance.GeodeticDistanceAndAzimuth(p1, p2, GeodeticCurveType.Geodesic, <span class="keyword">out</span> az12, <span class="keyword">out</span> az21);</span><br><span class="line"><span class="comment">// distance - 1339728.0303777338</span></span><br><span class="line"><span class="comment">// az12 - 326.235780421405</span></span><br><span class="line"><span class="comment">// az21 - 132.87425637913955</span></span><br><span class="line"></span><br><span class="line">distance = GeometryEngine.Instance.GeodeticDistanceAndAzimuth(p1, p2, GeodeticCurveType.Loxodrome, <span class="keyword">out</span> az12, <span class="keyword">out</span> az21);</span><br><span class="line"><span class="comment">// distance - 1342745.9687172563</span></span><br><span class="line"><span class="comment">// az12 - 319.966400332104</span></span><br><span class="line"><span class="comment">// az21- 139.96640033210397</span></span><br><span class="line"></span><br><span class="line">distance = GeometryEngine.Instance.GeodeticDistanceAndAzimuth(p1, p2, GeodeticCurveType.GreatElliptic, <span class="keyword">out</span> az12, <span class="keyword">out</span> az21);</span><br><span class="line"><span class="comment">// distance - 1339728.038837946</span></span><br><span class="line"><span class="comment">// az12 - 326.22479262335418</span></span><br><span class="line"><span class="comment">// az21 - 132.88558894347742</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">MapPoint p3 = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, sr);</span><br><span class="line">MapPoint p4 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">0</span>, sr);</span><br><span class="line"></span><br><span class="line">distance = GeometryEngine.Instance.GeodeticDistanceAndAzimuth(p3, p4, GeodeticCurveType.Geodesic, <span class="keyword">out</span> az12, <span class="keyword">out</span> az21);</span><br><span class="line"><span class="comment">// distance - 111319.49079327342</span></span><br><span class="line"><span class="comment">// az12 - 90</span></span><br><span class="line"><span class="comment">// az21 - 270</span></span><br><span class="line"></span><br><span class="line">distance = GeometryEngine.Instance.GeodeticDistanceAndAzimuth(p3, p4, GeodeticCurveType.Geodesic, LinearUnit.Miles, <span class="keyword">out</span> az12, <span class="keyword">out</span> az21);</span><br><span class="line"><span class="comment">// distance - 69.1707247134693</span></span><br><span class="line"><span class="comment">// az12 - 90</span></span><br><span class="line"><span class="comment">// az21 - 270</span></span><br></pre></td></tr></table></figure>

<h3 id="对一组地图点执行大地测量移动"><a href="#对一组地图点执行大地测量移动" class="headerlink" title="对一组地图点执行大地测量移动"></a>对一组地图点执行大地测量移动</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WebMercator;</span><br><span class="line"><span class="keyword">var</span> points = <span class="keyword">new</span>[] &#123; MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, sr) &#125;;</span><br><span class="line"><span class="built_in">double</span> distance = <span class="number">10</span>;</span><br><span class="line"><span class="built_in">double</span> azimuth = Math.PI / <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> resultPoints = GeometryEngine.Instance.GeodeticMove(points, sr, distance, LinearUnit.Meters, azimuth, GeodeticCurveType.Geodesic);</span><br><span class="line"></span><br><span class="line"><span class="comment">// resultPoints.First().X = 10</span></span><br><span class="line"><span class="comment">// resultPoints.First().Y = 0</span></span><br><span class="line"><span class="comment">// resultPoints.First().SpatialReference.Wkid = sr.Wkid</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Change LinearUnit to Miles</span></span><br><span class="line">resultPoints = GeometryEngine.Instance.GeodeticMove(points, sr, distance, LinearUnit.Miles, azimuth, GeodeticCurveType.Geodesic);</span><br><span class="line"><span class="comment">// resultPoints.First().X = 16093.44</span></span><br><span class="line"><span class="comment">// resultPoints.First().Y = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Change curve type</span></span><br><span class="line">resultPoints = GeometryEngine.Instance.GeodeticMove(points, sr, distance, LinearUnit.Miles, azimuth, GeodeticCurveType.Loxodrome);</span><br><span class="line"><span class="comment">// resultPoints.First().X = 16093.44</span></span><br><span class="line"><span class="comment">// resultPoints.First().Y = 0</span></span><br></pre></td></tr></table></figure>

<h3 id="检索坐标系"><a href="#检索坐标系" class="headerlink" title="检索坐标系"></a>检索坐标系</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get all the geographic coordinate systems</span></span><br><span class="line">IReadOnlyList&lt;CoordinateSystemListEntry&gt; gcs_list = GeometryEngine.Instance.GetPredefinedCoordinateSystemList(CoordinateSystemFilter.GeographicCoordinateSystem);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the projected coordinate systems</span></span><br><span class="line">IReadOnlyList&lt;CoordinateSystemListEntry&gt; proj_list = GeometryEngine.Instance.GetPredefinedCoordinateSystemList(CoordinateSystemFilter.ProjectedCoordinateSystem);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get the vertical coordinate systems</span></span><br><span class="line">IReadOnlyList&lt;CoordinateSystemListEntry&gt; vert_list = GeometryEngine.Instance.GetPredefinedCoordinateSystemList(CoordinateSystemFilter.VerticalCoordinateSystem);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get geographic and projected coordinate systems</span></span><br><span class="line">IReadOnlyList&lt;CoordinateSystemListEntry&gt; combined_list = GeometryEngine.Instance.GetPredefinedCoordinateSystemList(CoordinateSystemFilter.GeographicCoordinateSystem | CoordinateSystemFilter.ProjectedCoordinateSystem);</span><br><span class="line"></span><br><span class="line"><span class="comment">// investigate one of the entries</span></span><br><span class="line">CoordinateSystemListEntry entry = gcs_list[<span class="number">0</span>];</span><br><span class="line"><span class="built_in">int</span> wkid = entry.Wkid;</span><br><span class="line"><span class="built_in">string</span> category = entry.Category;</span><br><span class="line"><span class="built_in">string</span> name = entry.Name;</span><br></pre></td></tr></table></figure>

<h3 id="检索系统地理变换"><a href="#检索系统地理变换" class="headerlink" title="检索系统地理变换"></a>检索系统地理变换</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a geographic transformation is the definition of how to project from one spatial reference to another</span></span><br><span class="line">IReadOnlyList&lt;GeographicTransformationListEntry&gt; list = GeometryEngine.Instance.GetPredefinedGeographicTransformationList();</span><br><span class="line"></span><br><span class="line"><span class="comment">// a GeographicTransformationListEntry consists of Name, Wkid, the From SpatialReference Wkid, the To SpatialReference Wkid</span></span><br><span class="line">GeographicTransformationListEntry entry = list[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> fromWkid = entry.FromSRWkid;</span><br><span class="line"><span class="built_in">int</span> toWkid = entry.ToSRWkid;</span><br><span class="line"><span class="built_in">int</span> wkid = entry.Wkid;</span><br><span class="line"><span class="built_in">string</span> name = entry.Name;</span><br></pre></td></tr></table></figure>

<h3 id="获取折线或多边形的子曲线"><a href="#获取折线或多边形的子曲线" class="headerlink" title="获取折线或多边形的子曲线"></a>获取折线或多边形的子曲线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-111</span>, <span class="number">72</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-108</span>, <span class="number">68</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-114</span>, <span class="number">68</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords, sr);</span><br><span class="line"></span><br><span class="line">Polyline subCurve = GeometryEngine.Instance.GetSubCurve(polyline, <span class="number">0</span>, <span class="number">5</span>, AsRatioOrLength.AsLength);</span><br><span class="line"><span class="comment">// subCurve.PartCount = 1</span></span><br><span class="line"><span class="comment">// subCurve.PointCount = 2</span></span><br><span class="line"></span><br><span class="line">ReadOnlyPointCollection points = subCurve.Points;</span><br><span class="line"><span class="comment">// points[0] = -111, 72</span></span><br><span class="line"><span class="comment">// points[1] = -108, 68</span></span><br><span class="line"></span><br><span class="line">subCurve = GeometryEngine.Instance.GetSubCurve(polyline, <span class="number">0</span>, <span class="number">0.5</span>, AsRatioOrLength.AsRatio);</span><br><span class="line"><span class="comment">// subCurve.PointCount = 3</span></span><br><span class="line"></span><br><span class="line">points = subCurve.Points;</span><br><span class="line"><span class="comment">// points[0] = -111, 72</span></span><br><span class="line"><span class="comment">// points[1] = -108, 68</span></span><br><span class="line"><span class="comment">// points[2] = -108.5, 68</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">List&lt;Coordinate3D&gt; coords3D = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coords3D, sr);</span><br><span class="line"></span><br><span class="line">subCurve = GeometryEngine.Instance.GetSubCurve3D(polygon, <span class="number">0</span>, <span class="number">1</span>, AsRatioOrLength.AsLength);</span><br><span class="line"><span class="comment">// subCurve.HasZ = true</span></span><br><span class="line"></span><br><span class="line">points = subCurve.Points;</span><br><span class="line"><span class="comment">// points.Count = 2</span></span><br><span class="line"><span class="comment">// points[0] = 0, 0, 0</span></span><br><span class="line"><span class="comment">// points[1] = 0, 0.70710678118654746, 0.70710678118654746</span></span><br></pre></td></tr></table></figure>

<h3 id="图形缓冲区"><a href="#图形缓冲区" class="headerlink" title="图形缓冲区"></a>图形缓冲区</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// mitered join and butt caps</span></span><br><span class="line">SpatialReference sr = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">102010</span>);</span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">1400</span>,<span class="number">6200</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">1600</span>,<span class="number">6300</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">1800</span>,<span class="number">6200</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords, sr);</span><br><span class="line"></span><br><span class="line">Polygon polygon = GeometryEngine.Instance.GraphicBuffer(polyline, <span class="number">50</span>, LineJoinType.Miter, LineCapType.Butt, <span class="number">10</span>, <span class="number">0</span>, <span class="number">-1</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// bevelled join and round caps</span></span><br><span class="line">Envelope envelope = EnvelopeBuilderEx.CreateEnvelope(<span class="number">0</span>, <span class="number">0</span>, <span class="number">10000</span>, <span class="number">10000</span>, SpatialReferences.WebMercator);</span><br><span class="line"></span><br><span class="line">Polygon outPolygon = GeometryEngine.Instance.GraphicBuffer(envelope, <span class="number">1000</span>, LineJoinType.Bevel, LineCapType.Round, <span class="number">4</span>, <span class="number">0</span>, <span class="number">96</span>) <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="图形缓冲器很多"><a href="#图形缓冲器很多" class="headerlink" title="图形缓冲器很多"></a>图形缓冲器很多</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// round join and round caps</span></span><br><span class="line">MapPoint point1 = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">MapPoint point2 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint point3 = MapPointBuilderEx.CreateMapPoint(<span class="number">1000000</span>, <span class="number">1200000</span>, SpatialReferences.WebMercator);</span><br><span class="line">List&lt;MapPoint&gt; points = <span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; point1, point2, point3 &#125;;</span><br><span class="line"></span><br><span class="line">IReadOnlyList&lt;Geometry&gt; geometries = GeometryEngine.Instance.GraphicBuffer(points, <span class="number">5</span>, LineJoinType.Round, LineCapType.Round, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="两条折线之间的交点"><a href="#两条折线之间的交点" class="headerlink" title="两条折线之间的交点"></a>两条折线之间的交点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// determine intersection between two polylines</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line1 = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts2 = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>));</span><br><span class="line">pts2.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline line2 = PolylineBuilderEx.CreatePolyline(pts2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> intersects = GeometryEngine.Instance.Intersects(line1, line2);    <span class="comment">// intersects = true</span></span><br><span class="line">Geometry g = GeometryEngine.Instance.Intersection(line1, line2, GeometryDimensionType.EsriGeometry0Dimension);</span><br><span class="line">Multipoint resultMultipoint = g <span class="keyword">as</span> Multipoint;</span><br><span class="line"></span><br><span class="line"><span class="comment">// result is a multiPoint that intersects at (2,2) and (4,2)</span></span><br></pre></td></tr></table></figure>

<h3 id="两个多边形之间的交点"><a href="#两个多边形之间的交点" class="headerlink" title="两个多边形之间的交点"></a>两个多边形之间的交点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// determine intersection between two polygons</span></span><br><span class="line"></span><br><span class="line">Envelope env1 = EnvelopeBuilderEx.CreateEnvelope(<span class="keyword">new</span> Coordinate2D(<span class="number">3.0</span>, <span class="number">2.0</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">6.0</span>, <span class="number">6.0</span>));</span><br><span class="line">Polygon poly1 = PolygonBuilderEx.CreatePolygon(env1);</span><br><span class="line"></span><br><span class="line">Envelope env2 = EnvelopeBuilderEx.CreateEnvelope(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">1.0</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">4.0</span>));</span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env2);</span><br><span class="line"></span><br><span class="line">Polygon polyResult = GeometryEngine.Instance.Intersection(poly1, poly2) <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="确定多边形的标注点"><a href="#确定多边形的标注点" class="headerlink" title="确定多边形的标注点"></a>确定多边形的标注点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create a polygon</span></span><br><span class="line">List&lt;Coordinate2D&gt; list2D = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list2D);</span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polygon);</span><br><span class="line">MapPoint pt = GeometryEngine.Instance.LabelPoint(polygon);</span><br></pre></td></tr></table></figure>

<h3 id="确定线的长度，长度3D"><a href="#确定线的长度，长度3D" class="headerlink" title="确定线的长度，长度3D"></a>确定线的长度，长度3D</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MapPoint c1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">MapPoint c2 = MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// line segment</span></span><br><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(c1, c2);</span><br><span class="line"><span class="built_in">double</span> len = line.Length;     <span class="comment">// = 3</span></span><br><span class="line"><span class="built_in">double</span> len3D = line.Length3D;   <span class="comment">// = Math.Sqrt(10)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline</span></span><br><span class="line">Polyline p = PolylineBuilderEx.CreatePolyline(line);</span><br><span class="line"><span class="built_in">double</span> p_len = p.Length;        <span class="comment">// = len = 3</span></span><br><span class="line"><span class="built_in">double</span> p_len3D = p.Length3D;    <span class="comment">// = len3D = Math.Sqrt(10)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> ge_len = GeometryEngine.Instance.Length(p);      <span class="comment">// = p_len = len = 3</span></span><br><span class="line"><span class="built_in">double</span> ge_len3d = GeometryEngine.Instance.Length3D(p);    <span class="comment">// = p_len3D = len3D = Math.Sqrt(10)</span></span><br></pre></td></tr></table></figure>

<h3 id="获取最小和最大-M-值-GetMinMaxM"><a href="#获取最小和最大-M-值-GetMinMaxM" class="headerlink" title="获取最小和最大 M 值 - GetMinMaxM"></a>获取最小和最大 M 值 - GetMinMaxM</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;rings\&quot;:[[[-3000,-2000,10],[-2000,-2000,15],[-1000,-2000,20],[0,-2000,0],[1000,-2000,-20],[2000,-2000,-30],[3000,-2000,10],[4000,-2000,5]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polygon polygon = PolygonBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> minM, maxM;</span><br><span class="line">GeometryEngine.Instance.GetMinMaxM(polygon, <span class="keyword">out</span> minM, <span class="keyword">out</span> maxM);</span><br><span class="line"><span class="comment">// minM = -30 </span></span><br><span class="line"><span class="comment">// maxM = 20</span></span><br><span class="line"></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,10],[-2000,-2000,null],[-1000,-2000,null]]]&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">GeometryEngine.Instance.GetMinMaxM(polyline, <span class="keyword">out</span> minM, <span class="keyword">out</span> maxM);</span><br><span class="line"><span class="comment">// minM = 10</span></span><br><span class="line"><span class="comment">// maxM = 10</span></span><br><span class="line"></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,null],[-2000,-2000,null],[-1000,-2000,null]]]&#125;&quot;</span>;</span><br><span class="line">polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">GeometryEngine.Instance.GetMinMaxM(polyline, <span class="keyword">out</span> minM, <span class="keyword">out</span> maxM);</span><br><span class="line"><span class="comment">// minM = double.Nan</span></span><br><span class="line"><span class="comment">// maxM = double.Nan</span></span><br></pre></td></tr></table></figure>

<h3 id="确定-M-是单调的，是升序还是降序-GetMMonotonic"><a href="#确定-M-是单调的，是升序还是降序-GetMMonotonic" class="headerlink" title="确定 M 是单调的，是升序还是降序 - GetMMonotonic"></a>确定 M 是单调的，是升序还是降序 - GetMMonotonic</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,10],[-2000,-2000,15],[-1000,-2000,20]]]&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">MonotonicType monotonic = GeometryEngine.Instance.GetMMonotonic(polyline);</span><br><span class="line"><span class="comment">// monotonic = Monotonic.Ascending</span></span><br><span class="line"></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,10],[-2000,-2000,5],[-1000,-2000,0]]]&#125;&quot;</span>;</span><br><span class="line">polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">monotonic = GeometryEngine.Instance.GetMMonotonic(polyline);</span><br><span class="line"><span class="comment">// monotonic = Monotonic.Descending</span></span><br><span class="line"></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,10],[-2000,-2000,15],[-1000,-2000,0]]]&#125;&quot;</span>;</span><br><span class="line">polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">monotonic = GeometryEngine.Instance.GetMMonotonic(polyline);</span><br><span class="line"><span class="comment">// monotonic = Monotonic.NotMonotonic</span></span><br></pre></td></tr></table></figure>

<h3 id="获取与几何图形中指定-M-值出现的位置相对应的多点-GetPointsAtM"><a href="#获取与几何图形中指定-M-值出现的位置相对应的多点-GetPointsAtM" class="headerlink" title="获取与几何图形中指定 M 值出现的位置相对应的多点 - GetPointsAtM"></a>获取与几何图形中指定 M 值出现的位置相对应的多点 - GetPointsAtM</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,10],[-2000,-2000,15],[-1000,-2000,20],[0,-2000,0],[1000,-2000,20],[2000,-2000,30],[3000,-2000,10],[4000,-2000,5]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">Multipoint multipoint = GeometryEngine.Instance.GetPointsAtM(polyline, <span class="number">10</span>, <span class="number">500</span>);</span><br><span class="line"><span class="comment">// multiPoint.PointCount = 4</span></span><br><span class="line"><span class="comment">// multipoint.Points[0]  X= -3000, Y= -2500  M= 10</span></span><br><span class="line"><span class="comment">// multipoint.Points[1]  X= -500, Y= -2500  M= 10</span></span><br><span class="line"><span class="comment">// multipoint.Points[2]  X= 500, Y= -2500  M= 10</span></span><br><span class="line"><span class="comment">// multipoint.Points[3]  X= 3000, Y= -2500  M= 10</span></span><br></pre></td></tr></table></figure>

<h3 id="获取与指定-M-值之间的子曲线对应的折线-GetSubCurveBetweenMs"><a href="#获取与指定-M-值之间的子曲线对应的折线-GetSubCurveBetweenMs" class="headerlink" title="获取与指定 M 值之间的子曲线对应的折线 - GetSubCurveBetweenMs"></a>获取与指定 M 值之间的子曲线对应的折线 - GetSubCurveBetweenMs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-2000,0,1],[-1000,1000,2],[-1000,0,3],[1000,1000,4],[2000,1000,5],[2000,2000,6],[3000,2000,7],[4000,0,8]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">Polyline subCurve = GeometryEngine.Instance.GetSubCurveBetweenMs(polyline, <span class="number">2</span>, <span class="number">6</span>);</span><br><span class="line"><span class="comment">// subCurve.PointCount = 5</span></span><br><span class="line"><span class="comment">// subCurve.Points[0]  X= --1000, Y= 1000 M= 2</span></span><br><span class="line"><span class="comment">// subCurve.Points[1]  X= --1000, Y= 0  M= 3</span></span><br><span class="line"><span class="comment">// subCurve.Points[2]  X= 1000, Y= 1000  M= 4</span></span><br><span class="line"><span class="comment">// subCurve.Points[3]  X= 2000, Y= -1000  M= 5</span></span><br><span class="line"><span class="comment">// subCurve.Points[4]  X= 2000, Y= -2000  M= 6</span></span><br><span class="line"></span><br><span class="line">subCurve = GeometryEngine.Instance.GetSubCurveBetweenMs(polyline, <span class="built_in">double</span>.NaN, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// subCurve.PointCount = 0</span></span><br><span class="line"><span class="comment">// subCurve.IsEmpty = true</span></span><br></pre></td></tr></table></figure>

<h3 id="获取与沿几何图形中出现指定-M-值的位置处的法线对应的线段-GetNormalsAtM"><a href="#获取与沿几何图形中出现指定-M-值的位置处的法线对应的线段-GetNormalsAtM" class="headerlink" title="获取与沿几何图形中出现指定 M 值的位置处的法线对应的线段 - GetNormalsAtM"></a>获取与沿几何图形中出现指定 M 值的位置处的法线对应的线段 - GetNormalsAtM</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">IList&lt;MapPoint&gt; inPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-3000</span>, <span class="number">-2000</span>, <span class="number">0</span>, <span class="number">100</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-3000</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-1000</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-1000</span>, <span class="number">2000</span>, <span class="number">0</span>, <span class="number">100</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">3000</span>, <span class="number">2000</span>, <span class="number">0</span>, <span class="number">200</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">3000</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">300</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1000</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">1000</span>, <span class="number">-2000</span>, <span class="number">0</span>, <span class="number">200</span>),</span><br><span class="line">  MapPointBuilderEx.CreateMapPoint(<span class="number">-3000</span>, <span class="number">-2000</span>, <span class="number">0</span>, <span class="number">300</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(inPoints);</span><br><span class="line"><span class="comment">// polygon.HasM = true</span></span><br><span class="line"></span><br><span class="line">Polyline polyline = GeometryEngine.Instance.GetNormalsAtM(polygon, <span class="number">150</span>, <span class="number">100</span>);</span><br><span class="line"><span class="comment">// polyline.PartCount = 5</span></span><br><span class="line"><span class="comment">// polyline.PointCount = 10</span></span><br><span class="line"><span class="comment">// polyline.HasM = false</span></span><br><span class="line"></span><br><span class="line">ReadOnlyPartCollection parts = polyline.Parts;</span><br><span class="line">ReadOnlySegmentCollection segments = parts[<span class="number">0</span>];</span><br><span class="line">LineSegment line = segments[<span class="number">0</span>] <span class="keyword">as</span> LineSegment;</span><br><span class="line"><span class="comment">// line.StartCoordinate = (-3000, -1000)</span></span><br><span class="line"><span class="comment">// line.EndCoordinate = (-2900, -1000)</span></span><br><span class="line"></span><br><span class="line">segments = parts[<span class="number">1</span>];</span><br><span class="line">line = segments[<span class="number">0</span>] <span class="keyword">as</span> LineSegment;</span><br><span class="line"><span class="comment">// line.StartCoordinate = (-1000, 1500)</span></span><br><span class="line"><span class="comment">// line.EndCoordinate = (-900, 1500)</span></span><br><span class="line"></span><br><span class="line">segments = parts[<span class="number">2</span>];</span><br><span class="line">line = segments[<span class="number">0</span>] <span class="keyword">as</span> LineSegment;</span><br><span class="line"><span class="comment">// line.StartCoordinate = (1000, 2000)</span></span><br><span class="line"><span class="comment">// line.EndCoordinate = (1000, 1900)</span></span><br><span class="line"></span><br><span class="line">segments = parts[<span class="number">3</span>];</span><br><span class="line">line = segments[<span class="number">0</span>] <span class="keyword">as</span> LineSegment;</span><br><span class="line"><span class="comment">// line.StartCoordinate = (1500, 0)</span></span><br><span class="line"><span class="comment">// line.EndCoordinate = (1500, 100)</span></span><br><span class="line"></span><br><span class="line">segments = parts[<span class="number">4</span>];</span><br><span class="line">line = segments[<span class="number">0</span>] <span class="keyword">as</span> LineSegment;</span><br><span class="line"><span class="comment">// line.StartCoordinate = (1000, -1000)</span></span><br><span class="line"><span class="comment">// line.EndCoordinate = (900, -1000)</span></span><br></pre></td></tr></table></figure>

<h3 id="获取沿多部分的指定距离处的-M-值"><a href="#获取沿多部分的指定距离处的-M-值" class="headerlink" title="获取沿多部分的指定距离处的 M 值"></a>获取沿多部分的指定距离处的 M 值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,-3],[-2000,-2000,-2]],[[-2000,-2000,1],[-2000,1000,2]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline has 2 parts</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> m1, m2;</span><br><span class="line">GeometryEngine.Instance.GetMsAtDistance(polyline, <span class="number">0</span>, AsRatioOrLength.AsLength, <span class="keyword">out</span> m1, <span class="keyword">out</span> m2);</span><br><span class="line"><span class="comment">// m1 = -3</span></span><br><span class="line"><span class="comment">// m2 = NaN</span></span><br><span class="line"></span><br><span class="line">GeometryEngine.Instance.GetMsAtDistance(polyline, <span class="number">500</span>, AsRatioOrLength.AsLength, <span class="keyword">out</span> m1, <span class="keyword">out</span> m2);</span><br><span class="line"><span class="comment">// m1 = -2.5</span></span><br><span class="line"><span class="comment">// m2 = NaN</span></span><br><span class="line"></span><br><span class="line">GeometryEngine.Instance.GetMsAtDistance(polyline, <span class="number">1000</span>, AsRatioOrLength.AsLength, <span class="keyword">out</span> m1, <span class="keyword">out</span> m2);</span><br><span class="line"><span class="comment">// m1 = -2</span></span><br><span class="line"><span class="comment">// m2 = 1     // m2 has a value because distance 1000 is at the end of the first part, beginning of the second part</span></span><br></pre></td></tr></table></figure>

<h3 id="将-M-值设置为从多部分开始的累积长度-SetMsAsDistance"><a href="#将-M-值设置为从多部分开始的累积长度-SetMsAsDistance" class="headerlink" title="将 M 值设置为从多部分开始的累积长度 - SetMsAsDistance"></a>将 M 值设置为从多部分开始的累积长度 - SetMsAsDistance</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;rings\&quot;:[[[0,0],[0,3000],[4000,3000],[4000,0],[0,0]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polygon polygon = PolygonBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">Polygon outPolygon = GeometryEngine.Instance.SetMsAsDistance(polygon, AsRatioOrLength.AsLength) <span class="keyword">as</span> Polygon;</span><br><span class="line">ReadOnlyPointCollection outPoints = outPolygon.Points;</span><br><span class="line"><span class="comment">// outPoints M values are &#123; 0, 3000, 7000, 10000, 14000 &#125;;</span></span><br></pre></td></tr></table></figure>

<h3 id="在给定距离处插入-M-值-插入距离"><a href="#在给定距离处插入-M-值-插入距离" class="headerlink" title="在给定距离处插入 M 值 - 插入距离"></a>在给定距离处插入 M 值 - 插入距离</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,-3],[-2000,-2000,-2],[-1000,-2000,null]]]&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"><span class="built_in">bool</span> splitHappened;</span><br><span class="line"><span class="built_in">int</span> partIndex, segmentIndex;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A point already exists at the given distance</span></span><br><span class="line"><span class="built_in">double</span> m = <span class="number">-1</span>;</span><br><span class="line"><span class="built_in">double</span> distance = <span class="number">2000</span>;</span><br><span class="line"><span class="built_in">bool</span> createNewPart = <span class="literal">false</span>;</span><br><span class="line">Polyline outputPolyline = GeometryEngine.Instance.InsertMAtDistance(polyline, m, distance, AsRatioOrLength.AsLength, createNewPart, <span class="keyword">out</span> splitHappened, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex) <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitHappened = false, partIndex = 0, segmentIndex = 2</span></span><br><span class="line"><span class="comment">// outputPolyline.Points[2].M = -1</span></span><br><span class="line"></span><br><span class="line">json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000,-3],[-2000,-2000,-2],[-1000,-2000,-1]],[[0,0,0],[0,1000,0],[0,2000,2]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// A point already exists at the given distance, but createNewPart = true</span></span><br><span class="line">m = <span class="number">1</span>;</span><br><span class="line">distance = <span class="number">3000</span>;</span><br><span class="line">createNewPart = <span class="literal">true</span>;</span><br><span class="line">outputPolyline = GeometryEngine.Instance.InsertMAtDistance(polyline, m, distance, AsRatioOrLength.AsLength, createNewPart, <span class="keyword">out</span> splitHappened, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="built_in">string</span> outputJson = outputPolyline.ToJson();</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitHappened = true, partIndex = 2, segmentIndex = 0</span></span><br><span class="line"><span class="comment">// outputJson = &#123;&quot;hasM&quot;:true,&quot;paths&quot;:[[[-3000,-2000,-3],[-2000,-2000,-2],[-1000,-2000,-1]],[[0,0,0],[0,1000,1]],[[0,1000,1],[0,2000,2]]]&#125;&#125;</span></span><br><span class="line"><span class="comment">// A new part has been created and the M values for outputPolyline.Points[4] and outputPolyline.Points[5] have been modified</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// A point does not exist at the given distance</span></span><br><span class="line">m = <span class="number">1</span>;</span><br><span class="line">distance = <span class="number">3500</span>;</span><br><span class="line">createNewPart = <span class="literal">false</span>;</span><br><span class="line">outputPolyline = GeometryEngine.Instance.InsertMAtDistance(polyline, m, distance, AsRatioOrLength.AsLength, createNewPart, <span class="keyword">out</span> splitHappened, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex) <span class="keyword">as</span> Polyline;</span><br><span class="line">outputJson = outputPolyline.ToJson();</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitHappened = true even though createNewPart = false because a new point was created</span></span><br><span class="line"><span class="comment">// partIndex = 1, segmentIndex = 2</span></span><br><span class="line"><span class="comment">// outputJson = &#123;&quot;hasM&quot;:true,&quot;paths&quot;:[[[-3000,-2000,-3],[-2000,-2000,-2],[-1000,-2000,-1]],[[0,0,0],[0,1000,0],[0,1500,1],[0,2000,2]]]&#125;</span></span><br><span class="line"><span class="comment">// A new point has been inserted (0, 1500, 1) by interpolating the X and Y coordinates and M value set to the input M value.</span></span><br></pre></td></tr></table></figure>

<h3 id="使用输入点的-M-值校准-M-值-CalibrateByMs"><a href="#使用输入点的-M-值校准-M-值-CalibrateByMs" class="headerlink" title="使用输入点的 M 值校准 M 值 - CalibrateByMs"></a>使用输入点的 M 值校准 M 值 - CalibrateByMs</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[0,0,-1],[1,0,0],[1,1,1],[1,2,2],[3,1,3],[5,3,4],[9,5,5],[7,6,6]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Interpolate using points (0, 0, 17), (1, 0, 42), (7, 6, 18) </span></span><br><span class="line">List&lt;MapPoint&gt; updatePoints = <span class="keyword">new</span> List&lt;MapPoint&gt;(<span class="number">3</span>);</span><br><span class="line">MapPointBuilderEx builder = <span class="keyword">new</span> MapPointBuilderEx(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">builder.M = <span class="number">17</span>;</span><br><span class="line">updatePoints.Add(builder.ToGeometry() <span class="keyword">as</span> MapPoint);</span><br><span class="line"></span><br><span class="line">builder.X = <span class="number">1</span>;</span><br><span class="line">builder.M = <span class="number">42</span>;</span><br><span class="line">updatePoints.Add(builder.ToGeometry() <span class="keyword">as</span> MapPoint);</span><br><span class="line"></span><br><span class="line">builder.X = <span class="number">7</span>;</span><br><span class="line">builder.Y = <span class="number">6</span>;</span><br><span class="line">builder.M = <span class="number">18</span>;</span><br><span class="line">updatePoints.Add(builder.ToGeometry() <span class="keyword">as</span> MapPoint);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Calibrate all the points in the polyline</span></span><br><span class="line"><span class="built_in">double</span> cutOffDistance = polyline.Length;</span><br><span class="line"></span><br><span class="line">Polyline updatedPolyline = GeometryEngine.Instance.CalibrateByMs(polyline, updatePoints, UpdateMMethod.Interpolate, cutOffDistance) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// The points in the updated polyline are</span></span><br><span class="line"><span class="comment">// (0, 0, 17 ), ( 1, 0, 42 ), ( 1, 1, 38 ), ( 1, 2, 34 ), ( 3, 1, 30 ), ( 5, 3, 26 ), ( 9, 5, 22 ), ( 7, 6, 18 )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ExtrapolateBefore using points (1, 2, 42), (9, 5, 18)</span></span><br><span class="line">builder.X = <span class="number">1</span>;</span><br><span class="line">builder.Y = <span class="number">2</span>;</span><br><span class="line">builder.M = <span class="number">42</span>;</span><br><span class="line">updatePoints[<span class="number">0</span>] = builder.ToGeometry() <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line">builder.X = <span class="number">9</span>;</span><br><span class="line">builder.Y = <span class="number">5</span>;</span><br><span class="line">builder.M = <span class="number">18</span>;</span><br><span class="line">updatePoints[<span class="number">1</span>] = builder.ToGeometry() <span class="keyword">as</span> MapPoint;</span><br><span class="line"></span><br><span class="line">updatePoints.RemoveAt(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">updatedPolyline = GeometryEngine.Instance.CalibrateByMs(polyline, updatePoints, UpdateMMethod.ExtrapolateBefore, cutOffDistance) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// The points in the updated polyline are</span></span><br><span class="line"><span class="comment">// ( 0, 0, 66 ), ( 1, 0, 58 ), ( 1, 1, 50 ), ( 1, 2, 42 ), ( 3, 1, 3 ), ( 5, 3, 4 ), ( 9, 5, 18 ), ( 7, 6, 6 )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ExtrapolateAfter using points (0, 0, 17), (1, 2, 42)</span></span><br><span class="line">builder.X = <span class="number">0</span>;</span><br><span class="line">builder.Y = <span class="number">0</span>;</span><br><span class="line">builder.M = <span class="number">17</span>;</span><br><span class="line">updatePoints.Insert(<span class="number">0</span>, builder.ToGeometry() <span class="keyword">as</span> MapPoint);</span><br><span class="line"></span><br><span class="line">updatePoints.RemoveAt(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">updatedPolyline = GeometryEngine.Instance.CalibrateByMs(polyline, updatePoints, UpdateMMethod.ExtrapolateAfter, cutOffDistance) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// The points in the updated polyline are</span></span><br><span class="line"><span class="comment">// ( 0, 0, 17 ), ( 1, 0, 0 ), ( 1, 1, 1 ), ( 1, 2, 42 ), ( 3, 1, 50.333333333333333 ), ( 5, 3, 58.666666666666671 ), ( 9, 5, 67 ), ( 7, 6, 75.333333333333343 )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ExtrapolateAfter and Interpolate using points (0, 0, 17), (1, 2, 42)</span></span><br><span class="line">updatedPolyline = GeometryEngine.Instance.CalibrateByMs(polyline, updatePoints, UpdateMMethod.ExtrapolateAfter | UpdateMMethod.Interpolate, cutOffDistance) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// The points in the updated polyline are</span></span><br><span class="line"><span class="comment">// (0,0,17),(1,0,25.333333333333336),(1,1,33.666666666666671),(1,2,42),(3,1,50.333333333333336),(5,3,58.666666666666671),(9,5,67),(7,6,75.333333333333343)</span></span><br></pre></td></tr></table></figure>

<h3 id="通过对一系列点进行线性插值生成-M-值-插值MsBetween"><a href="#通过对一系列点进行线性插值生成-M-值-插值MsBetween" class="headerlink" title="通过对一系列点进行线性插值生成 M 值 - 插值MsBetween"></a>通过对一系列点进行线性插值生成 M 值 - 插值MsBetween</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[0,0,-1],[1,0,0],[1,1,1],[1,2,2],[3,1,3],[5,3,4],[9,5,5],[7,6,6]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:4326&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Interpolate between points 2 and 6</span></span><br><span class="line">Polyline outPolyline = GeometryEngine.Instance.InterpolateMsBetween(polyline, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// The points of the output polyline are</span></span><br><span class="line"><span class="comment">// (0, 0, -1), (1, 0, 0), (1, 1, 1), (1, 2, 1.3796279833912741), (3, 1, 2.2285019604153242), (5, 3, 3.3022520459518998), (9, 5, 5), (7, 6, 6)</span></span><br></pre></td></tr></table></figure>

<h3 id="在几何图形的开头和结尾设置-Ms，并在两个值之间插值-M-值-SetAndIntervalateMsBetween"><a href="#在几何图形的开头和结尾设置-Ms，并在两个值之间插值-M-值-SetAndIntervalateMsBetween" class="headerlink" title="在几何图形的开头和结尾设置 Ms，并在两个值之间插值 M 值 - SetAndIntervalateMsBetween"></a>在几何图形的开头和结尾设置 Ms，并在两个值之间插值 M 值 - SetAndIntervalateMsBetween</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;hasM\&quot;:true,\&quot;paths\&quot;:[[[-3000,-2000],[-2000,-2000],[-1000,-2000],[0,-2000],[1000,-2000],[2000,-2000],[3000,-2000],[4000,-2000]]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">Polyline outPolyline = GeometryEngine.Instance.SetAndInterpolateMsBetween(polyline, <span class="number">100</span>, <span class="number">800</span>) <span class="keyword">as</span> Polyline;</span><br><span class="line">ReadOnlyPointCollection outPoints = outPolyline.Points;</span><br><span class="line"><span class="comment">// outPoints M values are &#123; 100, 200, 300, 400, 500, 600, 700, 800 &#125;;</span></span><br></pre></td></tr></table></figure>

<h3 id="移动地图点"><a href="#移动地图点" class="headerlink" title="移动地图点"></a>移动地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>);</span><br><span class="line">MapPoint ptResult = GeometryEngine.Instance.Move(pt, <span class="number">-3.5</span>, <span class="number">2.5</span>) <span class="keyword">as</span> MapPoint;</span><br><span class="line"><span class="comment">// ptResult is (-2.5, 5.5)</span></span><br></pre></td></tr></table></figure>

<h3 id="移动-z-感知地图点"><a href="#移动-z-感知地图点" class="headerlink" title="移动 z 感知地图点"></a>移动 z 感知地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MapPoint zPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, <span class="number">2.0</span>);</span><br><span class="line">MapPoint zPtResult = GeometryEngine.Instance.Move(zPt, <span class="number">4</span>, <span class="number">0.25</span>, <span class="number">0.5</span>) <span class="keyword">as</span> MapPoint;</span><br><span class="line"><span class="comment">// zPtResult is (5.0, 3.25, 2.5);</span></span><br></pre></td></tr></table></figure>

<h3 id="移动折线"><a href="#移动折线" class="headerlink" title="移动折线"></a>移动折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">2</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"></span><br><span class="line">Geometry geometry = GeometryEngine.Instance.Move(polyline, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line">Polyline polylineResult = geometry <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// polylineResult.Points[0] = 4.0, 3.0, 3.0</span></span><br><span class="line"><span class="comment">// polylineResult.Points[1] = 6.0, 5.0, 3.0</span></span><br><span class="line"><span class="comment">// polylineResult.Points[2] = 6.0, 4.0, 3.0</span></span><br><span class="line"><span class="comment">// polylineResult.Points[3] = 7.0, 4.0, 3.0</span></span><br></pre></td></tr></table></figure>

<h3 id="移动点沿线"><a href="#移动点沿线" class="headerlink" title="移动点沿线"></a>移动点沿线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">3</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">3.0</span>));</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(line);</span><br><span class="line"><span class="built_in">bool</span> simple = GeometryEngine.Instance.IsSimpleAsFeature(polyline);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = false</span></span><br><span class="line">MapPoint pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">1.0</span>, <span class="literal">false</span>, <span class="number">0.0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt = 1.0, 3.0</span></span><br><span class="line"></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">1.0</span>, <span class="literal">false</span>, <span class="number">-1.0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt = 1.0, 4.0</span></span><br><span class="line"></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">1.0</span>, <span class="literal">false</span>, <span class="number">2.0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt = 1.0, 1.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">0.5</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt = 2.5, 3.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// move past the line</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">7</span>, <span class="literal">false</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt = 5.0, 3.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// move past the line with extension at &quot;to&quot; point</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">7</span>, <span class="literal">false</span>, <span class="number">0</span>, SegmentExtensionType.ExtendEmbeddedAtTo);</span><br><span class="line"><span class="comment">// pt = 7.0, 3.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// negative distance with extension at &quot;from&quot; point</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">-2</span>, <span class="literal">false</span>, <span class="number">0</span>, SegmentExtensionType.ExtendEmbeddedAtFrom);</span><br><span class="line"><span class="comment">// pt = -2.0, 3.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">0.5</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt = 2.5, 3.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// line with Z</span></span><br><span class="line">List&lt;Coordinate3D&gt; coords3D = <span class="keyword">new</span> List&lt;Coordinate3D&gt; &#123; <span class="keyword">new</span> Coordinate3D(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">1113195</span>, <span class="number">1118890</span>, <span class="number">5000</span>) &#125;;</span><br><span class="line">Polyline polylineZ = PolylineBuilderEx.CreatePolyline(coords3D, SpatialReferences.WebMercator);</span><br><span class="line"><span class="comment">// polylineZ.HasZ = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true, no offset</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polylineZ, <span class="number">0.5</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt.X = 556597.5</span></span><br><span class="line"><span class="comment">// pt.Y = 559445</span></span><br><span class="line"><span class="comment">// pt.Z = 2500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true, past the line with &quot;to&quot; extension, no offset</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polylineZ, <span class="number">1.5</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.ExtendEmbeddedAtTo);</span><br><span class="line"><span class="comment">// pt.X = 1669792.5</span></span><br><span class="line"><span class="comment">// pt.Y = 1678335</span></span><br><span class="line"><span class="comment">// pt.Z = 7500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true, negative distance past the line with no extension, no offset</span></span><br><span class="line">pt = GeometryEngine.Instance.MovePointAlongLine(polylineZ, <span class="number">-1.5</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pt.X = 0</span></span><br><span class="line"><span class="comment">// pt.Y = 0</span></span><br><span class="line"><span class="comment">// pt.Z = -7500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline with Z but 2d distance = 0</span></span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>, <span class="number">0</span>);</span><br><span class="line">MapPoint pt4 = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; pt3, pt4 &#125;;</span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"><span class="comment">// polyline.HasZ = true</span></span><br><span class="line"><span class="comment">// polyline.Length3D = 10</span></span><br><span class="line"><span class="comment">// polyline.Length = 0</span></span><br><span class="line"></span><br><span class="line">MapPoint result = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">2</span>, <span class="literal">false</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// result = 5, 5, 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline with length2d = 0 and length3d = 0</span></span><br><span class="line">MapPoint pt5 = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">MapPoint pt6 = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">pts.Clear();</span><br><span class="line">pts.Add(pt5);</span><br><span class="line">pts.Add(pt6);</span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"><span class="comment">// polyline.HasZ = true</span></span><br><span class="line"><span class="comment">// polyline.Length3D = 0</span></span><br><span class="line"><span class="comment">// polyline.Length = 0</span></span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">3</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// result = 5, 5, 10</span></span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.MovePointAlongLine(polyline, <span class="number">3</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.ExtendEmbeddedAtFrom);</span><br><span class="line"><span class="comment">// result = 5, 5, 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline with Z and M</span></span><br><span class="line">List&lt;MapPoint&gt; inputPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>),</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">2</span>, <span class="number">33</span>, <span class="number">44</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polylineZM = PolylineBuilderEx.CreatePolyline(inputPoints, SpatialReferences.WGS84);</span><br><span class="line"><span class="comment">// polylineZM.HasZ = true</span></span><br><span class="line"><span class="comment">// polylineZM.HasM = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true, no offset</span></span><br><span class="line">MapPoint pointAlong = GeometryEngine.Instance.MovePointAlongLine(polylineZM, <span class="number">0.5</span>, <span class="literal">true</span>, <span class="number">0</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pointAlong = 1, 2, 18, 24</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ratio = true with offset</span></span><br><span class="line">pointAlong = GeometryEngine.Instance.MovePointAlongLine(polylineZM, <span class="number">0.2</span>, <span class="literal">true</span>, <span class="number">2.23606797749979</span>, SegmentExtensionType.NoExtension);</span><br><span class="line"><span class="comment">// pointAlong = 1, 2, 9, 12</span></span><br></pre></td></tr></table></figure>

<h3 id="将几何体的组件分离为单个组件几何图形"><a href="#将几何体的组件分离为单个组件几何图形" class="headerlink" title="将几何体的组件分离为单个组件几何图形"></a>将几何体的组件分离为单个组件几何图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; coords2D = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">4</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">7</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">-10</span>, <span class="number">3</span>)</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(coords2D, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">IReadOnlyList&lt;Geometry&gt; result = GeometryEngine.Instance.MultipartToSinglePart(multipoint);</span><br><span class="line"><span class="comment">// result.Count = 4, </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// &#x27;explode&#x27; a multipart polygon</span></span><br><span class="line">result = GeometryEngine.Instance.MultipartToSinglePart(multipartPolygon);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// create a bag of geometries</span></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coords2D, SpatialReferences.WGS84);</span><br><span class="line"><span class="comment">//At 2.x - GeometryBag bag = GeometryBagBuilder.CreateGeometryBag(new List&lt;Geometry&gt;() &#123; multipoint, polygon &#125;);</span></span><br><span class="line"><span class="keyword">var</span> bag = GeometryBagBuilderEx.CreateGeometryBag(<span class="keyword">new</span> List&lt;Geometry&gt;() &#123; multipoint, polygon &#125;);</span><br><span class="line"><span class="comment">// bag.PartCount = =2</span></span><br><span class="line"></span><br><span class="line">result = GeometryEngine.Instance.MultipartToSinglePart(bag);</span><br><span class="line"><span class="comment">// result.Count == 2</span></span><br><span class="line"><span class="comment">// result[0] is MultiPoint</span></span><br><span class="line"><span class="comment">// result[1] is Polygon</span></span><br></pre></td></tr></table></figure>

<h3 id="最近点与最近顶点"><a href="#最近点与最近顶点" class="headerlink" title="最近点与最近顶点"></a>最近点与最近顶点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>, sr);</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">-4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">-4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coords);</span><br><span class="line"></span><br><span class="line"><span class="comment">// find the nearest point in the polygon geomtry to the pt</span></span><br><span class="line">ProximityResult result = GeometryEngine.Instance.NearestPoint(polygon, pt);</span><br><span class="line"><span class="comment">// result.Point = 5, 1</span></span><br><span class="line"><span class="comment">// result.SegmentIndex = 3</span></span><br><span class="line"><span class="comment">// result.PartIndex = 0</span></span><br><span class="line"><span class="comment">// result.PointIndex = null</span></span><br><span class="line"><span class="comment">//result.Distance = 4</span></span><br><span class="line"><span class="comment">//result.RightSide = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// find the nearest vertex in the polgyon geometry to the pt</span></span><br><span class="line">result = GeometryEngine.Instance.NearestVertex(polygon, pt);</span><br><span class="line"><span class="comment">// result.Point = 10, 1</span></span><br><span class="line"><span class="comment">// result.PointIndex = 0</span></span><br><span class="line"><span class="comment">// result.SegmentIndex = null</span></span><br><span class="line"><span class="comment">// result.PartIndex = 0</span></span><br><span class="line"><span class="comment">// result.Distance = Math.Sqrt(41)</span></span><br><span class="line"><span class="comment">// result.RightSide = false</span></span><br></pre></td></tr></table></figure>

<h3 id="确定-3D-中的最近点"><a href="#确定-3D-中的最近点" class="headerlink" title="确定 3D 中的最近点"></a>确定 3D 中的最近点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// test pt1 to pt2</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">ProximityResult result = GeometryEngine.Instance.NearestPoint3D(pt1, pt2);</span><br><span class="line"><span class="comment">// result.Point = 1,1,1</span></span><br><span class="line"><span class="comment">// result.Distance = Math.Sqrt(3)</span></span><br><span class="line"><span class="comment">// result.SegmentIndex = null</span></span><br><span class="line"><span class="comment">// result.PartIndex = 0</span></span><br><span class="line"><span class="comment">// result.PointIndex = 0</span></span><br><span class="line"><span class="comment">// result.RightSide = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// multipoint built from pt1, pt2.   should be closer to pt2</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(<span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; pt1, pt2 &#125;);</span><br><span class="line">result = GeometryEngine.Instance.NearestPoint3D(multipoint, pt3);</span><br><span class="line"><span class="comment">// result.Point = 2, 2, 2</span></span><br><span class="line"><span class="comment">// result.Distance = Math.Sqrt(65)</span></span><br><span class="line"><span class="comment">// result.SegmentIndex = null</span></span><br><span class="line"><span class="comment">// result.PartIndex = 1</span></span><br><span class="line"><span class="comment">// result.PointIndex = 1</span></span><br><span class="line"><span class="comment">// result.RightSide = false</span></span><br></pre></td></tr></table></figure>

<h3 id="计算与源的几何偏移"><a href="#计算与源的几何偏移" class="headerlink" title="计算与源的几何偏移"></a>计算与源的几何偏移</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MapPoint&gt; linePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">linePts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line">linePts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">10.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(linePts);</span><br><span class="line"></span><br><span class="line">Geometry g = GeometryEngine.Instance.Offset(polyline, <span class="number">10</span>, OffsetType.Square, <span class="number">0</span>);</span><br><span class="line">Polyline gResult = g <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// gResult.PointCount = 2</span></span><br><span class="line"><span class="comment">// gResult.Points[0] = (1, -9)</span></span><br><span class="line"><span class="comment">// gResult.Points[1] = (10, -9)</span></span><br><span class="line"></span><br><span class="line">g = GeometryEngine.Instance.Offset(polyline, <span class="number">-10</span>, OffsetType.Round, <span class="number">0.5</span>);</span><br><span class="line">gResult = g <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// gResult.PointCount = 2</span></span><br><span class="line"><span class="comment">// gResult.Points[0] = (1, -11</span></span><br><span class="line"><span class="comment">// gResult.Points[1] = (10, 11)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// elliptic arc curve</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Coordinate2D fromPt = <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">Coordinate2D toPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">Coordinate2D interiorPt = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>, <span class="number">1</span> + Math.Sqrt(<span class="number">2</span>) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">EllipticArcSegment circularArc = EllipticArcBuilderEx.CreateCircularArc(fromPt.ToMapPoint(), toPt.ToMapPoint(), interiorPt);</span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(circularArc);</span><br><span class="line">g = GeometryEngine.Instance.Offset(polyline, <span class="number">-0.25</span>, OffsetType.Miter, <span class="number">0.5</span>);</span><br><span class="line">gResult = g <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line">g = GeometryEngine.Instance.Offset(polyline, <span class="number">0.25</span>, OffsetType.Bevel, <span class="number">0.5</span>);</span><br><span class="line">gResult = g <span class="keyword">as</span> Polyline;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  offset for a polygon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">List&lt;MapPoint&gt; list = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">10.0</span>, <span class="number">10.0</span>, SpatialReferences.WGS84));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">10.0</span>, <span class="number">20.0</span>, SpatialReferences.WGS84));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">20.0</span>, <span class="number">20.0</span>, SpatialReferences.WGS84));</span><br><span class="line">list.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">20.0</span>, <span class="number">10.0</span>, SpatialReferences.WGS84));</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list);</span><br><span class="line"></span><br><span class="line">g = GeometryEngine.Instance.Offset(polygon, <span class="number">2</span>, OffsetType.Square, <span class="number">0</span>);</span><br><span class="line">Polygon gPolygon = g <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line">g = GeometryEngine.Instance.Offset(polygon, <span class="number">-2</span>, OffsetType.Round, <span class="number">0.3</span>);</span><br><span class="line">gPolygon = g <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line">g = GeometryEngine.Instance.Offset(polygon, <span class="number">-0.5</span>, OffsetType.Miter, <span class="number">0.6</span>);</span><br><span class="line">gPolygon = g <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="确定几何图形是否重叠"><a href="#确定几何图形是否重叠" class="headerlink" title="确定几何图形是否重叠"></a>确定几何图形是否重叠</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.25</span>, <span class="number">1.75</span>);</span><br><span class="line">MapPoint pt3 = MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">1.5</span>);</span><br><span class="line">MapPoint pt4 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// point and point overlap</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="built_in">bool</span> overlaps = GeometryEngine.Instance.Overlaps(pt1, pt2);        <span class="comment">// overlaps = false</span></span><br><span class="line">overlaps = GeometryEngine.Instance.Overlaps(pt1, pt1);             <span class="comment">// overlaps = false</span></span><br><span class="line">                                                                   <span class="comment">// Two geometries overlap if the region of their intersection is of the same dimension as the geometries involved and </span></span><br><span class="line">                                                                   <span class="comment">// is not equivalent to either of the geometries.  </span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(pt1);</span><br><span class="line">pts.Add(pt2);</span><br><span class="line">pts.Add(pt3);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts2 = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts2.Add(pt2);</span><br><span class="line">pts2.Add(pt3);</span><br><span class="line">pts2.Add(pt4);</span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// pt and line overlap</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polyline);         <span class="comment">// isSimple = true</span></span><br><span class="line">overlaps = GeometryEngine.Instance.Overlaps(polyline, pt1);                  <span class="comment">// overlaps = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// line and line</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">Polyline polyline2 = PolylineBuilderEx.CreatePolyline(pts2);</span><br><span class="line">isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polyline2);             <span class="comment">// isSimple = true</span></span><br><span class="line">overlaps = GeometryEngine.Instance.Overlaps(polyline, polyline2);            <span class="comment">// overlaps = true</span></span><br></pre></td></tr></table></figure>

<h3 id="从-WGS84-到-Web墨卡托的项目"><a href="#从-WGS84-到-Web墨卡托的项目" class="headerlink" title="从 WGS84 到 Web墨卡托的项目"></a>从 WGS84 到 Web墨卡托的项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, SpatialReferences.WGS84);</span><br><span class="line">Geometry result = GeometryEngine.Instance.Project(pt, SpatialReferences.WebMercator);</span><br><span class="line">MapPoint projectedPt = result <span class="keyword">as</span> MapPoint;</span><br></pre></td></tr></table></figure>

<h3 id="WGS84的项目"><a href="#WGS84的项目" class="headerlink" title="WGS84的项目"></a>WGS84的项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// create the polygon</span></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>, SpatialReferences.WGS84));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>, SpatialReferences.WGS84));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(pts);</span><br><span class="line"><span class="comment">// ensure it is simple</span></span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polygon);</span><br><span class="line"></span><br><span class="line"><span class="comment">// create the spatial reference to project to</span></span><br><span class="line">SpatialReference northPole = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">102018</span>);   <span class="comment">// north pole stereographic </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// project</span></span><br><span class="line">Geometry geometry = GeometryEngine.Instance.Project(polygon, northPole);</span><br></pre></td></tr></table></figure>

<h3 id="查询正常"><a href="#查询正常" class="headerlink" title="查询正常"></a>查询正常</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> json = <span class="string">&quot;&#123;\&quot;curvePaths\&quot;:[[[-13046586.8335,4036570.6796000004],&quot;</span> +</span><br><span class="line">              <span class="string">&quot;&#123;\&quot;c\&quot;:[[-13046645.107099999,4037152.5873000026],&quot;</span> +</span><br><span class="line">              <span class="string">&quot;[-13046132.776277589,4036932.1325614937]]&#125;]],\&quot;spatialReference\&quot;:&#123;\&quot;wkid\&quot;:3857&#125;&#125;&quot;</span>;</span><br><span class="line">Polyline polyline = PolylineBuilderEx.FromJson(json);</span><br><span class="line"></span><br><span class="line">EllipticArcSegment arc = polyline.Parts[<span class="number">0</span>][<span class="number">0</span>] <span class="keyword">as</span> EllipticArcSegment;</span><br><span class="line"></span><br><span class="line"><span class="comment">// No extension, distanceAlongCurve = 0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// use the polyline</span></span><br><span class="line">Polyline poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.NoExtension, <span class="number">0.5</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"><span class="comment">// or a segment</span></span><br><span class="line">LineSegment seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.NoExtension, <span class="number">0.5</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// TangentAtFrom, distanceAlongCurve = -1.2</span></span><br><span class="line">poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.ExtendTangentAtFrom, <span class="number">-1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line">seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.ExtendTangentAtFrom, <span class="number">-1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// TangentAtTo (ignored because distanceAlongCurve &lt; 0), distanceAlongCurve = -1.2</span></span><br><span class="line">poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.ExtendTangentAtTo, <span class="number">-1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line">seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.ExtendTangentAtTo, <span class="number">-1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// TangentAtTo, distanceAlongCurve = 1.2</span></span><br><span class="line">poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.ExtendTangentAtTo, <span class="number">1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line">seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.ExtendTangentAtTo, <span class="number">1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// TangentAtFrom (ignored because distanceAlongCurve &gt; 0), distanceAlongCurve = 1.2</span></span><br><span class="line">poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.ExtendTangentAtFrom, <span class="number">1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line">seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.ExtendTangentAtFrom, <span class="number">1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// EmbeddedAtTo, distanceAlongCurve = 1.2</span></span><br><span class="line">poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.ExtendEmbeddedAtTo, <span class="number">1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line">seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.ExtendEmbeddedAtTo, <span class="number">1.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// EmbeddedAtFrom, distanceAlongCurve = -0.2</span></span><br><span class="line">poly_normal = GeometryEngine.Instance.QueryNormal(polyline, SegmentExtensionType.ExtendEmbeddedAtFrom, <span class="number">-0.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br><span class="line">seg_normal = GeometryEngine.Instance.QueryNormal(arc, SegmentExtensionType.ExtendEmbeddedAtFrom, <span class="number">-0.2</span>, AsRatioOrLength.AsRatio, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<h3 id="查询点"><a href="#查询点" class="headerlink" title="查询点"></a>查询点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Horizontal line segment</span></span><br><span class="line">Coordinate2D start = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">Coordinate2D end = <span class="keyword">new</span> Coordinate2D(<span class="number">11</span>, <span class="number">1</span>);</span><br><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(start, end, sr);</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(line);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Don&#x27;t extend the segment</span></span><br><span class="line"></span><br><span class="line">MapPoint outPoint = GeometryEngine.Instance.QueryPoint(polyline, SegmentExtensionType.NoExtension, <span class="number">1.0</span>, AsRatioOrLength.AsLength);</span><br><span class="line"><span class="comment">// outPoint = (2, 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// or the segment</span></span><br><span class="line">MapPoint outPoint_seg = GeometryEngine.Instance.QueryPoint(line, SegmentExtensionType.NoExtension, <span class="number">1.0</span>, AsRatioOrLength.AsLength);</span><br><span class="line"><span class="comment">// outPoint_seg = (2, 1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Extend infinitely in both directions</span></span><br><span class="line">outPoint = GeometryEngine.Instance.QueryPoint(polyline, SegmentExtensionType.ExtendTangents, <span class="number">1.5</span>, AsRatioOrLength.AsRatio);</span><br><span class="line"><span class="comment">// outPoint = (16, 1)</span></span><br><span class="line">outPoint_seg = GeometryEngine.Instance.QueryPoint(line, SegmentExtensionType.ExtendTangents, <span class="number">1.5</span>, AsRatioOrLength.AsRatio);</span><br><span class="line"><span class="comment">// outPoint_seg = (16, 1)</span></span><br></pre></td></tr></table></figure>

<h3 id="查询点和距离"><a href="#查询点和距离" class="headerlink" title="查询点和距离"></a>查询点和距离</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Horizontal line segment</span></span><br><span class="line">List&lt;MapPoint&gt; linePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">linePts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line">linePts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">11.0</span>, <span class="number">1.0</span>, SpatialReferences.WGS84));</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(linePts);</span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polyline);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Don&#x27;t extent the segment</span></span><br><span class="line">SegmentExtensionType extension = SegmentExtensionType.NoExtension;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A point on the line segment</span></span><br><span class="line">MapPoint inPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">2</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="built_in">double</span> distanceAlongCurve, distanceFromCurve;</span><br><span class="line">LeftOrRightSide whichSide;</span><br><span class="line">AsRatioOrLength asRatioOrLength = AsRatioOrLength.AsLength;</span><br><span class="line"></span><br><span class="line">MapPoint outPoint = GeometryEngine.Instance.QueryPointAndDistance(polyline, extension, inPoint, asRatioOrLength, <span class="keyword">out</span> distanceAlongCurve, <span class="keyword">out</span> distanceFromCurve, <span class="keyword">out</span> whichSide);</span><br><span class="line"><span class="comment">// outPoint = 2, 1</span></span><br><span class="line"><span class="comment">// distanceAlongCurve = 1</span></span><br><span class="line"><span class="comment">// distanceFromCurve = 0</span></span><br><span class="line"><span class="comment">// whichSide = GeometryEngine.Instance.LeftOrRightSide.LeftSide</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Extend infinitely in both directions</span></span><br><span class="line">extension = SegmentExtensionType.ExtendTangents;</span><br><span class="line"></span><br><span class="line"><span class="comment">// A point on the left side</span></span><br><span class="line">inPoint = MapPointBuilderEx.CreateMapPoint(<span class="number">16</span>, <span class="number">6</span>, SpatialReferences.WGS84);</span><br><span class="line">asRatioOrLength = AsRatioOrLength.AsRatio;</span><br><span class="line"></span><br><span class="line">outPoint = GeometryEngine.Instance.QueryPointAndDistance(polyline, extension, inPoint, asRatioOrLength, <span class="keyword">out</span> distanceAlongCurve, <span class="keyword">out</span> distanceFromCurve, <span class="keyword">out</span> whichSide);</span><br><span class="line"><span class="comment">// outPoint = 16, 1</span></span><br><span class="line"><span class="comment">// distanceAlongCurve = 1.5</span></span><br><span class="line"><span class="comment">// distanceFromCurve = 5</span></span><br><span class="line"><span class="comment">// whichSide = GeometryEngine.Instance.LeftOrRightSide.LeftSide</span></span><br></pre></td></tr></table></figure>

<h3 id="查询切线"><a href="#查询切线" class="headerlink" title="查询切线"></a>查询切线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// No extension, distanceAlongCurve = 0.5</span></span><br><span class="line">LineSegment tangent = GeometryEngine.Instance.QueryTangent(line, SegmentExtensionType.NoExtension, <span class="number">0.5</span>, AsRatioOrLength.AsRatio, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// tangent.StartCoordinate = (0.5, 0.0)</span></span><br><span class="line"><span class="comment">// tangent.EndCoordinate = (1.5, 0.0)</span></span><br><span class="line"></span><br><span class="line">tangent = GeometryEngine.Instance.QueryTangent(line, SegmentExtensionType.NoExtension, <span class="number">1.5</span>, AsRatioOrLength.AsLength, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// tangent.StartCoordinate = (1.0, 0.0)</span></span><br><span class="line"><span class="comment">// tangent.EndCoordinate = (2.0, 0.0)</span></span><br><span class="line"></span><br><span class="line">tangent = GeometryEngine.Instance.QueryTangent(line, SegmentExtensionType.ExtendTangentAtTo, <span class="number">1.5</span>, AsRatioOrLength.AsLength, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// tangent.StartCoordinate = (1.5, 0.0)</span></span><br><span class="line"><span class="comment">// tangent.EndCoordinate = (2.5, 0.0)</span></span><br><span class="line"></span><br><span class="line">tangent = GeometryEngine.Instance.QueryTangent(line, SegmentExtensionType.ExtendTangentAtFrom, <span class="number">-1.5</span>, AsRatioOrLength.AsLength, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// tangent.StartCoordinate = (-1.5, 0.0)</span></span><br><span class="line"><span class="comment">// tangent.EndCoordinate = (-0.5, 0.0)</span></span><br><span class="line"></span><br><span class="line">tangent = GeometryEngine.Instance.QueryTangent(line, SegmentExtensionType.ExtendTangentAtFrom, <span class="number">-0.5</span>, AsRatioOrLength.AsRatio, <span class="number">1</span>);</span><br><span class="line"><span class="comment">// tangent.StartCoordinate = (-0.5, 0.0)</span></span><br><span class="line"><span class="comment">// tangent.EndCoordinate = (0.5, 0.0)</span></span><br></pre></td></tr></table></figure>

<h3 id="围绕线反射多边形"><a href="#围绕线反射多边形" class="headerlink" title="围绕线反射多边形"></a>围绕线反射多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line">Coordinate2D start = <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">Coordinate2D end = <span class="keyword">new</span> Coordinate2D(<span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">LineSegment line = LineBuilderEx.CreateLineSegment(start, end, sr);</span><br><span class="line"></span><br><span class="line">Coordinate2D[] coords = <span class="keyword">new</span> Coordinate2D[]</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">2</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coords, sr);</span><br><span class="line"></span><br><span class="line"><span class="comment">// reflect a polygon about the line</span></span><br><span class="line">Polygon reflectedPolygon = GeometryEngine.Instance.ReflectAboutLine(polygon, line) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reflectedPolygon points are </span></span><br><span class="line"><span class="comment">//    (2, -1), (4, -1), (4, 1), (2, -1)</span></span><br></pre></td></tr></table></figure>

<h3 id="确定两个几何图形之间的关系"><a href="#确定两个几何图形之间的关系" class="headerlink" title="确定两个几何图形之间的关系"></a>确定两个几何图形之间的关系</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set up some geometries</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// points</span></span><br><span class="line">MapPoint point0 = MapPointBuilderEx.CreateMapPoint(<span class="number">0</span>, <span class="number">0</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint point1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, SpatialReferences.WGS84);</span><br><span class="line">MapPoint point2 = MapPointBuilderEx.CreateMapPoint(<span class="number">-5</span>, <span class="number">5</span>, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// multipoint</span></span><br><span class="line">List&lt;MapPoint&gt; points = <span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; point0, point1, point2 &#125;;</span><br><span class="line">Multipoint multipoint = MultipointBuilderEx.CreateMultipoint(points, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon </span></span><br><span class="line">List&lt;Coordinate2D&gt; polygonCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">-10</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">10</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> Coordinate2D(<span class="number">-10</span>, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(polygonCoords, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polylines</span></span><br><span class="line">Polyline polyline1 = PolylineBuilderEx.CreatePolyline(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">-9.1</span>, <span class="number">0.1</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">9</span>)), SpatialReferences.WGS84);</span><br><span class="line">Polyline polyline2 = PolylineBuilderEx.CreatePolyline(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">-5</span>, <span class="number">5</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">5</span>)), SpatialReferences.WGS84);</span><br><span class="line">Polyline polyline3 = PolylineBuilderEx.CreatePolyline(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">2.09</span>, <span class="number">-2.04</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">10</span>)), SpatialReferences.WGS84);</span><br><span class="line">Polyline polyline4 = PolylineBuilderEx.CreatePolyline(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">-5</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">5</span>)), SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">List&lt;Segment&gt; segments = <span class="keyword">new</span> List&lt;Segment&gt;()</span><br><span class="line">&#123;</span><br><span class="line">    LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">5.05</span>, <span class="number">-2.87</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">6.35</span>, <span class="number">1.57</span>)),</span><br><span class="line">    LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">6.35</span>, <span class="number">1.57</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">4.13</span>, <span class="number">2.59</span>)),</span><br><span class="line">    LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">4.13</span>, <span class="number">2.59</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">&#125;;</span><br><span class="line">Polyline polyline5 = PolylineBuilderEx.CreatePolyline(segments, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">segments.Add(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">5</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">10</span>)));</span><br><span class="line"></span><br><span class="line">Polyline polyline6 = PolylineBuilderEx.CreatePolyline(segments, SpatialReferences.WGS84);</span><br><span class="line">Polyline polyline7 = PolylineBuilderEx.CreatePolyline(polyline5);</span><br><span class="line">Polyline polyline8 = PolylineBuilderEx.CreatePolyline(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">5</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">10</span>)), SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line">segments.Clear();</span><br><span class="line">segments.Add(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">0.6</span>, <span class="number">3.5</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">0.7</span>, <span class="number">7</span>)));</span><br><span class="line">segments.Add(LineBuilderEx.CreateLineSegment(<span class="keyword">new</span> Coordinate2D(<span class="number">0.7</span>, <span class="number">7</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">9</span>)));</span><br><span class="line"></span><br><span class="line">Polyline polyline9 = PolylineBuilderEx.CreatePolyline(segments, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="comment">// now do the Related tests</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Interior/Interior Intersects</span></span><br><span class="line"><span class="built_in">string</span> scl = <span class="string">&quot;T********&quot;</span>;</span><br><span class="line"><span class="built_in">bool</span> related = GeometryEngine.Instance.Relate(polygon, polyline1, scl);     <span class="comment">// related = true</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(point0, point1, scl);              <span class="comment">// related = false</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(point0, multipoint, scl);          <span class="comment">// related = true</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(multipoint, polygon, scl);         <span class="comment">// related = true</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(multipoint, polyline1, scl);       <span class="comment">// related = false</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(polyline2, point2, scl);           <span class="comment">// related = false</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(point1, polygon, scl);             <span class="comment">// related = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Interior/Boundary Intersects</span></span><br><span class="line">scl = <span class="string">&quot;*T*******&quot;</span>;</span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline2, scl);          <span class="comment">// related = true</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline3, scl);          <span class="comment">// related = false</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(point1, polygon, scl);             <span class="comment">// related = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Boundary/Boundary Interior intersects</span></span><br><span class="line">scl = <span class="string">&quot;***T*****&quot;</span>;</span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline4, scl);          <span class="comment">// related = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Overlaps Dim1</span></span><br><span class="line">scl = <span class="string">&quot;1*T***T**&quot;</span>;</span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline5, scl);          <span class="comment">// related = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Crosses Area/Line (LineB crosses PolygonA)</span></span><br><span class="line">scl = <span class="string">&quot;1020F1102&quot;</span>;</span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline6, scl);          <span class="comment">// related = false</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline9, scl);          <span class="comment">// related = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Boundary/Boundary Touches</span></span><br><span class="line">scl = <span class="string">&quot;F***T****&quot;</span>;</span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline7, scl);          <span class="comment">// related = false</span></span><br><span class="line">related = GeometryEngine.Instance.Relate(polygon, polyline8, scl);          <span class="comment">// related = true</span></span><br></pre></td></tr></table></figure>

<h3 id="替换多边形中的-NaN-Z"><a href="#替换多边形中的-NaN-Z" class="headerlink" title="替换多边形中的 NaN Z"></a>替换多边形中的 NaN Z</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate3D&gt; coordsZ = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1</span>, <span class="number">2</span>, <span class="built_in">double</span>.NaN),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">7</span>, <span class="number">8</span>, <span class="built_in">double</span>.NaN)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(coordsZ);</span><br><span class="line"><span class="comment">// polygon.HasZ = true</span></span><br><span class="line"></span><br><span class="line">Polygon polygonZReplaced = GeometryEngine.Instance.ReplaceNaNZs(polygon, <span class="number">-1</span>) <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// polygonZReplaced.Points[0].Z = -1</span></span><br><span class="line"><span class="comment">// polygonZReplaced.Points[1].Z = 3</span></span><br><span class="line"><span class="comment">// polygonZReplaced.Points[2].Z = -1</span></span><br></pre></td></tr></table></figure>

<h3 id="改变多边形的形状"><a href="#改变多边形的形状" class="headerlink" title="改变多边形的形状"></a>改变多边形的形状</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; polygon1Coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">-11000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1000</span>, <span class="number">-11000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1000</span>, <span class="number">-12000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">-12000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">0</span>, <span class="number">-11000</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// reshaper coordinates intersect the polygon</span></span><br><span class="line">List&lt;Coordinate2D&gt; reshaperCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1500</span>, <span class="number">-11800</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-2600</span>, <span class="number">-11800</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">102010</span>);</span><br><span class="line">Polygon polygon1 = PolygonBuilderEx.CreatePolygon(polygon1Coords, sr);</span><br><span class="line">Polyline reshaper = PolylineBuilderEx.CreatePolyline(reshaperCoords, sr);</span><br><span class="line"></span><br><span class="line">Polygon outPolygon = GeometryEngine.Instance.Reshape(polygon1, reshaper) <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// outPolygon.PartCount = 1</span></span><br><span class="line"></span><br><span class="line">ReadOnlySegmentCollection segments = outPolygon.Parts[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// segments.Count = 4</span></span><br><span class="line"><span class="comment">// outPolygon.PointCount = 5</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> json = GeometryEngine.Instance.ExportToJson(JsonExportFlags.JsonExportSkipCRS, outPolygon);</span><br><span class="line"><span class="comment">// json = &quot;&#123;\&quot;rings\&quot;:[[[0,-11800],[0,-11000],[1000,-11000],[1000,-11800],[0,-11800]]]&#125;&quot;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// example where the Reshaper polyline doesn&#x27;t intersect the input</span></span><br><span class="line"></span><br><span class="line">reshaperCoords.Clear();</span><br><span class="line">reshaperCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1000</span>, <span class="number">1000</span>));</span><br><span class="line">reshaperCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2000</span>, <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">reshaper = PolylineBuilderEx.CreatePolyline(reshaperCoords, sr);</span><br><span class="line"></span><br><span class="line">outPolygon = GeometryEngine.Instance.Reshape(polygon1, reshaper) <span class="keyword">as</span> Polygon;</span><br><span class="line"><span class="comment">// outPolygon = null</span></span><br></pre></td></tr></table></figure>

<h3 id="反转多边形中点的顺序"><a href="#反转多边形中点的顺序" class="headerlink" title="反转多边形中点的顺序"></a>反转多边形中点的顺序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; list2D = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(list2D);</span><br><span class="line"></span><br><span class="line">Geometry g = GeometryEngine.Instance.ReverseOrientation(polygon);</span><br><span class="line">Polygon gPolygon = g <span class="keyword">as</span> Polygon;</span><br><span class="line"></span><br><span class="line"><span class="comment">// gPolygon.Points[0] = 1.0, 1.0</span></span><br><span class="line"><span class="comment">// gPolygon.Points[1] = 2.0, 1.0</span></span><br><span class="line"><span class="comment">// gPolygon.Points[2] = 2.0, 2.0</span></span><br><span class="line"><span class="comment">// gPolygon.Points[3] = 1.0, 2.0</span></span><br><span class="line"><span class="comment">// gPolygon.Points[4] = 1.0, 1.0</span></span><br><span class="line"><span class="comment">// gPolygon.Area = -1 * polygon.Area</span></span><br></pre></td></tr></table></figure>

<h3 id="旋转地图点"><a href="#旋转地图点" class="headerlink" title="旋转地图点"></a>旋转地图点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>);</span><br><span class="line">MapPoint rotatePt = MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>);</span><br><span class="line"></span><br><span class="line">Geometry result = GeometryEngine.Instance.Rotate(pt, rotatePt, Math.PI / <span class="number">2</span>);</span><br><span class="line"><span class="comment">// result point is (3, 1)</span></span><br></pre></td></tr></table></figure>

<h3 id="旋转折线"><a href="#旋转折线" class="headerlink" title="旋转折线"></a>旋转折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// rotate a polyline</span></span><br><span class="line"></span><br><span class="line">MapPoint fixedPt = MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">3.0</span>);</span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">5.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">5.0</span>, <span class="number">1.0</span>));</span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"></span><br><span class="line">Polyline rotated = GeometryEngine.Instance.Rotate(polyline, fixedPt, Math.PI / <span class="number">4</span>) <span class="keyword">as</span> Polyline;  <span class="comment">// rotate 45 deg</span></span><br></pre></td></tr></table></figure>

<h3 id="缩放几何图形"><a href="#缩放几何图形" class="headerlink" title="缩放几何图形"></a>缩放几何图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line">MapPoint midPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line"><span class="comment">// polyline.Length = 6</span></span><br><span class="line"><span class="comment">// polyline.Length3D = 0</span></span><br><span class="line">Geometry g = GeometryEngine.Instance.Scale(polyline, midPt, <span class="number">0.5</span>, <span class="number">0.5</span>);</span><br><span class="line">Polyline resultPolyline = g <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// resultPolyline.length  = 3</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[0] = 1.25, 1.25, 3</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[1] = 1.25, 2.25, 3</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[2] = 2.25, 2.25, 3</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[3] = 2.25, 1.25, 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3D point - scale in 3d</span></span><br><span class="line">MapPoint midPtZ = MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>, <span class="number">1</span>);</span><br><span class="line">g = GeometryEngine.Instance.Scale(polyline, midPtZ, <span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.25</span>);</span><br><span class="line">resultPolyline = g <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// resultPolyline.Points[0] = 1.25, 1.25, 1.5</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[1] = 1.25, 2.25, 1.5</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[2] = 2.25, 2.25, 1.5</span></span><br><span class="line"><span class="comment">// resultPolyline.Points[3] = 2.25, 1.25, 1.5</span></span><br></pre></td></tr></table></figure>

<h3 id="设置折线中的所有-Z"><a href="#设置折线中的所有-Z" class="headerlink" title="设置折线中的所有 Z"></a>设置折线中的所有 Z</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate3D&gt; coordsZ = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">7</span>, <span class="number">8</span>, <span class="built_in">double</span>.NaN)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coordsZ);</span><br><span class="line"><span class="comment">// polyline.HasZ = true</span></span><br><span class="line"></span><br><span class="line">Polyline polylineSetZ = GeometryEngine.Instance.SetConstantZ(polyline, <span class="number">-1</span>) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// polylineSetZ.Points[0].Z = -1</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[1].Z = -1</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[2].Z = -1</span></span><br><span class="line"></span><br><span class="line">polylineSetZ = GeometryEngine.Instance.SetConstantZ(polyline, <span class="built_in">double</span>.NaN) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// polyline.HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[0].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[0].Z = NaN</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[1].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[1].Z = NaN</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[2].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[2].Z = NaN</span></span><br><span class="line"></span><br><span class="line">polylineSetZ = GeometryEngine.Instance.SetConstantZ(polyline, <span class="built_in">double</span>.PositiveInfinity) <span class="keyword">as</span> Polyline;</span><br><span class="line"><span class="comment">// polyline.HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[0].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[0].Z = double.PositiveInfinity</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[1].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[1].Z = double.PositiveInfinity</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[2].HasZ = true</span></span><br><span class="line"><span class="comment">// polylineSetZ.Points[2].Z = double.PositiveInfinity</span></span><br></pre></td></tr></table></figure>

<h3 id="计算地球椭球体表面上的几何面积-形状保存面积"><a href="#计算地球椭球体表面上的几何面积-形状保存面积" class="headerlink" title="计算地球椭球体表面上的几何面积 - 形状保存面积"></a>计算地球椭球体表面上的几何面积 - 形状保存面积</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pt</span></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, SpatialReferences.WebMercator);</span><br><span class="line"><span class="built_in">double</span> area = GeometryEngine.Instance.ShapePreservingArea(pt);         <span class="comment">// area = 0</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// multipoint</span></span><br><span class="line">Multipoint mPt = MultipointBuilderEx.CreateMultipoint(pts);</span><br><span class="line">area = GeometryEngine.Instance.ShapePreservingArea(mPt);               <span class="comment">// area = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(pts);</span><br><span class="line">area = GeometryEngine.Instance.ShapePreservingArea(polyline);          <span class="comment">// area = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon</span></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(pts, SpatialReferences.WGS84);</span><br><span class="line">area = GeometryEngine.Instance.ShapePreservingArea(polygon);</span><br><span class="line"></span><br><span class="line">polygon = PolygonBuilderEx.CreatePolygon(pts, SpatialReferences.WebMercator);</span><br><span class="line">area = GeometryEngine.Instance.ShapePreservingArea(polygon);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">polygon = PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint( <span class="number">-170</span>, <span class="number">45</span>),</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint( <span class="number">170</span>, <span class="number">45</span>),</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint( <span class="number">170</span>, <span class="number">-45</span>),</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint( <span class="number">-170</span>, <span class="number">-54</span>)</span><br><span class="line">&#125;, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> area_meters = GeometryEngine.Instance.ShapePreservingArea(polygon);<span class="comment">// , AreaUnits.SquareMeters);</span></span><br><span class="line"><span class="keyword">var</span> area_miles = GeometryEngine.Instance.ShapePreservingArea(polygon, AreaUnit.SquareMiles);</span><br><span class="line"></span><br><span class="line"><span class="comment">// area_meters - 352556425383104.37</span></span><br><span class="line"><span class="comment">// area_miles - 136122796.848425</span></span><br></pre></td></tr></table></figure>

<h3 id="计算地球椭球体表面几何形状的长度-形状保存长度"><a href="#计算地球椭球体表面几何形状的长度-形状保存长度" class="headerlink" title="计算地球椭球体表面几何形状的长度 - 形状保存长度"></a>计算地球椭球体表面几何形状的长度 - 形状保存长度</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pt</span></span><br><span class="line">MapPoint pt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, SpatialReferences.WebMercator);</span><br><span class="line"><span class="built_in">double</span> len = GeometryEngine.Instance.ShapePreservingLength(pt);          <span class="comment">// len = 0</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">3.0</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">3</span>, <span class="number">3.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">1.0</span>, <span class="number">3.0</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// multipoint</span></span><br><span class="line">Multipoint mPt = MultipointBuilderEx.CreateMultipoint(pts);</span><br><span class="line">len = GeometryEngine.Instance.ShapePreservingLength(mPt);                <span class="comment">// len = 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// polyline</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(pts, SpatialReferences.WGS84);</span><br><span class="line">len = GeometryEngine.Instance.ShapePreservingLength(polyline);</span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon</span></span><br><span class="line">Polygon polygon = PolygonBuilderEx.CreatePolygon(pts, SpatialReferences.WGS84);</span><br><span class="line">len = GeometryEngine.Instance.ShapePreservingLength(polygon);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span>[]</span><br><span class="line">&#123;</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint( <span class="number">-170</span>, <span class="number">0</span>),</span><br><span class="line">    MapPointBuilderEx.CreateMapPoint( <span class="number">170</span>, <span class="number">0</span>)</span><br><span class="line">&#125;, SpatialReferences.WGS84);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> length_meters = GeometryEngine.Instance.ShapePreservingLength(polyline); <span class="comment">// , LinearUnits.Meters);</span></span><br><span class="line"><span class="keyword">var</span> length_miles = GeometryEngine.Instance.ShapePreservingLength(polyline, LinearUnit.Miles);</span><br><span class="line"></span><br><span class="line"><span class="comment">// length_meters - 37848626.869713023</span></span><br><span class="line"><span class="comment">// length_miles - 23518.046402579574</span></span><br></pre></td></tr></table></figure>

<h3 id="侧缓冲器"><a href="#侧缓冲器" class="headerlink" title="侧缓冲器"></a>侧缓冲器</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// right side, round caps</span></span><br><span class="line">SpatialReference sr = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">102010</span>);</span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1200</span>, <span class="number">5800</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1400</span>, <span class="number">5800</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1400</span>, <span class="number">6000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1300</span>, <span class="number">6000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1300</span>, <span class="number">5700</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords, sr);</span><br><span class="line">Polygon output = GeometryEngine.Instance.SideBuffer(polyline, <span class="number">20</span>, LeftOrRightSide.RightSide, LineCapType.Round) <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="侧缓冲器很多"><a href="#侧缓冲器很多" class="headerlink" title="侧缓冲器很多"></a>侧缓冲器很多</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">SpatialReference spatialReference = SpatialReferenceBuilder.CreateSpatialReference(<span class="number">102010</span>);</span><br><span class="line">List&lt;Coordinate2D&gt; coordinates = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1200</span>, <span class="number">5800</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1400</span>, <span class="number">5800</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1400</span>, <span class="number">6000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1300</span>, <span class="number">6000</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1300</span>, <span class="number">5700</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline1 = PolylineBuilderEx.CreatePolyline(coordinates, spatialReference);</span><br><span class="line"></span><br><span class="line">coordinates.Clear();</span><br><span class="line">coordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1400</span>, <span class="number">6050</span>));</span><br><span class="line">coordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1600</span>, <span class="number">6150</span>));</span><br><span class="line">coordinates.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1800</span>, <span class="number">6050</span>));</span><br><span class="line"></span><br><span class="line">Polyline polyline2 = PolylineBuilderEx.CreatePolyline(coordinates, spatialReference);</span><br><span class="line">List&lt;Polyline&gt; polylines = <span class="keyword">new</span> List&lt;Polyline&gt;() &#123; polyline1, polyline2 &#125;;</span><br><span class="line">IReadOnlyList&lt;Geometry&gt; outGeometries = GeometryEngine.Instance.SideBuffer(polylines, <span class="number">10</span>, LeftOrRightSide.RightSide, LineCapType.Round);</span><br></pre></td></tr></table></figure>

<h3 id="简化多边形"><a href="#简化多边形" class="headerlink" title="简化多边形"></a>简化多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> g1 = PolygonBuilderEx.FromJson(<span class="string">&quot;&#123;\&quot;rings\&quot;: [ [ [0, 0], [10, 0], [10, 10], [0, 10] ] ] &#125;&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> result = GeometryEngine.Instance.Area(g1);      <span class="comment">// result = -100.0   - negative due to wrong ring orientation</span></span><br><span class="line">                                                    <span class="comment">// simplify it</span></span><br><span class="line"><span class="keyword">var</span> result2 = GeometryEngine.Instance.Area(GeometryEngine.Instance.SimplifyAsFeature(g1, <span class="literal">true</span>));</span><br><span class="line"><span class="comment">// result2 = 100.0  - positive due to correct ring orientation (clockwise)</span></span><br></pre></td></tr></table></figure>

<h3 id="简化具有相交、重叠的折线"><a href="#简化具有相交、重叠的折线" class="headerlink" title="简化具有相交、重叠的折线"></a>简化具有相交、重叠的折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">SpatialReference sr = SpatialReferences.WGS84;</span><br><span class="line"></span><br><span class="line"><span class="comment">// build a line that has segments that cross over each other</span></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(coords, sr);</span><br><span class="line"><span class="comment">// polyline.PartCount = 1</span></span><br><span class="line">ReadOnlyPartCollection parts = polyline.Parts;</span><br><span class="line">ReadOnlySegmentCollection segments = parts[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// segments.Count = 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//  note there is a difference between SimpleAsFeature (doesn&#x27;t detect intersections and overlaps, determines if it&#x27;s simple enough for gdb storage)</span></span><br><span class="line"><span class="comment">//  and SimplifyPolyline  (does detect intersections etc)</span></span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(polyline, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// isSimple = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// simplify it (with force = false)</span></span><br><span class="line"><span class="comment">// because it has already been deemed &#x27;simple&#x27; (previous IsSimpleAsFeature call) no detection of intersections, overlaps occur</span></span><br><span class="line">Polyline simplePolyline = GeometryEngine.Instance.SimplifyPolyline(polyline, SimplifyType.Planar, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">// simplePolyline.PartCount = 1</span></span><br><span class="line">ReadOnlyPartCollection simpleParts = simplePolyline.Parts;</span><br><span class="line">ReadOnlySegmentCollection simpleSegments = simpleParts[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// simpleSegments.Count = 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// simplify it (with force = true)</span></span><br><span class="line"><span class="comment">// detection of intersections, overlaps occur </span></span><br><span class="line">simplePolyline = GeometryEngine.Instance.SimplifyPolyline(polyline, SimplifyType.Planar, <span class="literal">true</span>);</span><br><span class="line"><span class="comment">// simplePolyline.PartCount = 3</span></span><br><span class="line">simpleParts = simplePolyline.Parts;</span><br><span class="line">simpleSegments = simpleParts[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// simpleSegments.Count = 1</span></span><br></pre></td></tr></table></figure>

<h3 id="将多边形切成相等的部分"><a href="#将多边形切成相等的部分" class="headerlink" title="将多边形切成相等的部分"></a>将多边形切成相等的部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> slices = GeometryEngine.Instance.SlicePolygonIntoEqualParts(polygon, <span class="number">3</span>, <span class="number">0</span>, SliceType.Blocks);</span><br><span class="line"><span class="comment">// slices.Count = 3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// simple polygon</span></span><br><span class="line">List&lt;Coordinate2D&gt; list2D = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">list2D.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon p = PolygonBuilderEx.CreatePolygon(list2D);</span><br><span class="line">slices = GeometryEngine.Instance.SlicePolygonIntoEqualParts(p, <span class="number">2</span>, <span class="number">0</span>, SliceType.Strips);</span><br><span class="line"></span><br><span class="line"><span class="comment">// slice[0] coordinates - (1.0, 1.0), (1.0, 1.5), (2.0, 1.5), (2.0, 1.0), (1.0, 1.0) </span></span><br><span class="line"><span class="comment">// slice[1] coordinates - (1.0, 1.5), (1.0, 2.0), (2.0, 2.0), (2.0, 1.5), (1.0, 1.5)</span></span><br><span class="line"></span><br><span class="line">slices = GeometryEngine.Instance.SlicePolygonIntoEqualParts(p, <span class="number">2</span>, Math.PI / <span class="number">4</span>, SliceType.Strips);</span><br><span class="line"></span><br><span class="line"><span class="comment">// slice[0] coordinates - (1.0, 1.0), (1.0, 2.0), (2.0, 1.0), (1.0, 1.0)</span></span><br><span class="line"><span class="comment">// slice[1] coordinates - (1.0, 2.0), (2.0, 2.0), (2.0, 1.0), (1.0, 2.0)</span></span><br></pre></td></tr></table></figure>

<h3 id="在点拆分多部分"><a href="#在点拆分多部分" class="headerlink" title="在点拆分多部分"></a>在点拆分多部分</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// define a polyline</span></span><br><span class="line">MapPoint startPointZ = MapPointBuilderEx.CreateMapPoint(<span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line">MapPoint endPointZ = MapPointBuilderEx.CreateMapPoint(<span class="number">20</span>, <span class="number">1</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">Polyline polylineZ = PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; startPointZ, endPointZ &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// define a split point</span></span><br><span class="line">MapPoint splitPointAboveLine = MapPointBuilderEx.CreateMapPoint(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> splitOccurred;</span><br><span class="line"><span class="built_in">int</span> partIndex;</span><br><span class="line"><span class="built_in">int</span> segmentIndex;</span><br><span class="line"></span><br><span class="line"><span class="comment">// split the polyline at the point.  dont project the split point onto the line, don&#x27;t create a new part</span></span><br><span class="line"><span class="keyword">var</span> splitPolyline = GeometryEngine.Instance.SplitAtPoint(polylineZ, splitPointAboveLine, <span class="literal">false</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitOccurred = true</span></span><br><span class="line"><span class="comment">// partIndex = 0</span></span><br><span class="line"><span class="comment">// segmentIndex = 1</span></span><br><span class="line"><span class="comment">// splitPolyline.PointCount = 3</span></span><br><span class="line"><span class="comment">// splitPolyline.PartCount = 1</span></span><br><span class="line"><span class="comment">// splitPolyline coordinates are (1, 1, 5), (10, 10, 10), (20, 1, 5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// split the polyline at the point.  dont project the split point onto the line, do create a new part</span></span><br><span class="line">splitPolyline = GeometryEngine.Instance.SplitAtPoint(polylineZ, splitPointAboveLine, <span class="literal">false</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitOccurred = true</span></span><br><span class="line"><span class="comment">// partIndex = 1</span></span><br><span class="line"><span class="comment">// segmentIndex = 0</span></span><br><span class="line"><span class="comment">// splitPolyline.PointCount = 4</span></span><br><span class="line"><span class="comment">// splitPolyline.PartCount = 2</span></span><br><span class="line"><span class="comment">// splitPolyline first part coordinates are (1, 1, 5), (10, 10, 10)</span></span><br><span class="line"><span class="comment">// splitPolyline second part coordinates are (10, 10, 10), (20, 1, 5)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// split the polyline at the point.  do project the split point onto the line, don&#x27;t create a new part</span></span><br><span class="line">splitPolyline = GeometryEngine.Instance.SplitAtPoint(polylineZ, splitPointAboveLine, <span class="literal">false</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitOccurred = true</span></span><br><span class="line"><span class="comment">// partIndex = 0</span></span><br><span class="line"><span class="comment">// segmentIndex = 1</span></span><br><span class="line"><span class="comment">// splitPolyline.PointCount = 3</span></span><br><span class="line"><span class="comment">// splitPolyline.PartCount = 1</span></span><br><span class="line"><span class="comment">// splitPolyline coordinates are (1, 1, 5), (10, 10, 5), (20, 1, 5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// split the polyline at the point.  do project the split point onto the line, do create a new part</span></span><br><span class="line">splitPolyline = GeometryEngine.Instance.SplitAtPoint(polylineZ, splitPointAboveLine, <span class="literal">false</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitOccurred = true</span></span><br><span class="line"><span class="comment">// partIndex = 1</span></span><br><span class="line"><span class="comment">// segmentIndex = 0</span></span><br><span class="line"><span class="comment">// splitPolyline.PointCount = 4</span></span><br><span class="line"><span class="comment">// splitPolyline.PartCount = 2</span></span><br><span class="line"><span class="comment">// splitPolyline first part coordinates are (1, 1, 5), (10, 10, 5)</span></span><br><span class="line"><span class="comment">// splitPolyline second part coordinates are (10, 10, 5), (20, 1, 5)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// try to split with a point that won&#x27;t split the line  - pt extends beyond the line</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pointAfterLine = MapPointBuilderEx.CreateMapPoint(<span class="number">50</span>, <span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">splitPolyline = GeometryEngine.Instance.SplitAtPoint(polylineZ, pointAfterLine, <span class="literal">false</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitOccurred = false</span></span><br><span class="line"><span class="comment">// ignore partIndex, sgementIndex</span></span><br><span class="line"><span class="comment">// splitPolyline is the same as polylineZ</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>  multipart polygon</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span></span></span><br><span class="line">List&lt;Coordinate3D&gt; coordsZ = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">10</span>,<span class="number">10</span>,<span class="number">5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">10</span>,<span class="number">20</span>,<span class="number">5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">20</span>,<span class="number">20</span>,<span class="number">5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">20</span>,<span class="number">10</span>,<span class="number">5</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List&lt;Coordinate3D&gt; coordsZ_2ndPart = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">30</span>,<span class="number">20</span>,<span class="number">10</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">30</span>,<span class="number">30</span>,<span class="number">10</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">35</span>,<span class="number">28</span>,<span class="number">10</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">40</span>,<span class="number">30</span>,<span class="number">10</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">40</span>,<span class="number">20</span>,<span class="number">10</span>),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> builder = <span class="keyword">new</span> PolygonBuilderEx();</span><br><span class="line">builder.HasZ = <span class="literal">true</span>;</span><br><span class="line">builder.AddPart(coordsZ);</span><br><span class="line">builder.AddPart(coordsZ_2ndPart);</span><br><span class="line"></span><br><span class="line">Polygon multipart = builder.ToGeometry();</span><br><span class="line"></span><br><span class="line"><span class="comment">// pointA is closer to the first part of the multipart - the split occurs in the first part</span></span><br><span class="line"><span class="keyword">var</span> pointA = MapPointBuilderEx.CreateMapPoint(<span class="number">22</span>, <span class="number">18</span>, <span class="number">7</span>);</span><br><span class="line"><span class="keyword">var</span> splitPolygon = GeometryEngine.Instance.SplitAtPoint(multipart, pointA, <span class="literal">false</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitPolygon.PointCount = 12</span></span><br><span class="line"><span class="comment">// splitPolygon.PartCount = 2</span></span><br><span class="line"><span class="comment">// splitPolygon first part coordinates  (10, 10, 5), (10, 20, 5), (20, 20, 5), (22, 18, 7), (20, 10, 5), (10, 10, 5)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// pointB is midPoint between the 2 parts - no split will occur</span></span><br><span class="line"><span class="keyword">var</span> pointB = MapPointBuilderEx.CreateMapPoint(<span class="number">25</span>, <span class="number">20</span>, <span class="number">7</span>);</span><br><span class="line">splitPolygon = GeometryEngine.Instance.SplitAtPoint(multipart, pointB, <span class="literal">true</span>, <span class="literal">false</span>, <span class="keyword">out</span> splitOccurred, <span class="keyword">out</span> partIndex, <span class="keyword">out</span> segmentIndex);</span><br><span class="line"></span><br><span class="line"><span class="comment">// splitOccurred = false</span></span><br><span class="line"><span class="comment">// ignore partIndex, sgementIndex</span></span><br><span class="line"><span class="comment">// splitPolyline is the same as polylineZ</span></span><br></pre></td></tr></table></figure>

<h3 id="多边形接触另一个多边形"><a href="#多边形接触另一个多边形" class="headerlink" title="多边形接触另一个多边形"></a>多边形接触另一个多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// two disjoint polygons</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">4.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">8</span>, <span class="number">8</span>));</span><br><span class="line">Polygon poly1 = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line"></span><br><span class="line">Envelope env2 = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">5</span>, <span class="number">5</span>));</span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env2);</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> touches = GeometryEngine.Instance.Touches(poly1, poly2);    <span class="comment">// touches = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// another polygon that touches the first</span></span><br><span class="line">Envelope env3 = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">4</span>, <span class="number">4</span>));</span><br><span class="line">Polygon poly3 = PolygonBuilderEx.CreatePolygon(env3);</span><br><span class="line"></span><br><span class="line">touches = GeometryEngine.Instance.Touches(poly1, poly3);         <span class="comment">// touches = true</span></span><br></pre></td></tr></table></figure>

<h3 id="转换2D"><a href="#转换2D" class="headerlink" title="转换2D"></a>转换2D</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Not all of the input points are transformed as some of them are outside of the GCS horizon.</span></span><br><span class="line">Coordinate2D[] inCoords2D = <span class="keyword">new</span> Coordinate2D[]</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-1</span>, <span class="number">-1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-2</span>, <span class="number">-5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-5</span>, <span class="number">-11</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-10</span>, <span class="number">-19</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-17</span>, <span class="number">-29</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-26</span>, <span class="number">-41</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-37</span>, <span class="number">-5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-50</span>, <span class="number">-21</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-65</span>, <span class="number">-39</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">-82</span>, <span class="number">-9</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> arraySize = inCoords2D.Length;</span><br><span class="line"></span><br><span class="line">ProjectionTransformation projTrans = ProjectionTransformation.Create(SpatialReferences.WGS84, SpatialReferenceBuilder.CreateSpatialReference(<span class="number">24891</span>));</span><br><span class="line"></span><br><span class="line">Coordinate2D[] outCoords2D = <span class="keyword">new</span> Coordinate2D[arraySize];</span><br><span class="line"></span><br><span class="line"><span class="comment">// transform and choose to remove the clipped coordinates</span></span><br><span class="line"><span class="built_in">int</span> numPointsTransformed = GeometryEngine.Instance.Transform2D(inCoords2D, projTrans, <span class="keyword">ref</span> outCoords2D, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// numPointsTransformed = 4</span></span><br><span class="line"><span class="comment">// outCoords2D.Length = 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// outCoords2D[0] = &#123;5580417.6876455201, 1328841.2376554986&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[1] = &#123;3508774.290814558, -568027.23444226268&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[2] = &#123;1568096.0886155984, -2343435.4394415971&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[3] = &#123;57325.827391741652, 1095146.8917508761&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// transform and don&#x27;t remove the clipped coordinates</span></span><br><span class="line">numPointsTransformed = GeometryEngine.Instance.Transform2D(inCoords2D, projTrans, <span class="keyword">ref</span> outCoords2D, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// numPointsTransformed = 4</span></span><br><span class="line"><span class="comment">// outCoords2D.Length = 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// outCoords2D[0] = &#123;double.Nan, double.Nan&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[1] = &#123;double.Nan, double.Nan&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[2] = &#123;double.Nan, double.Nan&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[3] = &#123;double.Nan, double.Nan&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[4] = &#123;double.Nan, double.Nan&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[5] = &#123;double.Nan, double.Nan&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[6] = &#123;5580417.6876455201, 1328841.2376554986&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[7] = &#123;3508774.290814558, -568027.23444226268&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[8] = &#123;1568096.0886155984, -2343435.4394415971&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[9] = &#123;57325.827391741652, 1095146.8917508761&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="转换3D"><a href="#转换3D" class="headerlink" title="转换3D"></a>转换3D</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Not all of the input points are transformed as some of them are outside of the GCS horizon.</span></span><br><span class="line">Coordinate3D[] inCoords3D = <span class="keyword">new</span> Coordinate3D[]</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">0</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-2</span>, <span class="number">-5</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-5</span>, <span class="number">-11</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-10</span>, <span class="number">-19</span>, <span class="number">3</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-17</span>, <span class="number">-29</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-26</span>, <span class="number">-41</span>, <span class="number">5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-37</span>, <span class="number">-5</span>, <span class="number">6</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-50</span>, <span class="number">-21</span>, <span class="number">7</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-65</span>, <span class="number">-39</span>, <span class="number">8</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">-82</span>, <span class="number">-9</span>, <span class="number">9</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> arraySize = inCoords3D.Length;</span><br><span class="line"></span><br><span class="line">ProjectionTransformation projTrans = ProjectionTransformation.Create(SpatialReferences.WGS84, SpatialReferenceBuilder.CreateSpatialReference(<span class="number">24891</span>));</span><br><span class="line"></span><br><span class="line">Coordinate3D[] outCoords3D = <span class="keyword">new</span> Coordinate3D[arraySize];</span><br><span class="line"></span><br><span class="line"><span class="comment">// transform and choose to remove the clipped coordinates</span></span><br><span class="line"><span class="built_in">int</span> numPointsTransformed = GeometryEngine.Instance.Transform3D(inCoords3D, projTrans, <span class="keyword">ref</span> outCoords3D);</span><br><span class="line"></span><br><span class="line"><span class="comment">// numPointsTransformed = 4</span></span><br><span class="line"><span class="comment">// outCoords2D.Length = 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// outCoords2D[0] = &#123;5580417.6876455201, 1328841.2376554986, 7&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[1] = &#123;3508774.290814558, -568027.23444226268, 8&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[2] = &#123;1568096.0886155984, -2343435.4394415971, 9&#125;</span></span><br><span class="line"><span class="comment">// outCoords2D[3] = &#123;57325.827391741652, 1095146.8917508761, 10&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="合并两个地图点-创建一个多点"><a href="#合并两个地图点-创建一个多点" class="headerlink" title="合并两个地图点 - 创建一个多点"></a>合并两个地图点 - 创建一个多点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MapPoint pt1 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>);</span><br><span class="line">MapPoint pt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.5</span>);</span><br><span class="line"></span><br><span class="line">Geometry geometry = GeometryEngine.Instance.Union(pt1, pt2);</span><br><span class="line">Multipoint multipoint = geometry <span class="keyword">as</span> Multipoint;   <span class="comment">// multipoint has point count of 2</span></span><br></pre></td></tr></table></figure>

<h3 id="并集两个多边形"><a href="#并集两个多边形" class="headerlink" title="并集两个多边形"></a>并集两个多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// union two polygons</span></span><br><span class="line"></span><br><span class="line">List&lt;MapPoint&gt; polyPts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">2.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">3.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">6.0</span>));</span><br><span class="line">polyPts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">6.0</span>, <span class="number">2.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon poly1 = PolygonBuilderEx.CreatePolygon(polyPts);</span><br><span class="line"><span class="built_in">bool</span> isSimple = GeometryEngine.Instance.IsSimpleAsFeature(poly1);</span><br><span class="line"></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(MapPointBuilderEx.CreateMapPoint(<span class="number">4.0</span>, <span class="number">4.0</span>), MapPointBuilderEx.CreateMapPoint(<span class="number">8</span>, <span class="number">8</span>));</span><br><span class="line">Polygon poly2 = PolygonBuilderEx.CreatePolygon(env);</span><br><span class="line">isSimple = GeometryEngine.Instance.IsSimpleAsFeature(poly2);</span><br><span class="line"></span><br><span class="line">Geometry g = GeometryEngine.Instance.Union(poly1, poly2);</span><br><span class="line">Polygon polyResult = g <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="联合许多折线"><a href="#联合许多折线" class="headerlink" title="联合许多折线"></a>联合许多折线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// union many polylines</span></span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; coords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">2</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">4</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">4</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">5</span>, <span class="number">6</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">7</span>, <span class="number">8</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">9</span>, <span class="number">10</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">11</span>, <span class="number">12</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">12</span>, <span class="number">8</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">10</span>, <span class="number">8</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">12</span>, <span class="number">12</span>), <span class="keyword">new</span> Coordinate2D(<span class="number">14</span>, <span class="number">10</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create Disjoint lines</span></span><br><span class="line">List&lt;Polyline&gt; manyLines = <span class="keyword">new</span> List&lt;Polyline&gt;</span><br><span class="line">&#123;</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">0</span>], coords[<span class="number">1</span>], coords[<span class="number">2</span>]&#125;, SpatialReferences.WGS84),</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">3</span>], coords[<span class="number">4</span>], coords[<span class="number">5</span>]&#125;),</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(<span class="keyword">new</span> List&lt;Coordinate2D&gt;()&#123;coords[<span class="number">6</span>], coords[<span class="number">7</span>], coords[<span class="number">8</span>]&#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polyline polyline = GeometryEngine.Instance.Union(manyLines) <span class="keyword">as</span> Polyline;</span><br></pre></td></tr></table></figure>

<h3 id="联合多个多边形"><a href="#联合多个多边形" class="headerlink" title="联合多个多边形"></a>联合多个多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// union many polygons</span></span><br><span class="line"></span><br><span class="line">List&lt;Coordinate3D&gt; coordsZ = <span class="keyword">new</span> List&lt;Coordinate3D&gt;()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">4</span>, <span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">7</span>, <span class="number">8</span>, <span class="number">4</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">8</span>, <span class="number">4</span>, <span class="number">5</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">9</span>, <span class="number">10</span>, <span class="number">6</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">12</span>, <span class="number">8</span>, <span class="number">8</span>),</span><br><span class="line">  <span class="keyword">new</span> Coordinate3D(<span class="number">10</span>, <span class="number">8</span>, <span class="number">9</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">12</span>, <span class="number">12</span>, <span class="number">10</span>), <span class="keyword">new</span> Coordinate3D(<span class="number">14</span>, <span class="number">10</span>, <span class="number">11</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// create polygons</span></span><br><span class="line">List&lt;Polygon&gt; manyPolygonsZ = <span class="keyword">new</span> List&lt;Polygon&gt;</span><br><span class="line">&#123;</span><br><span class="line">  PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span> List&lt;Coordinate3D&gt;()&#123;coordsZ[<span class="number">0</span>], coordsZ[<span class="number">1</span>], coordsZ[<span class="number">2</span>]&#125;, SpatialReferences.WGS84),</span><br><span class="line">  PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span> List&lt;Coordinate3D&gt;()&#123;coordsZ[<span class="number">3</span>], coordsZ[<span class="number">4</span>], coordsZ[<span class="number">5</span>]&#125;),</span><br><span class="line">  PolygonBuilderEx.CreatePolygon(<span class="keyword">new</span> List&lt;Coordinate3D&gt;()&#123;coordsZ[<span class="number">6</span>], coordsZ[<span class="number">7</span>], coordsZ[<span class="number">8</span>]&#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Polygon polygon = GeometryEngine.Instance.Union(manyPolygonsZ) <span class="keyword">as</span> Polygon;</span><br></pre></td></tr></table></figure>

<h3 id="地图点、折线、多边形内的多边形"><a href="#地图点、折线、多边形内的多边形" class="headerlink" title="地图点、折线、多边形内的多边形"></a>地图点、折线、多边形内的多边形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// build a polygon      </span></span><br><span class="line">List&lt;MapPoint&gt; pts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">1.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">1.0</span>, <span class="number">2.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">2.0</span>));</span><br><span class="line">pts.Add(MapPointBuilderEx.CreateMapPoint(<span class="number">2.0</span>, <span class="number">1.0</span>));</span><br><span class="line"></span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(pts);</span><br><span class="line"></span><br><span class="line"><span class="comment">// an inner point</span></span><br><span class="line">MapPoint innerPt = MapPointBuilderEx.CreateMapPoint(<span class="number">1.5</span>, <span class="number">1.5</span>);</span><br><span class="line"><span class="built_in">bool</span> within = GeometryEngine.Instance.Within(innerPt, poly);   <span class="comment">// within = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// point on a boundary</span></span><br><span class="line">within = GeometryEngine.Instance.Within(pts[<span class="number">0</span>], poly);     <span class="comment">// within = false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// an interior line</span></span><br><span class="line">MapPoint innerPt2 = MapPointBuilderEx.CreateMapPoint(<span class="number">1.25</span>, <span class="number">1.75</span>);</span><br><span class="line">List&lt;MapPoint&gt; innerLinePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">innerLinePts.Add(innerPt);</span><br><span class="line">innerLinePts.Add(innerPt2);</span><br><span class="line"></span><br><span class="line">Polyline polyline = PolylineBuilderEx.CreatePolyline(innerLinePts);</span><br><span class="line">within = GeometryEngine.Instance.Within(polyline, poly);   <span class="comment">// within = true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// a line that crosses the boundary</span></span><br><span class="line">MapPoint outerPt = MapPointBuilderEx.CreateMapPoint(<span class="number">3</span>, <span class="number">1.5</span>);</span><br><span class="line">List&lt;MapPoint&gt; crossingLinePts = <span class="keyword">new</span> List&lt;MapPoint&gt;();</span><br><span class="line">crossingLinePts.Add(innerPt);</span><br><span class="line">crossingLinePts.Add(outerPt);</span><br><span class="line"></span><br><span class="line">polyline = PolylineBuilderEx.CreatePolyline(crossingLinePts);</span><br><span class="line">within = GeometryEngine.Instance.Within(polyline, poly);     <span class="comment">// within = false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// polygon in polygon</span></span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(innerPt, innerPt2);</span><br><span class="line">within = GeometryEngine.Instance.Within(env, poly);      <span class="comment">// within = true</span></span><br></pre></td></tr></table></figure>

<p>e</p>
<pre><code>
</code></pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1361151272@qq.com">shaozhy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://shaoshao.net.cn/2022/12/28/20221228135428000/">https://shaoshao.net.cn/2022/12/28/20221228135428000/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://shaoshao.net.cn" target="_blank">WineMonk</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/discover/tags/CSharp/">CSharp</a><a class="post-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></div><div class="post_share"><div class="social-share" data-image="https://shaoshao.net.cn/images/blog/cover/current/post_09.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/28/20221228135620000/"><img class="prev-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_10.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ArcGIS Pro SDK 地理处理</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/28/20221228135207000/"><img class="next-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ArcGIS Pro SDK 地理数据库</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/12/28/20221228133712000/" title="ArcGIS Pro SDK 框架"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_04.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 框架</div></div></a></div><div><a href="/2022/12/28/20221228134215000/" title="ArcGIS Pro SDK 内容"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 内容</div></div></a></div><div><a href="/2022/12/28/20221228134536000/" title="ArcGIS Pro SDK 核心主机"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 核心主机</div></div></a></div><div><a href="/2022/12/28/20221228135620000/" title="ArcGIS Pro SDK 地理处理"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理处理</div></div></a></div><div><a href="/2022/12/28/20221228135207000/" title="ArcGIS Pro SDK 地理数据库"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理数据库</div></div></a></div><div><a href="/2022/12/28/20221228134946000/" title="ArcGIS Pro SDK 编辑"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 编辑</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%A0%E4%BD%95"><span class="toc-number">1.</span> <span class="toc-text">几何</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83"><span class="toc-number">1.1.</span> <span class="toc-text">空间参考</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83-%E4%BB%8E%E5%B7%B2%E7%9F%A5-ID"><span class="toc-number">1.1.1.</span> <span class="toc-text">构造空间参考 - 从已知 ID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E7%A9%BA%E9%97%B4%E5%BC%95%E7%94%A8-%E4%BB%8E%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.1.2.</span> <span class="toc-text">构造空间引用 - 从字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-WGS84-%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83"><span class="toc-number">1.1.3.</span> <span class="toc-text">使用 WGS84 空间参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9E%82%E7%9B%B4%E5%9D%90%E6%A0%87%E7%B3%BB%E6%9E%84%E9%80%A0%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83-%E4%BB%8E%E5%B7%B2%E7%9F%A5-ID"><span class="toc-number">1.1.4.</span> <span class="toc-text">使用垂直坐标系构造空间参考 - 从已知 ID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9E%82%E7%9B%B4%E5%9D%90%E6%A0%87%E7%B3%BB%E6%9E%84%E9%80%A0%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83-%E4%BB%8E%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.1.5.</span> <span class="toc-text">使用垂直坐标系构造空间参考 - 从字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89-PCS-%E6%9E%84%E9%80%A0%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83-%E4%BB%8E%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.1.6.</span> <span class="toc-text">使用自定义 PCS 构造空间参考 - 从字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.7.</span> <span class="toc-text">空间参考属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83"><span class="toc-number">1.1.8.</span> <span class="toc-text">导入和导出空间参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E7%BB%99%E5%AE%9A%E7%82%B9%E5%A4%84%E7%A9%BA%E9%97%B4%E5%8F%82%E8%80%83%E7%9A%84%E6%A0%BC%E7%BD%91%E6%94%B6%E6%95%9B"><span class="toc-number">1.1.9.</span> <span class="toc-text">确定给定点处空间参考的格网收敛</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%87%86"><span class="toc-number">1.1.10.</span> <span class="toc-text">基准</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E5%8F%82%E7%85%A7%E5%9F%BA%E5%87%86%E5%92%8C%E5%9F%BA%E5%87%86%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.11.</span> <span class="toc-text">空间参照基准和基准属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%90%E6%A0%873D"><span class="toc-number">1.2.</span> <span class="toc-text">坐标3D</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A2%E9%87%8F%E6%9E%81%E5%9D%90%E6%A0%87"><span class="toc-number">1.2.1.</span> <span class="toc-text">矢量极坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%9F%A2%E9%87%8F%E5%80%BE%E8%A7%92"><span class="toc-number">1.2.2.</span> <span class="toc-text">获取矢量倾角</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%9F%A2%E9%87%8F%E6%96%B9%E4%BD%8D%E8%A7%92"><span class="toc-number">1.2.3.</span> <span class="toc-text">获取矢量方位角</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%91%E9%87%8F%E8%BF%90%E7%AE%97"><span class="toc-number">1.2.4.</span> <span class="toc-text">向量运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2D-%E7%9F%A2%E9%87%8F%E6%93%8D%E4%BD%9C"><span class="toc-number">1.2.5.</span> <span class="toc-text">2D 矢量操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%B1%9E%E6%80%A7"><span class="toc-number">1.3.</span> <span class="toc-text">生成器属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%B1%9E%E6%80%A7-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">生成器属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.4.</span> <span class="toc-text">地图点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.4.1.</span> <span class="toc-text">构造地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E7%82%B9%E7%94%9F%E6%88%90%E5%99%A8%E5%B1%9E%E6%80%A7"><span class="toc-number">1.4.2.</span> <span class="toc-text">地图点生成器属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E7%82%B9%E6%98%AF%E5%B9%B3%E7%AD%89%E7%9A%84"><span class="toc-number">1.4.3.</span> <span class="toc-text">地图点是平等的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%A9%E6%94%BE%E8%87%B3%E6%8C%87%E5%AE%9A%E7%82%B9"><span class="toc-number">1.4.4.</span> <span class="toc-text">缩放至指定点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%98%E7%BA%BF"><span class="toc-number">1.5.</span> <span class="toc-text">折线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%8A%98%E7%BA%BF-%E4%BB%8E%E6%98%A0%E5%B0%84%E7%82%B9%E7%9A%84%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.5.1.</span> <span class="toc-text">构造折线 - 从映射点的枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8A%98%E7%BA%BF%E7%9A%84%E7%82%B9"><span class="toc-number">1.5.2.</span> <span class="toc-text">获取折线的点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8A%98%E7%BA%BF%E7%9A%84%E5%90%84%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">1.5.3.</span> <span class="toc-text">获取折线的各个部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E6%8A%98%E7%BA%BF%E7%9A%84%E5%90%84%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">1.5.4.</span> <span class="toc-text">枚举折线的各个部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E8%BD%AC%E6%8A%98%E7%BA%BF%E4%B8%AD%E7%82%B9%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.5.5.</span> <span class="toc-text">反转折线中点的顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8A%98%E7%BA%BF%E7%9A%84%E6%AE%B5"><span class="toc-number">1.5.6.</span> <span class="toc-text">获取折线的段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%A4%9A%E9%83%A8%E5%88%86%E6%8A%98%E7%BA%BF"><span class="toc-number">1.5.7.</span> <span class="toc-text">构建多部分折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%98%E7%BA%BF%E7%9A%84%E8%B5%B7%E7%82%B9"><span class="toc-number">1.5.8.</span> <span class="toc-text">折线的起点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E8%A7%92%E5%BA%A6%E6%9E%84%E9%80%A0%E5%B8%83%E6%96%99"><span class="toc-number">1.5.9.</span> <span class="toc-text">按角度构造布料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E9%95%BF%E5%BA%A6%E6%9E%84%E9%80%A0%E5%B8%83%E6%96%99"><span class="toc-number">1.5.10.</span> <span class="toc-text">按长度构造布料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9C%E8%B7%9D%E7%A6%BB%E5%88%86%E5%89%B2%E6%8A%98%E7%BA%BF"><span class="toc-number">1.5.11.</span> <span class="toc-text">远距离分割折线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.6.</span> <span class="toc-text">多边形</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%A4%9A%E8%BE%B9%E5%BD%A2-%E4%BB%8E%E6%98%A0%E5%B0%84%E7%82%B9%E7%9A%84%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.6.1.</span> <span class="toc-text">构造多边形 - 从映射点的枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%A4%9A%E8%BE%B9%E5%BD%A2-%E4%BB%8E%E4%BF%A1%E5%B0%81"><span class="toc-number">1.6.2.</span> <span class="toc-text">构造多边形 - 从信封</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E7%82%B9"><span class="toc-number">1.6.3.</span> <span class="toc-text">获取多边形的点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E5%90%84%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">1.6.4.</span> <span class="toc-text">获取多边形的各个部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%9A%E4%B8%BE%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E5%90%84%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">1.6.5.</span> <span class="toc-text">枚举多边形的各个部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E7%BA%BF%E6%AE%B5"><span class="toc-number">1.6.6.</span> <span class="toc-text">获取多边形的线段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%9C%86%E7%8E%AF%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.6.7.</span> <span class="toc-text">构建圆环多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-N-%E4%BE%A7%E6%AD%A3%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.6.8.</span> <span class="toc-text">创建 N 侧正多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E5%A4%96%E7%8E%AF-%E5%A4%9A%E8%BE%B9%E5%BD%A2%E3%80%82%E8%8E%B7%E5%8F%96%E5%A4%96%E9%83%A8%E7%8E%AF"><span class="toc-number">1.6.9.</span> <span class="toc-text">获取多边形的外环 - 多边形。获取外部环</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E5%B0%81"><span class="toc-number">1.7.</span> <span class="toc-text">信封</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%B0%81%E5%A5%97"><span class="toc-number">1.7.1.</span> <span class="toc-text">构造封套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E4%BF%A1%E5%B0%81-%E4%BB%8E-JSON-%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.7.2.</span> <span class="toc-text">构造信封 - 从 JSON 字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E4%BF%A1%E5%B0%81"><span class="toc-number">1.7.3.</span> <span class="toc-text">合并两个信封</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E%E4%B8%A4%E4%B8%AA%E4%BF%A1%E5%B0%81%E7%9B%B8%E4%BA%A4"><span class="toc-number">1.7.4.</span> <span class="toc-text">与两个信封相交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%95%E5%BC%80%E4%BF%A1%E5%B0%81"><span class="toc-number">1.7.5.</span> <span class="toc-text">展开信封</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%B0%81%E5%A5%97%E7%9A%84%E5%9D%90%E6%A0%87"><span class="toc-number">1.7.6.</span> <span class="toc-text">更新封套的坐标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E7%82%B9"><span class="toc-number">1.8.</span> <span class="toc-text">多点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%A4%9A%E7%82%B9-%E4%BB%8E%E6%98%A0%E5%B0%84%E7%82%B9%E7%9A%84%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.8.1.</span> <span class="toc-text">构造多点 - 从映射点的枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%A4%9A%E7%82%B9-%E4%BD%BF%E7%94%A8-MultipointBuilderEx"><span class="toc-number">1.8.2.</span> <span class="toc-text">构造多点 - 使用 MultipointBuilderEx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%A4%9A%E7%82%B9%E7%9A%84%E7%82%B9"><span class="toc-number">1.8.3.</span> <span class="toc-text">修改多点的点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%A4%9A%E7%82%B9%E6%A3%80%E7%B4%A2%E7%82%B9%E3%80%812D-%E5%9D%90%E6%A0%87%E3%80%813D-%E5%9D%90%E6%A0%87"><span class="toc-number">1.8.4.</span> <span class="toc-text">从多点检索点、2D 坐标、3D 坐标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%AE%B5"><span class="toc-number">1.9.</span> <span class="toc-text">线段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%A4%E4%B8%AA%E5%9C%B0%E5%9B%BE%E7%82%B9%E6%9E%84%E9%80%A0%E7%BA%BF%E6%AE%B5"><span class="toc-number">1.9.1.</span> <span class="toc-text">使用两个地图点构造线段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E7%BA%BF%E6%AE%B5%E5%9D%90%E6%A0%87"><span class="toc-number">1.9.2.</span> <span class="toc-text">更改线段坐标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AB%8B%E6%96%B9%E8%B4%9D%E5%A1%9E%E5%B0%94"><span class="toc-number">1.10.</span> <span class="toc-text">立方贝塞尔</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E4%B8%89%E6%AC%A1%E6%96%B9%E8%B4%9D%E5%A1%9E%E5%B0%94-%E4%BB%8E%E5%9D%90%E6%A0%87"><span class="toc-number">1.10.1.</span> <span class="toc-text">构建三次方贝塞尔 - 从坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E7%AB%8B%E6%96%B9%E8%B4%9D%E5%A1%9E%E5%B0%94-%E4%BB%8E%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.10.2.</span> <span class="toc-text">构建立方贝塞尔 - 从地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E4%B8%89%E6%AC%A1%E8%B4%9D%E5%A1%9E%E5%B0%94-%E4%BB%8E%E6%98%A0%E5%B0%84%E7%82%B9%E7%9A%84%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.10.3.</span> <span class="toc-text">构造三次贝塞尔 - 从映射点的枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%8B%E6%96%B9%E8%B4%9D%E5%A1%9E%E5%B0%94%E7%94%9F%E6%88%90%E5%99%A8%E5%B1%9E%E6%80%A7"><span class="toc-number">1.10.4.</span> <span class="toc-text">立方贝塞尔生成器属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AB%8B%E6%96%B9%E8%B4%9D%E5%A1%9E%E5%B0%94%E5%B1%9E%E6%80%A7"><span class="toc-number">1.10.5.</span> <span class="toc-text">立方贝塞尔属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%8A%98%E7%BA%BF-%E4%BB%8E%E4%B8%89%E6%AC%A1%E8%B4%9D%E5%A1%9E%E5%B0%94"><span class="toc-number">1.10.6.</span> <span class="toc-text">构造折线 - 从三次贝塞尔</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%A7"><span class="toc-number">1.11.</span> <span class="toc-text">弧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%9C%86%E5%BC%A7-%E4%BD%BF%E7%94%A8%E5%86%85%E9%83%A8%E7%82%B9"><span class="toc-number">1.11.1.</span> <span class="toc-text">构造圆弧 - 使用内部点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%9C%86%E5%BC%A7-%E4%BD%BF%E7%94%A8%E5%BC%A6%E9%95%BF%E5%BA%A6%E5%92%8C%E6%96%B9%E4%BD%8D"><span class="toc-number">1.11.2.</span> <span class="toc-text">构造圆弧 - 使用弦长度和方位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%9C%86%E5%BC%A7-%E4%BD%BF%E7%94%A8%E4%B8%AD%E5%BF%83%E7%82%B9%E3%80%81%E8%A7%92%E5%BA%A6%E5%92%8C%E5%8D%8A%E5%BE%84"><span class="toc-number">1.11.3.</span> <span class="toc-text">构建圆弧 - 使用中心点、角度和半径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%A4%AD%E5%9C%86%E5%BC%A7-%E4%BD%BF%E7%94%A8%E4%B8%AD%E5%BF%83%E7%82%B9%E5%92%8C%E6%97%8B%E8%BD%AC%E8%A7%92%E5%BA%A6"><span class="toc-number">1.11.4.</span> <span class="toc-text">构造椭圆弧 - 使用中心点和旋转角度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%9C%86%E5%BC%A7-%E4%BD%BF%E7%94%A8%E4%B8%AD%E5%BF%83%E7%82%B9%E5%92%8C%E6%96%B9%E5%90%91"><span class="toc-number">1.11.5.</span> <span class="toc-text">构造圆弧 - 使用中心点和方向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%9C%86%E5%BC%A7-%E4%BD%BF%E7%94%A8%E4%B8%A4%E4%B8%AA%E7%BA%BF%E6%AE%B5%E5%92%8C%E5%8D%8A%E5%BE%84"><span class="toc-number">1.11.6.</span> <span class="toc-text">构造圆弧 - 使用两个线段和半径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E4%B8%80%E4%B8%AA%E5%9C%86"><span class="toc-number">1.11.7.</span> <span class="toc-text">构造一个圆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%A4%AD%E5%9C%86"><span class="toc-number">1.11.8.</span> <span class="toc-text">构造椭圆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Elliptic-Arc-Builder-Properties"><span class="toc-number">1.11.9.</span> <span class="toc-text">Elliptic Arc Builder Properties</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A4%AD%E5%9C%86%E5%BC%A7%E5%B1%9E%E6%80%A7"><span class="toc-number">1.11.10.</span> <span class="toc-text">椭圆弧属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%A0%E4%BD%95%E8%A2%8B"><span class="toc-number">1.12.</span> <span class="toc-text">几何袋</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%A0%E4%BD%95%E5%8C%85"><span class="toc-number">1.12.1.</span> <span class="toc-text">构造几何包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%A0%E4%BD%95%E5%8C%85-%E4%BB%8E%E5%87%A0%E4%BD%95%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.12.2.</span> <span class="toc-text">构造几何包 - 从几何枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ConstructingGeometryBag-%E6%9D%A5%E8%87%AA-JSON%E3%80%81Xml"><span class="toc-number">1.12.3.</span> <span class="toc-text">ConstructingGeometryBag - 来自 JSON、Xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%A0%E4%BD%95%E5%8C%85-%E6%B7%BB%E5%8A%A0%E6%88%96%E6%8F%92%E5%85%A5%E5%87%A0%E4%BD%95%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.12.4.</span> <span class="toc-text">构造几何包 - 添加或插入几何枚举</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E9%9D%A2%E4%BD%93"><span class="toc-number">1.13.</span> <span class="toc-text">多面体</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E6%8B%89%E4%BC%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E6%88%96%E6%8A%98%E7%BA%BF%E6%9E%84%E5%BB%BA%E5%A4%9A%E9%9D%A2%E4%BD%93"><span class="toc-number">1.13.1.</span> <span class="toc-text">通过拉伸多边形或折线构建多面体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E9%9D%A2%E4%BD%93%E5%B1%9E%E6%80%A7"><span class="toc-number">1.13.2.</span> <span class="toc-text">多面体属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%A4%9A%E9%9D%A2%E4%BD%93"><span class="toc-number">1.13.3.</span> <span class="toc-text">构建多面体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87MultipatchBuilderEx%E6%9E%84%E5%BB%BA%E5%A4%9A%E9%9D%A2%E4%BD%93"><span class="toc-number">1.13.4.</span> <span class="toc-text">通过MultipatchBuilderEx构建多面体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%A4%9A%E9%9D%A2%E4%BD%93%E6%9E%84%E5%BB%BA%E5%A4%9A%E9%9D%A2%E4%BD%93"><span class="toc-number">1.13.5.</span> <span class="toc-text">从另一个多面体构建多面体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E-3D-%E6%A8%A1%E5%9E%8B%E6%96%87%E4%BB%B6%E6%9E%84%E5%BB%BA%E5%A4%9A%E9%9D%A2%E4%BD%93"><span class="toc-number">1.13.6.</span> <span class="toc-text">从 3D 模型文件构建多面体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA-3D-%E7%89%B9%E6%AE%8A%E5%A4%9A%E9%9D%A2%E4%BD%93%E5%BD%A2%E7%8A%B6"><span class="toc-number">1.13.7.</span> <span class="toc-text">构建 3D 特殊多面体形状</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E6%9D%90%E6%96%99"><span class="toc-number">1.13.8.</span> <span class="toc-text">创建基本材料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-JPEG-%E7%BA%B9%E7%90%86%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E6%9D%90%E8%B4%A8"><span class="toc-number">1.13.9.</span> <span class="toc-text">使用 JPEG 纹理创建基本材质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%9C%AA%E5%8E%8B%E7%BC%A9%E7%BA%B9%E7%90%86%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E6%9D%90%E8%B4%A8"><span class="toc-number">1.13.10.</span> <span class="toc-text">使用未压缩纹理创建基本材质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E9%9D%A2%E4%BD%93%E7%9A%84%E7%BA%B9%E7%90%86%E5%9B%BE%E5%83%8F"><span class="toc-number">1.13.11.</span> <span class="toc-text">获取多面体的纹理图像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E9%9D%A2%E4%BD%93%E7%9A%84%E6%B3%95%E7%BA%BF%E5%9D%90%E6%A0%87"><span class="toc-number">1.13.12.</span> <span class="toc-text">获取多面体的法线坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E9%9D%A2%E4%BD%93%E7%9A%84%E6%B3%95%E7%BA%BF"><span class="toc-number">1.13.13.</span> <span class="toc-text">获取多面体的法线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E9%9D%A2%E4%BD%93%E7%9A%84%E6%9D%90%E8%B4%A8%E5%B1%9E%E6%80%A7"><span class="toc-number">1.13.14.</span> <span class="toc-text">获取多面体的材质属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E9%83%A8%E4%BB%B6"><span class="toc-number">1.14.</span> <span class="toc-text">多部件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E9%83%A8%E5%88%86%E8%A6%81%E7%B4%A0%E7%9A%84%E5%90%84%E4%B8%AA%E9%83%A8%E5%88%86"><span class="toc-number">1.14.1.</span> <span class="toc-text">获取多部分要素的各个部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%9C%80%E5%A4%96%E5%B1%82%E7%8E%AF"><span class="toc-number">1.14.2.</span> <span class="toc-text">获取多边形的最外层环</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A3%80%E7%B4%A2%E5%87%A0%E4%BD%95"><span class="toc-number">1.15.</span> <span class="toc-text">从地理数据库检索几何</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A3%80%E7%B4%A2%E5%87%A0%E4%BD%95-1"><span class="toc-number">1.15.1.</span> <span class="toc-text">从地理数据库检索几何</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E3%80%81%E5%AF%BC%E5%87%BA%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.16.</span> <span class="toc-text">导入、导出几何图形</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA%E4%B8%BA%E5%B7%B2%E7%9F%A5%E6%96%87%E6%9C%AC"><span class="toc-number">1.16.1.</span> <span class="toc-text">将几何图形导入和导出为已知文本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA%E5%88%B0%E4%BC%97%E6%89%80%E5%91%A8%E7%9F%A5%E7%9A%84%E4%BA%8C%E8%BF%9B%E5%88%B6"><span class="toc-number">1.16.2.</span> <span class="toc-text">将几何图形导入和导出到众所周知的二进制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%87%A0%E4%BD%95%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA%E5%88%B0-EsriShape"><span class="toc-number">1.16.3.</span> <span class="toc-text">将几何导入和导出到 EsriShape</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA%E4%B8%BA-JSON"><span class="toc-number">1.16.4.</span> <span class="toc-text">将几何图形导入和导出为 JSON</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E5%AF%BC%E5%85%A5%E5%92%8C%E5%AF%BC%E5%87%BA%E4%B8%BA-XML"><span class="toc-number">1.16.5.</span> <span class="toc-text">将几何图形导入和导出为 XML</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.17.</span> <span class="toc-text">转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%B0%E7%90%86%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.17.1.</span> <span class="toc-text">创建地理转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%8D%E5%90%88%E5%9C%B0%E7%90%86%E5%8F%98%E6%8D%A2"><span class="toc-number">1.17.2.</span> <span class="toc-text">创建复合地理变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%8A%95%E5%BD%B1%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.17.3.</span> <span class="toc-text">创建投影转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%AB%98%E5%8E%8B%E5%9F%BA%E5%87%86%E5%8F%98%E6%8D%A2"><span class="toc-number">1.17.4.</span> <span class="toc-text">创建高压基准变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%8D%E5%90%88%E9%AB%98%E5%8E%8B%E5%9F%BA%E5%87%86%E5%8F%98%E6%8D%A2"><span class="toc-number">1.17.5.</span> <span class="toc-text">创建复合高压基准变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.17.6.</span> <span class="toc-text">确定转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E7%82%B9%E5%9C%B0%E7%90%86%E5%9D%90%E6%A0%87%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.18.</span> <span class="toc-text">地图点地理坐标字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E7%82%B9-%E5%9C%B0%E7%90%86%E5%9D%90%E6%A0%87%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.18.1.</span> <span class="toc-text">地图点 - 地理坐标字符串转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%92%E5%BA%A6%E5%8D%95%E5%85%83"><span class="toc-number">1.19.</span> <span class="toc-text">角度单元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%92%E5%BA%A6%E5%8D%95%E4%BD%8D-%E5%9C%A8%E5%BA%A6%E5%92%8C%E5%BC%A7%E5%BA%A6%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.19.1.</span> <span class="toc-text">角度单位 - 在度和弧度之间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%92%E5%BA%A6%E5%8D%95%E4%BD%8D-%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%8E%82%E4%BB%A3%E7%A0%81%E5%88%9B%E5%BB%BA%E8%A7%92%E5%BA%A6%E5%8D%95%E4%BD%8D"><span class="toc-number">1.19.2.</span> <span class="toc-text">角度单位 - 使用工厂代码创建角度单位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%92%E5%BA%A6%E5%8D%95%E4%BD%8D-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%92%E5%BA%A6%E5%8D%95%E4%BD%8D"><span class="toc-number">1.19.3.</span> <span class="toc-text">角度单位 - 创建自定义角度单位</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D"><span class="toc-number">1.20.</span> <span class="toc-text">线性单位</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D-%E5%9C%A8%E8%8B%B1%E5%B0%BA%E5%92%8C%E7%B1%B3%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.20.1.</span> <span class="toc-text">线性单位 - 在英尺和米之间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D-%E5%9C%A8%E5%8E%98%E7%B1%B3%E5%92%8C%E6%AF%AB%E7%B1%B3%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.20.2.</span> <span class="toc-text">线性单位 - 在厘米和毫米之间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D-%E4%BD%BF%E7%94%A8%E5%B7%A5%E5%8E%82%E4%BB%A3%E7%A0%81%E5%88%9B%E5%BB%BA%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D"><span class="toc-number">1.20.3.</span> <span class="toc-text">线性单位 - 使用工厂代码创建线性单位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D-%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%BF%E6%80%A7%E5%8D%95%E4%BD%8D"><span class="toc-number">1.20.4.</span> <span class="toc-text">线性单位 - 创建自定义线性单位</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D"><span class="toc-number">1.21.</span> <span class="toc-text">面积单位</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D-%E5%9C%A8%E5%B9%B3%E6%96%B9%E8%8B%B1%E5%B0%BA%E5%92%8C%E5%B9%B3%E6%96%B9%E7%B1%B3%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.21.1.</span> <span class="toc-text">面积单位 - 在平方英尺和平方米之间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D-%E5%9C%A8%E5%85%AC%E9%A1%B7%E5%92%8C%E8%8B%B1%E4%BA%A9%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.21.2.</span> <span class="toc-text">面积单位 - 在公顷和英亩之间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D-%E5%9C%A8%E5%85%AC%E9%A1%B7%E5%92%8C%E5%B9%B3%E6%96%B9%E8%8B%B1%E9%87%8C%E4%B9%8B%E9%97%B4%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.21.3.</span> <span class="toc-text">面积单位 - 在公顷和平方英里之间转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D-%E5%90%84%E7%A7%8D%E5%8D%95%E4%BD%8D%E7%9A%84%E5%B9%B3%E6%96%B9%E7%B1%B3%E6%95%B0"><span class="toc-number">1.21.4.</span> <span class="toc-text">面积单位 - 各种单位的平方米数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D-%E5%88%9B%E5%BB%BA%E9%9D%A2%E7%A7%AF%E5%8D%95%E4%BD%8D"><span class="toc-number">1.21.5.</span> <span class="toc-text">面积单位 - 创建面积单位</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%A0%E4%BD%95%E5%BC%95%E6%93%8E%E5%87%BD%E6%95%B0"><span class="toc-number">1.22.</span> <span class="toc-text">几何引擎函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E9%80%9F%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.22.1.</span> <span class="toc-text">加速几何图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E9%9D%A2%E7%9A%84%E9%9D%A2%E7%A7%AF"><span class="toc-number">1.22.2.</span> <span class="toc-text">确定面的面积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E5%A4%9A%E9%83%A8%E5%88%86%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E8%BE%B9%E7%95%8C"><span class="toc-number">1.22.3.</span> <span class="toc-text">确定多部分多边形的边界</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.22.4.</span> <span class="toc-text">缓冲地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%9C%86%E5%BC%A7"><span class="toc-number">1.22.5.</span> <span class="toc-text">缓冲圆弧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%A4%9A%E4%B8%AA%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.22.6.</span> <span class="toc-text">缓冲多个地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%A4%9A%E7%A7%8D%E4%B8%8D%E5%90%8C%E7%9A%84%E5%87%A0%E4%BD%95%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.22.7.</span> <span class="toc-text">缓冲多种不同的几何类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%8A%98%E7%BA%BF%E4%B8%8A%E6%8F%92%E5%80%BC-Z-%E5%80%BC"><span class="toc-number">1.22.8.</span> <span class="toc-text">在折线上插值 Z 值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E4%B8%8A%E6%8F%92%E5%80%BC-M-%E5%80%BC"><span class="toc-number">1.22.9.</span> <span class="toc-text">在多边形上插值 M 值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%B0%81%E5%A5%97%E5%9C%A8-X%EF%BC%8CY-%E5%91%A8%E5%9B%B4%E5%B1%85%E4%B8%AD"><span class="toc-number">1.22.10.</span> <span class="toc-text">将封套在 X，Y 周围居中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%87%A0%E4%BD%95%E4%BD%93%E7%9A%84%E8%B4%A8%E5%BF%83"><span class="toc-number">1.22.11.</span> <span class="toc-text">查找几何体的质心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%AA%E8%A3%81%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.12.</span> <span class="toc-text">剪裁折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E5%A4%9A%E8%BE%B9%E5%BD%A2%E8%A3%81%E5%89%AA%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.13.</span> <span class="toc-text">按多边形裁剪折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%85%B7%E6%9C%89%E6%8C%87%E5%AE%9A%E8%B7%9D%E7%A6%BB%E5%92%8C%E6%96%B9%E4%BD%8D%E8%A7%92%E7%9A%84%E5%A4%A7%E5%9C%B0%E6%B5%8B%E9%87%8F%E7%BA%BF"><span class="toc-number">1.22.14.</span> <span class="toc-text">构建具有指定距离和方位角的大地测量线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E8%BF%9E%E6%8E%A5%E7%82%B9%E7%9A%84%E5%A4%A7%E5%9C%B0%E6%B5%8B%E9%87%8F%E7%BA%BF"><span class="toc-number">1.22.15.</span> <span class="toc-text">构建连接点的大地测量线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E8%B7%9D%E7%8E%B0%E6%9C%89%E7%82%B9%E4%B8%80%E5%AE%9A%E8%B7%9D%E7%A6%BB%E5%92%8C%E4%B8%80%E5%AE%9A%E8%A7%92%E5%BA%A6%E5%A4%84%E6%9E%84%E9%80%A0%E7%82%B9"><span class="toc-number">1.22.16.</span> <span class="toc-text">在距现有点一定距离和一定角度处构造点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E4%B8%80%E7%BB%84%E6%8A%98%E7%BA%BF%E6%9E%84%E9%80%A0%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.17.</span> <span class="toc-text">从一组折线构造多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%BE%B9%E5%BD%A2%E5%8C%85%E5%90%AB%E5%9C%B0%E5%9B%BE%E7%82%B9%E3%80%81%E6%8A%98%E7%BA%BF%E3%80%81%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.18.</span> <span class="toc-text">多边形包含地图点、折线、多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E5%87%B8%E5%8C%85"><span class="toc-number">1.22.19.</span> <span class="toc-text">确定凸包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E6%98%AF%E5%90%A6%E7%9B%B8%E4%BA%A4"><span class="toc-number">1.22.20.</span> <span class="toc-text">确定两个几何图形是否相交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%8A%98%E7%BA%BF%E5%88%87%E5%89%B2%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.22.21.</span> <span class="toc-text">使用折线切割几何图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%89%E9%95%BF%E5%BA%A6%E8%87%B4%E5%AF%86"><span class="toc-number">1.22.22.</span> <span class="toc-text">按长度致密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E5%A4%9A%E8%BE%B9%E5%BD%A2%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-number">1.22.23.</span> <span class="toc-text">两个多边形之间的差异</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%87%A0%E4%BD%95%E6%98%AF%E5%90%A6%E4%B8%8D%E7%9B%B8%E4%BA%A4"><span class="toc-number">1.22.24.</span> <span class="toc-text">确定两个几何是否不相交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%87%A0%E4%BD%95%E4%B9%8B%E9%97%B4%E7%9A%84%E8%B7%9D%E7%A6%BB"><span class="toc-number">1.22.25.</span> <span class="toc-text">确定两个几何之间的距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%87%A0%E4%BD%95%E4%BD%93%E4%B9%8B%E9%97%B4%E7%9A%84-3D-%E8%B7%9D%E7%A6%BB"><span class="toc-number">1.22.26.</span> <span class="toc-text">确定两个几何体之间的 3D 距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%95%E5%BC%80%E4%BF%A1%E5%B0%81-1"><span class="toc-number">1.22.27.</span> <span class="toc-text">展开信封</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.28.</span> <span class="toc-text">扩展折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E6%8B%AC"><span class="toc-number">1.22.29.</span> <span class="toc-text">概括</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E9%9D%A2%E7%9A%84%E6%B5%8B%E5%9C%B0%E7%BA%BF%E9%9D%A2%E7%A7%AF"><span class="toc-number">1.22.30.</span> <span class="toc-text">计算面的测地线面积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%8C%87%E5%AE%9A%E7%9A%84%E6%B5%8B%E5%9C%B0%E7%BA%BF%E8%B7%9D%E7%A6%BB%E5%A4%84%E5%88%9B%E5%BB%BA%E7%BC%93%E5%86%B2%E5%8C%BA%E9%9D%A2"><span class="toc-number">1.22.31.</span> <span class="toc-text">在指定的测地线距离处创建缓冲区面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%87%A0%E4%BD%95%E4%B9%8B%E9%97%B4%E7%9A%84%E6%B5%8B%E5%9C%B0%E7%BA%BF%E8%B7%9D%E7%A6%BB"><span class="toc-number">1.22.32.</span> <span class="toc-text">确定两个几何之间的测地线距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E5%9C%B0%E7%BA%BF%E6%A4%AD%E5%9C%86"><span class="toc-number">1.22.33.</span> <span class="toc-text">测地线椭圆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E7%BA%BF%E7%9A%84%E6%B5%8B%E5%9C%B0%E7%BA%BF%E9%95%BF%E5%BA%A6"><span class="toc-number">1.22.34.</span> <span class="toc-text">确定线的测地线长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E5%9C%B0%E7%BA%BF%E6%89%87%E5%8C%BA"><span class="toc-number">1.22.35.</span> <span class="toc-text">测地线扇区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%9C%B0%E6%B5%8B%E9%87%8F%E8%87%B4%E5%AF%86%E5%8C%96%E5%81%8F%E5%B7%AE-%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.36.</span> <span class="toc-text">大地测量致密化偏差 - 折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E5%9C%B0%E6%B5%8B%E9%87%8F%E8%87%B4%E5%AF%86%E6%8C%89%E9%95%BF%E5%BA%A6-%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.37.</span> <span class="toc-text">大地测量致密按长度 - 多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%A4%A7%E5%9C%B0%E6%B5%8B%E9%87%8F%E8%B7%9D%E7%A6%BB%EF%BC%8C%E4%B8%A4%E7%82%B9%E4%B9%8B%E9%97%B4%E7%9A%84%E6%96%B9%E4%BD%8D%E8%A7%92"><span class="toc-number">1.22.38.</span> <span class="toc-text">计算大地测量距离，两点之间的方位角</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%B8%80%E7%BB%84%E5%9C%B0%E5%9B%BE%E7%82%B9%E6%89%A7%E8%A1%8C%E5%A4%A7%E5%9C%B0%E6%B5%8B%E9%87%8F%E7%A7%BB%E5%8A%A8"><span class="toc-number">1.22.39.</span> <span class="toc-text">对一组地图点执行大地测量移动</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E5%9D%90%E6%A0%87%E7%B3%BB"><span class="toc-number">1.22.40.</span> <span class="toc-text">检索坐标系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E7%B4%A2%E7%B3%BB%E7%BB%9F%E5%9C%B0%E7%90%86%E5%8F%98%E6%8D%A2"><span class="toc-number">1.22.41.</span> <span class="toc-text">检索系统地理变换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%8A%98%E7%BA%BF%E6%88%96%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E5%AD%90%E6%9B%B2%E7%BA%BF"><span class="toc-number">1.22.42.</span> <span class="toc-text">获取折线或多边形的子曲线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E7%BC%93%E5%86%B2%E5%8C%BA"><span class="toc-number">1.22.43.</span> <span class="toc-text">图形缓冲区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E7%BC%93%E5%86%B2%E5%99%A8%E5%BE%88%E5%A4%9A"><span class="toc-number">1.22.44.</span> <span class="toc-text">图形缓冲器很多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%9D%A1%E6%8A%98%E7%BA%BF%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BA%A4%E7%82%B9"><span class="toc-number">1.22.45.</span> <span class="toc-text">两条折线之间的交点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E5%A4%9A%E8%BE%B9%E5%BD%A2%E4%B9%8B%E9%97%B4%E7%9A%84%E4%BA%A4%E7%82%B9"><span class="toc-number">1.22.46.</span> <span class="toc-text">两个多边形之间的交点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E6%A0%87%E6%B3%A8%E7%82%B9"><span class="toc-number">1.22.47.</span> <span class="toc-text">确定多边形的标注点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E7%BA%BF%E7%9A%84%E9%95%BF%E5%BA%A6%EF%BC%8C%E9%95%BF%E5%BA%A63D"><span class="toc-number">1.22.48.</span> <span class="toc-text">确定线的长度，长度3D</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%80%E5%B0%8F%E5%92%8C%E6%9C%80%E5%A4%A7-M-%E5%80%BC-GetMinMaxM"><span class="toc-number">1.22.49.</span> <span class="toc-text">获取最小和最大 M 值 - GetMinMaxM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A-M-%E6%98%AF%E5%8D%95%E8%B0%83%E7%9A%84%EF%BC%8C%E6%98%AF%E5%8D%87%E5%BA%8F%E8%BF%98%E6%98%AF%E9%99%8D%E5%BA%8F-GetMMonotonic"><span class="toc-number">1.22.50.</span> <span class="toc-text">确定 M 是单调的，是升序还是降序 - GetMMonotonic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8E%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E4%B8%AD%E6%8C%87%E5%AE%9A-M-%E5%80%BC%E5%87%BA%E7%8E%B0%E7%9A%84%E4%BD%8D%E7%BD%AE%E7%9B%B8%E5%AF%B9%E5%BA%94%E7%9A%84%E5%A4%9A%E7%82%B9-GetPointsAtM"><span class="toc-number">1.22.51.</span> <span class="toc-text">获取与几何图形中指定 M 值出现的位置相对应的多点 - GetPointsAtM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8E%E6%8C%87%E5%AE%9A-M-%E5%80%BC%E4%B9%8B%E9%97%B4%E7%9A%84%E5%AD%90%E6%9B%B2%E7%BA%BF%E5%AF%B9%E5%BA%94%E7%9A%84%E6%8A%98%E7%BA%BF-GetSubCurveBetweenMs"><span class="toc-number">1.22.52.</span> <span class="toc-text">获取与指定 M 值之间的子曲线对应的折线 - GetSubCurveBetweenMs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8E%E6%B2%BF%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%8C%87%E5%AE%9A-M-%E5%80%BC%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%A4%84%E7%9A%84%E6%B3%95%E7%BA%BF%E5%AF%B9%E5%BA%94%E7%9A%84%E7%BA%BF%E6%AE%B5-GetNormalsAtM"><span class="toc-number">1.22.53.</span> <span class="toc-text">获取与沿几何图形中出现指定 M 值的位置处的法线对应的线段 - GetNormalsAtM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%B2%BF%E5%A4%9A%E9%83%A8%E5%88%86%E7%9A%84%E6%8C%87%E5%AE%9A%E8%B7%9D%E7%A6%BB%E5%A4%84%E7%9A%84-M-%E5%80%BC"><span class="toc-number">1.22.54.</span> <span class="toc-text">获取沿多部分的指定距离处的 M 值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86-M-%E5%80%BC%E8%AE%BE%E7%BD%AE%E4%B8%BA%E4%BB%8E%E5%A4%9A%E9%83%A8%E5%88%86%E5%BC%80%E5%A7%8B%E7%9A%84%E7%B4%AF%E7%A7%AF%E9%95%BF%E5%BA%A6-SetMsAsDistance"><span class="toc-number">1.22.55.</span> <span class="toc-text">将 M 值设置为从多部分开始的累积长度 - SetMsAsDistance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E7%BB%99%E5%AE%9A%E8%B7%9D%E7%A6%BB%E5%A4%84%E6%8F%92%E5%85%A5-M-%E5%80%BC-%E6%8F%92%E5%85%A5%E8%B7%9D%E7%A6%BB"><span class="toc-number">1.22.56.</span> <span class="toc-text">在给定距离处插入 M 值 - 插入距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%BE%93%E5%85%A5%E7%82%B9%E7%9A%84-M-%E5%80%BC%E6%A0%A1%E5%87%86-M-%E5%80%BC-CalibrateByMs"><span class="toc-number">1.22.57.</span> <span class="toc-text">使用输入点的 M 值校准 M 值 - CalibrateByMs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%AF%B9%E4%B8%80%E7%B3%BB%E5%88%97%E7%82%B9%E8%BF%9B%E8%A1%8C%E7%BA%BF%E6%80%A7%E6%8F%92%E5%80%BC%E7%94%9F%E6%88%90-M-%E5%80%BC-%E6%8F%92%E5%80%BCMsBetween"><span class="toc-number">1.22.58.</span> <span class="toc-text">通过对一系列点进行线性插值生成 M 值 - 插值MsBetween</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E7%9A%84%E5%BC%80%E5%A4%B4%E5%92%8C%E7%BB%93%E5%B0%BE%E8%AE%BE%E7%BD%AE-Ms%EF%BC%8C%E5%B9%B6%E5%9C%A8%E4%B8%A4%E4%B8%AA%E5%80%BC%E4%B9%8B%E9%97%B4%E6%8F%92%E5%80%BC-M-%E5%80%BC-SetAndIntervalateMsBetween"><span class="toc-number">1.22.59.</span> <span class="toc-text">在几何图形的开头和结尾设置 Ms，并在两个值之间插值 M 值 - SetAndIntervalateMsBetween</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.22.60.</span> <span class="toc-text">移动地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8-z-%E6%84%9F%E7%9F%A5%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.22.61.</span> <span class="toc-text">移动 z 感知地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.62.</span> <span class="toc-text">移动折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E7%82%B9%E6%B2%BF%E7%BA%BF"><span class="toc-number">1.22.63.</span> <span class="toc-text">移动点沿线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%87%A0%E4%BD%95%E4%BD%93%E7%9A%84%E7%BB%84%E4%BB%B6%E5%88%86%E7%A6%BB%E4%B8%BA%E5%8D%95%E4%B8%AA%E7%BB%84%E4%BB%B6%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.22.64.</span> <span class="toc-text">将几何体的组件分离为单个组件几何图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E8%BF%91%E7%82%B9%E4%B8%8E%E6%9C%80%E8%BF%91%E9%A1%B6%E7%82%B9"><span class="toc-number">1.22.65.</span> <span class="toc-text">最近点与最近顶点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A-3D-%E4%B8%AD%E7%9A%84%E6%9C%80%E8%BF%91%E7%82%B9"><span class="toc-number">1.22.66.</span> <span class="toc-text">确定 3D 中的最近点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E4%B8%8E%E6%BA%90%E7%9A%84%E5%87%A0%E4%BD%95%E5%81%8F%E7%A7%BB"><span class="toc-number">1.22.67.</span> <span class="toc-text">计算与源的几何偏移</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E6%98%AF%E5%90%A6%E9%87%8D%E5%8F%A0"><span class="toc-number">1.22.68.</span> <span class="toc-text">确定几何图形是否重叠</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E-WGS84-%E5%88%B0-Web%E5%A2%A8%E5%8D%A1%E6%89%98%E7%9A%84%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.22.69.</span> <span class="toc-text">从 WGS84 到 Web墨卡托的项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WGS84%E7%9A%84%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.22.70.</span> <span class="toc-text">WGS84的项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%AD%A3%E5%B8%B8"><span class="toc-number">1.22.71.</span> <span class="toc-text">查询正常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%82%B9"><span class="toc-number">1.22.72.</span> <span class="toc-text">查询点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%82%B9%E5%92%8C%E8%B7%9D%E7%A6%BB"><span class="toc-number">1.22.73.</span> <span class="toc-text">查询点和距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%88%87%E7%BA%BF"><span class="toc-number">1.22.74.</span> <span class="toc-text">查询切线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%B4%E7%BB%95%E7%BA%BF%E5%8F%8D%E5%B0%84%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.75.</span> <span class="toc-text">围绕线反射多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E4%B8%A4%E4%B8%AA%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.22.76.</span> <span class="toc-text">确定两个几何图形之间的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%A4%9A%E8%BE%B9%E5%BD%A2%E4%B8%AD%E7%9A%84-NaN-Z"><span class="toc-number">1.22.77.</span> <span class="toc-text">替换多边形中的 NaN Z</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E5%A4%9A%E8%BE%B9%E5%BD%A2%E7%9A%84%E5%BD%A2%E7%8A%B6"><span class="toc-number">1.22.78.</span> <span class="toc-text">改变多边形的形状</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E8%BD%AC%E5%A4%9A%E8%BE%B9%E5%BD%A2%E4%B8%AD%E7%82%B9%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.22.79.</span> <span class="toc-text">反转多边形中点的顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E5%9C%B0%E5%9B%BE%E7%82%B9"><span class="toc-number">1.22.80.</span> <span class="toc-text">旋转地图点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.81.</span> <span class="toc-text">旋转折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%A9%E6%94%BE%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.22.82.</span> <span class="toc-text">缩放几何图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%8A%98%E7%BA%BF%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89-Z"><span class="toc-number">1.22.83.</span> <span class="toc-text">设置折线中的所有 Z</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%9C%B0%E7%90%83%E6%A4%AD%E7%90%83%E4%BD%93%E8%A1%A8%E9%9D%A2%E4%B8%8A%E7%9A%84%E5%87%A0%E4%BD%95%E9%9D%A2%E7%A7%AF-%E5%BD%A2%E7%8A%B6%E4%BF%9D%E5%AD%98%E9%9D%A2%E7%A7%AF"><span class="toc-number">1.22.84.</span> <span class="toc-text">计算地球椭球体表面上的几何面积 - 形状保存面积</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%9C%B0%E7%90%83%E6%A4%AD%E7%90%83%E4%BD%93%E8%A1%A8%E9%9D%A2%E5%87%A0%E4%BD%95%E5%BD%A2%E7%8A%B6%E7%9A%84%E9%95%BF%E5%BA%A6-%E5%BD%A2%E7%8A%B6%E4%BF%9D%E5%AD%98%E9%95%BF%E5%BA%A6"><span class="toc-number">1.22.85.</span> <span class="toc-text">计算地球椭球体表面几何形状的长度 - 形状保存长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%A7%E7%BC%93%E5%86%B2%E5%99%A8"><span class="toc-number">1.22.86.</span> <span class="toc-text">侧缓冲器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%A7%E7%BC%93%E5%86%B2%E5%99%A8%E5%BE%88%E5%A4%9A"><span class="toc-number">1.22.87.</span> <span class="toc-text">侧缓冲器很多</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.88.</span> <span class="toc-text">简化多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96%E5%85%B7%E6%9C%89%E7%9B%B8%E4%BA%A4%E3%80%81%E9%87%8D%E5%8F%A0%E7%9A%84%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.89.</span> <span class="toc-text">简化具有相交、重叠的折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%A4%9A%E8%BE%B9%E5%BD%A2%E5%88%87%E6%88%90%E7%9B%B8%E7%AD%89%E7%9A%84%E9%83%A8%E5%88%86"><span class="toc-number">1.22.90.</span> <span class="toc-text">将多边形切成相等的部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E7%82%B9%E6%8B%86%E5%88%86%E5%A4%9A%E9%83%A8%E5%88%86"><span class="toc-number">1.22.91.</span> <span class="toc-text">在点拆分多部分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%BE%B9%E5%BD%A2%E6%8E%A5%E8%A7%A6%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.92.</span> <span class="toc-text">多边形接触另一个多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A22D"><span class="toc-number">1.22.93.</span> <span class="toc-text">转换2D</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A23D"><span class="toc-number">1.22.94.</span> <span class="toc-text">转换3D</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E5%9C%B0%E5%9B%BE%E7%82%B9-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A4%9A%E7%82%B9"><span class="toc-number">1.22.95.</span> <span class="toc-text">合并两个地图点 - 创建一个多点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E9%9B%86%E4%B8%A4%E4%B8%AA%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.96.</span> <span class="toc-text">并集两个多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E8%AE%B8%E5%A4%9A%E6%8A%98%E7%BA%BF"><span class="toc-number">1.22.97.</span> <span class="toc-text">联合许多折线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E5%A4%9A%E4%B8%AA%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.98.</span> <span class="toc-text">联合多个多边形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E7%82%B9%E3%80%81%E6%8A%98%E7%BA%BF%E3%80%81%E5%A4%9A%E8%BE%B9%E5%BD%A2%E5%86%85%E7%9A%84%E5%A4%9A%E8%BE%B9%E5%BD%A2"><span class="toc-number">1.22.99.</span> <span class="toc-text">地图点、折线、多边形内的多边形</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_09.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By shaozhy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="/img/icp.png"><span>冀ICP备2023009991号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'd990e8cbbd1dabc9c98e',
      clientSecret: '59676d5926f4df676ec1ba6b36395bf90a0aeb54',
      repo: 'WineMonk.github.io',
      owner: 'WineMonk',
      admin: ['WineMonk'],
      id: '7629dfb54fd1473f43786906ac8847d1',
      updateCountCallback: commentCount
    },{"proxy":"https://vercel.prohibitorum.top/github_access_token"}))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="茶飘香,酒罢去,聚朋友,再回楼" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>