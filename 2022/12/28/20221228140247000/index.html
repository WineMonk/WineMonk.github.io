<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ArcGIS Pro SDK 布局 | WineMonk</title><meta name="keywords" content="CSharp,ArcGIS Pro SDK"><meta name="author" content="shaozhy,1361151272@qq.com"><meta name="copyright" content="shaozhy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="布局布局项目项参考布局项目项及其关联布局1234567891011&#x2F;&#x2F;Reference layout project items and their associated layout.&#x2F;&#x2F;A layout project item is an item that appears in the Layouts&#x2F;&#x2F;folder in the Catalog pane.&#x2F;&#x2F;Reference all">
<meta property="og:type" content="article">
<meta property="og:title" content="ArcGIS Pro SDK 布局">
<meta property="og:url" content="https://shaoshao.net.cn/2022/12/28/20221228140247000/index.html">
<meta property="og:site_name" content="WineMonk">
<meta property="og:description" content="布局布局项目项参考布局项目项及其关联布局1234567891011&#x2F;&#x2F;Reference layout project items and their associated layout.&#x2F;&#x2F;A layout project item is an item that appears in the Layouts&#x2F;&#x2F;folder in the Catalog pane.&#x2F;&#x2F;Reference all">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_12.jpg">
<meta property="article:published_time" content="2022-12-28T06:02:47.000Z">
<meta property="article:modified_time" content="2023-04-14T01:28:34.000Z">
<meta property="article:author" content="shaozhy">
<meta property="article:tag" content="CSharp">
<meta property="article:tag" content="ArcGIS Pro SDK">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_12.jpg"><link rel="shortcut icon" href="/cover/head_portrait.jpg"><link rel="canonical" href="https://shaoshao.net.cn/2022/12/28/20221228140247000/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ArcGIS Pro SDK 布局',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-14 09:28:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/discover/archives/"><div class="headline">文章</div><div class="length-num">185</div></a></div><div class="data-item"><a href="/discover/tags/"><div class="headline">标签</div><div class="length-num">115</div></a></div><div class="data-item"><a href="/discover/categories/"><div class="headline">分类</div><div class="length-num">83</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_12.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">WineMonk</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ArcGIS Pro SDK 布局</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-28T06:02:47.000Z" title="发表于 2022-12-28 14:02:47">2022-12-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-14T01:28:34.000Z" title="更新于 2023-04-14 09:28:34">2023-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>71分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ArcGIS Pro SDK 布局"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="布局"><a href="#布局" class="headerlink" title="布局"></a>布局</h1><h2 id="布局项目项"><a href="#布局项目项" class="headerlink" title="布局项目项"></a>布局项目项</h2><h3 id="参考布局项目项及其关联布局"><a href="#参考布局项目项及其关联布局" class="headerlink" title="参考布局项目项及其关联布局"></a>参考布局项目项及其关联布局</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Reference layout project items and their associated layout.</span></span><br><span class="line"><span class="comment">//A layout project item is an item that appears in the Layouts</span></span><br><span class="line"><span class="comment">//folder in the Catalog pane.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference all the layout project items</span></span><br><span class="line">IEnumerable&lt;LayoutProjectItem&gt; layouts = </span><br><span class="line">                     Project.Current.GetItems&lt;LayoutProjectItem&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Or reference a specific layout project item by name</span></span><br><span class="line">LayoutProjectItem layoutItem = Project.Current.GetItems&lt;LayoutProjectItem&gt;()</span><br><span class="line">                           .FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;MyLayout&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="在新视图中打开布局项目项"><a href="#在新视图中打开布局项目项" class="headerlink" title="在新视图中打开布局项目项"></a>在新视图中打开布局项目项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Open a layout project item in a new view.</span></span><br><span class="line"><span class="comment">//A layout project item may exist but it may not be open in a view. </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a layout project item by name</span></span><br><span class="line">LayoutProjectItem someLytItem = Project.Current.GetItems&lt;LayoutProjectItem&gt;()</span><br><span class="line">                          .FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;MyLayout&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//Get the layout associated with the layout project item</span></span><br><span class="line">Layout layout = <span class="keyword">await</span> QueuedTask.Run(() =&gt; someLytItem.GetLayout());  <span class="comment">//Worker thread</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create the new pane - call on UI</span></span><br><span class="line">ILayoutPane iNewLayoutPane = <span class="keyword">await</span> ProApp.Panes.CreateLayoutPaneAsync(layout); <span class="comment">//GUI thread</span></span><br></pre></td></tr></table></figure>

<h3 id="激活已打开的布局视图"><a href="#激活已打开的布局视图" class="headerlink" title="激活已打开的布局视图"></a>激活已打开的布局视图</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Activate an already open layout view.</span></span><br><span class="line"><span class="comment">//A layout view may be open but it may not be active.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Find the pane that references the layout and activate it. </span></span><br><span class="line"><span class="comment">//Note - there can be multiple panes referencing the same layout.</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> pane <span class="keyword">in</span> ProApp.Panes)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> layoutPane = pane <span class="keyword">as</span> ILayoutPane;</span><br><span class="line">  <span class="keyword">if</span> (layoutPane == <span class="literal">null</span>)  <span class="comment">//if not a layout view, continue to the next pane</span></span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  <span class="keyword">if</span> (layoutPane.LayoutView.Layout == layout) <span class="comment">//activate the view</span></span><br><span class="line">  &#123;</span><br><span class="line">    (layoutPane <span class="keyword">as</span> Pane).Activate();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="引用活动布局视图"><a href="#引用活动布局视图" class="headerlink" title="引用活动布局视图"></a>引用活动布局视图</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Reference the active layout view.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Confirm if the current, active view is a layout view.</span></span><br><span class="line"><span class="comment">//If it is, do something.</span></span><br><span class="line">LayoutView activeLayoutView = LayoutView.Active;</span><br><span class="line"><span class="keyword">if</span> (activeLayoutView != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="将-pagx-导入到项目中"><a href="#将-pagx-导入到项目中" class="headerlink" title="将 pagx 导入到项目中"></a>将 pagx 导入到项目中</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Import a pagx into a project.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a layout project item from importing a pagx file</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  IProjectItem pagx = ItemFactory.Instance.Create(</span><br><span class="line">                            <span class="string">@&quot;C:\Temp\Layout.pagx&quot;</span>) <span class="keyword">as</span> IProjectItem;</span><br><span class="line">  Project.Current.AddItem(pagx);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="删除布局项目项"><a href="#删除布局项目项" class="headerlink" title="删除布局项目项"></a>删除布局项目项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Remove a layout project item.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Remove the layout fro the project</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; Project.Current.RemoveItem(layoutItem));</span><br></pre></td></tr></table></figure>

<h3 id="创建新的基本布局并将其打开"><a href="#创建新的基本布局并将其打开" class="headerlink" title="创建新的基本布局并将其打开"></a>创建新的基本布局并将其打开</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a new, basic layout and open it.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create layout with minimum set of parameters on the worker thread</span></span><br><span class="line">Layout lyt = <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> newLayout = LayoutFactory.Instance.CreateLayout(<span class="number">8.5</span>, <span class="number">11</span>, LinearUnit.Inches);</span><br><span class="line">  newLayout.SetName(<span class="string">&quot;New 8.5x11 Layout&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> newLayout;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Open new layout on the GUI thread</span></span><br><span class="line"><span class="keyword">await</span> ProApp.Panes.CreateLayoutPaneAsync(lyt);</span><br></pre></td></tr></table></figure>

<h3 id="使用修改后的-CIM-创建新布局并将其打开"><a href="#使用修改后的-CIM-创建新布局并将其打开" class="headerlink" title="使用修改后的 CIM 创建新布局并将其打开"></a>使用修改后的 CIM 创建新布局并将其打开</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a new layout using a modified CIM and open it.</span></span><br><span class="line"><span class="comment">//The CIM exposes additional members that may not be</span></span><br><span class="line"><span class="comment">//available through the managed API.  </span></span><br><span class="line"><span class="comment">//In this example, optional guides are added.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a new CIMLayout on the worker thread</span></span><br><span class="line">Layout newCIMLayout = <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Set up a CIM page</span></span><br><span class="line">  CIMPage newPage = <span class="keyword">new</span> CIMPage</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//required parameters</span></span><br><span class="line">    Width = <span class="number">8.5</span>,</span><br><span class="line">    Height = <span class="number">11</span>,</span><br><span class="line">    Units = LinearUnit.Inches,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//optional rulers</span></span><br><span class="line">    ShowRulers = <span class="literal">true</span>,</span><br><span class="line">    SmallestRulerDivision = <span class="number">0.5</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">//optional guides</span></span><br><span class="line">    ShowGuides = <span class="literal">true</span></span><br><span class="line">  &#125;;</span><br><span class="line">  CIMGuide guide1 = <span class="keyword">new</span> CIMGuide</span><br><span class="line">  &#123;</span><br><span class="line">    Position = <span class="number">1</span>,</span><br><span class="line">    Orientation = Orientation.Vertical</span><br><span class="line">  &#125;;</span><br><span class="line">  CIMGuide guide2 = <span class="keyword">new</span> CIMGuide</span><br><span class="line">  &#123;</span><br><span class="line">    Position = <span class="number">6.5</span>,</span><br><span class="line">    Orientation = Orientation.Vertical</span><br><span class="line">  &#125;;</span><br><span class="line">  CIMGuide guide3 = <span class="keyword">new</span> CIMGuide</span><br><span class="line">  &#123;</span><br><span class="line">    Position = <span class="number">1</span>,</span><br><span class="line">    Orientation = Orientation.Horizontal</span><br><span class="line">  &#125;;</span><br><span class="line">  CIMGuide guide4 = <span class="keyword">new</span> CIMGuide</span><br><span class="line">  &#123;</span><br><span class="line">    Position = <span class="number">10</span>,</span><br><span class="line">    Orientation = Orientation.Horizontal</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  List&lt;CIMGuide&gt; guideList = <span class="keyword">new</span> List&lt;CIMGuide&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    guide1,</span><br><span class="line">    guide2,</span><br><span class="line">    guide3,</span><br><span class="line">    guide4</span><br><span class="line">  &#125;;</span><br><span class="line">  newPage.Guides = guideList.ToArray();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Construct the new layout using the customized cim definitions</span></span><br><span class="line">  <span class="keyword">var</span> layout_local = LayoutFactory.Instance.CreateLayout(newPage);</span><br><span class="line">  layout_local.SetName(<span class="string">&quot;New 8.5x11 Layout&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> layout_local;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Open new layout on the GUI thread</span></span><br><span class="line"><span class="keyword">await</span> ProApp.Panes.CreateLayoutPaneAsync(newCIMLayout);</span><br></pre></td></tr></table></figure>

<h3 id="更改布局页面大小"><a href="#更改布局页面大小" class="headerlink" title="更改布局页面大小"></a>更改布局页面大小</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Change the layout page size.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference the layout project item</span></span><br><span class="line">LayoutProjectItem lytItem = Project.Current.GetItems&lt;LayoutProjectItem&gt;()</span><br><span class="line">                         .FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;MyLayout&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (layoutItem != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Get the layout</span></span><br><span class="line">    Layout lyt = lytItem.GetLayout();</span><br><span class="line">    <span class="keyword">if</span> (lyt != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//Change properties</span></span><br><span class="line">      CIMPage page = lyt.GetPage();</span><br><span class="line">      page.Width = <span class="number">8.5</span>;</span><br><span class="line">      page.Height = <span class="number">11</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Apply the changes to the layout</span></span><br><span class="line">      lyt.SetPage(page);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ProSnippet-Group-CIM-Graphics-and-GraphicFactory"><a href="#ProSnippet-Group-CIM-Graphics-and-GraphicFactory" class="headerlink" title="ProSnippet Group CIM Graphics and GraphicFactory"></a>ProSnippet Group CIM Graphics and GraphicFactory</h3><h3 id="创建圆形图形"><a href="#创建圆形图形" class="headerlink" title="创建圆形图形"></a>创建圆形图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">4</span>);</span><br><span class="line">EllipticArcSegment circle_seg = EllipticArcBuilderEx.CreateCircle(</span><br><span class="line">  <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">4</span>), <span class="number">0.5</span>, ArcOrientation.ArcClockwise, <span class="literal">null</span>);</span><br><span class="line"><span class="keyword">var</span> circle_poly = PolygonBuilderEx.CreatePolygon(PolylineBuilderEx.CreatePolyline(circle_seg));</span><br><span class="line"></span><br><span class="line"><span class="comment">//PolylineBuilderEx.CreatePolyline(cir, AttributeFlags.AllAttributes));</span></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">  ColorFactory.Instance.BlackRGB, <span class="number">2.0</span>, SimpleLineStyle.Dash);</span><br><span class="line"></span><br><span class="line">CIMPolygonSymbol circleSym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">  ColorFactory.Instance.RedRGB, SimpleFillStyle.Solid, outline);</span><br><span class="line">SymbolFactory.Instance.ConstructPolygonSymbol(<span class="literal">null</span>,</span><br><span class="line">  SymbolFactory.Instance.ConstructStroke(ColorFactory.Instance.RedRGB, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> circleGraphic = GraphicFactory.Instance.CreateSimpleGraphic(circle_poly, circleSym);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Make an element to add to GraphicsLayer or Layout</span></span><br><span class="line"><span class="comment">//var elemInfo = new ElementInfo() &#123; Anchor = Anchor.CenterPoint &#125;;</span></span><br><span class="line"><span class="comment">//GraphicElement cirElm = ElementFactory.Instance.CreateGraphicElement(</span></span><br><span class="line"><span class="comment">//  container, circleGraphic, &quot;New Circle&quot;, true, elemInfo);</span></span><br></pre></td></tr></table></figure>

<h3 id="创建圆形文本图形"><a href="#创建圆形文本图形" class="headerlink" title="创建圆形文本图形"></a>创建圆形文本图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">4</span>);</span><br><span class="line"><span class="keyword">var</span> eabCir = <span class="keyword">new</span> EllipticArcBuilderEx(center, <span class="number">0.5</span>, ArcOrientation.ArcClockwise);</span><br><span class="line"><span class="keyword">var</span> cir = eabCir.ToSegment();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> poly = PolygonBuilderEx.CreatePolygon(</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(cir, AttributeFlags.AllAttributes));</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">  ColorFactory.Instance.GreenRGB, <span class="number">10</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;Circle, circle, circle&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> graphic = GraphicFactory.Instance.CreateSimpleTextGraphic(</span><br><span class="line">  TextType.CircleParagraph, poly, sym, text);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Make an element to add to GraphicsLayer or Layout</span></span><br><span class="line"><span class="comment">//var ge = ElementFactory.Instance.CreateGraphicElement(container, graphic,</span></span><br><span class="line"><span class="comment">//  &quot;New Circle Text&quot;, true);</span></span><br></pre></td></tr></table></figure>

<h3 id="创建贝塞尔图形"><a href="#创建贝塞尔图形" class="headerlink" title="创建贝塞尔图形"></a>创建贝塞尔图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D pt1 = <span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">7.5</span>);</span><br><span class="line">Coordinate2D pt2 = <span class="keyword">new</span> Coordinate2D(<span class="number">4.16</span>, <span class="number">8</span>);</span><br><span class="line">Coordinate2D pt3 = <span class="keyword">new</span> Coordinate2D(<span class="number">4.83</span>, <span class="number">7.1</span>);</span><br><span class="line">Coordinate2D pt4 = <span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">7.5</span>);</span><br><span class="line"><span class="keyword">var</span> bez = <span class="keyword">new</span> CubicBezierBuilderEx(pt1, pt2, pt3, pt4);</span><br><span class="line"><span class="keyword">var</span> bezSeg = bez.ToSegment();</span><br><span class="line">Polyline bezPl = PolylineBuilderEx.CreatePolyline(bezSeg, AttributeFlags.AllAttributes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">      ColorFactory.Instance.BlackRGB, <span class="number">24</span>, <span class="string">&quot;Comic Sans MS&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> graphic = GraphicFactory.Instance.CreateSimpleTextGraphic(</span><br><span class="line">  TextType.SplinedText, bezPl, sym, <span class="string">&quot;Splined text&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Make an element to add to GraphicsLayer or Layout</span></span><br><span class="line"><span class="comment">//var ge = ElementFactory.Instance.CreateGraphicElement(container, graphic);</span></span><br></pre></td></tr></table></figure>

<h3 id="创建图例图面图形"><a href="#创建图例图面图形" class="headerlink" title="创建图例图面图形"></a>创建图例图面图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plyCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.25</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.5</span>, <span class="number">1.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.75</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">1.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.25</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.5</span>, <span class="number">1.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.75</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">1</span>));</span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(plyCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">          ColorFactory.Instance.BlackRGB, <span class="number">2.0</span>, SimpleLineStyle.Solid);</span><br><span class="line">CIMPolygonSymbol polySym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">          ColorFactory.Instance.RedRGB, SimpleFillStyle.ForwardDiagonal, outline);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> graphic = GraphicFactory.Instance.CreateLegendPatchGraphic(</span><br><span class="line">            PatchShape.AreaBoundary, poly.Extent, polySym);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Make an element to add to GraphicsLayer or Layout</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//var elemInfo = new ElementInfo()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//  CustomProperties = null,</span></span><br><span class="line"><span class="comment">//  Anchor = Anchor.LeftMidPoint</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line"><span class="comment">//var ge = ElementFactory.Instance.CreateGraphicElement(container, graphic,</span></span><br><span class="line"><span class="comment">//  &quot;New Legend Patch&quot;, true, elemInfo);</span></span><br></pre></td></tr></table></figure>

<h3 id="创建箭头图形"><a href="#创建箭头图形" class="headerlink" title="创建箭头图形"></a>创建箭头图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">8.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.66</span>, <span class="number">9</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.33</span>, <span class="number">8.1</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">8.5</span>));</span><br><span class="line">Polyline linePl = PolylineBuilderEx.CreatePolyline(plCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set up the arrow info</span></span><br><span class="line"><span class="keyword">var</span> arrowInfo = <span class="keyword">new</span> ArrowInfo()</span><br><span class="line">&#123;</span><br><span class="line">  ArrowHeadKey = ArrowInfo.DefaultArrowHeadKeys[<span class="number">1</span>],</span><br><span class="line">  ArrowOnBothEnds = <span class="literal">true</span>,</span><br><span class="line">  ArrowSizePoints = <span class="number">30</span>,</span><br><span class="line">  LineWidthPoints = <span class="number">15</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> graphic = GraphicFactory.Instance.CreateArrowGraphic(linePl, arrowInfo);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Make an element to add to GraphicsLayer or Layout</span></span><br><span class="line"><span class="comment">//var ge = ElementFactory.Instance.CreateGraphicElement(</span></span><br><span class="line"><span class="comment">//  container, graphic, &quot;Arrow Line&quot;, false);</span></span><br></pre></td></tr></table></figure>

<h3 id="创建图片图形"><a href="#创建图片图形" class="headerlink" title="创建图片图形"></a>创建图片图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">1</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">2</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create and add element to layout</span></span><br><span class="line"><span class="comment">//string picPath = ApplicationUtilities.BASEPATH + _settings.baseFolder + &quot;irefusetowatchthismovi�.jpg&quot;;</span></span><br><span class="line"><span class="keyword">var</span> graphic = GraphicFactory.Instance.CreatePictureGraphic(env.Center, picPath);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Make an element to add to GraphicsLayer or Layout</span></span><br><span class="line"><span class="comment">//var ge = ElementFactory.Instance.CreateGraphicElement(layout, graphic);</span></span><br></pre></td></tr></table></figure>

<h2 id="创建布局图形元素"><a href="#创建布局图形元素" class="headerlink" title="创建布局图形元素"></a>创建布局图形元素</h2><h3 id="创建椭圆图形元素"><a href="#创建椭圆图形元素" class="headerlink" title="创建椭圆图形元素"></a>创建椭圆图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">2.75</span>);</span><br><span class="line"><span class="keyword">var</span> eabElp = <span class="keyword">new</span> EllipticArcBuilderEx(center, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.45</span>, </span><br><span class="line">                                       ArcOrientation.ArcClockwise);</span><br><span class="line"><span class="keyword">var</span> ellipse = eabElp.ToSegment();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">                                ColorFactory.Instance.GreenRGB, <span class="number">2.0</span>,</span><br><span class="line">                        SimpleLineStyle.Dot);</span><br><span class="line">CIMPolygonSymbol ellipseSym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">                         ColorFactory.Instance.GreyRGB, SimpleFillStyle.Vertical, </span><br><span class="line">                                                  outline);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> poly = PolygonBuilderEx.CreatePolygon(</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(ellipse, AttributeFlags.AllAttributes));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> elpElm = ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">  container, poly, ellipseSym, <span class="string">&quot;New Ellipse&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建套索线，手绘图形元素"><a href="#创建套索线，手绘图形元素" class="headerlink" title="创建套索线，手绘图形元素"></a>创建套索线，手绘图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.5</span>, <span class="number">10.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.25</span>, <span class="number">9.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">10.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0.75</span>, <span class="number">9.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0.5</span>, <span class="number">10.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0.5</span>, <span class="number">1</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">0.75</span>, <span class="number">2</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">Polyline linePl = PolylineBuilderEx.CreatePolyline(plCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMLineSymbol lineSym = SymbolFactory.Instance.ConstructLineSymbol(</span><br><span class="line">          ColorFactory.Instance.BlackRGB, <span class="number">2.0</span>, SimpleLineStyle.Solid);</span><br><span class="line"><span class="comment">//var graphic = GraphicFactory.Instance.CreateShapeGraphic(linePl, lineSym);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">                        container, linePl, lineSym, <span class="string">&quot;New Freehand&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建套索多边形，手绘元素"><a href="#创建套索多边形，手绘元素" class="headerlink" title="创建套索多边形，手绘元素"></a>创建套索多边形，手绘元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line">List&lt;Coordinate2D&gt; plyCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.25</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.5</span>, <span class="number">1.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.75</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">1.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.25</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.5</span>, <span class="number">1.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.75</span>, <span class="number">2</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">1</span>));</span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(plyCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">            ColorFactory.Instance.BlackRGB, <span class="number">2.0</span>, SimpleLineStyle.Solid);</span><br><span class="line">CIMPolygonSymbol polySym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">         ColorFactory.Instance.RedRGB, SimpleFillStyle.ForwardDiagonal, outline);</span><br><span class="line"></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">  container, poly, polySym, <span class="string">&quot;New Lasso&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建线元素"><a href="#创建线元素" class="headerlink" title="创建线元素"></a>创建线元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">8.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.66</span>, <span class="number">9</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.33</span>, <span class="number">8.1</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">8.5</span>));</span><br><span class="line">Polyline linePl = PolylineBuilderEx.CreatePolyline(plCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a line symbol in a style</span></span><br><span class="line"><span class="keyword">var</span> ProjectStyles = Project.Current.GetItems&lt;StyleProjectItem&gt;();</span><br><span class="line">StyleProjectItem style = ProjectStyles.First(x =&gt; x.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> symStyle = style.SearchSymbols(StyleItemType.LineSymbol, <span class="string">&quot;Line with 2 Markers&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">CIMLineSymbol lineSym = symStyle.Symbol <span class="keyword">as</span> CIMLineSymbol;</span><br><span class="line">lineSym.SetSize(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line"><span class="comment">//CIMLineSymbol lineSym = SymbolFactory.Instance.ConstructLineSymbol(ColorFactory.Instance.BlueRGB, 4.0, SimpleLineStyle.Solid);</span></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">  container, linePl, lineSym, <span class="string">&quot;New Line&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建点元素"><a href="#创建点元素" class="headerlink" title="创建点元素"></a>创建点元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D coord2D = <span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">10.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a point symbol in a style</span></span><br><span class="line">StyleProjectItem stylePrjItm = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">         .FirstOrDefault(item =&gt; item.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line">SymbolStyleItem symStyleItm = stylePrjItm.SearchSymbols(</span><br><span class="line">                      StyleItemType.PointSymbol, <span class="string">&quot;City Hall&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">CIMPointSymbol pointSym = symStyleItm.Symbol <span class="keyword">as</span> CIMPointSymbol;</span><br><span class="line">pointSym.SetSize(<span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> elemInfo = <span class="keyword">new</span> ElementInfo()</span><br><span class="line">&#123;</span><br><span class="line">  CustomProperties = <span class="keyword">new</span> List&lt;CIMStringMap&gt;() &#123;</span><br><span class="line">     <span class="keyword">new</span> CIMStringMap() &#123; Key = <span class="string">&quot;Key1&quot;</span>, Value = <span class="string">&quot;Value1&quot;</span>&#125;,</span><br><span class="line">     <span class="keyword">new</span> CIMStringMap() &#123; Key = <span class="string">&quot;Key2&quot;</span>, Value = <span class="string">&quot;Value2&quot;</span>&#125;</span><br><span class="line">   &#125;,</span><br><span class="line">  Anchor = Anchor.TopRightCorner,</span><br><span class="line">  Rotation = <span class="number">45.0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> graphic = GraphicFactory.Instance.CreateSimpleGraphic(</span><br><span class="line">                              coord2D.ToMapPoint(), pointSym);</span><br><span class="line"></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">  container, graphic, <span class="string">&quot;New Point&quot;</span>, <span class="literal">true</span>, elemInfo);</span><br></pre></td></tr></table></figure>

<h3 id="创建多边形元素"><a href="#创建多边形元素" class="headerlink" title="创建多边形元素"></a>创建多边形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plyCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">6.7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">6.7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">6.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">6.1</span>));</span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(plyCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">  ColorFactory.Instance.BlueRGB, <span class="number">2.0</span>, SimpleLineStyle.DashDotDot);</span><br><span class="line">CIMPolygonSymbol polySym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">  ColorFactory.Instance.RedRGB, SimpleFillStyle.ForwardDiagonal, outline);</span><br><span class="line"></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">  container, poly, polySym, <span class="string">&quot;New Polygon&quot;</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建矩形元素"><a href="#创建矩形元素" class="headerlink" title="创建矩形元素"></a>创建矩形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">4.75</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">3.0</span>, <span class="number">5.75</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">  ColorFactory.Instance.BlackRGB, <span class="number">5.0</span>, SimpleLineStyle.Solid);</span><br><span class="line">CIMPolygonSymbol polySym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">  ColorFactory.Instance.GreenRGB, SimpleFillStyle.DiagonalCross, outline);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = GraphicFactory.Instance.CreateSimpleGraphic(env, polySym);</span><br><span class="line"><span class="keyword">var</span> elemInfo = <span class="keyword">new</span> ElementInfo()</span><br><span class="line">&#123;</span><br><span class="line">  Anchor = Anchor.CenterPoint,</span><br><span class="line">  Rotation = <span class="number">45.0</span>,</span><br><span class="line">  CornerRounding = <span class="number">5.0</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">  container, env, polySym, <span class="string">&quot;New Rectangle&quot;</span>, <span class="literal">false</span>, elemInfo);</span><br></pre></td></tr></table></figure>

<h3 id="创建贝塞尔曲线元素"><a href="#创建贝塞尔曲线元素" class="headerlink" title="创建贝塞尔曲线元素"></a>创建贝塞尔曲线元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D pt1 = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">7.5</span>);</span><br><span class="line">Coordinate2D pt2 = <span class="keyword">new</span> Coordinate2D(<span class="number">1.66</span>, <span class="number">8</span>);</span><br><span class="line">Coordinate2D pt3 = <span class="keyword">new</span> Coordinate2D(<span class="number">2.33</span>, <span class="number">7.1</span>);</span><br><span class="line">Coordinate2D pt4 = <span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">7.5</span>);</span><br><span class="line"><span class="keyword">var</span> bez = <span class="keyword">new</span> CubicBezierBuilderEx(pt1, pt2, pt3, pt4);</span><br><span class="line"><span class="keyword">var</span> bezSeg = bez.ToSegment();</span><br><span class="line">Polyline bezPl = PolylineBuilderEx.CreatePolyline(bezSeg, AttributeFlags.AllAttributes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbology, create and add element to layout</span></span><br><span class="line">CIMLineSymbol lineSym = SymbolFactory.Instance.ConstructLineSymbol(</span><br><span class="line">  ColorFactory.Instance.RedRGB, <span class="number">4.0</span>, SimpleLineStyle.DashDot);</span><br><span class="line"></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(container, bezPl, lineSym, <span class="string">&quot;New Bezier&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建图形元素"><a href="#创建图形元素" class="headerlink" title="创建图形元素"></a>创建图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plyCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">6.7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">6.7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">6.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">6.1</span>));</span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(plyCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">4.75</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">3.0</span>, <span class="number">5.75</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D coord2D = <span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">10.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g1 = GraphicFactory.Instance.CreateSimpleGraphic(poly);</span><br><span class="line"><span class="keyword">var</span> g2 = GraphicFactory.Instance.CreateSimpleGraphic(env);</span><br><span class="line"><span class="keyword">var</span> g3 = GraphicFactory.Instance.CreateSimpleGraphic(coord2D.ToMapPoint());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreateGraphicElements(</span><br><span class="line">  container, <span class="keyword">new</span> List&lt;CIMGraphic&gt;() &#123; g1, g2, g3 &#125;,</span><br><span class="line">  <span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Poly&quot;</span>, <span class="string">&quot;Envelope&quot;</span>, <span class="string">&quot;MapPoint&quot;</span> &#125;,</span><br><span class="line">  <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<h3 id="使用-CIMG-创建图形元素"><a href="#使用-CIMG-创建图形元素" class="headerlink" title="使用 CIMG 创建图形元素"></a>使用 CIMG 创建图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//on the QueuedTask</span></span><br><span class="line"><span class="comment">//Place symbol on the layout</span></span><br><span class="line"><span class="comment">//At 2.x - MapPoint location = MapPointBuilder.CreateMapPoint(</span></span><br><span class="line"><span class="comment">//                                               new Coordinate2D(9, 1));</span></span><br><span class="line">MapPoint location = MapPointBuilderEx.CreateMapPoint(<span class="keyword">new</span> Coordinate2D(<span class="number">9</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//specify a symbol</span></span><br><span class="line"><span class="keyword">var</span> pt_symbol = SymbolFactory.Instance.ConstructPointSymbol(</span><br><span class="line">                      ColorFactory.Instance.GreenRGB);</span><br><span class="line"></span><br><span class="line"><span class="comment">//create a CIMGraphic </span></span><br><span class="line"><span class="keyword">var</span> graphic = <span class="keyword">new</span> CIMPointGraphic()</span><br><span class="line">&#123;</span><br><span class="line">  Symbol = pt_symbol.MakeSymbolReference(),</span><br><span class="line">  Location = location <span class="comment">//center of map</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//Or use GraphicFactory</span></span><br><span class="line"><span class="keyword">var</span> graphic2 = GraphicFactory.Instance.CreateSimpleGraphic(location, pt_symbol);</span><br><span class="line"></span><br><span class="line"><span class="comment">//At 2.x - LayoutElementFactory.Instance.CreateGraphicElement(layout, graphic);</span></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(container, graphic);</span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(container, graphic2);</span><br></pre></td></tr></table></figure>

<h3 id="使用-CIMSymbol-创建图形元素"><a href="#使用-CIMSymbol-创建图形元素" class="headerlink" title="使用 CIMSymbol 创建图形元素"></a>使用 CIMSymbol 创建图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Place symbol on the layout</span></span><br><span class="line"><span class="comment">//At 2.x - MapPoint location = MapPointBuilder.CreateMapPoint(</span></span><br><span class="line"><span class="comment">//                                       new Coordinate2D(9, 1));</span></span><br><span class="line">MapPoint location = MapPointBuilderEx.CreateMapPoint(<span class="keyword">new</span> Coordinate2D(<span class="number">9</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//specify a symbol</span></span><br><span class="line"><span class="keyword">var</span> pt_symbol = SymbolFactory.Instance.ConstructPointSymbol(</span><br><span class="line">                      ColorFactory.Instance.GreenRGB);</span><br><span class="line"><span class="comment">//At 2.x -</span></span><br><span class="line"><span class="comment">//     LayoutElementFactory.Instance.CreateGraphicElement(</span></span><br><span class="line"><span class="comment">//                                       layout, location, pt_symbol);</span></span><br><span class="line"></span><br><span class="line">ElementFactory.Instance.CreateGraphicElement(container, location, pt_symbol);</span><br></pre></td></tr></table></figure>

<h3 id="批量元素创建"><a href="#批量元素创建" class="headerlink" title="批量元素创建"></a>批量元素创建</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//List of Point graphics</span></span><br><span class="line"><span class="keyword">var</span> listGraphics = <span class="keyword">new</span> List&lt;CIMPointGraphic&gt;();</span><br><span class="line"><span class="keyword">var</span> listGraphics2 = <span class="keyword">new</span> List&lt;CIMPointGraphic&gt;();</span><br><span class="line"><span class="comment">//Symbol</span></span><br><span class="line"><span class="keyword">var</span> pointSymbol = SymbolFactory.Instance.ConstructPointSymbol(</span><br><span class="line">                                    ColorFactory.Instance.BlackRGB);</span><br><span class="line"><span class="comment">//Define size of the array</span></span><br><span class="line"><span class="built_in">int</span> dx = <span class="number">5</span>;</span><br><span class="line"><span class="built_in">int</span> dy = <span class="number">5</span>;</span><br><span class="line">MapPoint point = <span class="literal">null</span>;</span><br><span class="line"><span class="comment">//Create the List of graphics for the array</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> row = <span class="number">0</span>; row &lt;= dx; ++row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="built_in">int</span> col = <span class="number">0</span>; col &lt;= dy; ++col)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//At 2.x - point = MapPointBuilder.CreateMapPoint(col, row);</span></span><br><span class="line">    point = MapPointBuilderEx.CreateMapPoint(col, row);</span><br><span class="line">    <span class="comment">//create a CIMGraphic </span></span><br><span class="line">    <span class="keyword">var</span> graphic = <span class="keyword">new</span> CIMPointGraphic()</span><br><span class="line">    &#123;</span><br><span class="line">      Symbol = pointSymbol.MakeSymbolReference(),</span><br><span class="line">      Location = point</span><br><span class="line">    &#125;;</span><br><span class="line">    listGraphics.Add(graphic);</span><br><span class="line">    <span class="comment">//Or use GraphicFactory</span></span><br><span class="line">    <span class="keyword">var</span> graphic2 = GraphicFactory.Instance.CreateSimpleGraphic(</span><br><span class="line">                                  point, pointSymbol) <span class="keyword">as</span> CIMPointGraphic;</span><br><span class="line">    listGraphics2.Add(graphic2);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Draw the array of graphics</span></span><br><span class="line"><span class="comment">//At 2.x - var bulkgraphics =</span></span><br><span class="line"><span class="comment">//              LayoutElementFactory.Instance.CreateGraphicElements(</span></span><br><span class="line"><span class="comment">//                                              layout, listGraphics, null);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bulkgraphics = ElementFactory.Instance.CreateGraphicElements(</span><br><span class="line">                                                   container, listGraphics);</span><br><span class="line"><span class="keyword">var</span> bulkgraphics2 = ElementFactory.Instance.CreateGraphicElements(</span><br><span class="line">                                                   container, listGraphics2);</span><br></pre></td></tr></table></figure>

<h3 id="使用-CIMG-创建元素"><a href="#使用-CIMG-创建元素" class="headerlink" title="使用 CIMG 创建元素"></a>使用 CIMG 创建元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Place symbol on the layout</span></span><br><span class="line"><span class="comment">//At 2.x - MapPoint point = MapPointBuilder.CreateMapPoint(new Coordinate2D(9, 1));</span></span><br><span class="line">MapPoint point = MapPointBuilderEx.CreateMapPoint(<span class="keyword">new</span> Coordinate2D(<span class="number">9</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//specify a symbol</span></span><br><span class="line"><span class="keyword">var</span> pt_symbol = SymbolFactory.Instance.ConstructPointSymbol(</span><br><span class="line">                      ColorFactory.Instance.GreenRGB);</span><br><span class="line"></span><br><span class="line"><span class="comment">//create a CIMGraphic </span></span><br><span class="line"><span class="keyword">var</span> graphic = <span class="keyword">new</span> CIMGraphicElement()</span><br><span class="line">&#123;</span><br><span class="line">  Graphic = <span class="keyword">new</span> CIMPointGraphic()</span><br><span class="line">  &#123;</span><br><span class="line">    Symbol = pt_symbol.MakeSymbolReference(),</span><br><span class="line">    Location = point <span class="comment">//A point in the layout</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//At 2.x - LayoutElementFactory.Instance.CreateElement(layout, graphic);</span></span><br><span class="line">ElementFactory.Instance.CreateElement(container, graphic);</span><br></pre></td></tr></table></figure>

<h3 id="使用符号系统创建点图形"><a href="#使用符号系统创建点图形" class="headerlink" title="使用符号系统创建点图形"></a>使用符号系统创建点图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a simple 2D point graphic and apply an existing point style item as the symbology.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D point geometry  </span></span><br><span class="line">  Coordinate2D coord2D = <span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">10.0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//(optionally) Reference a point symbol in a style</span></span><br><span class="line">  StyleProjectItem ptStylePrjItm = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">                                .FirstOrDefault(item =&gt; item.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line">  SymbolStyleItem ptSymStyleItm = ptStylePrjItm.SearchSymbols(</span><br><span class="line">                                         StyleItemType.PointSymbol, <span class="string">&quot;City Hall&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">  CIMPointSymbol pointSym = ptSymStyleItm.Symbol <span class="keyword">as</span> CIMPointSymbol;</span><br><span class="line">  pointSym.SetSize(<span class="number">50</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//An alternative simple symbol is also commented out below.</span></span><br><span class="line">  <span class="comment">//This would elminate the four optional lines of code above that</span></span><br><span class="line">  <span class="comment">//reference a style.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//CIMPointSymbol pointSym = SymbolFactory.Instance.ConstructPointSymbol(</span></span><br><span class="line">  <span class="comment">//                  ColorFactory.Instance.RedRGB, 25.0, SimpleMarkerStyle.Star);  </span></span><br><span class="line">  <span class="comment">//At 2.x - GraphicElement ptElm =</span></span><br><span class="line">  <span class="comment">//                    LayoutElementFactory.Instance.CreatePointGraphicElement(</span></span><br><span class="line">  <span class="comment">//                                        layout, coord2D, pointSym);</span></span><br><span class="line"></span><br><span class="line">  GraphicElement ptElm = ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">                                 container, coord2D.ToMapPoint(), pointSym);</span><br><span class="line">  ptElm.SetName(<span class="string">&quot;New Point&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用符号系统创建线图形"><a href="#使用符号系统创建线图形" class="headerlink" title="使用符号系统创建线图形"></a>使用符号系统创建线图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a simple 2D line graphic and apply an existing line</span></span><br><span class="line"><span class="comment">//style item as the symbology.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2d line geometry</span></span><br><span class="line">  List&lt;Coordinate2D&gt; plCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">  plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">8.5</span>));</span><br><span class="line">  plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.66</span>, <span class="number">9</span>));</span><br><span class="line">  plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.33</span>, <span class="number">8.1</span>));</span><br><span class="line">  plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">8.5</span>));</span><br><span class="line">  <span class="comment">//At 2.x - Polyline linePl = PolylineBuilder.CreatePolyline(plCoords);</span></span><br><span class="line">  Polyline linePl = PolylineBuilderEx.CreatePolyline(plCoords);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//(optionally) Reference a line symbol in a style</span></span><br><span class="line">  StyleProjectItem lnStylePrjItm = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">                                .FirstOrDefault(item =&gt; item.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line">  SymbolStyleItem lnSymStyleItm = lnStylePrjItm.SearchSymbols(</span><br><span class="line">                                StyleItemType.LineSymbol, <span class="string">&quot;Line with 2 Markers&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">  CIMLineSymbol lineSym = lnSymStyleItm.Symbol <span class="keyword">as</span> CIMLineSymbol;</span><br><span class="line">  lineSym.SetSize(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//An alternative simple symbol is also commented out below.</span></span><br><span class="line">  <span class="comment">//This would elminate the four optional lines of code above that</span></span><br><span class="line">  <span class="comment">//reference a style.</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">//CIMLineSymbol lineSym = SymbolFactory.Instance.ConstructLineSymbol(</span></span><br><span class="line">  <span class="comment">//         ColorFactory.Instance.BlueRGB, 4.0, SimpleLineStyle.Solid);  </span></span><br><span class="line">  <span class="comment">//At 2.x - GraphicElement lineElm =</span></span><br><span class="line">  <span class="comment">//        LayoutElementFactory.Instance.CreateLineGraphicElement(</span></span><br><span class="line">  <span class="comment">//                                            layout, linePl, lineSym);</span></span><br><span class="line"></span><br><span class="line">  GraphicElement lineElm = ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">                                              container, linePl, lineSym);</span><br><span class="line">  lineElm.SetName(<span class="string">&quot;New Line&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用简单符号系统创建矩形图形"><a href="#使用简单符号系统创建矩形图形" class="headerlink" title="使用简单符号系统创建矩形图形"></a>使用简单符号系统创建矩形图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a simple 2D rectangle graphic and apply simple fill and</span></span><br><span class="line"><span class="comment">//outline symbols.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D envelope geometry</span></span><br><span class="line">  Coordinate2D rec_ll = <span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">4.75</span>);</span><br><span class="line">  Coordinate2D rec_ur = <span class="keyword">new</span> Coordinate2D(<span class="number">3.0</span>, <span class="number">5.75</span>);</span><br><span class="line">  <span class="comment">//At 2.x - Envelope rec_env = EnvelopeBuilder.CreateEnvelope(rec_ll, rec_ur);</span></span><br><span class="line">  Envelope rec_env = EnvelopeBuilderEx.CreateEnvelope(rec_ll, rec_ur);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">  CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">    ColorFactory.Instance.BlackRGB, <span class="number">5.0</span>, SimpleLineStyle.Solid);</span><br><span class="line">  CIMPolygonSymbol polySym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">    ColorFactory.Instance.GreenRGB, SimpleFillStyle.DiagonalCross, outline);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//At 2.x - GraphicElement recElm =</span></span><br><span class="line">  <span class="comment">//           LayoutElementFactory.Instance.CreateRectangleGraphicElement(</span></span><br><span class="line">  <span class="comment">//                                                  layout, rec_env, polySym);</span></span><br><span class="line">  <span class="comment">//         recElm.SetName(&quot;New Rectangle&quot;);</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  GraphicElement recElm = ElementFactory.Instance.CreateGraphicElement(</span><br><span class="line">    container, rec_env, polySym, <span class="string">&quot;New Rectangle&quot;</span>);</span><br><span class="line">  <span class="comment">//Or use Predefined shape</span></span><br><span class="line">  GraphicElement recElm2 = ElementFactory.Instance.CreatePredefinedShapeGraphicElement(</span><br><span class="line">                            container, PredefinedShape.Rectangle, rec_env, polySym, </span><br><span class="line">                            <span class="string">&quot;New Rectangle2&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="创建文本图形元素"><a href="#创建文本图形元素" class="headerlink" title="创建文本图形元素"></a>创建文本图形元素</h2><h3 id="创建点文本元素-1"><a href="#创建点文本元素-1" class="headerlink" title="创建点文本元素 1"></a>创建点文本元素 1</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a simple point text element and assign basic symbology and text settings.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D point geometry</span></span><br><span class="line">  Coordinate2D coord2D = <span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">  CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">                ColorFactory.Instance.RedRGB, <span class="number">32</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line">  <span class="built_in">string</span> textString = <span class="string">&quot;Point text&quot;</span>;</span><br><span class="line">  <span class="comment">//At 2.x - GraphicElement ptTxtElm =</span></span><br><span class="line">  <span class="comment">//         LayoutElementFactory.Instance.CreatePointTextGraphicElement(</span></span><br><span class="line">  <span class="comment">//                           layout, coord2D, textString, sym);</span></span><br><span class="line">  <span class="comment">//ptTxtElm.SetName(&quot;New Point Text&quot;);</span></span><br><span class="line">  <span class="comment">//ptTxtElm.SetAnchor(Anchor.CenterPoint);</span></span><br><span class="line">  <span class="comment">//ptTxtElm.SetX(4.5);</span></span><br><span class="line">  <span class="comment">//ptTxtElm.SetY(9.5);</span></span><br><span class="line">  <span class="comment">//ptTxtElm.SetRotation(45);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//use ElementInfo to set placement properties during create</span></span><br><span class="line">  <span class="keyword">var</span> elemInfo = <span class="keyword">new</span> ElementInfo()</span><br><span class="line">  &#123;</span><br><span class="line">    Anchor = Anchor.CenterPoint,</span><br><span class="line">    Rotation = <span class="number">45</span></span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> ptTxtElm = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">    container, TextType.PointText, coord2D.ToMapPoint(), sym, textString,</span><br><span class="line">                       <span class="string">&quot;New Point Text&quot;</span>, <span class="literal">true</span>, elemInfo);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Change additional text properties</span></span><br><span class="line">  ptTxtElm.SetX(<span class="number">4.5</span>);</span><br><span class="line">  ptTxtElm.SetY(<span class="number">9.5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建矩形段落文本元素-1"><a href="#创建矩形段落文本元素-1" class="headerlink" title="创建矩形段落文本元素 1"></a>创建矩形段落文本元素 1</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create rectangle text with background and border symbology.  </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D polygon geometry</span></span><br><span class="line">  List&lt;Coordinate2D&gt; plyCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">  plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">7</span>));</span><br><span class="line">  plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">7</span>));</span><br><span class="line">  plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">6.7</span>));</span><br><span class="line">  plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">6.7</span>));</span><br><span class="line">  plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">6.1</span>));</span><br><span class="line">  plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">6.1</span>));</span><br><span class="line">  <span class="comment">//At 2.x - Polygon poly = PolygonBuilder.CreatePolygon(plyCoords);</span></span><br><span class="line">  Polygon poly = PolygonBuilderEx.CreatePolygon(plyCoords);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">  <span class="comment">//Also notice how formatting tags are using within the text string.</span></span><br><span class="line">  CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">                    ColorFactory.Instance.GreyRGB, <span class="number">10</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line">  <span class="built_in">string</span> text = <span class="string">&quot;Some Text String that is really long and is &quot;</span> +</span><br><span class="line">                <span class="string">&quot;&lt;BOL&gt;forced to wrap to other lines&lt;/BOL&gt; so that &quot;</span> +</span><br><span class="line">                <span class="string">&quot;we can see the effects.&quot;</span> <span class="keyword">as</span> String;</span><br><span class="line">  <span class="comment">//At 2.x - GraphicElement polyTxtElm =</span></span><br><span class="line">  <span class="comment">//           LayoutElementFactory.Instance.CreatePolygonParagraphGraphicElement(</span></span><br><span class="line">  <span class="comment">//                                      layout, poly, text, sym);</span></span><br><span class="line">  <span class="comment">//         polyTxtElm.SetName(&quot;New Polygon Text&quot;);</span></span><br><span class="line"></span><br><span class="line">  GraphicElement polyTxtElm = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">    container, TextType.RectangleParagraph, poly, sym, text, <span class="string">&quot;Polygon Paragraph&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//(Optionally) Modify paragraph border </span></span><br><span class="line">  CIMGraphic polyTxtGra = polyTxtElm.GetGraphic();</span><br><span class="line">  CIMParagraphTextGraphic cimPolyTxtGra = polyTxtGra <span class="keyword">as</span> CIMParagraphTextGraphic;</span><br><span class="line">  cimPolyTxtGra.Frame.BorderSymbol = <span class="keyword">new</span> CIMSymbolReference();</span><br><span class="line">  cimPolyTxtGra.Frame.BorderSymbol.Symbol =</span><br><span class="line">               SymbolFactory.Instance.ConstructLineSymbol(</span><br><span class="line">                          ColorFactory.Instance.GreyRGB, <span class="number">1.0</span>, SimpleLineStyle.Solid);</span><br><span class="line">  polyTxtElm.SetGraphic(polyTxtGra);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建动态点文本元素"><a href="#创建动态点文本元素" class="headerlink" title="创建动态点文本元素"></a>创建动态点文本元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a dynamic text element.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Set the string with tags and the location</span></span><br><span class="line">String title = <span class="string">@&quot;&lt;dyn type = &quot;&quot;page&quot;&quot; property = &quot;&quot;name&quot;&quot; /&gt;&quot;</span>;</span><br><span class="line">Coordinate2D llTitle = <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">2.5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct element on worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Create with default text properties</span></span><br><span class="line">  <span class="comment">//At 2.x - TextElement titleGraphics =</span></span><br><span class="line">  <span class="comment">//          LayoutElementFactory.Instance.CreatePointTextGraphicElement(</span></span><br><span class="line">  <span class="comment">//                                  layout, llTitle, null) as TextElement;</span></span><br><span class="line">  TextElement titleGraphics = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">                container, TextType.PointText, llTitle.ToMapPoint()) <span class="keyword">as</span> TextElement;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Modify the text properties</span></span><br><span class="line">  titleGraphics.SetTextProperties(<span class="keyword">new</span> TextProperties(title, <span class="string">&quot;Arial&quot;</span>, <span class="number">24</span>, <span class="string">&quot;Bold&quot;</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建点文本元素-2"><a href="#创建点文本元素-2" class="headerlink" title="创建点文本元素 2"></a>创建点文本元素 2</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D coord2D = <span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">  ColorFactory.Instance.RedRGB, <span class="number">32</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> textString = <span class="string">&quot;Point text&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> elemInfo = <span class="keyword">new</span> ElementInfo() &#123; Anchor = Anchor.BottomLeftCorner &#125;;</span><br><span class="line">GraphicElement ptTxtElm = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">  container, TextType.PointText, coord2D.ToMapPoint(), sym, textString,</span><br><span class="line">  <span class="string">&quot;New Point Text&quot;</span>, <span class="literal">true</span>, elemInfo);</span><br></pre></td></tr></table></figure>

<h3 id="创建多边形段落文本元素"><a href="#创建多边形段落文本元素" class="headerlink" title="创建多边形段落文本元素"></a>创建多边形段落文本元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plyCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">6.7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">6.7</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">6.1</span>));</span><br><span class="line">plyCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">6.1</span>));</span><br><span class="line">Polygon poly = PolygonBuilderEx.CreatePolygon(plyCoords);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">     ColorFactory.Instance.GreyRGB, <span class="number">10</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;Some text string that is really long and &quot;</span> +</span><br><span class="line">              <span class="string">&quot;&lt;BOL&gt;wraps to other lines&lt;/BOL&gt;&quot;</span> +</span><br><span class="line">              <span class="string">&quot; so that we can see the effects.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">  container, TextType.PolygonParagraph, poly, sym, text,</span><br><span class="line">        <span class="string">&quot;New Polygon Text&quot;</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建矩形段落文本元素-2"><a href="#创建矩形段落文本元素-2" class="headerlink" title="创建矩形段落文本元素 2"></a>创建矩形段落文本元素 2</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">4.75</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">5.75</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">           ColorFactory.Instance.WhiteRGB, <span class="number">10</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;Some text string that is really long and &quot;</span> +</span><br><span class="line">              <span class="string">&quot;&lt;BOL&gt;wraps to other lines&lt;/BOL&gt;&quot;</span> +</span><br><span class="line">              <span class="string">&quot; so that we can see the effects.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//(Optionally) Modify border and background with 50% transparency </span></span><br><span class="line"><span class="comment">//CIMGraphic recTxtGra = recTxtElm.Graphic;</span></span><br><span class="line"><span class="comment">//CIMParagraphTextGraphic cimRecTxtGra = recTxtGra as CIMParagraphTextGraphic;</span></span><br><span class="line"><span class="comment">//CIMSymbolReference cimRecTxtBorder = cimRecTxtGra.Frame.BorderSymbol;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//CIMLineSymbol lineSym = SymbolFactory.Instance.ConstructLineSymbol(</span></span><br><span class="line"><span class="comment">//                    ColorFactory.Instance.BlackRGB, 1.0, SimpleLineStyle.Solid);</span></span><br><span class="line"><span class="comment">//cimRecTxtBorder.Symbol = lineSym;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//CIMSymbolReference cimRecTxtBkgrd = cimRecTxtGra.Frame.BackgroundSymbol;</span></span><br><span class="line"><span class="comment">//CIMPolygonSymbol polySym = SymbolFactory.Instance.ConstructPolygonSymbol(</span></span><br><span class="line"><span class="comment">//                            ColorFactory.Instance.GreyRGB, SimpleFillStyle.Solid);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//CIMColor symCol = polySym.GetColor(IElementContainer container);</span></span><br><span class="line"><span class="comment">//symCol.SetAlphaValue(50);</span></span><br><span class="line"><span class="comment">//cimRecTxtBkgrd.Symbol = polySym;</span></span><br><span class="line"><span class="comment">//recTxtElm.SetGraphic(recTxtGra);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreateTextGraphicElement(container,</span><br><span class="line">            TextType.RectangleParagraph, env, sym, text, <span class="string">&quot;New Rectangle Text&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建圆形文本元素"><a href="#创建圆形文本元素" class="headerlink" title="创建圆形文本元素"></a>创建圆形文本元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">4</span>);</span><br><span class="line"><span class="keyword">var</span> eabCir = <span class="keyword">new</span> EllipticArcBuilderEx(center, <span class="number">0.5</span>, ArcOrientation.ArcClockwise);</span><br><span class="line"><span class="keyword">var</span> cir = eabCir.ToSegment();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> poly = PolygonBuilderEx.CreatePolygon(</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(cir, AttributeFlags.AllAttributes));</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">                ColorFactory.Instance.GreenRGB, <span class="number">10</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;Circle, circle, circle&quot;</span>;</span><br><span class="line"></span><br><span class="line">GraphicElement cirTxtElm = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">  container, TextType.CircleParagraph, poly, sym, text, <span class="string">&quot;New Circle Text&quot;</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建贝塞尔文本元素"><a href="#创建贝塞尔文本元素" class="headerlink" title="创建贝塞尔文本元素"></a>创建贝塞尔文本元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D pt1 = <span class="keyword">new</span> Coordinate2D(<span class="number">3.5</span>, <span class="number">7.5</span>);</span><br><span class="line">Coordinate2D pt2 = <span class="keyword">new</span> Coordinate2D(<span class="number">4.16</span>, <span class="number">8</span>);</span><br><span class="line">Coordinate2D pt3 = <span class="keyword">new</span> Coordinate2D(<span class="number">4.83</span>, <span class="number">7.1</span>);</span><br><span class="line">Coordinate2D pt4 = <span class="keyword">new</span> Coordinate2D(<span class="number">5.5</span>, <span class="number">7.5</span>);</span><br><span class="line"><span class="keyword">var</span> bez = <span class="keyword">new</span> CubicBezierBuilderEx(pt1, pt2, pt3, pt4);</span><br><span class="line"><span class="keyword">var</span> bezSeg = bez.ToSegment();</span><br><span class="line">Polyline bezPl = PolylineBuilderEx.CreatePolyline(bezSeg, AttributeFlags.AllAttributes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">  ColorFactory.Instance.BlackRGB, <span class="number">24</span>, <span class="string">&quot;Comic Sans MS&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">  container, TextType.SplinedText, bezPl, sym, <span class="string">&quot;this is the bezier text&quot;</span>,</span><br><span class="line">        <span class="string">&quot;New Bezier Text&quot;</span>, <span class="literal">true</span>, <span class="keyword">new</span> ElementInfo() &#123; Anchor = Anchor.CenterPoint &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建椭圆文本元素"><a href="#创建椭圆文本元素" class="headerlink" title="创建椭圆文本元素"></a>创建椭圆文本元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">4.5</span>, <span class="number">2.75</span>);</span><br><span class="line"><span class="keyword">var</span> eabElp = <span class="keyword">new</span> EllipticArcBuilderEx(center, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.45</span>, ArcOrientation.ArcClockwise);</span><br><span class="line"><span class="keyword">var</span> ellipse = eabElp.ToSegment();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> poly = PolygonBuilderEx.CreatePolygon(</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(ellipse, AttributeFlags.AllAttributes));</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMTextSymbol sym = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">                      ColorFactory.Instance.BlueRGB, <span class="number">10</span>, <span class="string">&quot;Arial&quot;</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> text = <span class="string">&quot;Ellipse, ellipse, ellipse&quot;</span>;</span><br><span class="line"></span><br><span class="line">GraphicElement ge = ElementFactory.Instance.CreateTextGraphicElement(</span><br><span class="line">  container, TextType.PolygonParagraph, poly, sym, text, <span class="string">&quot;New Ellipse Text&quot;</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<h2 id="创建预定义的形状和箭头"><a href="#创建预定义的形状和箭头" class="headerlink" title="创建预定义的形状和箭头"></a>创建预定义的形状和箭头</h2><h3 id="创建预定义的形状图形元素"><a href="#创建预定义的形状图形元素" class="headerlink" title="创建预定义的形状图形元素"></a>创建预定义的形状图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//PredefinedShape shapeType =</span></span><br><span class="line"><span class="comment">//              PredefinedShape.Circle | Cloud | Cross |Circle | Triangle | ... ;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">4</span>, <span class="number">2.5</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">4.5</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">                ColorFactory.Instance.BlueRGB, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> poly_sym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">                 <span class="literal">null</span>, outline);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreatePredefinedShapeGraphicElement(</span><br><span class="line">                       container, shapeType, env.Center, env.Width, env.Height, </span><br><span class="line">                        poly_sym, shapeType.ToString(), <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建预定义的形状图形元素-1"><a href="#创建预定义的形状图形元素-1" class="headerlink" title="创建预定义的形状图形元素"></a>创建预定义的形状图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">6.5</span>, <span class="number">7</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">9</span>, <span class="number">9</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">                ColorFactory.Instance.GreenRGB, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">var</span> poly_sym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">                 <span class="literal">null</span>, outline);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreatePredefinedShapeGraphicElement(</span><br><span class="line">  container, PredefinedShape.RoundedRectangle, env, poly_sym, <span class="string">&quot;Rounded Rect&quot;</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建预定义的形状图形元素-2"><a href="#创建预定义的形状图形元素-2" class="headerlink" title="创建预定义的形状图形元素"></a>创建预定义的形状图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">2</span>, <span class="number">2.75</span>);</span><br><span class="line"><span class="keyword">var</span> eabElp = <span class="keyword">new</span> EllipticArcBuilderEx(</span><br><span class="line">                         center, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.45</span>, ArcOrientation.ArcClockwise);</span><br><span class="line"><span class="keyword">var</span> ellipse = eabElp.ToSegment();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set symbolology, create and add element to layout</span></span><br><span class="line">CIMStroke outline = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">                      ColorFactory.Instance.GreenRGB, <span class="number">2.0</span>, SimpleLineStyle.Dot);</span><br><span class="line">CIMPolygonSymbol ellipseSym = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">                 ColorFactory.Instance.GreyRGB, SimpleFillStyle.Vertical, outline);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> poly = PolygonBuilderEx.CreatePolygon(</span><br><span class="line">  PolylineBuilderEx.CreatePolyline(ellipse, AttributeFlags.AllAttributes));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ge = ElementFactory.Instance.CreatePredefinedShapeGraphicElement(</span><br><span class="line">  container, PredefinedShape.Ellipse, poly.Extent.Center, <span class="number">0</span>, <span class="number">0</span>, ellipseSym, </span><br><span class="line">  <span class="string">&quot;New Ellipse2&quot;</span>, <span class="literal">false</span>, <span class="keyword">new</span> ElementInfo() &#123; Anchor = Anchor.TopRightCorner &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建线箭头元素"><a href="#创建线箭头元素" class="headerlink" title="创建线箭头元素"></a>创建线箭头元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">List&lt;Coordinate2D&gt; plCoords = <span class="keyword">new</span> List&lt;Coordinate2D&gt;();</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">8.5</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">1.66</span>, <span class="number">9</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">2.33</span>, <span class="number">8.1</span>));</span><br><span class="line">plCoords.Add(<span class="keyword">new</span> Coordinate2D(<span class="number">3</span>, <span class="number">8.5</span>));</span><br><span class="line">Polyline linePl = PolylineBuilderEx.CreatePolyline(plCoords);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arrowInfo = <span class="keyword">new</span> ArrowInfo()</span><br><span class="line">&#123;</span><br><span class="line">  ArrowHeadKey = ArrowInfo.DefaultArrowHeadKeys[<span class="number">8</span>],</span><br><span class="line">  ArrowOnBothEnds = <span class="literal">true</span>,</span><br><span class="line">  ArrowSizePoints = <span class="number">24</span>,</span><br><span class="line">  LineWidthPoints = <span class="number">12</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create and add element to layout</span></span><br><span class="line">GraphicElement lineElm = ElementFactory.Instance.CreateArrowGraphicElement(</span><br><span class="line">  container, linePl, arrowInfo, <span class="string">&quot;Arrow Line&quot;</span>, <span class="literal">true</span>, </span><br><span class="line">                            <span class="keyword">new</span> ElementInfo() &#123; Rotation = <span class="number">15.0</span> &#125;);</span><br><span class="line"><span class="comment">//lineElm.SetName(&quot;New Line&quot;);</span></span><br></pre></td></tr></table></figure>

<h2 id="图片元素"><a href="#图片元素" class="headerlink" title="图片元素"></a>图片元素</h2><h3 id="使用-CIMSymbol-创建图片图形元素"><a href="#使用-CIMSymbol-创建图片图形元素" class="headerlink" title="使用 CIMSymbol 创建图片图形元素"></a>使用 CIMSymbol 创建图片图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">0.5</span>, <span class="number">1</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">2.5</span>, <span class="number">2</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create and add element to layout</span></span><br><span class="line"><span class="comment">//string picPath = ApplicationUtilities.BASEPATH + _settings.baseFolder + &quot;irefusetowatchthismovi�.jpg&quot;;</span></span><br><span class="line"><span class="keyword">var</span> pic_gr = ElementFactory.Instance.CreatePictureGraphicElement(</span><br><span class="line">  layout, env.Center, picPath, <span class="string">&quot;New Picture&quot;</span>, <span class="literal">true</span>, <span class="keyword">new</span> ElementInfo() &#123; Anchor = Anchor.CenterPoint &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用高级符号设置创建新的图片元素"><a href="#使用高级符号设置创建新的图片元素" class="headerlink" title="使用高级符号设置创建新的图片元素"></a>使用高级符号设置创建新的图片元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a picture element and also set background and border symbology.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D envelope geometry</span></span><br><span class="line">  Coordinate2D pic_ll = <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">1</span>);</span><br><span class="line">  Coordinate2D pic_ur = <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">2</span>);</span><br><span class="line">  <span class="comment">//At 2.x - Envelope env = EnvelopeBuilder.CreateEnvelope(pic_ll, pic_ur);</span></span><br><span class="line">  Envelope env = EnvelopeBuilderEx.CreateEnvelope(pic_ll, pic_ur);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Create and add element to layout</span></span><br><span class="line">  <span class="built_in">string</span> picPath = <span class="string">@&quot;C:\Temp\WhitePass.jpg&quot;</span>;</span><br><span class="line">  <span class="comment">//At 2.x - GraphicElement picElm =</span></span><br><span class="line">  <span class="comment">//    LayoutElementFactory.Instance.CreatePictureGraphicElement(</span></span><br><span class="line">  <span class="comment">//                                             layout, env, picPath);</span></span><br><span class="line">  <span class="comment">//         picElm.SetName(&quot;New Picture&quot;);</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  GraphicElement picElm = ElementFactory.Instance.CreatePictureGraphicElement(</span><br><span class="line">                                       layout, env, picPath, <span class="string">&quot;New Picture&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//(Optionally) Modify the border and shadow </span></span><br><span class="line">  CIMGraphic picGra = picElm.GetGraphic();</span><br><span class="line">  CIMPictureGraphic cimPicGra = picGra <span class="keyword">as</span> CIMPictureGraphic;</span><br><span class="line">  cimPicGra.Frame.BorderSymbol = <span class="keyword">new</span> CIMSymbolReference();</span><br><span class="line">  cimPicGra.Frame.BorderSymbol.Symbol =</span><br><span class="line">        SymbolFactory.Instance.ConstructLineSymbol(</span><br><span class="line">               ColorFactory.Instance.BlueRGB, <span class="number">2.0</span>, SimpleLineStyle.Solid);</span><br><span class="line"></span><br><span class="line">  cimPicGra.Frame.ShadowSymbol = <span class="keyword">new</span> CIMSymbolReference();</span><br><span class="line">  cimPicGra.Frame.ShadowSymbol.Symbol =</span><br><span class="line">              SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">                    ColorFactory.Instance.BlackRGB, SimpleFillStyle.Solid);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Update the element</span></span><br><span class="line">  picElm.SetGraphic(picGra);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="创建地图框和环绕要素"><a href="#创建地图框和环绕要素" class="headerlink" title="创建地图框和环绕要素"></a>创建地图框和环绕要素</h2><h3 id="创建地图框并设置照相机"><a href="#创建地图框并设置照相机" class="headerlink" title="创建地图框并设置照相机"></a>创建地图框并设置照相机</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a map frame and set its camera by zooming to the extent of an existing bookmark.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D envelope geometry</span></span><br><span class="line">  Coordinate2D mf_ll = <span class="keyword">new</span> Coordinate2D(<span class="number">6.0</span>, <span class="number">8.5</span>);</span><br><span class="line">  Coordinate2D mf_ur = <span class="keyword">new</span> Coordinate2D(<span class="number">8.0</span>, <span class="number">10.5</span>);</span><br><span class="line">  <span class="comment">//At 2.x - Envelope mf_env = EnvelopeBuilder.CreateEnvelope(mf_ll, mf_ur);</span></span><br><span class="line">  Envelope mf_env = EnvelopeBuilderEx.CreateEnvelope(mf_ll, mf_ur);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference map, create MF and add to layout</span></span><br><span class="line">  MapProjectItem mapPrjItem = Project.Current.GetItems&lt;MapProjectItem&gt;()</span><br><span class="line">                       .FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;Map&quot;</span>));</span><br><span class="line">  Map mfMap = mapPrjItem.GetMap();</span><br><span class="line">  Bookmark bookmark = mfMap.GetBookmarks().FirstOrDefault(</span><br><span class="line">                        b =&gt; b.Name == <span class="string">&quot;Great Lakes&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//At 2.x - MapFrame mfElm =</span></span><br><span class="line">  <span class="comment">//                  LayoutElementFactory.Instance.CreateMapFrame(</span></span><br><span class="line">  <span class="comment">//                                             layout, mf_env, mfMap);</span></span><br><span class="line">  <span class="comment">//         mfElm.SetName(&quot;New Map Frame&quot;);</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  MapFrame mfElm = ElementFactory.Instance.CreateMapFrameElement(</span><br><span class="line">                       layout, mf_env, mfMap, <span class="string">&quot;New Map Frame&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Zoom to bookmark</span></span><br><span class="line">  mfElm.SetCamera(bookmark);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建图例"><a href="#创建图例" class="headerlink" title="创建图例"></a>创建图例</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a legend for an associated map frame.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D envelope geometry</span></span><br><span class="line">  Coordinate2D leg_ll = <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">2.5</span>);</span><br><span class="line">  Coordinate2D leg_ur = <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4.5</span>);</span><br><span class="line">  <span class="comment">//At 2.x - Envelope leg_env = EnvelopeBuilder.CreateEnvelope(leg_ll, leg_ur);</span></span><br><span class="line">  Envelope leg_env = EnvelopeBuilderEx.CreateEnvelope(leg_ll, leg_ur);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference MF, create legend and add to layout</span></span><br><span class="line">  MapFrame mapFrame = layout.FindElement(<span class="string">&quot;New Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">  <span class="keyword">if</span> (mapFrame == <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//TODO handle null map frame</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//At 2.x - Legend legendElm = LayoutElementFactory.Instance.CreateLegend(</span></span><br><span class="line">  <span class="comment">//                                               layout, leg_env, mapFrame);</span></span><br><span class="line">  <span class="comment">//         legendElm.SetName(&quot;New Legend&quot;); </span></span><br><span class="line">  <span class="keyword">var</span> legendInfo = <span class="keyword">new</span> LegendInfo()</span><br><span class="line">  &#123;</span><br><span class="line">    MapFrameName = mapFrame.Name</span><br><span class="line">  &#125;;</span><br><span class="line">  Legend legendElm = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">                      layout, leg_env, legendInfo, <span class="string">&quot;New Legend&quot;</span>) <span class="keyword">as</span> Legend;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="从样式项创建比例尺"><a href="#从样式项创建比例尺" class="headerlink" title="从样式项创建比例尺"></a>从样式项创建比例尺</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a scale bar using a style.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Search for a style project item by name</span></span><br><span class="line">StyleProjectItem arcgis_2dStyle = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">                            .First(si =&gt; si.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Reference the specific scale bar by name </span></span><br><span class="line">  ScaleBarStyleItem scaleBarItem = arcgis_2dStyle.SearchScaleBars(</span><br><span class="line">                     <span class="string">&quot;Double Alternating Scale Bar&quot;</span>).FirstOrDefault();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference the map frame and define the location</span></span><br><span class="line">  MapFrame myMapFrame = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">  Coordinate2D coord2D = <span class="keyword">new</span> Coordinate2D(<span class="number">10.0</span>, <span class="number">7.0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Construct the scale bar</span></span><br><span class="line">  <span class="comment">//At 2.x - LayoutElementFactory.Instance.CreateScaleBar(</span></span><br><span class="line">  <span class="comment">//             layout, coord2D, myMapFrame, scaleBarItem);</span></span><br><span class="line">  <span class="keyword">var</span> sbarInfo = <span class="keyword">new</span> ScaleBarInfo()</span><br><span class="line">  &#123;</span><br><span class="line">    MapFrameName = myMapFrame.Name,</span><br><span class="line">    ScaleBarStyleItem = scaleBarItem</span><br><span class="line">  &#125;;</span><br><span class="line">  ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">          layout, coord2D.ToMapPoint(), sbarInfo);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="从样式项-1-创建指北针"><a href="#从样式项-1-创建指北针" class="headerlink" title="从样式项 1 创建指北针"></a>从样式项 1 创建指北针</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a north arrow using a style.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Search for a style project item by name</span></span><br><span class="line">StyleProjectItem arcgis2dStyles = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">                  .First(si =&gt; si.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  NorthArrowStyleItem naStyleItem = arcgis2dStyles.SearchNorthArrows(</span><br><span class="line">                <span class="string">&quot;ArcGIS North 13&quot;</span>).FirstOrDefault();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference the map frame and define the location</span></span><br><span class="line">  MapFrame newFrame = layout.FindElement(<span class="string">&quot;New Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">  Coordinate2D nArrow = <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">2.5</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Construct the north arrow</span></span><br><span class="line">  <span class="comment">//At 2.x - var newNorthArrow = LayoutElementFactory.Instance.CreateNorthArrow(</span></span><br><span class="line">  <span class="comment">//                        layout, nArrow, newFrame, naStyleItem);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> naInfo = <span class="keyword">new</span> NorthArrowInfo()</span><br><span class="line">  &#123;</span><br><span class="line">    MapFrameName = newFrame.Name,</span><br><span class="line">    NorthArrowStyleItem = naStyleItem</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> newNorthArrow = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">                          layout, nArrow.ToMapPoint(), naInfo);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建表格框"><a href="#创建表格框" class="headerlink" title="创建表格框"></a>创建表格框</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a table frame.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Build 2D envelope geometry</span></span><br><span class="line">  Coordinate2D rec_ll = <span class="keyword">new</span> Coordinate2D(<span class="number">1.0</span>, <span class="number">3.5</span>);</span><br><span class="line">  Coordinate2D rec_ur = <span class="keyword">new</span> Coordinate2D(<span class="number">7.5</span>, <span class="number">4.5</span>);</span><br><span class="line">  <span class="comment">//At 2.x - Envelope rec_env = EnvelopeBuilder.CreateEnvelope(rec_ll, rec_ur);</span></span><br><span class="line">  Envelope rec_env = EnvelopeBuilderEx.CreateEnvelope(rec_ll, rec_ur);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference map frame and layer</span></span><br><span class="line">  MapFrame mf = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">  FeatureLayer lyr = mf.Map.FindLayers(<span class="string">&quot;GreatLakes&quot;</span>).First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Build fields list</span></span><br><span class="line">  <span class="keyword">var</span> fields = <span class="keyword">new</span>[] &#123; <span class="string">&quot;NAME&quot;</span>, <span class="string">&quot;Shape_Area&quot;</span>, <span class="string">&quot;Shape_Length&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Construct the table frame</span></span><br><span class="line">  <span class="comment">//At 2.x - TableFrame tabFrame = LayoutElementFactory.Instance.CreateTableFrame(</span></span><br><span class="line">  <span class="comment">//              layout, rec_env, mf, lyr, fields);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> tableFrameInfo = <span class="keyword">new</span> TableFrameInfo()</span><br><span class="line">  &#123;</span><br><span class="line">    FieldNames = fields,</span><br><span class="line">    MapFrameName = mf.Name,</span><br><span class="line">    MapMemberUri = lyr.URI</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">var</span> tabFrame = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">    layout, rec_env, tableFrameInfo) <span class="keyword">as</span> TableFrame;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建地图框-1"><a href="#创建地图框-1" class="headerlink" title="创建地图框 1"></a>创建地图框 1</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">2.0</span>, <span class="number">4.5</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">6.5</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference map, create MF and add to layout</span></span><br><span class="line"><span class="comment">//var map = MapView.Active.Map;</span></span><br><span class="line"><span class="comment">//var map = mapProjectItem.GetMap();</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">MapFrame mfElm = ElementFactory.Instance.CreateMapFrameElement(</span><br><span class="line">                                                layout, env, map);</span><br></pre></td></tr></table></figure>

<h3 id="创建地图框-2"><a href="#创建地图框-2" class="headerlink" title="创建地图框 2"></a>创建地图框 2</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">4.0</span>, <span class="number">2.5</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">7.0</span>, <span class="number">5.5</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference map, create MF and add to layout</span></span><br><span class="line"><span class="comment">//var map = MapView.Active.Map;</span></span><br><span class="line"><span class="comment">//var map = mapProjectItem.GetMap();</span></span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">MapFrame mfElm = ElementFactory.Instance.CreateMapFrameElement(</span><br><span class="line">  layout, env.Center, map);</span><br></pre></td></tr></table></figure>

<h3 id="创建图例-2"><a href="#创建图例-2" class="headerlink" title="创建图例 2"></a>创建图例 2</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">6</span>, <span class="number">2.5</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">8</span>, <span class="number">4.5</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference MF, create legend and add to layout</span></span><br><span class="line">MapFrame mf = layout.FindElement(mapFrameName) <span class="keyword">as</span> MapFrame;</span><br><span class="line"><span class="keyword">var</span> surroundInfo = <span class="keyword">new</span> LegendInfo()</span><br><span class="line">&#123;</span><br><span class="line">  MapFrameName = mf.Name</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> legendElm = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">  layout, env.Center, surroundInfo) <span class="keyword">as</span> Legend;</span><br><span class="line">legendElm.SetName(<span class="string">&quot;New Legend&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="从样式项-2-创建指北针"><a href="#从样式项-2-创建指北针" class="headerlink" title="从样式项 2 创建指北针"></a>从样式项 2 创建指北针</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D center = <span class="keyword">new</span> Coordinate2D(<span class="number">7</span>, <span class="number">5.5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a North Arrow in a style</span></span><br><span class="line">StyleProjectItem stylePrjItm = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">                               .FirstOrDefault(item =&gt; item.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line">NorthArrowStyleItem naStyleItm = stylePrjItm.SearchNorthArrows(</span><br><span class="line">                                       <span class="string">&quot;ArcGIS North 10&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference MF, create north arrow and add to layout </span></span><br><span class="line"><span class="comment">//var mf = container.FindElement(&quot;New Map Frame&quot;) as MapFrame;</span></span><br><span class="line"><span class="keyword">var</span> mf = layout.FindElement(MapFrameName) <span class="keyword">as</span> MapFrame;</span><br><span class="line"><span class="keyword">var</span> narrow_info = <span class="keyword">new</span> NorthArrowInfo()</span><br><span class="line">&#123;</span><br><span class="line">  MapFrameName = mf.Name,</span><br><span class="line">  NorthArrowStyleItem = naStyleItm</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> arrowElm = (NorthArrow)ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">  layout, center.ToMapPoint(), narrow_info) <span class="keyword">as</span> NorthArrow;</span><br><span class="line">arrowElm.SetName(<span class="string">&quot;New North Arrow&quot;</span>);</span><br><span class="line">arrowElm.SetHeight(<span class="number">1.75</span>);</span><br><span class="line">arrowElm.SetX(<span class="number">7</span>);</span><br><span class="line">arrowElm.SetY(<span class="number">6</span>);</span><br></pre></td></tr></table></figure>

<h3 id="创建表格框-1"><a href="#创建表格框-1" class="headerlink" title="创建表格框"></a>创建表格框</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">Envelope env = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tableFrameInfo = <span class="keyword">new</span> TableFrameInfo()</span><br><span class="line">&#123;</span><br><span class="line">  MapFrameName = mapFrameName,</span><br><span class="line">  MapMemberUri = uri</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> attribs = <span class="keyword">new</span> List&lt;CIMStringMap&gt;();</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">  attribs.Add(<span class="keyword">new</span> CIMStringMap</span><br><span class="line">  &#123;</span><br><span class="line">    Key = <span class="string">$&quot;Key <span class="subst">&#123;i&#125;</span>&quot;</span>,</span><br><span class="line">    Value = <span class="string">$&quot;Value <span class="subst">&#123;i&#125;</span>&quot;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> elemInfo = <span class="keyword">new</span> ElementInfo()</span><br><span class="line">&#123;</span><br><span class="line">  CustomProperties = attribs</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> tableFrameElem = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">                              layout, env.Center, tableFrameInfo,</span><br><span class="line">                              <span class="string">&quot;New Table Frame&quot;</span>, <span class="literal">false</span>, elemInfo) <span class="keyword">as</span> TableFrame;</span><br></pre></td></tr></table></figure>

<h3 id="创建比例尺"><a href="#创建比例尺" class="headerlink" title="创建比例尺"></a>创建比例尺</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">5.0</span>, <span class="number">6</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">6.0</span>, <span class="number">7</span>);</span><br><span class="line">Envelope sbEnv = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a Scale Bar in a style</span></span><br><span class="line">StyleProjectItem stylePrjItm = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">              .FirstOrDefault(item =&gt; item.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line">ScaleBarStyleItem sbStyleItm = stylePrjItm.SearchScaleBars(</span><br><span class="line">             <span class="string">&quot;Alternating Scale Bar 1&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//ScaleBarStyleItem sbStyleItm = stylePrjItm.SearchScaleBars(</span></span><br><span class="line"><span class="comment">//                                   &quot;Double Alternating Scale Bar 1&quot;)[0];</span></span><br><span class="line"><span class="comment">//ScaleBarStyleItem sbStyleItm = stylePrjItm.SearchScaleBars(</span></span><br><span class="line"><span class="comment">//                                    &quot;Hollow Scale Bar 1&quot;)[0];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create Scale Bar</span></span><br><span class="line">ScaleBarInfo sbInfo = <span class="keyword">new</span> ScaleBarInfo()</span><br><span class="line">&#123;</span><br><span class="line">  MapFrameName = mapFrame.Name</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sbElm = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">                                   layout, sbEnv, sbInfo) <span class="keyword">as</span> ScaleBar;</span><br></pre></td></tr></table></figure>

<h3 id="创建比例线"><a href="#创建比例线" class="headerlink" title="创建比例线"></a>创建比例线</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on QueuedTask.Run(() =&gt; &#123; ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Build geometry</span></span><br><span class="line">Coordinate2D ll = <span class="keyword">new</span> Coordinate2D(<span class="number">5.0</span>, <span class="number">8</span>);</span><br><span class="line">Coordinate2D ur = <span class="keyword">new</span> Coordinate2D(<span class="number">6.0</span>, <span class="number">9</span>);</span><br><span class="line">Envelope sbEnv = EnvelopeBuilderEx.CreateEnvelope(ll, ur);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a Scale Bar in a style</span></span><br><span class="line">StyleProjectItem stylePrjItm = Project.Current.GetItems&lt;StyleProjectItem&gt;()</span><br><span class="line">                             .FirstOrDefault(item =&gt; item.Name == <span class="string">&quot;ArcGIS 2D&quot;</span>);</span><br><span class="line">ScaleBarStyleItem sbStyleItm = stylePrjItm.SearchScaleBars(</span><br><span class="line">                              <span class="string">&quot;Scale Line 1&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//ScaleBarStyleItem sbStyleItm = stylePrjItm.SearchScaleBars(</span></span><br><span class="line"><span class="comment">//                                           &quot;Stepped Scale Line&quot;)[0];</span></span><br><span class="line"><span class="comment">//ScaleBarStyleItem sbStyleItm = stylePrjItm.SearchScaleBars(</span></span><br><span class="line"><span class="comment">//                                            &quot;Scale Line 2&quot;)[0];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create Scale Bar</span></span><br><span class="line">ScaleBarInfo sbInfo = <span class="keyword">new</span> ScaleBarInfo()</span><br><span class="line">&#123;</span><br><span class="line">  MapFrameName = mapFrame.Name,</span><br><span class="line">  ScaleBarStyleItem = sbStyleItm</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sbElm = ElementFactory.Instance.CreateMapSurroundElement(</span><br><span class="line">                  layout, sbEnv, sbInfo, <span class="string">&quot;ScaleBar Line&quot;</span>) <span class="keyword">as</span> ScaleBar;</span><br></pre></td></tr></table></figure>

<h2 id="组元素"><a href="#组元素" class="headerlink" title="组元素"></a>组元素</h2><h3 id="创建空组元素"><a href="#创建空组元素" class="headerlink" title="创建空组元素"></a>创建空组元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create an empty group element at the root level of the contents pane</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create on worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//At 2.x - GroupElement grp1 =</span></span><br><span class="line">  <span class="comment">//             LayoutElementFactory.Instance.CreateGroupElement(layout);</span></span><br><span class="line">  <span class="comment">//         grp1.SetName(&quot;Group&quot;); </span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//container is IElementContainer - GroupLayer or Layout</span></span><br><span class="line">  GroupElement grp1 = ElementFactory.Instance.CreateGroupElement(</span><br><span class="line">                        container, <span class="literal">null</span>, <span class="string">&quot;Group&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// *** or ***</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a group element inside another group element</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Find an existing group element</span></span><br><span class="line"><span class="comment">//container is IElementContainer - GroupLayer or Layout</span></span><br><span class="line">GroupElement existingGroup = container.FindElement(<span class="string">&quot;Group&quot;</span>) <span class="keyword">as</span> GroupElement;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create on worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//At 2.x - GroupElement grp2 =</span></span><br><span class="line">  <span class="comment">//      LayoutElementFactory.Instance.CreateGroupElement(existingGroup);</span></span><br><span class="line">  <span class="comment">//         grp2.SetName(&quot;Group in Group&quot;);</span></span><br><span class="line">  GroupElement grp2 = ElementFactory.Instance.CreateGroupElement(</span><br><span class="line">    existingGroup, <span class="literal">null</span>, <span class="string">&quot;Group in Group&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建包含元素的组元素"><a href="#创建包含元素的组元素" class="headerlink" title="创建包含元素的组元素"></a>创建包含元素的组元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a group with a list of elements at the root level of the contents pane.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Find an existing elements</span></span><br><span class="line"><span class="comment">//container is IElementContainer - GroupLayer or Layout</span></span><br><span class="line"><span class="keyword">var</span> elem1 = container.FindElement(<span class="string">&quot;Polygon 1&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> elem2 = container.FindElement(<span class="string">&quot;Bezier Text&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> elem3 = container.FindElement(<span class="string">&quot;Cloud Shape 2&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct a list and add the elements</span></span><br><span class="line"><span class="keyword">var</span> elmList = <span class="keyword">new</span> List&lt;Element&gt;</span><br><span class="line">&#123;</span><br><span class="line">  elem1,</span><br><span class="line">  elem2,</span><br><span class="line">  elem3</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//At 2.x - GroupElement groupWithListOfElementsAtRoot =</span></span><br><span class="line">  <span class="comment">//             LayoutElementFactory.Instance.CreateGroupElement(layout, elmList);</span></span><br><span class="line">  <span class="comment">//groupWithListOfElementsAtRoot.SetName(&quot;Group with list of elements at root&quot;);</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  GroupElement groupWithListOfElementsAtRoot =</span><br><span class="line">          ElementFactory.Instance.CreateGroupElement(</span><br><span class="line">                   container, elmList, <span class="string">&quot;Group with list of elements at root&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// *** or ***</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a group using a list of element names at the root level of the contents pane.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//List of element names</span></span><br><span class="line"><span class="keyword">var</span> elmNameList = <span class="keyword">new</span>[] &#123; <span class="string">&quot;Para Text1&quot;</span>, <span class="string">&quot;Line 3&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//At 2.x - GroupElement groupWithListOfElementNamesAtRoot =</span></span><br><span class="line">  <span class="comment">//   LayoutElementFactory.Instance.CreateGroupElement(layout, elmNameList);</span></span><br><span class="line">  <span class="comment">//         groupWithListOfElementNamesAtRoot.SetName(</span></span><br><span class="line">  <span class="comment">//                  &quot;Group with list of element names at root&quot;);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//At 3.x, use the names to find the relevant elements first</span></span><br><span class="line">  <span class="comment">//container is IElementContainer - GroupLayer or Layout</span></span><br><span class="line">  <span class="keyword">var</span> elems = container.FindElements(elmNameList);</span><br><span class="line">  GroupElement groupWithListOfElementNamesAtRoot =</span><br><span class="line">      ElementFactory.Instance.CreateGroupElement(</span><br><span class="line">           container, elems, <span class="string">&quot;Group with list of element names at root&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="布局元素和选择"><a href="#布局元素和选择" class="headerlink" title="布局元素和选择"></a>布局元素和选择</h2><h3 id="在布局上查找元素"><a href="#在布局上查找元素" class="headerlink" title="在布局上查找元素"></a>在布局上查找元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Find an element on a layout.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Reference a layout project item by name</span></span><br><span class="line">LayoutProjectItem layoutItem = Project.Current.GetItems&lt;LayoutProjectItem&gt;().FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;MyLayout&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (layoutItem != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">    Layout mylayout = layoutItem.GetLayout();</span><br><span class="line">    <span class="keyword">if</span> (mylayout != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//Find a single specific element</span></span><br><span class="line">      Element rect = mylayout.FindElement(<span class="string">&quot;Rectangle&quot;</span>) <span class="keyword">as</span> Element;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Or use the Elements collection</span></span><br><span class="line">      Element rect2 = mylayout.Elements.FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;Rectangle&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查找布局元素"><a href="#查找布局元素" class="headerlink" title="查找布局元素"></a>查找布局元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//on the QueuedTask</span></span><br><span class="line"><span class="comment">//Find elements by name</span></span><br><span class="line"><span class="keyword">var</span> layoutElementsToFind = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Point 1&quot;</span>, <span class="string">&quot;Line 3&quot;</span>, <span class="string">&quot;Text 1&quot;</span> &#125;);</span><br><span class="line"><span class="comment">//Get the collection of elements from the page layout. Nesting within GroupElement is preserved.</span></span><br><span class="line"><span class="keyword">var</span> elementCollection = layout.GetElements();</span><br><span class="line"><span class="comment">//Get the collection of Element from the page layout as a flattened list. Nested groups within GroupElement are not preserved.</span></span><br><span class="line"><span class="keyword">var</span> elements = layout.GetElementsAsFlattenedList();</span><br><span class="line"><span class="comment">//Convert collection of the elements to a collection of GraphicElements.</span></span><br><span class="line"><span class="keyword">var</span> graphicElements = elements.ToList().ConvertAll(x =&gt; (GraphicElement)x);</span><br><span class="line"><span class="comment">//Find elements by type</span></span><br><span class="line"><span class="comment">//Find all point graphics in the Layout</span></span><br><span class="line"><span class="keyword">var</span> pointGraphics = graphicElements.Where(elem =&gt; elem.GetGraphic() <span class="keyword">is</span> CIMPointGraphic);</span><br><span class="line"><span class="comment">//Find all line graphics in the Graphics Layer</span></span><br><span class="line"><span class="keyword">var</span> lineGraphics = graphicElements.Where(elem =&gt; elem.GetGraphic() <span class="keyword">is</span> CIMLineGraphic);</span><br><span class="line"><span class="comment"><span class="doctag">///</span>/Find all polygon graphics in the Graphics Layer</span></span><br><span class="line"><span class="keyword">var</span> polyGraphics = graphicElements.Where(elem =&gt; elem.GetGraphic() <span class="keyword">is</span> CIMPolygonGraphic);</span><br><span class="line"><span class="comment"><span class="doctag">///</span>/Find all text graphics in the Graphics Layer</span></span><br><span class="line"><span class="keyword">var</span> textGraphics = graphicElements.Where(elem =&gt; elem.GetGraphic() <span class="keyword">is</span> CIMTextGraphic);</span><br><span class="line"><span class="comment"><span class="doctag">///</span>/Find all picture graphics in the Graphics Layer</span></span><br><span class="line"><span class="keyword">var</span> pictureGraphic = graphicElements.Where(elem =&gt; elem.GetGraphic() <span class="keyword">is</span> CIMPictureGraphic);</span><br></pre></td></tr></table></figure>

<h3 id="更新元素属性"><a href="#更新元素属性" class="headerlink" title="更新元素属性"></a>更新元素属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Update an element&#x27;s properties.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Performed on worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// update an element&#x27;s name</span></span><br><span class="line">  element.SetName(<span class="string">&quot;New Name&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// update and element&#x27;s visibility</span></span><br><span class="line">  element.SetVisible(<span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="获取元素选择计数"><a href="#获取元素选择计数" class="headerlink" title="获取元素选择计数"></a>获取元素选择计数</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get element&#x27;s selection count.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Count the number of selected elements on the active layout view</span></span><br><span class="line">LayoutView activeLayoutView = LayoutView.Active;</span><br><span class="line"><span class="keyword">if</span> (activeLayoutView != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> selectedElements = activeLayoutView.GetSelectedElements();</span><br><span class="line">  ArcGIS.Desktop.Framework.Dialogs.MessageBox.Show(<span class="string">$@&quot;Selected elements: <span class="subst">&#123;selectedElements.Count&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="设置元素选择"><a href="#设置元素选择" class="headerlink" title="设置元素选择"></a>设置元素选择</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Set the active layout view&#x27;s selection to include 2 rectangle elements.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference the active view </span></span><br><span class="line">LayoutView activeLayoutView = LayoutView.Active;</span><br><span class="line"><span class="keyword">if</span> (activeLayoutView != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Perform on the worker thread</span></span><br><span class="line">  QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Reference the layout</span></span><br><span class="line">    Layout lyt = activeLayoutView.Layout;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Reference the two rectangle elements</span></span><br><span class="line">    Element rec = lyt.FindElement(<span class="string">&quot;Rectangle&quot;</span>);</span><br><span class="line">    Element rec2 = lyt.FindElement(<span class="string">&quot;Rectangle 2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Construct a list and add the elements</span></span><br><span class="line">    List&lt;Element&gt; elmList = <span class="keyword">new</span> List&lt;Element&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      rec,</span><br><span class="line">      rec2</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Set the selection</span></span><br><span class="line">    activeLayoutView.SelectElements(elmList);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="取消选择布局上的元素"><a href="#取消选择布局上的元素" class="headerlink" title="取消选择布局上的元素"></a>取消选择布局上的元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Unselect one element.</span></span><br><span class="line"><span class="keyword">var</span> elementToUnSelect = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;MyPoint&quot;</span> &#125;).FirstOrDefault();</span><br><span class="line">layout.UnSelectElement(elementToUnSelect);</span><br><span class="line"><span class="comment">//Unselect multiple elements.</span></span><br><span class="line"><span class="keyword">var</span> elementsToUnSelect = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Point 1&quot;</span>, <span class="string">&quot;Line 3&quot;</span>, <span class="string">&quot;Text 1&quot;</span> &#125;);</span><br><span class="line">layout.UnSelectElements(elementsToUnSelect);</span><br></pre></td></tr></table></figure>

<h3 id="在布局视图中取消选择元素"><a href="#在布局视图中取消选择元素" class="headerlink" title="在布局视图中取消选择元素"></a>在布局视图中取消选择元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LayoutView layoutView = LayoutView.Active;</span><br><span class="line"><span class="comment">//Unselect one element.</span></span><br><span class="line"><span class="keyword">var</span> elementToUnSelectInView = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;MyPoint&quot;</span> &#125;).FirstOrDefault();</span><br><span class="line">layoutView.UnSelectElement(elementToUnSelect);</span><br><span class="line"><span class="comment">//Unselect multiple elements.</span></span><br><span class="line"><span class="keyword">var</span> elementsToUnSelectInView = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Point 1&quot;</span>, <span class="string">&quot;Line 3&quot;</span>, <span class="string">&quot;Text 1&quot;</span> &#125;);</span><br><span class="line">layoutView.UnSelectElements(elementsToUnSelect);</span><br></pre></td></tr></table></figure>

<h3 id="清除布局视图中的选择"><a href="#清除布局视图中的选择" class="headerlink" title="清除布局视图中的选择"></a>清除布局视图中的选择</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//If the a layout view is active, clear its selection</span></span><br><span class="line">LayoutView activeLayoutView = LayoutView.Active;</span><br><span class="line"><span class="keyword">if</span> (activeLayoutView != <span class="literal">null</span>)</span><br><span class="line">&#123;          </span><br><span class="line">  activeLayoutView.ClearElementSelection();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="清除布局中的所选内容"><a href="#清除布局中的所选内容" class="headerlink" title="清除布局中的所选内容"></a>清除布局中的所选内容</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Clear the layout selection.</span></span><br><span class="line">layout.ClearElementSelection();</span><br></pre></td></tr></table></figure>

<h3 id="复制布局元素"><a href="#复制布局元素" class="headerlink" title="复制布局元素"></a>复制布局元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//on the QueuedTask</span></span><br><span class="line"><span class="keyword">var</span> elems = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Point 1&quot;</span>, <span class="string">&quot;Line 3&quot;</span>, <span class="string">&quot;Text 1&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">var</span> copiedElements = layout.CopyElements(elems);</span><br></pre></td></tr></table></figure>

<h3 id="删除布局元素"><a href="#删除布局元素" class="headerlink" title="删除布局元素"></a>删除布局元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//on the QueuedTask  </span></span><br><span class="line"><span class="keyword">var</span> elementsToRemove = layout.GetSelectedElements();</span><br><span class="line">layout.DeleteElements(elementsToRemove);</span><br></pre></td></tr></table></figure>

<h3 id="删除布局上的一个或多个元素"><a href="#删除布局上的一个或多个元素" class="headerlink" title="删除布局上的一个或多个元素"></a>删除布局上的一个或多个元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Delete an element or elements on a layout.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Delete a specific element on a layout</span></span><br><span class="line">  aLayout.DeleteElement(elm);</span><br><span class="line"> </span><br><span class="line">  <span class="comment">//Or delete a group of elements using a filter</span></span><br><span class="line">  aLayout.DeleteElements(item =&gt; item.Name.Contains(<span class="string">&quot;Clone&quot;</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Or delete all elements on a layout</span></span><br><span class="line">  aLayout.DeleteElements(item =&gt; <span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="缩放到元素"><a href="#缩放到元素" class="headerlink" title="缩放到元素"></a>缩放到元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LayoutView lytView = LayoutView.Active;</span><br><span class="line"><span class="comment">//Zoom to an element</span></span><br><span class="line"><span class="keyword">var</span> elementToZoomTo = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;MyPoint&quot;</span> &#125;).FirstOrDefault();</span><br><span class="line">lytView.ZoomToElement(elementToZoomTo);</span><br><span class="line"><span class="comment">//Zoom to  multiple elements.</span></span><br><span class="line"><span class="keyword">var</span> elementsToZoomTo = layout.FindElements(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;() &#123; <span class="string">&quot;Point 1&quot;</span>, <span class="string">&quot;Line 3&quot;</span>, <span class="string">&quot;Text 1&quot;</span> &#125;);</span><br><span class="line">lytView.ZoomToElements(elementsToZoomTo);</span><br></pre></td></tr></table></figure>

<h3 id="设置指北针的晕圈属性"><a href="#设置指北针的晕圈属性" class="headerlink" title="设置指北针的晕圈属性"></a>设置指北针的晕圈属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Set the CIM halo properties of a north arrow.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference the first selected element (assumption is it is a north arrow)</span></span><br><span class="line">Element northArrow = LayoutView.Active.GetSelectedElements().First();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Get definition of north arrow...</span></span><br><span class="line">  <span class="keyword">var</span> cim = northArrow.GetDefinition() <span class="keyword">as</span> CIMMarkerNorthArrow;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//this halo symbol is 50% transparent, no outline (i.e. 0 width)</span></span><br><span class="line">  <span class="comment">//First construct a polygon symbol to use in the Halo</span></span><br><span class="line">  <span class="comment">//Polygon symbol will need a fill and a stroke</span></span><br><span class="line">  <span class="keyword">var</span> polyFill = SymbolFactory.Instance.ConstructSolidFill(ColorFactory.Instance.CreateRGBColor(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">50</span>));</span><br><span class="line">  <span class="keyword">var</span> polyStroke = SymbolFactory.Instance.ConstructStroke(ColorFactory.Instance.BlackRGB, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">var</span> haloPoly = SymbolFactory.Instance.ConstructPolygonSymbol(polyFill, polyStroke);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//Set the north arrow defintion of HaloSymbol and HaloSize </span></span><br><span class="line">  ((CIMPointSymbol)cim.PointSymbol.Symbol).HaloSymbol = haloPoly;</span><br><span class="line">  ((CIMPointSymbol)cim.PointSymbol.Symbol).HaloSize = <span class="number">3</span>;<span class="comment">//size of the halo</span></span><br><span class="line">    </span><br><span class="line">  <span class="comment">//Apply the CIM changes back to the element</span></span><br><span class="line">  northArrow.SetDefinition(cim);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="对图形元素进行分组和排序"><a href="#对图形元素进行分组和排序" class="headerlink" title="对图形元素进行分组和排序"></a>对图形元素进行分组和排序</h2><h3 id="组图形元素"><a href="#组图形元素" class="headerlink" title="组图形元素"></a>组图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//on the QueuedTask</span></span><br><span class="line"><span class="keyword">var</span> elemsToGroup = layout.GetSelectedElements();</span><br><span class="line"><span class="comment">//Note: run within the QueuedTask</span></span><br><span class="line"><span class="comment">//group  elements</span></span><br><span class="line"><span class="keyword">var</span> groupElement = layout.GroupElements(elemsToGroup);</span><br></pre></td></tr></table></figure>

<h3 id="取消组合图形元素"><a href="#取消组合图形元素" class="headerlink" title="取消组合图形元素"></a>取消组合图形元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> selectedElements = layout.GetSelectedElements().ToList(); </span><br><span class="line"><span class="keyword">if</span> (selectedElements?.Any() == <span class="literal">false</span>)<span class="comment">//must be at least 1.</span></span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">var</span> elementsToUnGroup = <span class="keyword">new</span> List&lt;GroupElement&gt;();</span><br><span class="line"><span class="comment">//All selected elements should be grouped elements.</span></span><br><span class="line"><span class="keyword">if</span> (selectedElements.Count() == selectedElements.OfType&lt;GroupElement&gt;().Count())</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Convert to a GroupElement list.</span></span><br><span class="line">  elementsToUnGroup = selectedElements.ConvertAll(x =&gt; (GroupElement)x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (elementsToUnGroup.Count() == <span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line"><span class="comment">//UnGroup many grouped elements</span></span><br><span class="line">layout.UnGroupElements(elementsToUnGroup);</span><br><span class="line"><span class="comment">//Ungroup one grouped element</span></span><br><span class="line">layout.UnGroupElement(elementsToUnGroup.FirstOrDefault());</span><br></pre></td></tr></table></figure>

<h3 id="组元素的父级"><a href="#组元素的父级" class="headerlink" title="组元素的父级"></a>组元素的父级</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//check the parent</span></span><br><span class="line"><span class="keyword">var</span> parent = groupElement.Elements.First().GetParent();<span class="comment">//will be the group element</span></span><br><span class="line"><span class="comment">//top-most parent</span></span><br><span class="line"><span class="comment">//will be a GraphicsLayer or Layout</span></span><br><span class="line"><span class="keyword">var</span> top_most = groupElement.Elements.First().GetParent(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<h3 id="组元素中的子元素"><a href="#组元素中的子元素" class="headerlink" title="组元素中的子元素"></a>组元素中的子元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Nested groups within ArcGIS.Desktop.Layouts.GroupElement are not preserved.</span></span><br><span class="line"><span class="keyword">var</span> children = groupElement.GetElementsAsFlattenedList();</span><br></pre></td></tr></table></figure>

<h3 id="排序：向后发送和向前发送"><a href="#排序：向后发送和向前发送" class="headerlink" title="排序：向后发送和向前发送"></a>排序：向后发送和向前发送</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//On the QueuedTask</span></span><br><span class="line"><span class="comment">//get the current selection set</span></span><br><span class="line"><span class="keyword">var</span> sel_elems = layout.GetSelectedElements();</span><br><span class="line"><span class="comment">//can they be brought forward? This will also check that all elements have the same parent</span></span><br><span class="line"><span class="keyword">if</span> (layout.CanBringForward(sel_elems))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//bring forward</span></span><br><span class="line">  layout.BringForward(sel_elems);</span><br><span class="line">  <span class="comment">//bring to front (of parent)</span></span><br><span class="line">  <span class="comment">//graphicsLayer.BringToFront(sel_elems);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (layout.CanSendBackward(sel_elems))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//send back</span></span><br><span class="line">  layout.SendBackward(sel_elems);</span><br><span class="line">  <span class="comment">//send to the back (of parent)</span></span><br><span class="line">  <span class="comment">//graphicsLayer.SendToBack(sel_elems);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取-Z-顺序"><a href="#获取-Z-顺序" class="headerlink" title="获取 Z 顺序"></a>获取 Z 顺序</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> selElementsZOrder = layout.GetSelectedElements();</span><br><span class="line"><span class="comment">//list out the z order</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> elem <span class="keyword">in</span> selElementsZOrder)</span><br><span class="line">  <span class="comment">//At 2.x - System.Diagnostics.Debug.WriteLine($&quot;&#123;elem.Name&#125;: z-order &#123;elem.GetZOrder()&#125;&quot;);</span></span><br><span class="line">  System.Diagnostics.Debug.WriteLine(<span class="string">$&quot;<span class="subst">&#123;elem.Name&#125;</span>: z-order <span class="subst">&#123;elem.ZOrder&#125;</span>&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="更新布局元素"><a href="#更新布局元素" class="headerlink" title="更新布局元素"></a>更新布局元素</h2><h3 id="更新文本元素属性"><a href="#更新文本元素属性" class="headerlink" title="更新文本元素属性"></a>更新文本元素属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Update text element properties for an existing text element.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Reference a layoutitem in a project by name</span></span><br><span class="line">LayoutProjectItem layoutItem = Project.Current.GetItems&lt;LayoutProjectItem&gt;()</span><br><span class="line">                      .FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;MyLayout&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (layoutItem != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Perform on the worker thread</span></span><br><span class="line">  QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">    Layout layout = layoutItem.GetLayout();</span><br><span class="line">    <span class="keyword">if</span> (layout != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// Reference a text element by name</span></span><br><span class="line">      TextElement txtElm = layout.FindElement(<span class="string">&quot;MyTextElement&quot;</span>) <span class="keyword">as</span> TextElement;</span><br><span class="line">      <span class="keyword">if</span> (txtElm != <span class="literal">null</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// Change placement properties</span></span><br><span class="line">        txtElm.SetAnchor(Anchor.CenterPoint);</span><br><span class="line">        txtElm.SetX(x);</span><br><span class="line">        txtElm.SetY(y);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Change TextProperties</span></span><br><span class="line">        TextProperties txtProperties = <span class="keyword">new</span> TextProperties(</span><br><span class="line">                         <span class="string">&quot;Hello world&quot;</span>, <span class="string">&quot;Times New Roman&quot;</span>, <span class="number">48</span>, <span class="string">&quot;Regular&quot;</span>);</span><br><span class="line">        txtElm.SetTextProperties(txtProperties);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="更新图片元素"><a href="#更新图片元素" class="headerlink" title="更新图片元素"></a>更新图片元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Update a picture element.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">  Layout layout = layoutItem.GetLayout();</span><br><span class="line">  <span class="keyword">if</span> (layout != <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Reference a picture element by name</span></span><br><span class="line">    PictureElement picElm = layout.FindElement(<span class="string">&quot;MyPicture&quot;</span>) <span class="keyword">as</span> PictureElement;</span><br><span class="line">    <span class="comment">// Change the path to a new source</span></span><br><span class="line">    <span class="keyword">if</span> (picElm != <span class="literal">null</span>)</span><br><span class="line">      picElm.SetSourcePath(<span class="string">@&quot;D:\MyData\Pics\somePic.jpg&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将背景颜色应用于地图框"><a href="#将背景颜色应用于地图框" class="headerlink" title="将背景颜色应用于地图框"></a>将背景颜色应用于地图框</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Apply a background color to the map frame element using the CIM.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Get the layout</span></span><br><span class="line">  <span class="keyword">var</span> myLayout = Project.Current.GetItems&lt;LayoutProjectItem&gt;()?.First().GetLayout();</span><br><span class="line">  <span class="keyword">if</span> (myLayout == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Get the map frame in the layout</span></span><br><span class="line">  MapFrame mapFrame = myLayout.FindElement(<span class="string">&quot;New Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">  <span class="keyword">if</span> (mapFrame == <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//TODO Handle null mapframe</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Get the map frame&#x27;s definition in order to modify the background.</span></span><br><span class="line">  <span class="keyword">var</span> mapFrameDefn = mapFrame.GetDefinition() <span class="keyword">as</span> CIMMapFrame;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Construct the polygon symbol to use to create a background</span></span><br><span class="line">  <span class="keyword">var</span> polySymbol = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">                 ColorFactory.Instance.BlueRGB, SimpleFillStyle.Solid);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set the background</span></span><br><span class="line">  mapFrameDefn.GraphicFrame.BackgroundSymbol =</span><br><span class="line">                                   polySymbol.MakeSymbolReference();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set the map frame definition</span></span><br><span class="line">  mapFrame.SetDefinition(mapFrameDefn);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="更新地图整饰"><a href="#更新地图整饰" class="headerlink" title="更新地图整饰"></a>更新地图整饰</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Update a map surround.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">  Layout layout = layoutItem.GetLayout();</span><br><span class="line">  <span class="keyword">if</span> (layout != <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Reference a scale bar element by name</span></span><br><span class="line">    MapSurround scaleBar = layout.FindElement(<span class="string">&quot;MyScaleBar&quot;</span>) <span class="keyword">as</span> MapSurround;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Reference a map frame element by name</span></span><br><span class="line">    MapFrame mf = layout.FindElement(<span class="string">&quot;MyMapFrame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((scaleBar != <span class="literal">null</span>) &amp;&amp; (mf != <span class="literal">null</span>))</span><br><span class="line">      <span class="comment">//Set the scale bar to the newly referenced map frame</span></span><br><span class="line">      scaleBar.SetMapFrame(mf);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="锁定元素"><a href="#锁定元素" class="headerlink" title="锁定元素"></a>锁定元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The Locked property is displayed in the TOC as a lock symbol next</span></span><br><span class="line"><span class="comment">// to each element.  If locked the element can&#x27;t be selected in the layout</span></span><br><span class="line"><span class="comment">// using the graphic selection tools.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">  Layout layout = layoutItem.GetLayout();</span><br><span class="line">  <span class="keyword">if</span> (layout != <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Reference an element by name</span></span><br><span class="line">    Element element = layout.FindElement(<span class="string">&quot;MyElement&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (element != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// Modify the Locked property via the CIM</span></span><br><span class="line">      CIMElement CIMElement = element.GetDefinition() <span class="keyword">as</span> CIMElement;</span><br><span class="line">      CIMElement.Locked = <span class="literal">true</span>;</span><br><span class="line">      element.SetDefinition(CIMElement);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="更新元素透明度"><a href="#更新元素透明度" class="headerlink" title="更新元素透明度"></a>更新元素透明度</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Update an element&#x27;s transparency using the CIM.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">  Layout layout = layoutItem.GetLayout();</span><br><span class="line">  <span class="keyword">if</span> (layout != <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Reference a element by name</span></span><br><span class="line">    GraphicElement graphicElement = layout.FindElement(<span class="string">&quot;MyElement&quot;</span>) <span class="keyword">as</span> GraphicElement;</span><br><span class="line">    <span class="keyword">if</span> (graphicElement != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// Modify the Transparency property that exists only in the CIMGraphic class.</span></span><br><span class="line">      CIMGraphic CIMGraphic = graphicElement.GetGraphic() <span class="keyword">as</span> CIMGraphic;</span><br><span class="line">      CIMGraphic.Transparency = <span class="number">50</span>; <span class="comment">// mark it 50% transparent</span></span><br><span class="line">      graphicElement.SetGraphic(CIMGraphic);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="克隆元素"><a href="#克隆元素" class="headerlink" title="克隆元素"></a>克隆元素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Clone a layout graphic element and apply an offset.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Reference and load the layout associated with the layout item</span></span><br><span class="line">  Layout layout = layoutItem.GetLayout();</span><br><span class="line">  <span class="keyword">if</span> (layout != <span class="literal">null</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Reference a graphic element by name</span></span><br><span class="line">    GraphicElement graphicElement = </span><br><span class="line">                        layout.FindElement(<span class="string">&quot;MyElement&quot;</span>) <span class="keyword">as</span> GraphicElement;</span><br><span class="line">    <span class="keyword">if</span> (graphicElement != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Clone and set the new x,y</span></span><br><span class="line">      GraphicElement cloneElement = graphicElement.Clone(<span class="string">&quot;Clone&quot;</span>);</span><br><span class="line">      cloneElement.SetX(cloneElement.GetX() + xOffset);</span><br><span class="line">      cloneElement.SetY(cloneElement.GetY() + yOffset);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="布局元数据"><a href="#布局元数据" class="headerlink" title="布局元数据"></a>布局元数据</h2><h3 id="布局元数据-1"><a href="#布局元数据-1" class="headerlink" title="布局元数据"></a>布局元数据</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var layout = ...;</span></span><br><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Gets the Layout metadata.</span></span><br><span class="line"><span class="keyword">var</span> layout_xml = layout.GetMetadata();</span><br><span class="line"><span class="comment">//Can metadata be edited?</span></span><br><span class="line"><span class="keyword">if</span> (layout.GetCanEditMetadata())</span><br><span class="line">  <span class="comment">//Set the metadata back</span></span><br><span class="line">  layout.SetMetadata(layout_xml);</span><br></pre></td></tr></table></figure>

<h2 id="布局地图框"><a href="#布局地图框" class="headerlink" title="布局地图框"></a>布局地图框</h2><h3 id="更改与地图框关联的地图"><a href="#更改与地图框关联的地图" class="headerlink" title="更改与地图框关联的地图"></a>更改与地图框关联的地图</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Change the map associated with a map frame</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference a map frame on a layout</span></span><br><span class="line">MapFrame mfrm = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Peform on worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Reference map from the project item </span></span><br><span class="line">  Map map = Project.Current.GetItems&lt;MapProjectItem&gt;().FirstOrDefault(m =&gt; m.Name.Equals(<span class="string">&quot;Map1&quot;</span>)).GetMap();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set the map to the map frame</span></span><br><span class="line">  mfrm.SetMap(map);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="更改地图框照相机设置"><a href="#更改地图框照相机设置" class="headerlink" title="更改地图框照相机设置"></a>更改地图框照相机设置</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Change a map frame&#x27;s camera settings.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Reference MapFrame</span></span><br><span class="line">  MapFrame mf = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference the camera associated with the map frame and change the scale</span></span><br><span class="line">  Camera cam = mf.Camera;</span><br><span class="line">  cam.Scale = <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set the map frame extent based on the new camera info</span></span><br><span class="line">  mf.SetCamera(cam);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将地图框缩放到单个图层的范围"><a href="#将地图框缩放到单个图层的范围" class="headerlink" title="将地图框缩放到单个图层的范围"></a>将地图框缩放到单个图层的范围</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Zoom map frame to the extent of a single layer.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Reference MapFrame</span></span><br><span class="line">  MapFrame mf = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference map and layer</span></span><br><span class="line">  Map m = mf.Map;</span><br><span class="line">  FeatureLayer lyr = m.FindLayers(<span class="string">&quot;GreatLakes&quot;</span>).First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set the map frame extent to all features in the layer</span></span><br><span class="line">  mf.SetCamera(lyr, <span class="literal">false</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将地图框范围更改为多个图层中的所选要素"><a href="#将地图框范围更改为多个图层中的所选要素" class="headerlink" title="将地图框范围更改为多个图层中的所选要素"></a>将地图框范围更改为多个图层中的所选要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Change the extent of a map frame to the selected features multiple layers.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Reference MapFrame</span></span><br><span class="line">  MapFrame mf = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference map, layers and create layer list</span></span><br><span class="line">  Map m = mf.Map;</span><br><span class="line">  FeatureLayer fl_1 = m.FindLayers(<span class="string">&quot;GreatLakes&quot;</span>).First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line">  FeatureLayer fl_2 = m.FindLayers(<span class="string">&quot;States_WithRegions&quot;</span>).First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line">  <span class="keyword">var</span> layers = <span class="keyword">new</span>[] &#123; fl_1, fl_2 &#125;;</span><br><span class="line">  <span class="comment">//IEnumerable&lt;Layer&gt; layers = m.Layers;  //This creates a list of ALL layers in map.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set the map frame extent to the selected features in the list of layers</span></span><br><span class="line">  mf.SetCamera(layers, <span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将地图框范围更改为具有-15-缓冲区的单个要素"><a href="#将地图框范围更改为具有-15-缓冲区的单个要素" class="headerlink" title="将地图框范围更改为具有 15% 缓冲区的单个要素"></a>将地图框范围更改为具有 15% 缓冲区的单个要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Change map frame extent to single feature with 10 percent buffer</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Process on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Reference the mapframe and its associated map</span></span><br><span class="line">  MapFrame mf = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">  Map m = mf.Map;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Reference a feature layer and build a query (to return a single feature)</span></span><br><span class="line">  FeatureLayer fl = m.FindLayers(<span class="string">&quot;GreatLakes&quot;</span>).First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line">  QueryFilter qf = <span class="keyword">new</span> QueryFilter();</span><br><span class="line">  <span class="built_in">string</span> whereClause = <span class="string">&quot;NAME = &#x27;Lake Erie&#x27;&quot;</span>;</span><br><span class="line">  qf.WhereClause = whereClause;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Zoom to the feature</span></span><br><span class="line">  <span class="keyword">using</span> (ArcGIS.Core.Data.RowCursor rowCursor = fl.Search(qf))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> (rowCursor.MoveNext())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//Get the shape from the row and set extent</span></span><br><span class="line">      <span class="keyword">using</span> (<span class="keyword">var</span> feature = rowCursor.Current <span class="keyword">as</span> ArcGIS.Core.Data.Feature)</span><br><span class="line">      &#123;</span><br><span class="line">        Polygon polygon = feature.GetShape() <span class="keyword">as</span> Polygon;</span><br><span class="line">        Envelope env = polygon.Extent <span class="keyword">as</span> Envelope;</span><br><span class="line">        mf.SetCamera(env);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Zoom out 15 percent</span></span><br><span class="line">        Camera cam = mf.Camera;</span><br><span class="line">        cam.Scale = cam.Scale * <span class="number">1.15</span>;</span><br><span class="line">        mf.SetCamera(cam);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将页面坐标中的点转换为地图坐标中的点。"><a href="#将页面坐标中的点转换为地图坐标中的点。" class="headerlink" title="将页面坐标中的点转换为地图坐标中的点。"></a>将页面坐标中的点转换为地图坐标中的点。</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//On the QueuedTask</span></span><br><span class="line"><span class="keyword">var</span> layout = Project.Current.GetItems&lt;LayoutProjectItem&gt;().FirstOrDefault().GetLayout();</span><br><span class="line"><span class="keyword">var</span> mapFrame = layout.FindElement(<span class="string">&quot;New Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Get a point in the center of the Map frame</span></span><br><span class="line"><span class="keyword">var</span> mapFrameCenterPoint = mapFrame.GetBounds().CenterCoordinate;</span><br><span class="line"><span class="comment">//Convert to MapPoint</span></span><br><span class="line"><span class="comment">//At 2.x - var pointInMapFrame = MapPointBuilder.CreateMapPoint(mapFrameCenterPoint);</span></span><br><span class="line"><span class="keyword">var</span> pointInMapFrame = MapPointBuilderEx.CreateMapPoint(mapFrameCenterPoint);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Find the corresponding point in the MapView</span></span><br><span class="line"><span class="keyword">var</span> pointOnMap = mapFrame.PageToMap(pointInMapFrame);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a point graphic on the MapView.</span></span><br><span class="line"><span class="keyword">var</span> cimGraphicElement = <span class="keyword">new</span> CIMPointGraphic</span><br><span class="line">&#123;</span><br><span class="line">  Location = pointOnMap,</span><br><span class="line">  Symbol = pointSymbol.MakeSymbolReference()</span><br><span class="line">&#125;;</span><br><span class="line">graphicsLayer.AddElement(cimGraphicElement);</span><br></pre></td></tr></table></figure>

<h3 id="将地图坐标中的点转换为页面坐标中的点"><a href="#将地图坐标中的点转换为页面坐标中的点" class="headerlink" title="将地图坐标中的点转换为页面坐标中的点"></a>将地图坐标中的点转换为页面坐标中的点</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">GetMapCoordinates</span> : <span class="title">MapTool</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnToolMouseDown</span>(<span class="params">MapViewMouseButtonEventArgs e</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (e.ChangedButton == System.Windows.Input.MouseButton.Left)</span><br><span class="line">      e.Handled = <span class="literal">true</span>; <span class="comment">//Handle the event args to get the call to the corresponding async method</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> Task <span class="title">HandleMouseDownAsync</span>(<span class="params">MapViewMouseButtonEventArgs e</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> QueuedTask.Run(() =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">var</span> pointSymbol = SymbolFactory.Instance.ConstructPointSymbol(ColorFactory.Instance.BlackRGB, <span class="number">8</span>);</span><br><span class="line">      <span class="keyword">var</span> layout = Project.Current.GetItems&lt;LayoutProjectItem&gt;().FirstOrDefault().GetLayout();</span><br><span class="line">      </span><br><span class="line">      <span class="comment">//Convert the clicked point in client coordinates to the corresponding map coordinates.</span></span><br><span class="line">      <span class="keyword">var</span> mapPoint = MapView.Active.ClientToMap(e.ClientPoint);</span><br><span class="line">      ArcGIS.Desktop.Framework.Dialogs.MessageBox.Show(<span class="built_in">string</span>.Format(<span class="string">&quot;X: &#123;0&#125; Y: &#123;1&#125; Z: &#123;2&#125;&quot;</span>,</span><br><span class="line">          mapPoint.X, mapPoint.Y, mapPoint.Z), <span class="string">&quot;Map Coordinates&quot;</span>);</span><br><span class="line">      <span class="comment">//Get the corresponding layout point</span></span><br><span class="line">      <span class="keyword">var</span> mapFrame = layout.FindElement(<span class="string">&quot;New Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">      <span class="keyword">var</span> pointOnLayoutFrame = mapFrame.MapToPage(mapPoint);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//Create a point graphic on the Layout.</span></span><br><span class="line">      <span class="keyword">var</span> cimGraphicElement = <span class="keyword">new</span> CIMPointGraphic</span><br><span class="line">      &#123;</span><br><span class="line">        Location = pointOnLayoutFrame,</span><br><span class="line">        Symbol = pointSymbol.MakeSymbolReference()</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="comment">//Or use GraphicFactory</span></span><br><span class="line">      <span class="keyword">var</span> cimGraphicElement2 = GraphicFactory.Instance.CreateSimpleGraphic(</span><br><span class="line">              pointOnLayoutFrame, pointSymbol);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//At 2.x - LayoutElementFactory.Instance.CreateGraphicElement(layout, cimGraphicElement);</span></span><br><span class="line"></span><br><span class="line">      ElementFactory.Instance.CreateGraphicElement(layout, cimGraphicElement);</span><br><span class="line">      ElementFactory.Instance.CreateGraphicElement(layout, cimGraphicElement2);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="布局图系列"><a href="#布局图系列" class="headerlink" title="布局图系列"></a>布局图系列</h2><h3 id="修改现有地图系列"><a href="#修改现有地图系列" class="headerlink" title="修改现有地图系列"></a>修改现有地图系列</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Modify the currently active map series and changes its sort field and page number field.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Perform on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  SpatialMapSeries SMS = layout.MapSeries <span class="keyword">as</span> SpatialMapSeries; <span class="comment">//cast as spatial map seris for additional members</span></span><br><span class="line">  SMS.SortField = <span class="string">&quot;State_Name&quot;</span>;</span><br><span class="line">  SMS.SortAscending = <span class="literal">true</span>;</span><br><span class="line">  SMS.PageNumberField = <span class="string">&quot;PageNum&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Overwrite the current map series with these new settings</span></span><br><span class="line">  layout.SetMapSeries(SMS); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建新的空间地图系列"><a href="#创建新的空间地图系列" class="headerlink" title="创建新的空间地图系列"></a>创建新的空间地图系列</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This example create a new spatial map series and then applies it to the active layout. This will automatically </span></span><br><span class="line"><span class="comment">// overwrite an existing map series if one is already present.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference map frame and index layer</span></span><br><span class="line">MapFrame mf = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">Map m = mf.Map;</span><br><span class="line">BasicFeatureLayer indexLyr = m.FindLayers(<span class="string">&quot;Countries&quot;</span>).FirstOrDefault() <span class="keyword">as</span> BasicFeatureLayer;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Construct map series on worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//SpatialMapSeries constructor - required parameters</span></span><br><span class="line">  SpatialMapSeries SMS = MapSeries.CreateSpatialMapSeries(layout, mf, indexLyr, <span class="string">&quot;Name&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//Set optional, non-default values</span></span><br><span class="line">  SMS.CategoryField = <span class="string">&quot;Continent&quot;</span>;</span><br><span class="line">  SMS.SortField = <span class="string">&quot;Population&quot;</span>;</span><br><span class="line">  SMS.ExtentOptions = ExtentFitType.BestFit;</span><br><span class="line">  SMS.MarginType = ArcGIS.Core.CIM.UnitType.PageUnits;</span><br><span class="line">  SMS.MarginUnits = ArcGIS.Core.Geometry.LinearUnit.Centimeters;</span><br><span class="line">  SMS.Margin = <span class="number">1</span>;</span><br><span class="line">  SMS.ScaleRounding = <span class="number">1000</span>;</span><br><span class="line">  layout.SetMapSeries(SMS);  <span class="comment">//Overwrite existing map series.</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="布局导出"><a href="#布局导出" class="headerlink" title="布局导出"></a>布局导出</h2><h3 id="将布局导出为-PDF"><a href="#将布局导出为-PDF" class="headerlink" title="将布局导出为 PDF"></a>将布局导出为 PDF</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Export a single page layout to PDF.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create a PDF format with appropriate settings</span></span><br><span class="line"><span class="comment">//BMP, EMF, EPS, GIF, JPEG, PNG, SVG, TGA, and TFF formats are also available for export</span></span><br><span class="line">PDFFormat PDF = <span class="keyword">new</span> PDFFormat()</span><br><span class="line">&#123;</span><br><span class="line">  OutputFileName = filePath,</span><br><span class="line">  Resolution = <span class="number">300</span>,</span><br><span class="line">  DoCompressVectorGraphics = <span class="literal">true</span>,</span><br><span class="line">  DoEmbedFonts = <span class="literal">true</span>,</span><br><span class="line">  HasGeoRefInfo = <span class="literal">true</span>,</span><br><span class="line">  ImageCompression = ImageCompression.Adaptive,</span><br><span class="line">  ImageQuality = ImageQuality.Best,</span><br><span class="line">  LayersAndAttributes = LayersAndAttributes.LayersAndAttributes</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Check to see if the path is valid and export</span></span><br><span class="line"><span class="keyword">if</span> (PDF.ValidateOutputFilePath())</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">await</span> QueuedTask.Run(() =&gt; layout.Export(PDF));  <span class="comment">//Export the layout to PDF on the worker thread</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="将地图框导出为-JPG"><a href="#将地图框导出为-JPG" class="headerlink" title="将地图框导出为 JPG"></a>将地图框导出为 JPG</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Export a map frame to JPG.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create JPEG format with appropriate settings</span></span><br><span class="line"><span class="comment">//BMP, EMF, EPS, GIF, PDF, PNG, SVG, TGA, and TFF formats are also available for export</span></span><br><span class="line"><span class="comment">//at 2.x - JPEGFormat JPG = new JPEGFormat()</span></span><br><span class="line"><span class="comment">//&#123;</span></span><br><span class="line"><span class="comment">//  HasWorldFile = true,</span></span><br><span class="line"><span class="comment">//  Resolution = 300,</span></span><br><span class="line"><span class="comment">//  OutputFileName = filePath,</span></span><br><span class="line"><span class="comment">//  JPEGColorMode = JPEGColorMode.TwentyFourBitTrueColor,</span></span><br><span class="line"><span class="comment">//  Height = 800,</span></span><br><span class="line"><span class="comment">//  Width = 1200</span></span><br><span class="line"><span class="comment">//&#125;;</span></span><br><span class="line">JPEGFormat JPG = <span class="keyword">new</span> JPEGFormat()</span><br><span class="line">&#123;</span><br><span class="line">  HasWorldFile = <span class="literal">true</span>,</span><br><span class="line">  Resolution = <span class="number">300</span>,</span><br><span class="line">  OutputFileName = filePath,</span><br><span class="line">  ColorMode = JPEGColorMode.TwentyFourBitTrueColor,</span><br><span class="line">  Height = <span class="number">800</span>,</span><br><span class="line">  Width = <span class="number">1200</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference the map frame</span></span><br><span class="line">MapFrame mf = layout.FindElement(<span class="string">&quot;MyMapFrame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Export on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Check to see if the path is valid and export</span></span><br><span class="line">  <span class="keyword">if</span> (JPG.ValidateOutputFilePath())</span><br><span class="line">  &#123;</span><br><span class="line">    mf.Export(JPG);  <span class="comment">//Export the map frame to JPG</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将与地图框关联的地图视图导出到-BMP"><a href="#将与地图框关联的地图视图导出到-BMP" class="headerlink" title="将与地图框关联的地图视图导出到 BMP"></a>将与地图框关联的地图视图导出到 BMP</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Export the map view associated with a map frame to BMP.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create BMP format with appropriate settings</span></span><br><span class="line"><span class="comment">//EMF, EPS, GIF, JPEG, PDF, PNG, SVG, TGA, and TFF formats are also available for export</span></span><br><span class="line">BMPFormat BMP = <span class="keyword">new</span> BMPFormat()</span><br><span class="line">&#123;</span><br><span class="line">  Resolution = <span class="number">300</span>,</span><br><span class="line">  Height = <span class="number">500</span>,</span><br><span class="line">  Width = <span class="number">800</span>,</span><br><span class="line">  HasWorldFile = <span class="literal">true</span>,</span><br><span class="line">  OutputFileName = filePath</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference the active layout view</span></span><br><span class="line">LayoutView lytView = LayoutView.Active;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reference the map frame and its map view</span></span><br><span class="line">MapFrame mf_bmp = layout.FindElement(<span class="string">&quot;Map Frame&quot;</span>) <span class="keyword">as</span> MapFrame;</span><br><span class="line">MapView mv_bmp = mf_bmp.GetMapView(lytView);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mv_bmp != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Export on the worker thread</span></span><br><span class="line">  <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Check to see if the path is valid and export</span></span><br><span class="line">    <span class="keyword">if</span> (BMP.ValidateOutputFilePath())</span><br><span class="line">    &#123;</span><br><span class="line">      mv_bmp.Export(BMP);  <span class="comment">//Export to BMP</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="将地图系列导出为单个-PDF"><a href="#将地图系列导出为单个-PDF" class="headerlink" title="将地图系列导出为单个 PDF"></a>将地图系列导出为单个 PDF</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Export a map series with multiple pages to a single PDF.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create PDF format with appropriate settings</span></span><br><span class="line">PDFFormat MS_PDF = <span class="keyword">new</span> PDFFormat()</span><br><span class="line">&#123;</span><br><span class="line">  OutputFileName = filePath,</span><br><span class="line">  Resolution = <span class="number">300</span>,</span><br><span class="line">  DoCompressVectorGraphics = <span class="literal">true</span>,</span><br><span class="line">  DoEmbedFonts = <span class="literal">true</span>,</span><br><span class="line">  HasGeoRefInfo = <span class="literal">true</span>,</span><br><span class="line">  ImageCompression = ImageCompression.Adaptive,</span><br><span class="line">  ImageQuality = ImageQuality.Best,</span><br><span class="line">  LayersAndAttributes = LayersAndAttributes.LayersAndAttributes</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set up map series export options</span></span><br><span class="line">MapSeriesExportOptions MS_ExportOptions = <span class="keyword">new</span> MapSeriesExportOptions()</span><br><span class="line">&#123;</span><br><span class="line">  ExportPages = ExportPages.Custom,  <span class="comment">//Provide a specific list of pages</span></span><br><span class="line">  CustomPages = <span class="string">&quot;1-3, 5&quot;</span>,  <span class="comment">//Only used if ExportPages.Custom is set</span></span><br><span class="line">  ExportFileOptions = ExportFileOptions.ExportAsSinglePDF,  <span class="comment">//Export all pages to a single, multi-page PDF</span></span><br><span class="line">  ShowSelectedSymbology = <span class="literal">false</span>  <span class="comment">//Do no show selection symbology in the output</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Export on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Check to see if the path is valid and export</span></span><br><span class="line">  <span class="keyword">if</span> (MS_PDF.ValidateOutputFilePath())</span><br><span class="line">  &#123;</span><br><span class="line">    layout.Export(MS_PDF, MS_ExportOptions);  <span class="comment">//Export to PDF</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将地图系列导出到单个-TIFF-文件"><a href="#将地图系列导出到单个-TIFF-文件" class="headerlink" title="将地图系列导出到单个 TIFF 文件"></a>将地图系列导出到单个 TIFF 文件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Export each page of a map series to an individual TIFF file.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Create TIFF format with appropriate settings</span></span><br><span class="line">TIFFFormat TIFF = <span class="keyword">new</span> TIFFFormat()</span><br><span class="line">&#123;</span><br><span class="line">  OutputFileName = filePath,</span><br><span class="line">  Resolution = <span class="number">300</span>,</span><br><span class="line">  ColorMode = TIFFColorMode.TwentyFourBitTrueColor,</span><br><span class="line">  HasGeoTiffTags = <span class="literal">true</span>,</span><br><span class="line">  HasWorldFile = <span class="literal">true</span>,</span><br><span class="line">  ImageCompression = TIFFImageCompression.LZW</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Set up map series export options</span></span><br><span class="line">MapSeriesExportOptions MSExportOptions_TIFF = <span class="keyword">new</span> MapSeriesExportOptions()</span><br><span class="line">&#123;</span><br><span class="line">  ExportPages = ExportPages.All,  <span class="comment">//All pages</span></span><br><span class="line">  ExportFileOptions = ExportFileOptions.ExportMultipleNames,  <span class="comment">//Export each page to an individual file using page name as a suffix.</span></span><br><span class="line">  ShowSelectedSymbology = <span class="literal">true</span>  <span class="comment">//Include selection symbology in the output</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Export on the worker thread</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Check to see if the path is valid and export</span></span><br><span class="line">  <span class="keyword">if</span> (TIFF.ValidateOutputFilePath())</span><br><span class="line">  &#123;</span><br><span class="line">    layout.Export(TIFF, MSExportOptions_TIFF);  <span class="comment">//Export to TIFF</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="布局选项"><a href="#布局选项" class="headerlink" title="布局选项"></a>布局选项</h2><h3 id="获取布局选项"><a href="#获取布局选项" class="headerlink" title="获取布局选项"></a>获取布局选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> lastToolActive = ApplicationOptions.LayoutOptions.KeepLastToolActive;</span><br><span class="line"><span class="keyword">var</span> warnOnSurrounds = ApplicationOptions.LayoutOptions.WarnAboutAssociatedSurrounds;</span><br><span class="line"><span class="comment">//eg &lt;Install_Path&gt;\Resources\LayoutTemplates\en-US</span></span><br><span class="line"><span class="keyword">var</span> gallery_path = ApplicationOptions.LayoutOptions.LayoutTemplatePath;</span><br></pre></td></tr></table></figure>

<h3 id="设置布局选项"><a href="#设置布局选项" class="headerlink" title="设置布局选项"></a>设置布局选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//keep graphic element insert tool active</span></span><br><span class="line">ApplicationOptions.LayoutOptions.KeepLastToolActive = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">//no warning when deleting a map frame results in other elements being deleted</span></span><br><span class="line">ApplicationOptions.LayoutOptions.WarnAboutAssociatedSurrounds = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">//path to .pagx files used as templates</span></span><br><span class="line">ApplicationOptions.LayoutOptions.LayoutTemplatePath = <span class="string">@&quot;D:\data\layout_templates&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="文本和图形元素选项"><a href="#文本和图形元素选项" class="headerlink" title="文本和图形元素选项"></a>文本和图形元素选项</h2><h3 id="获取所有可用字体"><a href="#获取所有可用字体" class="headerlink" title="获取所有可用字体"></a>获取所有可用字体</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Note: see also SymbolFactory.Instance.GetAvailableFonts() which returns the</span></span><br><span class="line"><span class="comment">//same list. Use for TextAndGraphicsElementsOptions.GetAvailableFonts() convenience</span></span><br><span class="line"></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//A list of tuples of Font name + associated Font Styles, one tuple per</span></span><br><span class="line">  <span class="comment">//font, is returned</span></span><br><span class="line">  <span class="keyword">var</span> fonts = ApplicationOptions.TextAndGraphicsElementsOptions.GetAvailableFonts();</span><br><span class="line">  StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">  sb.AppendLine(<span class="string">&quot;Pro Fonts\r\n============================&quot;</span>);</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> font <span class="keyword">in</span> fonts)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> styles = <span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>, font.fontStyles);</span><br><span class="line">    sb.AppendLine(<span class="string">$&quot;<span class="subst">&#123;font.fontName&#125;</span>, [<span class="subst">&#123;styles&#125;</span>]&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(sb.ToString());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="获取文本和图形元素选项"><a href="#获取文本和图形元素选项" class="headerlink" title="获取文本和图形元素选项"></a>获取文本和图形元素选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Get the default font (see also &#x27;SymbolFactory.Instance.DefaultFont&#x27;)</span></span><br><span class="line">  <span class="keyword">var</span> def_font = ApplicationOptions.TextAndGraphicsElementsOptions.GetDefaultFont();</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(</span><br><span class="line">    <span class="string">$&quot;\r\ndefault font: <span class="subst">&#123;def_font.fontName&#125;</span>, <span class="subst">&#123;def_font.styleName&#125;</span>&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Get the default graphics element symbols - point, line, poly, text</span></span><br><span class="line">  <span class="keyword">var</span> ptSymbol = ApplicationOptions.TextAndGraphicsElementsOptions.GetDefaultPointSymbol();</span><br><span class="line">  <span class="keyword">var</span> lineSymbol = ApplicationOptions.TextAndGraphicsElementsOptions.GetDefaultLineSymbol();</span><br><span class="line">  <span class="keyword">var</span> polySymbol = ApplicationOptions.TextAndGraphicsElementsOptions.GetDefaultPolygonSymbol();</span><br><span class="line">  <span class="keyword">var</span> textSymbol = ApplicationOptions.TextAndGraphicsElementsOptions.GetDefaultTextSymbol();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="设置文本和图形元素选项"><a href="#设置文本和图形元素选项" class="headerlink" title="设置文本和图形元素选项"></a>设置文本和图形元素选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Set a default font. Use its default style</span></span><br><span class="line">  ApplicationOptions.TextAndGraphicsElementsOptions.SetDefaultFont(<span class="string">&quot;tahoma&quot;</span>);</span><br><span class="line">  <span class="comment">//or specify an explicit style</span></span><br><span class="line">  ApplicationOptions.TextAndGraphicsElementsOptions.SetDefaultFont(<span class="string">&quot;tahoma&quot;</span>, <span class="string">&quot;bold&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Create symbols</span></span><br><span class="line">  <span class="keyword">var</span> ptSymbol2 = SymbolFactory.Instance.ConstructPointSymbol(</span><br><span class="line">    ColorFactory.Instance.RedRGB, <span class="number">14</span>, SimpleMarkerStyle.Diamond);</span><br><span class="line">  <span class="keyword">var</span> lineSymbol2 = SymbolFactory.Instance.ConstructLineSymbol(</span><br><span class="line">    ColorFactory.Instance.RedRGB, <span class="number">2</span>, SimpleLineStyle.Dash);</span><br><span class="line">  <span class="keyword">var</span> polySymbol2 = SymbolFactory.Instance.ConstructPolygonSymbol(</span><br><span class="line">    ColorFactory.Instance.RedRGB, SimpleFillStyle.DiagonalCross);</span><br><span class="line">  <span class="keyword">var</span> textSymbol2 = SymbolFactory.Instance.ConstructTextSymbol(</span><br><span class="line">    ColorFactory.Instance.RedRGB, <span class="number">12</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Set default point, line, poly, text graphics element symbols</span></span><br><span class="line">  ApplicationOptions.TextAndGraphicsElementsOptions.SetDefaultPointSymbol(ptSymbol2);</span><br><span class="line">  ApplicationOptions.TextAndGraphicsElementsOptions.SetDefaultLineSymbol(lineSymbol2);</span><br><span class="line">  ApplicationOptions.TextAndGraphicsElementsOptions.SetDefaultPolygonSymbol(polySymbol2);</span><br><span class="line">  ApplicationOptions.TextAndGraphicsElementsOptions.SetDefaultTextSymbol(textSymbol2);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="MapFrame-Display-Constraints"><a href="#MapFrame-Display-Constraints" class="headerlink" title="MapFrame_Display_Constraints"></a>MapFrame_Display_Constraints</h2><h3 id="设置自动相机无"><a href="#设置自动相机无" class="headerlink" title="设置自动相机无"></a>设置自动相机无</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.None;</span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机固定范围"><a href="#设置自动相机固定范围" class="headerlink" title="设置自动相机固定范围"></a>设置自动相机固定范围</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.Fixed;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Extent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mf_extent = mf.GetViewExtent();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> extent = EnvelopeBuilderEx.CreateEnvelope(</span><br><span class="line">  <span class="number">400748.62</span>, <span class="number">800296.4</span>, <span class="number">1310669.05</span>, <span class="number">1424520.74</span>, mf.Map.SpatialReference);</span><br><span class="line">autoCamera.Extent = extent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机固定中心"><a href="#设置自动相机固定中心" class="headerlink" title="设置自动相机固定中心"></a>设置自动相机固定中心</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.Fixed;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Center;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera = mf.GetMapView(LayoutView.Active).Camera;</span><br><span class="line"><span class="keyword">var</span> center = mf.GetViewCenter();</span><br><span class="line"></span><br><span class="line"><span class="comment">//var extent = EnvelopeBuilderEx.CreateEnvelope(</span></span><br><span class="line"><span class="comment">//    400748.62, 800296.4, 1310669.05, 1424520.74, mf.Map.SpatialReference);</span></span><br><span class="line"><span class="comment">//autoCamera.Extent = extent;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera2 = <span class="keyword">new</span> CIMViewCamera()</span><br><span class="line">&#123;</span><br><span class="line">  Heading = <span class="number">0</span>,</span><br><span class="line">  Pitch = <span class="number">-90</span>,</span><br><span class="line">  Roll = <span class="number">0</span>,</span><br><span class="line">  Scale = <span class="number">21169571</span>,</span><br><span class="line">  X = <span class="number">855708</span>,</span><br><span class="line">  Y = <span class="number">1112409</span>,</span><br><span class="line">  Z = <span class="built_in">double</span>.NaN</span><br><span class="line">&#125;;</span><br><span class="line">autoCamera.Camera = camera2;</span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line">autoCamera.IntersectLayerPath = states.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机固定居中和缩放"><a href="#设置自动相机固定居中和缩放" class="headerlink" title="设置自动相机固定居中和缩放"></a>设置自动相机固定居中和缩放</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.Fixed;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.CenterAndScale;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera = mf.GetMapView(LayoutView.Active).Camera;</span><br><span class="line"><span class="keyword">var</span> center = mf.GetViewCenter();</span><br><span class="line"></span><br><span class="line"><span class="comment">//var extent = EnvelopeBuilderEx.CreateEnvelope(</span></span><br><span class="line"><span class="comment">//    400748.62, 800296.4, 1310669.05, 1424520.74, mf.Map.SpatialReference);</span></span><br><span class="line"><span class="comment">//autoCamera.Extent = extent;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera2 = <span class="keyword">new</span> CIMViewCamera()</span><br><span class="line">&#123;</span><br><span class="line">  Heading = <span class="number">0</span>,</span><br><span class="line">  Pitch = <span class="number">-90</span>,</span><br><span class="line">  Roll = <span class="number">0</span>,</span><br><span class="line">  Scale = <span class="number">21169571</span>,</span><br><span class="line">  X = <span class="number">1310669.0</span> + ((<span class="number">400748.5</span> - <span class="number">1310669.0</span>) / <span class="number">2.0</span>),</span><br><span class="line">  Y = <span class="number">800296.4</span> + ((<span class="number">1424520.74</span> - <span class="number">800296.4</span>) / <span class="number">2.0</span>),</span><br><span class="line">  Z = <span class="built_in">double</span>.NaN</span><br><span class="line">&#125;;</span><br><span class="line">autoCamera.Camera = camera2;</span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line"><span class="comment">//autoCamera.IntersectLayerPath = states.URI;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机固定比例"><a href="#设置自动相机固定比例" class="headerlink" title="设置自动相机固定比例"></a>设置自动相机固定比例</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.Fixed;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Scale;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera = mf.GetMapView(LayoutView.Active).Camera;</span><br><span class="line"><span class="keyword">var</span> center = mf.GetViewCenter();</span><br><span class="line"></span><br><span class="line"><span class="comment">//var extent = EnvelopeBuilderEx.CreateEnvelope(</span></span><br><span class="line"><span class="comment">//    400748.62, 800296.4, 1310669.05, 1424520.74, mf.Map.SpatialReference);</span></span><br><span class="line"><span class="comment">//autoCamera.Extent = extent;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera2 = <span class="keyword">new</span> CIMViewCamera()</span><br><span class="line">&#123;</span><br><span class="line">  Heading = <span class="number">0</span>,</span><br><span class="line">  Pitch = <span class="number">-90</span>,</span><br><span class="line">  Roll = <span class="number">0</span>,</span><br><span class="line">  Scale = <span class="number">20000571</span>,</span><br><span class="line">  X = <span class="number">1310669.0</span> + ((<span class="number">400748.5</span> - <span class="number">1310669.0</span>) / <span class="number">2.0</span>),</span><br><span class="line">  Y = <span class="number">800296.4</span> + ((<span class="number">1424520.74</span> - <span class="number">800296.4</span>) / <span class="number">2.0</span>),</span><br><span class="line">  Z = <span class="built_in">double</span>.NaN</span><br><span class="line">&#125;;</span><br><span class="line">autoCamera.Camera = camera2;</span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line"><span class="comment">//autoCamera.IntersectLayerPath = states.URI;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动照相机链接范围"><a href="#设置自动照相机链接范围" class="headerlink" title="设置自动照相机链接范围"></a>设置自动照相机链接范围</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.MapFrameLink;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Extent;</span><br><span class="line">autoCamera.MapFrameLinkName = mapFrameLink;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机链接中心"><a href="#设置自动相机链接中心" class="headerlink" title="设置自动相机链接中心"></a>设置自动相机链接中心</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.MapFrameLink;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Center;</span><br><span class="line">autoCamera.MapFrameLinkName = mapFrameLink;</span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line">autoCamera.IntersectLayerPath = states.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机链接中心和缩放"><a href="#设置自动相机链接中心和缩放" class="headerlink" title="设置自动相机链接中心和缩放"></a>设置自动相机链接中心和缩放</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.MapFrameLink;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.CenterAndScale;</span><br><span class="line">autoCamera.MapFrameLinkName = mapFrameLink;</span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line">autoCamera.IntersectLayerPath = states.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机链接缩放"><a href="#设置自动相机链接缩放" class="headerlink" title="设置自动相机链接缩放"></a>设置自动相机链接缩放</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.MapFrameLink;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Scale;</span><br><span class="line">autoCamera.MapFrameLinkName = mapFrameLink;</span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line">autoCamera.IntersectLayerPath = states.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机链接地图系列形状"><a href="#设置自动相机链接地图系列形状" class="headerlink" title="设置自动相机链接地图系列形状"></a>设置自动相机链接地图系列形状</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.MapSeriesLink;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Extent;</span><br><span class="line"><span class="comment">//autoCamera.MapFrameLinkName = mapFrameLink;</span></span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line">autoCamera.IntersectLayerPath = states.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<h3 id="设置自动相机链接地图系列中心"><a href="#设置自动相机链接地图系列中心" class="headerlink" title="设置自动相机链接地图系列中心"></a>设置自动相机链接地图系列中心</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layout = LayoutView.Active.Layout;</span><br><span class="line"><span class="keyword">var</span> mf = layout.GetElementsAsFlattenedList().OfType&lt;MapFrame&gt;()</span><br><span class="line">  .First(mf =&gt; mf.Name == mapFrame);</span><br><span class="line"><span class="keyword">var</span> autoCamera = mf.GetAutoCamera();</span><br><span class="line">autoCamera.Source = AutoCameraSource.MapSeriesLink;</span><br><span class="line">autoCamera.AutoCameraType = AutoCameraType.Center;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> states = mf.Map.GetLayersAsFlattenedList().First(l =&gt; l.Name == <span class="string">&quot;State_Polygons&quot;</span>);</span><br><span class="line">autoCamera.IntersectLayerPath = states.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mf.ValidateAutoCamera(autoCamera) &amp;&amp;</span><br><span class="line">  !mf.IsMapSeriesMapFrame())</span><br><span class="line">  mf.SetAutoCamera(autoCamera);</span><br></pre></td></tr></table></figure>

<p>;</p>
<pre><code>
</code></pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1361151272@qq.com">shaozhy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://shaoshao.net.cn/2022/12/28/20221228140247000/">https://shaoshao.net.cn/2022/12/28/20221228140247000/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://shaoshao.net.cn" target="_blank">WineMonk</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/discover/tags/CSharp/">CSharp</a><a class="post-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></div><div class="post_share"><div class="social-share" data-image="https://shaoshao.net.cn/images/blog/cover/current/post_12.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/28/20221228140451000/"><img class="prev-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_13.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ArcGIS Pro SDK 布局-报告</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/28/20221228135824000/"><img class="next-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_11.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ArcGIS Pro SDK 图形图层</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/12/28/20221228133712000/" title="ArcGIS Pro SDK 框架"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_04.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 框架</div></div></a></div><div><a href="/2022/12/28/20221228134536000/" title="ArcGIS Pro SDK 核心主机"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 核心主机</div></div></a></div><div><a href="/2022/12/28/20221228134215000/" title="ArcGIS Pro SDK 内容"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 内容</div></div></a></div><div><a href="/2022/12/28/20221228134946000/" title="ArcGIS Pro SDK 编辑"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 编辑</div></div></a></div><div><a href="/2022/12/28/20221228135620000/" title="ArcGIS Pro SDK 地理处理"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理处理</div></div></a></div><div><a href="/2022/12/28/20221228135207000/" title="ArcGIS Pro SDK 地理数据库"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理数据库</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%83%E5%B1%80"><span class="toc-number">1.</span> <span class="toc-text">布局</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E9%A1%B9%E7%9B%AE%E9%A1%B9"><span class="toc-number">1.1.</span> <span class="toc-text">布局项目项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%B8%83%E5%B1%80%E9%A1%B9%E7%9B%AE%E9%A1%B9%E5%8F%8A%E5%85%B6%E5%85%B3%E8%81%94%E5%B8%83%E5%B1%80"><span class="toc-number">1.1.1.</span> <span class="toc-text">参考布局项目项及其关联布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E6%96%B0%E8%A7%86%E5%9B%BE%E4%B8%AD%E6%89%93%E5%BC%80%E5%B8%83%E5%B1%80%E9%A1%B9%E7%9B%AE%E9%A1%B9"><span class="toc-number">1.1.2.</span> <span class="toc-text">在新视图中打开布局项目项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BF%80%E6%B4%BB%E5%B7%B2%E6%89%93%E5%BC%80%E7%9A%84%E5%B8%83%E5%B1%80%E8%A7%86%E5%9B%BE"><span class="toc-number">1.1.3.</span> <span class="toc-text">激活已打开的布局视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E7%94%A8%E6%B4%BB%E5%8A%A8%E5%B8%83%E5%B1%80%E8%A7%86%E5%9B%BE"><span class="toc-number">1.1.4.</span> <span class="toc-text">引用活动布局视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86-pagx-%E5%AF%BC%E5%85%A5%E5%88%B0%E9%A1%B9%E7%9B%AE%E4%B8%AD"><span class="toc-number">1.1.5.</span> <span class="toc-text">将 pagx 导入到项目中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%B8%83%E5%B1%80%E9%A1%B9%E7%9B%AE%E9%A1%B9"><span class="toc-number">1.1.6.</span> <span class="toc-text">删除布局项目项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B8%83%E5%B1%80%E5%B9%B6%E5%B0%86%E5%85%B6%E6%89%93%E5%BC%80"><span class="toc-number">1.1.7.</span> <span class="toc-text">创建新的基本布局并将其打开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84-CIM-%E5%88%9B%E5%BB%BA%E6%96%B0%E5%B8%83%E5%B1%80%E5%B9%B6%E5%B0%86%E5%85%B6%E6%89%93%E5%BC%80"><span class="toc-number">1.1.8.</span> <span class="toc-text">使用修改后的 CIM 创建新布局并将其打开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%B8%83%E5%B1%80%E9%A1%B5%E9%9D%A2%E5%A4%A7%E5%B0%8F"><span class="toc-number">1.1.9.</span> <span class="toc-text">更改布局页面大小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProSnippet-Group-CIM-Graphics-and-GraphicFactory"><span class="toc-number">1.1.10.</span> <span class="toc-text">ProSnippet Group CIM Graphics and GraphicFactory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%86%E5%BD%A2%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.1.11.</span> <span class="toc-text">创建圆形图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%86%E5%BD%A2%E6%96%87%E6%9C%AC%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.1.12.</span> <span class="toc-text">创建圆形文本图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B4%9D%E5%A1%9E%E5%B0%94%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.1.13.</span> <span class="toc-text">创建贝塞尔图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9B%BE%E4%BE%8B%E5%9B%BE%E9%9D%A2%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.1.14.</span> <span class="toc-text">创建图例图面图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%AE%AD%E5%A4%B4%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.1.15.</span> <span class="toc-text">创建箭头图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9B%BE%E7%89%87%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.1.16.</span> <span class="toc-text">创建图片图形</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%B8%83%E5%B1%80%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.</span> <span class="toc-text">创建布局图形元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%A4%AD%E5%9C%86%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.1.</span> <span class="toc-text">创建椭圆图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A5%97%E7%B4%A2%E7%BA%BF%EF%BC%8C%E6%89%8B%E7%BB%98%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.2.</span> <span class="toc-text">创建套索线，手绘图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A5%97%E7%B4%A2%E5%A4%9A%E8%BE%B9%E5%BD%A2%EF%BC%8C%E6%89%8B%E7%BB%98%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.3.</span> <span class="toc-text">创建套索多边形，手绘元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%BA%BF%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.4.</span> <span class="toc-text">创建线元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%82%B9%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.5.</span> <span class="toc-text">创建点元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%9A%E8%BE%B9%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.6.</span> <span class="toc-text">创建多边形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%9F%A9%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.7.</span> <span class="toc-text">创建矩形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.8.</span> <span class="toc-text">创建贝塞尔曲线元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.9.</span> <span class="toc-text">创建图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-CIMG-%E5%88%9B%E5%BB%BA%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.10.</span> <span class="toc-text">使用 CIMG 创建图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-CIMSymbol-%E5%88%9B%E5%BB%BA%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.11.</span> <span class="toc-text">使用 CIMSymbol 创建图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%B9%E9%87%8F%E5%85%83%E7%B4%A0%E5%88%9B%E5%BB%BA"><span class="toc-number">1.2.12.</span> <span class="toc-text">批量元素创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-CIMG-%E5%88%9B%E5%BB%BA%E5%85%83%E7%B4%A0"><span class="toc-number">1.2.13.</span> <span class="toc-text">使用 CIMG 创建元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AC%A6%E5%8F%B7%E7%B3%BB%E7%BB%9F%E5%88%9B%E5%BB%BA%E7%82%B9%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.2.14.</span> <span class="toc-text">使用符号系统创建点图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AC%A6%E5%8F%B7%E7%B3%BB%E7%BB%9F%E5%88%9B%E5%BB%BA%E7%BA%BF%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.2.15.</span> <span class="toc-text">使用符号系统创建线图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E7%AE%80%E5%8D%95%E7%AC%A6%E5%8F%B7%E7%B3%BB%E7%BB%9F%E5%88%9B%E5%BB%BA%E7%9F%A9%E5%BD%A2%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.2.16.</span> <span class="toc-text">使用简单符号系统创建矩形图形</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%87%E6%9C%AC%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.3.</span> <span class="toc-text">创建文本图形元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%82%B9%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">创建点文本元素 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%9F%A9%E5%BD%A2%E6%AE%B5%E8%90%BD%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0-1"><span class="toc-number">1.3.2.</span> <span class="toc-text">创建矩形段落文本元素 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%8A%A8%E6%80%81%E7%82%B9%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">1.3.3.</span> <span class="toc-text">创建动态点文本元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%82%B9%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0-2"><span class="toc-number">1.3.4.</span> <span class="toc-text">创建点文本元素 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%9A%E8%BE%B9%E5%BD%A2%E6%AE%B5%E8%90%BD%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">1.3.5.</span> <span class="toc-text">创建多边形段落文本元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%9F%A9%E5%BD%A2%E6%AE%B5%E8%90%BD%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0-2"><span class="toc-number">1.3.6.</span> <span class="toc-text">创建矩形段落文本元素 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%86%E5%BD%A2%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">1.3.7.</span> <span class="toc-text">创建圆形文本元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">1.3.8.</span> <span class="toc-text">创建贝塞尔文本元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%A4%AD%E5%9C%86%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">1.3.9.</span> <span class="toc-text">创建椭圆文本元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BD%A2%E7%8A%B6%E5%92%8C%E7%AE%AD%E5%A4%B4"><span class="toc-number">1.4.</span> <span class="toc-text">创建预定义的形状和箭头</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BD%A2%E7%8A%B6%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.4.1.</span> <span class="toc-text">创建预定义的形状图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BD%A2%E7%8A%B6%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">创建预定义的形状图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A2%84%E5%AE%9A%E4%B9%89%E7%9A%84%E5%BD%A2%E7%8A%B6%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0-2"><span class="toc-number">1.4.3.</span> <span class="toc-text">创建预定义的形状图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%BA%BF%E7%AE%AD%E5%A4%B4%E5%85%83%E7%B4%A0"><span class="toc-number">1.4.4.</span> <span class="toc-text">创建线箭头元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%85%83%E7%B4%A0"><span class="toc-number">1.5.</span> <span class="toc-text">图片元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-CIMSymbol-%E5%88%9B%E5%BB%BA%E5%9B%BE%E7%89%87%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.5.1.</span> <span class="toc-text">使用 CIMSymbol 创建图片图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%AB%98%E7%BA%A7%E7%AC%A6%E5%8F%B7%E8%AE%BE%E7%BD%AE%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E5%9B%BE%E7%89%87%E5%85%83%E7%B4%A0"><span class="toc-number">1.5.2.</span> <span class="toc-text">使用高级符号设置创建新的图片元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%B0%E5%9B%BE%E6%A1%86%E5%92%8C%E7%8E%AF%E7%BB%95%E8%A6%81%E7%B4%A0"><span class="toc-number">1.6.</span> <span class="toc-text">创建地图框和环绕要素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%B0%E5%9B%BE%E6%A1%86%E5%B9%B6%E8%AE%BE%E7%BD%AE%E7%85%A7%E7%9B%B8%E6%9C%BA"><span class="toc-number">1.6.1.</span> <span class="toc-text">创建地图框并设置照相机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9B%BE%E4%BE%8B"><span class="toc-number">1.6.2.</span> <span class="toc-text">创建图例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%A0%B7%E5%BC%8F%E9%A1%B9%E5%88%9B%E5%BB%BA%E6%AF%94%E4%BE%8B%E5%B0%BA"><span class="toc-number">1.6.3.</span> <span class="toc-text">从样式项创建比例尺</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%A0%B7%E5%BC%8F%E9%A1%B9-1-%E5%88%9B%E5%BB%BA%E6%8C%87%E5%8C%97%E9%92%88"><span class="toc-number">1.6.4.</span> <span class="toc-text">从样式项 1 创建指北针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC%E6%A1%86"><span class="toc-number">1.6.5.</span> <span class="toc-text">创建表格框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%B0%E5%9B%BE%E6%A1%86-1"><span class="toc-number">1.6.6.</span> <span class="toc-text">创建地图框 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9C%B0%E5%9B%BE%E6%A1%86-2"><span class="toc-number">1.6.7.</span> <span class="toc-text">创建地图框 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%9B%BE%E4%BE%8B-2"><span class="toc-number">1.6.8.</span> <span class="toc-text">创建图例 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%A0%B7%E5%BC%8F%E9%A1%B9-2-%E5%88%9B%E5%BB%BA%E6%8C%87%E5%8C%97%E9%92%88"><span class="toc-number">1.6.9.</span> <span class="toc-text">从样式项 2 创建指北针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%A0%BC%E6%A1%86-1"><span class="toc-number">1.6.10.</span> <span class="toc-text">创建表格框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%AF%94%E4%BE%8B%E5%B0%BA"><span class="toc-number">1.6.11.</span> <span class="toc-text">创建比例尺</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%AF%94%E4%BE%8B%E7%BA%BF"><span class="toc-number">1.6.12.</span> <span class="toc-text">创建比例线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%85%83%E7%B4%A0"><span class="toc-number">1.7.</span> <span class="toc-text">组元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%A9%BA%E7%BB%84%E5%85%83%E7%B4%A0"><span class="toc-number">1.7.1.</span> <span class="toc-text">创建空组元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%8C%85%E5%90%AB%E5%85%83%E7%B4%A0%E7%9A%84%E7%BB%84%E5%85%83%E7%B4%A0"><span class="toc-number">1.7.2.</span> <span class="toc-text">创建包含元素的组元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E5%85%83%E7%B4%A0%E5%92%8C%E9%80%89%E6%8B%A9"><span class="toc-number">1.8.</span> <span class="toc-text">布局元素和选择</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%B8%83%E5%B1%80%E4%B8%8A%E6%9F%A5%E6%89%BE%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.1.</span> <span class="toc-text">在布局上查找元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%B8%83%E5%B1%80%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.2.</span> <span class="toc-text">查找布局元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%85%83%E7%B4%A0%E5%B1%9E%E6%80%A7"><span class="toc-number">1.8.3.</span> <span class="toc-text">更新元素属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E9%80%89%E6%8B%A9%E8%AE%A1%E6%95%B0"><span class="toc-number">1.8.4.</span> <span class="toc-text">获取元素选择计数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%85%83%E7%B4%A0%E9%80%89%E6%8B%A9"><span class="toc-number">1.8.5.</span> <span class="toc-text">设置元素选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E9%80%89%E6%8B%A9%E5%B8%83%E5%B1%80%E4%B8%8A%E7%9A%84%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.6.</span> <span class="toc-text">取消选择布局上的元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%B8%83%E5%B1%80%E8%A7%86%E5%9B%BE%E4%B8%AD%E5%8F%96%E6%B6%88%E9%80%89%E6%8B%A9%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.7.</span> <span class="toc-text">在布局视图中取消选择元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%B8%83%E5%B1%80%E8%A7%86%E5%9B%BE%E4%B8%AD%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-number">1.8.8.</span> <span class="toc-text">清除布局视图中的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E5%B8%83%E5%B1%80%E4%B8%AD%E7%9A%84%E6%89%80%E9%80%89%E5%86%85%E5%AE%B9"><span class="toc-number">1.8.9.</span> <span class="toc-text">清除布局中的所选内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E5%B8%83%E5%B1%80%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.10.</span> <span class="toc-text">复制布局元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%B8%83%E5%B1%80%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.11.</span> <span class="toc-text">删除布局元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%B8%83%E5%B1%80%E4%B8%8A%E7%9A%84%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.12.</span> <span class="toc-text">删除布局上的一个或多个元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%A9%E6%94%BE%E5%88%B0%E5%85%83%E7%B4%A0"><span class="toc-number">1.8.13.</span> <span class="toc-text">缩放到元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%8C%87%E5%8C%97%E9%92%88%E7%9A%84%E6%99%95%E5%9C%88%E5%B1%9E%E6%80%A7"><span class="toc-number">1.8.14.</span> <span class="toc-text">设置指北针的晕圈属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84%E5%92%8C%E6%8E%92%E5%BA%8F"><span class="toc-number">1.9.</span> <span class="toc-text">对图形元素进行分组和排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.9.1.</span> <span class="toc-text">组图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E7%BB%84%E5%90%88%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0"><span class="toc-number">1.9.2.</span> <span class="toc-text">取消组合图形元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%85%83%E7%B4%A0%E7%9A%84%E7%88%B6%E7%BA%A7"><span class="toc-number">1.9.3.</span> <span class="toc-text">组元素的父级</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%85%83%E7%B4%A0%E4%B8%AD%E7%9A%84%E5%AD%90%E5%85%83%E7%B4%A0"><span class="toc-number">1.9.4.</span> <span class="toc-text">组元素中的子元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%EF%BC%9A%E5%90%91%E5%90%8E%E5%8F%91%E9%80%81%E5%92%8C%E5%90%91%E5%89%8D%E5%8F%91%E9%80%81"><span class="toc-number">1.9.5.</span> <span class="toc-text">排序：向后发送和向前发送</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96-Z-%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.9.6.</span> <span class="toc-text">获取 Z 顺序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%B8%83%E5%B1%80%E5%85%83%E7%B4%A0"><span class="toc-number">1.10.</span> <span class="toc-text">更新布局元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%96%87%E6%9C%AC%E5%85%83%E7%B4%A0%E5%B1%9E%E6%80%A7"><span class="toc-number">1.10.1.</span> <span class="toc-text">更新文本元素属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%9B%BE%E7%89%87%E5%85%83%E7%B4%A0"><span class="toc-number">1.10.2.</span> <span class="toc-text">更新图片元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E8%83%8C%E6%99%AF%E9%A2%9C%E8%89%B2%E5%BA%94%E7%94%A8%E4%BA%8E%E5%9C%B0%E5%9B%BE%E6%A1%86"><span class="toc-number">1.10.3.</span> <span class="toc-text">将背景颜色应用于地图框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%9C%B0%E5%9B%BE%E6%95%B4%E9%A5%B0"><span class="toc-number">1.10.4.</span> <span class="toc-text">更新地图整饰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%81%E5%AE%9A%E5%85%83%E7%B4%A0"><span class="toc-number">1.10.5.</span> <span class="toc-text">锁定元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%85%83%E7%B4%A0%E9%80%8F%E6%98%8E%E5%BA%A6"><span class="toc-number">1.10.6.</span> <span class="toc-text">更新元素透明度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%8B%E9%9A%86%E5%85%83%E7%B4%A0"><span class="toc-number">1.10.7.</span> <span class="toc-text">克隆元素</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">1.11.</span> <span class="toc-text">布局元数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E5%85%83%E6%95%B0%E6%8D%AE-1"><span class="toc-number">1.11.1.</span> <span class="toc-text">布局元数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E5%9C%B0%E5%9B%BE%E6%A1%86"><span class="toc-number">1.12.</span> <span class="toc-text">布局地图框</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E4%B8%8E%E5%9C%B0%E5%9B%BE%E6%A1%86%E5%85%B3%E8%81%94%E7%9A%84%E5%9C%B0%E5%9B%BE"><span class="toc-number">1.12.1.</span> <span class="toc-text">更改与地图框关联的地图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E5%9C%B0%E5%9B%BE%E6%A1%86%E7%85%A7%E7%9B%B8%E6%9C%BA%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.12.2.</span> <span class="toc-text">更改地图框照相机设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E6%A1%86%E7%BC%A9%E6%94%BE%E5%88%B0%E5%8D%95%E4%B8%AA%E5%9B%BE%E5%B1%82%E7%9A%84%E8%8C%83%E5%9B%B4"><span class="toc-number">1.12.3.</span> <span class="toc-text">将地图框缩放到单个图层的范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E6%A1%86%E8%8C%83%E5%9B%B4%E6%9B%B4%E6%94%B9%E4%B8%BA%E5%A4%9A%E4%B8%AA%E5%9B%BE%E5%B1%82%E4%B8%AD%E7%9A%84%E6%89%80%E9%80%89%E8%A6%81%E7%B4%A0"><span class="toc-number">1.12.4.</span> <span class="toc-text">将地图框范围更改为多个图层中的所选要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E6%A1%86%E8%8C%83%E5%9B%B4%E6%9B%B4%E6%94%B9%E4%B8%BA%E5%85%B7%E6%9C%89-15-%E7%BC%93%E5%86%B2%E5%8C%BA%E7%9A%84%E5%8D%95%E4%B8%AA%E8%A6%81%E7%B4%A0"><span class="toc-number">1.12.5.</span> <span class="toc-text">将地图框范围更改为具有 15% 缓冲区的单个要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E9%A1%B5%E9%9D%A2%E5%9D%90%E6%A0%87%E4%B8%AD%E7%9A%84%E7%82%B9%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%9C%B0%E5%9B%BE%E5%9D%90%E6%A0%87%E4%B8%AD%E7%9A%84%E7%82%B9%E3%80%82"><span class="toc-number">1.12.6.</span> <span class="toc-text">将页面坐标中的点转换为地图坐标中的点。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E5%9D%90%E6%A0%87%E4%B8%AD%E7%9A%84%E7%82%B9%E8%BD%AC%E6%8D%A2%E4%B8%BA%E9%A1%B5%E9%9D%A2%E5%9D%90%E6%A0%87%E4%B8%AD%E7%9A%84%E7%82%B9"><span class="toc-number">1.12.7.</span> <span class="toc-text">将地图坐标中的点转换为页面坐标中的点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E5%9B%BE%E7%B3%BB%E5%88%97"><span class="toc-number">1.13.</span> <span class="toc-text">布局图系列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%8E%B0%E6%9C%89%E5%9C%B0%E5%9B%BE%E7%B3%BB%E5%88%97"><span class="toc-number">1.13.1.</span> <span class="toc-text">修改现有地图系列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%96%B0%E7%9A%84%E7%A9%BA%E9%97%B4%E5%9C%B0%E5%9B%BE%E7%B3%BB%E5%88%97"><span class="toc-number">1.13.2.</span> <span class="toc-text">创建新的空间地图系列</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E5%AF%BC%E5%87%BA"><span class="toc-number">1.14.</span> <span class="toc-text">布局导出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%B8%83%E5%B1%80%E5%AF%BC%E5%87%BA%E4%B8%BA-PDF"><span class="toc-number">1.14.1.</span> <span class="toc-text">将布局导出为 PDF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E6%A1%86%E5%AF%BC%E5%87%BA%E4%B8%BA-JPG"><span class="toc-number">1.14.2.</span> <span class="toc-text">将地图框导出为 JPG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E4%B8%8E%E5%9C%B0%E5%9B%BE%E6%A1%86%E5%85%B3%E8%81%94%E7%9A%84%E5%9C%B0%E5%9B%BE%E8%A7%86%E5%9B%BE%E5%AF%BC%E5%87%BA%E5%88%B0-BMP"><span class="toc-number">1.14.3.</span> <span class="toc-text">将与地图框关联的地图视图导出到 BMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E7%B3%BB%E5%88%97%E5%AF%BC%E5%87%BA%E4%B8%BA%E5%8D%95%E4%B8%AA-PDF"><span class="toc-number">1.14.4.</span> <span class="toc-text">将地图系列导出为单个 PDF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E7%B3%BB%E5%88%97%E5%AF%BC%E5%87%BA%E5%88%B0%E5%8D%95%E4%B8%AA-TIFF-%E6%96%87%E4%BB%B6"><span class="toc-number">1.14.5.</span> <span class="toc-text">将地图系列导出到单个 TIFF 文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B1%80%E9%80%89%E9%A1%B9"><span class="toc-number">1.15.</span> <span class="toc-text">布局选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%B8%83%E5%B1%80%E9%80%89%E9%A1%B9"><span class="toc-number">1.15.1.</span> <span class="toc-text">获取布局选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%B8%83%E5%B1%80%E9%80%89%E9%A1%B9"><span class="toc-number">1.15.2.</span> <span class="toc-text">设置布局选项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0%E9%80%89%E9%A1%B9"><span class="toc-number">1.16.</span> <span class="toc-text">文本和图形元素选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E5%8F%AF%E7%94%A8%E5%AD%97%E4%BD%93"><span class="toc-number">1.16.1.</span> <span class="toc-text">获取所有可用字体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0%E9%80%89%E9%A1%B9"><span class="toc-number">1.16.2.</span> <span class="toc-text">获取文本和图形元素选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%96%87%E6%9C%AC%E5%92%8C%E5%9B%BE%E5%BD%A2%E5%85%83%E7%B4%A0%E9%80%89%E9%A1%B9"><span class="toc-number">1.16.3.</span> <span class="toc-text">设置文本和图形元素选项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MapFrame-Display-Constraints"><span class="toc-number">1.17.</span> <span class="toc-text">MapFrame_Display_Constraints</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E6%97%A0"><span class="toc-number">1.17.1.</span> <span class="toc-text">设置自动相机无</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E5%9B%BA%E5%AE%9A%E8%8C%83%E5%9B%B4"><span class="toc-number">1.17.2.</span> <span class="toc-text">设置自动相机固定范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E5%9B%BA%E5%AE%9A%E4%B8%AD%E5%BF%83"><span class="toc-number">1.17.3.</span> <span class="toc-text">设置自动相机固定中心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E5%9B%BA%E5%AE%9A%E5%B1%85%E4%B8%AD%E5%92%8C%E7%BC%A9%E6%94%BE"><span class="toc-number">1.17.4.</span> <span class="toc-text">设置自动相机固定居中和缩放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E5%9B%BA%E5%AE%9A%E6%AF%94%E4%BE%8B"><span class="toc-number">1.17.5.</span> <span class="toc-text">设置自动相机固定比例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%85%A7%E7%9B%B8%E6%9C%BA%E9%93%BE%E6%8E%A5%E8%8C%83%E5%9B%B4"><span class="toc-number">1.17.6.</span> <span class="toc-text">设置自动照相机链接范围</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E9%93%BE%E6%8E%A5%E4%B8%AD%E5%BF%83"><span class="toc-number">1.17.7.</span> <span class="toc-text">设置自动相机链接中心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E9%93%BE%E6%8E%A5%E4%B8%AD%E5%BF%83%E5%92%8C%E7%BC%A9%E6%94%BE"><span class="toc-number">1.17.8.</span> <span class="toc-text">设置自动相机链接中心和缩放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E9%93%BE%E6%8E%A5%E7%BC%A9%E6%94%BE"><span class="toc-number">1.17.9.</span> <span class="toc-text">设置自动相机链接缩放</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E9%93%BE%E6%8E%A5%E5%9C%B0%E5%9B%BE%E7%B3%BB%E5%88%97%E5%BD%A2%E7%8A%B6"><span class="toc-number">1.17.10.</span> <span class="toc-text">设置自动相机链接地图系列形状</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%87%AA%E5%8A%A8%E7%9B%B8%E6%9C%BA%E9%93%BE%E6%8E%A5%E5%9C%B0%E5%9B%BE%E7%B3%BB%E5%88%97%E4%B8%AD%E5%BF%83"><span class="toc-number">1.17.11.</span> <span class="toc-text">设置自动相机链接地图系列中心</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_12.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By shaozhy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="/img/icp.png"><span>冀ICP备2023009991号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'd990e8cbbd1dabc9c98e',
      clientSecret: '59676d5926f4df676ec1ba6b36395bf90a0aeb54',
      repo: 'WineMonk.github.io',
      owner: 'WineMonk',
      admin: ['WineMonk'],
      id: '95ae4c255cc94d5d9518645c0c88481e',
      updateCountCallback: commentCount
    },{"proxy":"https://vercel.prohibitorum.top/github_access_token"}))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="茶飘香,酒罢去,聚朋友,再回楼" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>