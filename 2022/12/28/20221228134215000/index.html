<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ArcGIS Pro SDK 内容 | WineMonk</title><meta name="keywords" content="CSharp,ArcGIS Pro SDK"><meta name="author" content="shaozhy,1361151272@qq.com"><meta name="copyright" content="shaozhy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="内容项目创建一个空项目123&#x2F;&#x2F;Create an empty project. The project will be created in the default folder&#x2F;&#x2F;It will be named MyProject1, MyProject2, or similar...await Project.CreateAsync();  创建具有指定名称的新项目12345678&#x2F;&#x2F;Se">
<meta property="og:type" content="article">
<meta property="og:title" content="ArcGIS Pro SDK 内容">
<meta property="og:url" content="https://shaoshao.net.cn/2022/12/28/20221228134215000/index.html">
<meta property="og:site_name" content="WineMonk">
<meta property="og:description" content="内容项目创建一个空项目123&#x2F;&#x2F;Create an empty project. The project will be created in the default folder&#x2F;&#x2F;It will be named MyProject1, MyProject2, or similar...await Project.CreateAsync();  创建具有指定名称的新项目12345678&#x2F;&#x2F;Se">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg">
<meta property="article:published_time" content="2022-12-28T05:42:15.000Z">
<meta property="article:modified_time" content="2023-04-14T01:28:34.000Z">
<meta property="article:author" content="shaozhy">
<meta property="article:tag" content="CSharp">
<meta property="article:tag" content="ArcGIS Pro SDK">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg"><link rel="shortcut icon" href="/cover/head_portrait.jpg"><link rel="canonical" href="https://shaoshao.net.cn/2022/12/28/20221228134215000/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ArcGIS Pro SDK 内容',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-14 09:28:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/discover/archives/"><div class="headline">文章</div><div class="length-num">181</div></a></div><div class="data-item"><a href="/discover/tags/"><div class="headline">标签</div><div class="length-num">112</div></a></div><div class="data-item"><a href="/discover/categories/"><div class="headline">分类</div><div class="length-num">81</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">WineMonk</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ArcGIS Pro SDK 内容</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-28T05:42:15.000Z" title="发表于 2022-12-28 13:42:15">2022-12-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-14T01:28:34.000Z" title="更新于 2023-04-14 09:28:34">2023-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ArcGIS Pro SDK 内容"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h1><h2 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h2><h3 id="创建一个空项目"><a href="#创建一个空项目" class="headerlink" title="创建一个空项目"></a>创建一个空项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create an empty project. The project will be created in the default folder</span></span><br><span class="line"><span class="comment">//It will be named MyProject1, MyProject2, or similar...</span></span><br><span class="line"><span class="keyword">await</span> Project.CreateAsync();</span><br></pre></td></tr></table></figure>

<h3 id="创建具有指定名称的新项目"><a href="#创建具有指定名称的新项目" class="headerlink" title="创建具有指定名称的新项目"></a>创建具有指定名称的新项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Settings used to create a new project</span></span><br><span class="line">CreateProjectSettings projectSettings = <span class="keyword">new</span> CreateProjectSettings()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Sets the name of the project that will be created</span></span><br><span class="line">  Name = <span class="string">@&quot;C:\Data\MyProject1\MyProject1.aprx&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//Create the new project</span></span><br><span class="line"><span class="keyword">await</span> Project.CreateAsync(projectSettings);</span><br></pre></td></tr></table></figure>

<h3 id="使用-Pro-的默认设置创建新项目"><a href="#使用-Pro-的默认设置创建新项目" class="headerlink" title="使用 Pro 的默认设置创建新项目"></a>使用 Pro 的默认设置创建新项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get Pro&#x27;s default project settings.</span></span><br><span class="line"><span class="keyword">var</span> defaultProjectSettings = Project.GetDefaultProjectSettings();</span><br><span class="line"><span class="comment">//Create a new project using the default project settings</span></span><br><span class="line"><span class="keyword">await</span> Project.CreateAsync(defaultProjectSettings);</span><br></pre></td></tr></table></figure>

<h3 id="使用自定义模板文件新建项目"><a href="#使用自定义模板文件新建项目" class="headerlink" title="使用自定义模板文件新建项目"></a>使用自定义模板文件新建项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Settings used to create a new project</span></span><br><span class="line">CreateProjectSettings projectSettings = <span class="keyword">new</span> CreateProjectSettings()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Sets the project&#x27;s name</span></span><br><span class="line">  Name = <span class="string">&quot;New Project&quot;</span>,</span><br><span class="line">  <span class="comment">//Path where new project will be stored in</span></span><br><span class="line">  LocationPath = <span class="string">@&quot;C:\Data\NewProject&quot;</span>,</span><br><span class="line">  <span class="comment">//Sets the project template that will be used to create the new project</span></span><br><span class="line">  TemplatePath = <span class="string">@&quot;C:\Data\MyProject1\CustomTemplate.aptx&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//Create the new project</span></span><br><span class="line"><span class="keyword">await</span> Project.CreateAsync(projectSettings);</span><br></pre></td></tr></table></figure>

<h3 id="使用-ArcGIS-Pro-提供的模板创建工程"><a href="#使用-ArcGIS-Pro-提供的模板创建工程" class="headerlink" title="使用 ArcGIS Pro 提供的模板创建工程"></a>使用 ArcGIS Pro 提供的模板创建工程</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Settings used to create a new project</span></span><br><span class="line">CreateProjectSettings proTemplateSettings = <span class="keyword">new</span> CreateProjectSettings()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Sets the project&#x27;s name</span></span><br><span class="line">  Name = <span class="string">&quot;New Project&quot;</span>,</span><br><span class="line">  <span class="comment">//Path where new project will be stored in</span></span><br><span class="line">  LocationPath = <span class="string">@&quot;C:\Data\NewProject&quot;</span>,</span><br><span class="line">  <span class="comment">//Select which Pro template you like to use</span></span><br><span class="line">  TemplateType = TemplateType.Catalog</span><br><span class="line">  <span class="comment">//TemplateType = TemplateType.LocalScene</span></span><br><span class="line">  <span class="comment">//TemplateType = TemplateType.GlobalScene</span></span><br><span class="line">  <span class="comment">//TemplateType = TemplateType.Map</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//Create the new project</span></span><br><span class="line"><span class="keyword">await</span> Project.CreateAsync(proTemplateSettings);</span><br></pre></td></tr></table></figure>

<h3 id="打开现有项目"><a href="#打开现有项目" class="headerlink" title="打开现有项目"></a>打开现有项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Opens an existing project or project package</span></span><br><span class="line"><span class="keyword">await</span> Project.OpenAsync(<span class="string">@&quot;C:\Data\MyProject1\MyProject1.aprx&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="获取当前项目"><a href="#获取当前项目" class="headerlink" title="获取当前项目"></a>获取当前项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Gets the current project</span></span><br><span class="line"><span class="keyword">var</span> project = Project.Current;</span><br></pre></td></tr></table></figure>

<h3 id="获取当前项目的位置"><a href="#获取当前项目的位置" class="headerlink" title="获取当前项目的位置"></a>获取当前项目的位置</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Gets the location of the current project; that is, the path to the current project file (*.aprx)  </span></span><br><span class="line"><span class="built_in">string</span> projectPath = Project.Current.URI;</span><br></pre></td></tr></table></figure>

<h3 id="获取项目的默认-gdb-路径"><a href="#获取项目的默认-gdb-路径" class="headerlink" title="获取项目的默认 gdb 路径"></a>获取项目的默认 gdb 路径</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> projGDBPath = Project.Current.DefaultGeodatabasePath;</span><br></pre></td></tr></table></figure>

<h3 id="保存项目"><a href="#保存项目" class="headerlink" title="保存项目"></a>保存项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Saves the project</span></span><br><span class="line"><span class="keyword">await</span> Project.Current.SaveAsync();</span><br></pre></td></tr></table></figure>

<h3 id="检查是否需要保存项目"><a href="#检查是否需要保存项目" class="headerlink" title="检查是否需要保存项目"></a>检查是否需要保存项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//The project&#x27;s dirty state indicates changes made to the project have not yet been saved. </span></span><br><span class="line"><span class="built_in">bool</span> isProjectDirty = Project.Current.IsDirty;</span><br></pre></td></tr></table></figure>

<h3 id="另存为项目"><a href="#另存为项目" class="headerlink" title="另存为项目"></a>另存为项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Saves a copy of the current project file (*.aprx) to the specified location with the specified file name, </span></span><br><span class="line"><span class="comment">//then opens the new project file</span></span><br><span class="line"><span class="keyword">await</span> Project.Current.SaveAsAsync(<span class="string">@&quot;C:\Data\MyProject1\MyNewProject1.aprx&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="关闭项目"><a href="#关闭项目" class="headerlink" title="关闭项目"></a>关闭项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//A project cannot be closed using the ArcGIS Pro API. </span></span><br><span class="line"><span class="comment">//A project is only closed when another project is opened, a new one is created, or the application is shutdown.</span></span><br></pre></td></tr></table></figure>

<h3 id="如何向工程添加新地图"><a href="#如何向工程添加新地图" class="headerlink" title="如何向工程添加新地图"></a>如何向工程添加新地图</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Note: see also MapFactory in ArcGIS.Desktop.Mapping</span></span><br><span class="line">  <span class="keyword">var</span> map = MapFactory.Instance.CreateMap(<span class="string">&quot;New Map&quot;</span>, MapType.Map, MapViewingMode.Map, Basemap.Oceans);</span><br><span class="line">  ProApp.Panes.CreateMapPaneAsync(map);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="项目项"><a href="#项目项" class="headerlink" title="项目项"></a>项目项</h2><h3 id="将文件夹连接项添加到当前项目"><a href="#将文件夹连接项添加到当前项目" class="headerlink" title="将文件夹连接项添加到当前项目"></a>将文件夹连接项添加到当前项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Adding a folder connection</span></span><br><span class="line"><span class="built_in">string</span> folderPath = <span class="string">&quot;@C:\\myDataFolder&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> folder = <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Create the folder connection project item</span></span><br><span class="line">  <span class="keyword">var</span> item = ItemFactory.Instance.Create(folderPath) <span class="keyword">as</span> IProjectItem;</span><br><span class="line">  <span class="comment">//If it is succesfully added to the project, return it otherwise null</span></span><br><span class="line">  <span class="keyword">return</span> Project.Current.AddItem(item) ? item <span class="keyword">as</span> FolderConnectionProjectItem : <span class="literal">null</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Adding a Geodatabase:</span></span><br><span class="line"><span class="built_in">string</span> gdbPath = <span class="string">&quot;@C:\\myDataFolder\\myData.gdb&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> newlyAddedGDB = <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Create the File GDB project item</span></span><br><span class="line">  <span class="keyword">var</span> item = ItemFactory.Instance.Create(gdbPath) <span class="keyword">as</span> IProjectItem;</span><br><span class="line">  <span class="comment">//If it is succesfully added to the project, return it otherwise null</span></span><br><span class="line">  <span class="keyword">return</span> Project.Current.AddItem(item) ? item <span class="keyword">as</span> GDBProjectItem : <span class="literal">null</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="获取所有项目项"><a href="#获取所有项目项" class="headerlink" title="获取所有项目项"></a>获取所有项目项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IEnumerable&lt;Item&gt; allProjectItems = Project.Current.GetItems&lt;Item&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> pi <span class="keyword">in</span> allProjectItems)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取项目的所有“MapProjectItems”"><a href="#获取项目的所有“MapProjectItems”" class="headerlink" title="获取项目的所有“MapProjectItems”"></a>获取项目的所有“MapProjectItems”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">IEnumerable&lt;MapProjectItem&gt; newMapItemsContainer = project.GetItems&lt;MapProjectItem&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> mp <span class="keyword">in</span> newMapItemsContainer)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Do Something with the map. For Example:</span></span><br><span class="line">    Map myMap = mp.GetMap();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="获取特定的“MapProjectItem”"><a href="#获取特定的“MapProjectItem”" class="headerlink" title="获取特定的“MapProjectItem”"></a>获取特定的“MapProjectItem”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MapProjectItem mapProjItem = Project.Current.GetItems&lt;MapProjectItem&gt;().FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;EuropeMap&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="获取所有“样式项目项”"><a href="#获取所有“样式项目项”" class="headerlink" title="获取所有“样式项目项”"></a>获取所有“样式项目项”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IEnumerable&lt;StyleProjectItem&gt; newStyleItemsContainer = <span class="literal">null</span>;</span><br><span class="line">newStyleItemsContainer = Project.Current.GetItems&lt;StyleProjectItem&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> styleItem <span class="keyword">in</span> newStyleItemsContainer)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something with the style.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取特定的“样式项目项”"><a href="#获取特定的“样式项目项”" class="headerlink" title="获取特定的“样式项目项”"></a>获取特定的“样式项目项”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> container = Project.Current.GetItems&lt;StyleProjectItem&gt;();</span><br><span class="line">StyleProjectItem testStyle = container.FirstOrDefault(style =&gt; (style.Name == <span class="string">&quot;ArcGIS 3D&quot;</span>));</span><br><span class="line">StyleItem cone = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (testStyle != <span class="literal">null</span>)</span><br><span class="line">  cone = testStyle.LookupItem(StyleItemType.PointSymbol, <span class="string">&quot;Cone_Volume_3&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="获取“收藏夹”样式项目项"><a href="#获取“收藏夹”样式项目项" class="headerlink" title="获取“收藏夹”样式项目项"></a>获取“收藏夹”样式项目项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fav_style_item = <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> containerStyle = Project.Current.GetProjectItemContainer(<span class="string">&quot;Style&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> containerStyle.GetItems().OfType&lt;StyleProjectItem&gt;().First(item =&gt; item.TypeID == <span class="string">&quot;personal_style&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="获取所有“GDBProjectItems”"><a href="#获取所有“GDBProjectItems”" class="headerlink" title="获取所有“GDBProjectItems”"></a>获取所有“GDBProjectItems”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IEnumerable&lt;GDBProjectItem&gt; newGDBItemsContainer = <span class="literal">null</span>;</span><br><span class="line">newGDBItemsContainer = Project.Current.GetItems&lt;GDBProjectItem&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> GDBItem <span class="keyword">in</span> newGDBItemsContainer)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something with the GDB.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取特定的“GDBProjectItem”"><a href="#获取特定的“GDBProjectItem”" class="headerlink" title="获取特定的“GDBProjectItem”"></a>获取特定的“GDBProjectItem”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GDBProjectItem GDBProjItem = Project.Current.GetItems&lt;GDBProjectItem&gt;().FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;myGDB&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="获取所有“服务器连接项目项”"><a href="#获取所有“服务器连接项目项”" class="headerlink" title="获取所有“服务器连接项目项”"></a>获取所有“服务器连接项目项”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IEnumerable&lt;ServerConnectionProjectItem&gt; newServerConnections = <span class="literal">null</span>;</span><br><span class="line">newServerConnections = project.GetItems&lt;ServerConnectionProjectItem&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> serverItem <span class="keyword">in</span> newServerConnections)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something with the server connection.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取特定的“服务器连接项目项”"><a href="#获取特定的“服务器连接项目项”" class="headerlink" title="获取特定的“服务器连接项目项”"></a>获取特定的“服务器连接项目项”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ServerConnectionProjectItem serverProjItem = Project.Current.GetItems&lt;ServerConnectionProjectItem&gt;().FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;myServer&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="获取项目中的所有文件夹连接"><a href="#获取项目中的所有文件夹连接" class="headerlink" title="获取项目中的所有文件夹连接"></a>获取项目中的所有文件夹连接</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Gets all the folder connections in the current project</span></span><br><span class="line"><span class="keyword">var</span> projectFolders = Project.Current.GetItems&lt;FolderConnectionProjectItem&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> FolderItem <span class="keyword">in</span> projectFolders)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something with the Folder connection.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取特定文件夹连接"><a href="#获取特定文件夹连接" class="headerlink" title="获取特定文件夹连接"></a>获取特定文件夹连接</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Gets a specific folder connection in the current project</span></span><br><span class="line">FolderConnectionProjectItem myProjectFolder = Project.Current.GetItems&lt;FolderConnectionProjectItem&gt;().FirstOrDefault(folderPI =&gt; folderPI.Name.Equals(<span class="string">&quot;myDataFolder&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="删除特定文件夹连接"><a href="#删除特定文件夹连接" class="headerlink" title="删除特定文件夹连接"></a>删除特定文件夹连接</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Remove a folder connection from a project; the folder stored on the local disk or the network is not deleted</span></span><br><span class="line">FolderConnectionProjectItem folderToRemove = Project.Current.GetItems&lt;FolderConnectionProjectItem&gt;().FirstOrDefault(myfolder =&gt; myfolder.Name.Equals(<span class="string">&quot;PlantSpecies&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (folderToRemove != <span class="literal">null</span>)</span><br><span class="line">  Project.Current.RemoveItem(folderToRemove <span class="keyword">as</span> IProjectItem);</span><br></pre></td></tr></table></figure>

<h3 id="获取特定的“布局项目项”"><a href="#获取特定的“布局项目项”" class="headerlink" title="获取特定的“布局项目项”"></a>获取特定的“布局项目项”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LayoutProjectItem layoutProjItem = Project.Current.GetItems&lt;LayoutProjectItem&gt;().FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;myLayout&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="获取项目中的所有布局"><a href="#获取项目中的所有布局" class="headerlink" title="获取项目中的所有布局"></a>获取项目中的所有布局</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Gets all the layouts in the current project</span></span><br><span class="line"><span class="keyword">var</span> projectLayouts = Project.Current.GetItems&lt;LayoutProjectItem&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> layoutItem <span class="keyword">in</span> projectLayouts)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something with the layout</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取特定的“地理处理项目项”"><a href="#获取特定的“地理处理项目项”" class="headerlink" title="获取特定的“地理处理项目项”"></a>获取特定的“地理处理项目项”</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GeoprocessingProjectItem GPProjItem = Project.Current.GetItems&lt;GeoprocessingProjectItem&gt;().FirstOrDefault(item =&gt; item.Name.Equals(<span class="string">&quot;myToolbox&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="获取工程中的所有地理处理工程项"><a href="#获取工程中的所有地理处理工程项" class="headerlink" title="获取工程中的所有地理处理工程项"></a>获取工程中的所有地理处理工程项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Gets all the GeoprocessingProjectItem in the current project</span></span><br><span class="line"><span class="keyword">var</span> GPItems = Project.Current.GetItems&lt;GeoprocessingProjectItem&gt;();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> tbx <span class="keyword">in</span> GPItems)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Do Something with the toolbox</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="在项目中搜索特定项目"><a href="#在项目中搜索特定项目" class="headerlink" title="在项目中搜索特定项目"></a>在项目中搜索特定项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Item&gt; _mxd = <span class="keyword">new</span> List&lt;Item&gt;();</span><br><span class="line"><span class="comment">//Gets all the folder connections in the current project</span></span><br><span class="line"><span class="keyword">var</span> allFoldersItem = Project.Current.GetItems&lt;FolderConnectionProjectItem&gt;();</span><br><span class="line"><span class="keyword">if</span> (allFoldersItem != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//iterate through all the FolderConnectionProjectItems found</span></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> folderItem <span class="keyword">in</span> allFoldersItem)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Search for mxd files in that folder connection and add it to the List&lt;T&gt;</span></span><br><span class="line">    <span class="comment">//Note:ArcGIS Pro automatically creates and dynamically updates a searchable index as you build and work with projects. </span></span><br><span class="line">    <span class="comment">//Items are indexed when they are added to a project.</span></span><br><span class="line">    <span class="comment">//The first time a folder or database is indexed, indexing may take a while if it contains a large number of items. </span></span><br><span class="line">    <span class="comment">//While the index is being created, searches will not return any results.</span></span><br><span class="line">    _mxd.AddRange(folderItem.GetItems());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取默认项目文件夹"><a href="#获取默认项目文件夹" class="headerlink" title="获取默认项目文件夹"></a>获取默认项目文件夹</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get Pro&#x27;s default project settings.</span></span><br><span class="line"><span class="keyword">var</span> defaultSettings = Project.GetDefaultProjectSettings();</span><br><span class="line"><span class="keyword">var</span> defaultProjectPath = defaultSettings.LocationPath;</span><br><span class="line"><span class="keyword">if</span> (defaultProjectPath == <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// If not set, projects are saved in the user&#x27;s My Documents\ArcGIS\Projects folder;</span></span><br><span class="line">  <span class="comment">// this folder is created if it doesn&#x27;t already exist.</span></span><br><span class="line">  defaultProjectPath = System.IO.Path.Combine(</span><br><span class="line">              System.Environment.GetFolderPath(</span><br><span class="line">                   Environment.SpecialFolder.MyDocuments),</span><br><span class="line">              <span class="string">@&quot;ArcGIS\Projects&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="刷新文件夹连接项的子项"><a href="#刷新文件夹连接项的子项" class="headerlink" title="刷新文件夹连接项的子项"></a>刷新文件夹连接项的子项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> contentItem = Project.Current.GetItems&lt;FolderConnectionProjectItem&gt;().First();</span><br><span class="line"><span class="comment">//var contentItem = ...</span></span><br><span class="line"><span class="comment">//Check if the MCT is required for Refresh()</span></span><br><span class="line"><span class="keyword">if</span> (contentItem.IsMainThreadRequired)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//QueuedTask.Run must be used if item.IsMainThreadRequired</span></span><br><span class="line">  <span class="comment">//returns true</span></span><br><span class="line">  QueuedTask.Run(() =&gt; contentItem.Refresh());</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//if item.IsMainThreadRequired returns false, any</span></span><br><span class="line">  <span class="comment">//thread can be used to invoke Refresh(), though</span></span><br><span class="line">  <span class="comment">//BackgroundTask is preferred.</span></span><br><span class="line">  contentItem.Refresh();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Or, via BackgroundTask</span></span><br><span class="line">  ArcGIS.Core.Threading.Tasks.BackgroundTask.Run(() =&gt;</span><br><span class="line">    contentItem.Refresh(), ArcGIS.Core.Threading.Tasks.BackgroundProgressor.None);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取项目类别"><a href="#获取项目类别" class="headerlink" title="获取项目类别"></a>获取项目类别</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Get the ItemCategories with which an item is associated</span></span><br><span class="line">Item gdb = ItemFactory.Instance.Create(<span class="string">@&quot;E:\CurrentProject\RegionalPolling\polldata.gdb&quot;</span>);</span><br><span class="line">List&lt;ItemCategory&gt; gdbItemCategories = gdb.ItemCategories;</span><br></pre></td></tr></table></figure>

<h3 id="使用项目类别"><a href="#使用项目类别" class="headerlink" title="使用项目类别"></a>使用项目类别</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Browse items using an ItemCategory as a filter</span></span><br><span class="line">IEnumerable&lt;Item&gt; gdbContents = gdb.GetItems();</span><br><span class="line">IEnumerable&lt;Item&gt; filteredGDBContents1 = gdbContents.Where(item =&gt; item.ItemCategories.OfType&lt;ItemCategoryDataSet&gt;().Any());</span><br><span class="line">IEnumerable&lt;Item&gt; filteredGDBContents2 = <span class="keyword">new</span> ItemCategoryDataSet().Items(gdbContents);</span><br></pre></td></tr></table></figure>

<h3 id="使用模板创建项目"><a href="#使用模板创建项目" class="headerlink" title="使用模板创建项目"></a>使用模板创建项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> projectFolder = System.IO.Path.Combine(</span><br><span class="line">    System.Environment.GetFolderPath(</span><br><span class="line">        Environment.SpecialFolder.MyDocuments),</span><br><span class="line">    <span class="string">@&quot;ArcGIS\Projects&quot;</span>);</span><br><span class="line"></span><br><span class="line">CreateProjectSettings ps = <span class="keyword">new</span> CreateProjectSettings()</span><br><span class="line">&#123;</span><br><span class="line">  Name = <span class="string">&quot;MyProject&quot;</span>,</span><br><span class="line">  LocationPath = projectFolder,</span><br><span class="line">  TemplatePath = <span class="string">@&quot;C:\data\my_templates\custom_template.aptx&quot;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> project = <span class="keyword">await</span> Project.CreateAsync(ps);</span><br></pre></td></tr></table></figure>

<h3 id="选择项目容器-用于-SelectItemAsync"><a href="#选择项目容器-用于-SelectItemAsync" class="headerlink" title="选择项目容器 - 用于 SelectItemAsync"></a>选择项目容器 - 用于 SelectItemAsync</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Use Project.Current.ProjectItemContainers</span></span><br><span class="line"><span class="keyword">var</span> folderContainer = Project.Current.ProjectItemContainers.First(c =&gt; c.Path == <span class="string">&quot;FolderConnection&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> gdbContainer = Project.Current.ProjectItemContainers.First(c =&gt; c.Path == <span class="string">&quot;GDB&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> mapContainer = Project.Current.ProjectItemContainers.First(c =&gt; c.Path == <span class="string">&quot;Map&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> layoutContainer = Project.Current.ProjectItemContainers.First(c =&gt; c.Path == <span class="string">&quot;Layout&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> toolboxContainer = Project.Current.ProjectItemContainers.First(c =&gt; c.Path == <span class="string">&quot;GP&quot;</span>);</span><br><span class="line"><span class="comment">//etc.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//or...use Project.Current.GetProjectItemContainer</span></span><br><span class="line"></span><br><span class="line">folderContainer = Project.Current.GetProjectItemContainer(<span class="string">&quot;FolderConnection&quot;</span>);</span><br><span class="line">gdbContainer = Project.Current.GetProjectItemContainer(<span class="string">&quot;GDB&quot;</span>);</span><br><span class="line">mapContainer = Project.Current.GetProjectItemContainer(<span class="string">&quot;Map&quot;</span>);</span><br><span class="line">layoutContainer = Project.Current.GetProjectItemContainer(<span class="string">&quot;Layout&quot;</span>);</span><br><span class="line">toolboxContainer = Project.Current.GetProjectItemContainer(<span class="string">&quot;GP&quot;</span>);</span><br><span class="line"><span class="comment">//etc.</span></span><br></pre></td></tr></table></figure>

<h3 id="项目项：获取项或查找项"><a href="#项目项：获取项或查找项" class="headerlink" title="项目项：获取项或查找项"></a>项目项：获取项或查找项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//GetItems searches project content</span></span><br><span class="line"><span class="keyword">var</span> map = Project.Current.GetItems&lt;MapProjectItem&gt;().FirstOrDefault(m =&gt; m.Name == <span class="string">&quot;Map1&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> layout = Project.Current.GetItems&lt;LayoutProjectItem&gt;().FirstOrDefault(m =&gt; m.Name == <span class="string">&quot;Layout1&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> folders = Project.Current.GetItems&lt;FolderConnectionProjectItem&gt;();</span><br><span class="line"><span class="keyword">var</span> style = Project.Current.GetItems&lt;StyleProjectItem&gt;().FirstOrDefault(s =&gt; s.Name == <span class="string">&quot;ArcGIS 3D&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Find item uses a catalog path. The path can be to a file or dataset</span></span><br><span class="line"><span class="keyword">var</span> fcPath = <span class="string">@&quot;C:\Pro\CommunitySampleData\Interacting with Maps\Interacting with Maps.gdb\Crimes&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> pdfPath = <span class="string">@&quot;C:\Temp\Layout1.pdf&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> imgPath = <span class="string">@&quot;C:\Temp\AddinDesktop16.png&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fc = Project.Current.FindItem(fcPath);</span><br><span class="line"><span class="keyword">var</span> pdf = Project.Current.FindItem(pdfPath);</span><br><span class="line"><span class="keyword">var</span> img = Project.Current.FindItem(imgPath);</span><br></pre></td></tr></table></figure>

<h3 id="在目录窗格中选择一个项目"><a href="#在目录窗格中选择一个项目" class="headerlink" title="在目录窗格中选择一个项目"></a>在目录窗格中选择一个项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get the catalog pane</span></span><br><span class="line">ArcGIS.Desktop.Core.IProjectWindow projectWindow = Project.GetCatalogPane();</span><br><span class="line"><span class="comment">//or get the active catalog view...</span></span><br><span class="line"><span class="comment">//ArcGIS.Desktop.Core.IProjectWindow projectWindow = Project.GetActiveCatalogWindow();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//eg Find a toolbox in the project</span></span><br><span class="line"><span class="built_in">string</span> gpName = <span class="string">&quot;Interacting with Maps.tbx&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> toolbox = Project.Current.GetItems&lt;GeoprocessingProjectItem&gt;().FirstOrDefault(tbx =&gt; tbx.Name == gpName);</span><br><span class="line"><span class="comment">//Select it under Toolboxes</span></span><br><span class="line">projectWindow.SelectItemAsync(toolbox, <span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">null</span>);<span class="comment">//null selects it in the first container - optionally await</span></span><br><span class="line">                                                         <span class="comment">//Note: Project.Current.GetProjectItemContainer(&quot;GP&quot;) would get toolbox container...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//assume toolbox is also under Folders container. Select it under Folders instead of Toolboxes</span></span><br><span class="line"><span class="keyword">var</span> foldersContainer = Project.Current.ProjectItemContainers.First(c =&gt; c.Path == <span class="string">&quot;FolderConnection&quot;</span>);</span><br><span class="line"><span class="comment">//We must specify the container because Folders comes second (after Toolboxes)</span></span><br><span class="line">projectWindow.SelectItemAsync(toolbox, <span class="literal">true</span>, <span class="literal">true</span>, foldersContainer);<span class="comment">//optionally await</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Find a map and select it</span></span><br><span class="line"><span class="keyword">var</span> mapItem = Project.Current.GetItems&lt;MapProjectItem&gt;().FirstOrDefault(m =&gt; m.Name == <span class="string">&quot;Map&quot;</span>);</span><br><span class="line"><span class="comment">//Map only occurs under &quot;Maps&quot; so the container need not be specified</span></span><br><span class="line">projectWindow.SelectItemAsync(mapItem, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<h2 id="地理数据库内容"><a href="#地理数据库内容" class="headerlink" title="地理数据库内容"></a>地理数据库内容</h2><h3 id="浏览对话框中的地理数据库内容"><a href="#浏览对话框中的地理数据库内容" class="headerlink" title="浏览对话框中的地理数据库内容"></a>浏览对话框中的地理数据库内容</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> openDlg = <span class="keyword">new</span> OpenItemDialog</span><br><span class="line">&#123;</span><br><span class="line">  Title = <span class="string">&quot;Select a Feature Class&quot;</span>,</span><br><span class="line">  InitialLocation = <span class="string">@&quot;C:\Data&quot;</span>,</span><br><span class="line">  MultiSelect = <span class="literal">false</span>,</span><br><span class="line">  BrowseFilter = BrowseProjectFilter.GetFilter(ArcGIS.Desktop.Catalog.ItemFilters.GeodatabaseItems_All)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//show the browse dialog</span></span><br><span class="line"><span class="built_in">bool</span>? ok = openDlg.ShowDialog();</span><br><span class="line"><span class="keyword">if</span> (!ok.HasValue || openDlg.Items.Count() == <span class="number">0</span>)</span><br><span class="line">  <span class="keyword">return</span>;   <span class="comment">//nothing selected</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// get the item</span></span><br><span class="line">  <span class="keyword">var</span> item = openDlg.Items.First();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// see if the item has a dataset</span></span><br><span class="line">  <span class="keyword">if</span> (ItemFactory.Instance.CanGetDataset(item))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// get it</span></span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> ds = ItemFactory.Instance.GetDataset(item))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// access some properties</span></span><br><span class="line">      <span class="keyword">var</span> name = ds.GetName();</span><br><span class="line">      <span class="keyword">var</span> path = ds.GetPath();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// if it&#x27;s a featureclass</span></span><br><span class="line">      <span class="keyword">if</span> (ds <span class="keyword">is</span> ArcGIS.Core.Data.FeatureClass fc)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// create a layer </span></span><br><span class="line">        <span class="keyword">var</span> featureLayerParams = <span class="keyword">new</span> FeatureLayerCreationParams(fc)</span><br><span class="line">        &#123;</span><br><span class="line">          MapMemberIndex = <span class="number">0</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">var</span> layer = LayerFactory.Instance.CreateLayer&lt;FeatureLayer&gt;(featureLayerParams, MapView.Active.Map);</span><br><span class="line">    </span><br><span class="line">        <span class="comment">// continue</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="目录中的地理数据库内容"><a href="#目录中的地理数据库内容" class="headerlink" title="目录中的地理数据库内容"></a>目录中的地理数据库内容</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// subscribe to event</span></span><br><span class="line">ProjectWindowSelectedItemsChangedEvent.Subscribe(<span class="keyword">async</span> (ProjectWindowSelectedItemsChangedEventArgs args) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (args.IProjectWindow.SelectionCount &gt; <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// get the first selected item</span></span><br><span class="line">    <span class="keyword">var</span> selectedItem = args.IProjectWindow.SelectedItems.First();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// datasetType</span></span><br><span class="line">      <span class="keyword">var</span> dataType = ItemFactory.Instance.GetDatasetType(selectedItem);</span><br><span class="line">    </span><br><span class="line">      <span class="comment">// get the dataset Defintion</span></span><br><span class="line">      <span class="keyword">if</span> (ItemFactory.Instance.CanGetDefinition(selectedItem))</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> def = ItemFactory.Instance.GetDefinition(selectedItem))</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> (def <span class="keyword">is</span> ArcGIS.Core.Data.FeatureClassDefinition fcDef)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">var</span> oidField = fcDef.GetObjectIDField();</span><br><span class="line">            <span class="keyword">var</span> shapeField = fcDef.GetShapeField();</span><br><span class="line">            <span class="keyword">var</span> shapeType = fcDef.GetShapeType();</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (def <span class="keyword">is</span> ArcGIS.Core.Data.Parcels.ParcelFabricDefinition pfDef)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="built_in">string</span> ver = pfDef.GetSchemaVersion();</span><br><span class="line">            <span class="built_in">bool</span> enabled = pfDef.GetTopologyEnabled();</span><br><span class="line">          &#125;</span><br><span class="line">    </span><br><span class="line">          <span class="comment">// etc</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">      <span class="comment">// get the dataset</span></span><br><span class="line">      <span class="keyword">if</span> (ItemFactory.Instance.CanGetDataset(selectedItem))</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> ds = ItemFactory.Instance.GetDataset(selectedItem))</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> (ds <span class="keyword">is</span> ArcGIS.Core.Data.FeatureDataset fds)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="comment">// open featureclasses within the feature dataset</span></span><br><span class="line">            <span class="comment">// var fcPoint = fds.OpenDataset&lt;FeatureClass&gt;(&quot;Point&quot;);</span></span><br><span class="line">            <span class="comment">// var fcPolyline = fds.OpenDataset&lt;FeatureClass&gt;(&quot;Polyline&quot;);</span></span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (ds <span class="keyword">is</span> FeatureClass fc)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">var</span> name = fc.GetName() + <span class="string">&quot;_copy&quot;</span>;</span><br><span class="line">    </span><br><span class="line">            <span class="comment">// create</span></span><br><span class="line">            <span class="keyword">var</span> featureLayerParams = <span class="keyword">new</span> FeatureLayerCreationParams(fc)</span><br><span class="line">            &#123;</span><br><span class="line">              Name = name,</span><br><span class="line">              MapMemberIndex = <span class="number">0</span></span><br><span class="line">            &#125;;</span><br><span class="line">            LayerFactory.Instance.CreateLayer&lt;FeatureLayer&gt;(featureLayerParams, MapView.Active.Map);</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span> (ds <span class="keyword">is</span> Table table)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">var</span> name = table.GetName() + <span class="string">&quot;_copy&quot;</span>;</span><br><span class="line">            <span class="keyword">var</span> tableParams = <span class="keyword">new</span> StandaloneTableCreationParams(table)</span><br><span class="line">            &#123;</span><br><span class="line">              Name = name</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">// create</span></span><br><span class="line">            StandaloneTableFactory.Instance.CreateStandaloneTable(tableParams, MapView.Active.Map);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="收藏-夹"><a href="#收藏-夹" class="headerlink" title="收藏 夹"></a>收藏 夹</h2><h3 id="添加收藏夹-文件夹"><a href="#添加收藏夹-文件夹" class="headerlink" title="添加收藏夹 - 文件夹"></a>添加收藏夹 - 文件夹</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> itemFolder = ItemFactory.Instance.Create(<span class="string">@&quot;d:\data&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// is the folder item already a favorite?</span></span><br><span class="line"><span class="keyword">var</span> fav = FavoritesManager.Current.GetFavorite(itemFolder);</span><br><span class="line"><span class="keyword">if</span> (fav == <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (FavoritesManager.Current.CanAddAsFavorite(itemFolder))</span><br><span class="line">  &#123;</span><br><span class="line">    fav = FavoritesManager.Current.AddFavorite(itemFolder);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="插入收藏夹-地理数据库路径"><a href="#插入收藏夹-地理数据库路径" class="headerlink" title="插入收藏夹 - 地理数据库路径"></a>插入收藏夹 - 地理数据库路径</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> gdbPath = <span class="string">&quot;@C:\\myDataFolder\\myData.gdb&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> itemGDB = ItemFactory.Instance.Create(gdbPath);</span><br><span class="line"></span><br><span class="line"><span class="comment">// is the item already a favorite?</span></span><br><span class="line"><span class="keyword">var</span> fav = FavoritesManager.Current.GetFavorite(itemGDB);</span><br><span class="line"><span class="comment">// no; add it with IsAddedToAllNewProjects set to true</span></span><br><span class="line"><span class="keyword">if</span> (fav != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (FavoritesManager.Current.CanAddAsFavorite(itemGDB))</span><br><span class="line">    FavoritesManager.Current.InsertFavorite(itemGDB, <span class="number">1</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="添加收藏夹-设置项目项的样式"><a href="#添加收藏夹-设置项目项的样式" class="headerlink" title="添加收藏夹 - 设置项目项的样式"></a>添加收藏夹 - 设置项目项的样式</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">StyleProjectItem styleItem = Project.Current.GetItems&lt;StyleProjectItem&gt;().</span><br><span class="line">                        FirstOrDefault(style =&gt; (style.Name == <span class="string">&quot;ArcGIS 3D&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (FavoritesManager.Current.CanAddAsFavorite(styleItem))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// add to favorites with IsAddedToAllNewProjects set to false</span></span><br><span class="line">  FavoritesManager.Current.AddFavorite(styleItem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="切换标志是添加到所有新项目为收藏夹"><a href="#切换标志是添加到所有新项目为收藏夹" class="headerlink" title="切换标志是添加到所有新项目为收藏夹"></a>切换标志是添加到所有新项目为收藏夹</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> itemFolder = ItemFactory.Instance.Create(<span class="string">@&quot;d:\data&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// is the folder item already a favorite?</span></span><br><span class="line"><span class="keyword">var</span> fav = FavoritesManager.Current.GetFavorite(itemFolder);</span><br><span class="line"><span class="keyword">if</span> (fav != <span class="literal">null</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (fav.IsAddedToAllNewProjects)</span><br><span class="line">    FavoritesManager.Current.ClearIsAddedToAllNewProjects(fav.Item);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    FavoritesManager.Current.SetIsAddedToAllNewProjects(fav.Item);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取收藏夹集并迭代"><a href="#获取收藏夹集并迭代" class="headerlink" title="获取收藏夹集并迭代"></a>获取收藏夹集并迭代</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> favorites = FavoritesManager.Current.GetFavorites();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> favorite <span class="keyword">in</span> favorites)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">bool</span> isAddedToAllProjects = favorite.IsAddedToAllNewProjects;</span><br><span class="line">  <span class="comment">// retrieve the underlying item of the favorite</span></span><br><span class="line">  Item item = favorite.Item;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Item properties</span></span><br><span class="line">  <span class="keyword">var</span> itemType = item.TypeID;</span><br><span class="line">  <span class="keyword">var</span> path = item.Path;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// if it&#x27;s a folder item</span></span><br><span class="line">  <span class="keyword">if</span> (item <span class="keyword">is</span> FolderConnectionProjectItem)</span><br><span class="line">  &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// if it&#x27;s a goedatabase item</span></span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (item <span class="keyword">is</span> GDBProjectItem)</span><br><span class="line">  &#123;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// else </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="删除所有收藏夹"><a href="#删除所有收藏夹" class="headerlink" title="删除所有收藏夹"></a>删除所有收藏夹</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> favorites = FavoritesManager.Current.GetFavorites();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> favorite <span class="keyword">in</span> favorites)</span><br><span class="line">  FavoritesManager.Current.RemoveFavorite(favorite.Item);</span><br></pre></td></tr></table></figure>

<h3 id="收藏夹更改事件"><a href="#收藏夹更改事件" class="headerlink" title="收藏夹更改事件"></a>收藏夹更改事件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ArcGIS.Desktop.Core.Events.FavoritesChangedEvent.Subscribe((args) =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// favorites have changed</span></span><br><span class="line">  <span class="built_in">int</span> count = FavoritesManager.Current.GetFavorites().Count;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="元数据"><a href="#元数据" class="headerlink" title="元数据"></a>元数据</h2><h3 id="项目：获取其-IMetadata-接口"><a href="#项目：获取其-IMetadata-接口" class="headerlink" title="项目：获取其 IMetadata 接口"></a>项目：获取其 IMetadata 接口</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Item gdbItem = ItemFactory.Instance.Create(<span class="string">@&quot;C:\projectAlpha\GDBs\regionFive.gdb&quot;</span>);</span><br><span class="line">IMetadata gdbMetadataItem = gdbItem <span class="keyword">as</span> IMetadata;</span><br></pre></td></tr></table></figure>

<h3 id="项目：获取项目的元数据：获取XML"><a href="#项目：获取项目的元数据：获取XML" class="headerlink" title="项目：获取项目的元数据：获取XML"></a>项目：获取项目的元数据：获取XML</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> gdbXMLMetadataXmlAsString = <span class="built_in">string</span>.Empty;</span><br><span class="line">gdbXMLMetadataXmlAsString = <span class="keyword">await</span> QueuedTask.Run(() =&gt; gdbMetadataItem.GetXml());</span><br><span class="line"><span class="comment">//check metadata was returned</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(gdbXMLMetadataXmlAsString))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//use the metadata</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="项目：设置项目的元数据：设置XML项"><a href="#项目：设置项目的元数据：设置XML项" class="headerlink" title="项目：设置项目的元数据：设置XML项"></a>项目：设置项目的元数据：设置XML项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> xml = System.IO.File.ReadAllText(<span class="string">@&quot;E:\Data\Metadata\MetadataForFeatClass.xml&quot;</span>);</span><br><span class="line">  <span class="comment">//Will throw InvalidOperationException if the metadata cannot be changed</span></span><br><span class="line">  <span class="comment">//so check &quot;CanEdit&quot; first</span></span><br><span class="line">  <span class="keyword">if</span> (featureClassMetadataItem.CanEdit())</span><br><span class="line">    featureClassMetadataItem.SetXml(xml);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="项目：检查元数据是否可以编辑：可以编辑"><a href="#项目：检查元数据是否可以编辑：可以编辑" class="headerlink" title="项目：检查元数据是否可以编辑：可以编辑"></a>项目：检查元数据是否可以编辑：可以编辑</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bool</span> canEdit1;</span><br><span class="line"><span class="comment">//Call CanEdit before calling SetXml</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; canEdit1 = metadataItemToCheck.CanEdit());</span><br></pre></td></tr></table></figure>

<h3 id="项目：使用项目的当前属性更新元数据：同步"><a href="#项目：使用项目的当前属性更新元数据：同步" class="headerlink" title="项目：使用项目的当前属性更新元数据：同步"></a>项目：使用项目的当前属性更新元数据：同步</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> syncedMetadataXml = <span class="built_in">string</span>.Empty;</span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; syncedMetadataXml = metadataItemToSync.Synchronize());</span><br></pre></td></tr></table></figure>

<h3 id="项目：从源项目的元数据复制元数据：复制元数据从项目"><a href="#项目：从源项目的元数据复制元数据：复制元数据从项目" class="headerlink" title="项目：从源项目的元数据复制元数据：复制元数据从项目"></a>项目：从源项目的元数据复制元数据：复制元数据从项目</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Item featureClassItem = ItemFactory.Instance.Create(<span class="string">@&quot;C:\projectAlpha\GDBs\regionFive.gdb\SourceFeatureClass&quot;</span>);</span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemImport.CopyMetadataFromItem(featureClassItem));</span><br></pre></td></tr></table></figure>

<h3 id="项目：从当前项目的元数据中删除某些内容：删除元数据内容"><a href="#项目：从当前项目的元数据中删除某些内容：删除元数据内容" class="headerlink" title="项目：从当前项目的元数据中删除某些内容：删除元数据内容"></a>项目：从当前项目的元数据中删除某些内容：删除元数据内容</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Item featureClassWithMetadataItem = ItemFactory.Instance.Create(<span class="string">@&quot;C:\projectBeta\GDBs\regionFive.gdb\SourceFeatureClass&quot;</span>);</span><br><span class="line"><span class="comment">//Delete thumbnail content from item&#x27;s metadata</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; featureClassWithMetadataItem.DeleteMetadataContent(MDDeleteContentOption.esriMDDeleteThumbnail));</span><br></pre></td></tr></table></figure>

<h3 id="项目：使用导入的元数据更新元数据-输入路径可以是包含元数据的项目的路径，也可以是-XML-文件的-URI：导入元数据"><a href="#项目：使用导入的元数据更新元数据-输入路径可以是包含元数据的项目的路径，也可以是-XML-文件的-URI：导入元数据" class="headerlink" title="项目：使用导入的元数据更新元数据 - 输入路径可以是包含元数据的项目的路径，也可以是 XML 文件的 URI：导入元数据"></a>项目：使用导入的元数据更新元数据 - 输入路径可以是包含元数据的项目的路径，也可以是 XML 文件的 URI：导入元数据</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// the input path can be the path to an item with metadata, or a URI to an XML file</span></span><br><span class="line">IMetadata metadataItemImport1 = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemImport1.ImportMetadata(<span class="string">@&quot;E:\YellowStone.gdb\MyDataset\MyFeatureClass&quot;</span>, MDImportExportOption.esriCurrentMetadataStyle));</span><br></pre></td></tr></table></figure>

<h3 id="项目：使用导入的元数据更新元数据：导入元数据"><a href="#项目：使用导入的元数据更新元数据：导入元数据" class="headerlink" title="项目：使用导入的元数据更新元数据：导入元数据"></a>项目：使用导入的元数据更新元数据：导入元数据</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// the input path can be the path to an item with metadata, or a URI to an XML file</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemImport2.ImportMetadata(<span class="string">@&quot;E:\YellowStone.gdb\MyDataset\MyFeatureClass&quot;</span>, MDImportExportOption.esriCustomizedStyleSheet, <span class="string">@&quot;E:\StyleSheets\Import\MyImportStyleSheet.xslt&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="项目：导出当前选定项目的元数据：导出元数据"><a href="#项目：导出当前选定项目的元数据：导出元数据" class="headerlink" title="项目：导出当前选定项目的元数据：导出元数据"></a>项目：导出当前选定项目的元数据：导出元数据</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemExport1.ExportMetadata(<span class="string">@&quot;E:\Temp\OutputXML.xml&quot;</span>, MDImportExportOption.esriCurrentMetadataStyle, MDExportRemovalOption.esriExportExactCopy));</span><br></pre></td></tr></table></figure>

<h3 id="项目：导出当前选定项目的元数据：导出元数据-1"><a href="#项目：导出当前选定项目的元数据：导出元数据-1" class="headerlink" title="项目：导出当前选定项目的元数据：导出元数据"></a>项目：导出当前选定项目的元数据：导出元数据</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemExport2.ExportMetadata(<span class="string">@&quot;E:\Temp\OutputXML.xml&quot;</span>, MDImportExportOption.esriCustomizedStyleSheet, MDExportRemovalOption.esriExportExactCopy, <span class="string">@&quot;E:\StyleSheets\Export\MyExportStyleSheet.xslt&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="项目：将当前项目的元数据另存为-XML：将元数据另存为-XML"><a href="#项目：将当前项目的元数据另存为-XML：将元数据另存为-XML" class="headerlink" title="项目：将当前项目的元数据另存为 XML：将元数据另存为 XML"></a>项目：将当前项目的元数据另存为 XML：将元数据另存为 XML</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemToSaveAsXML.SaveMetadataAsXML(<span class="string">@&quot;E:\Temp\OutputXML.xml&quot;</span>, MDSaveAsXMLOption.esriExactCopy));</span><br></pre></td></tr></table></figure>

<h3 id="项目：将当前项目的元数据另存为-HTML：将元数据另存为HTML"><a href="#项目：将当前项目的元数据另存为-HTML：将元数据另存为HTML" class="headerlink" title="项目：将当前项目的元数据另存为 HTML：将元数据另存为HTML"></a>项目：将当前项目的元数据另存为 HTML：将元数据另存为HTML</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemToSaveAsHTML.SaveMetadataAsHTML(<span class="string">@&quot;E:\Temp\OutputHTML.htm&quot;</span>, MDSaveAsHTMLOption.esriCurrentMetadataStyle));</span><br></pre></td></tr></table></figure>

<h3 id="项目：使用自定义-XSLT-保存当前项目的元数据：保存元数据作为使用自定义-XSLT"><a href="#项目：使用自定义-XSLT-保存当前项目的元数据：保存元数据作为使用自定义-XSLT" class="headerlink" title="项目：使用自定义 XSLT 保存当前项目的元数据：保存元数据作为使用自定义 XSLT"></a>项目：使用自定义 XSLT 保存当前项目的元数据：保存元数据作为使用自定义 XSLT</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; metadataItemToSaveAsUsingCustomXSLT.SaveMetadataAsUsingCustomXSLT(<span class="string">@&quot;E:\Data\Metadata\CustomXSLT.xsl&quot;</span>, <span class="string">@&quot;E:\Temp\OutputXMLCustom.xml&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="项目：升级当前项目的元数据：升级元数据"><a href="#项目：升级当前项目的元数据：升级元数据" class="headerlink" title="项目：升级当前项目的元数据：升级元数据"></a>项目：升级当前项目的元数据：升级元数据</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fgdcItem = ItemFactory.Instance.Create(<span class="string">@&quot;C:\projectAlpha\GDBs\testData.gdb&quot;</span>);</span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt; fgdcItem.UpgradeMetadata(MDUpgradeOption.esriUpgradeFgdcCsdgm));</span><br></pre></td></tr></table></figure>

<h2 id="项目单位"><a href="#项目单位" class="headerlink" title="项目单位"></a>项目单位</h2><h3 id="获取所有可用单位格式的完整列表"><a href="#获取所有可用单位格式的完整列表" class="headerlink" title="获取所有可用单位格式的完整列表"></a>获取所有可用单位格式的完整列表</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> unit_formats = Enum.GetValues(<span class="keyword">typeof</span>(UnitFormatType))</span><br><span class="line">                      .OfType&lt;UnitFormatType&gt;().ToList();</span><br><span class="line">System.Diagnostics.Debug.WriteLine(<span class="string">&quot;All available units\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> unit_format <span class="keyword">in</span> unit_formats)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> units = DisplayUnitFormats.Instance.GetPredefinedProjectUnitFormats(unit_format);</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(unit_format.ToString());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> display_unit_format <span class="keyword">in</span> units)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> line = <span class="string">$&quot;<span class="subst">&#123;display_unit_format.DisplayName&#125;</span>, <span class="subst">&#123;display_unit_format.UnitCode&#125;</span>&quot;</span>;</span><br><span class="line">    System.Diagnostics.Debug.WriteLine(line);</span><br><span class="line">  &#125;</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取当前项目的单位格式列表"><a href="#获取当前项目的单位格式列表" class="headerlink" title="获取当前项目的单位格式列表"></a>获取当前项目的单位格式列表</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> unit_formats = Enum.GetValues(<span class="keyword">typeof</span>(UnitFormatType))</span><br><span class="line">                      .OfType&lt;UnitFormatType&gt;().ToList();</span><br><span class="line">System.Diagnostics.Debug.WriteLine(<span class="string">&quot;Project units\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> unit_format <span class="keyword">in</span> unit_formats)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> units = DisplayUnitFormats.Instance.GetProjectUnitFormats(unit_format);</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(unit_format.ToString());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> display_unit_format <span class="keyword">in</span> units)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> line = <span class="string">$&quot;<span class="subst">&#123;display_unit_format.DisplayName&#125;</span>, <span class="subst">&#123;display_unit_format.UnitCode&#125;</span>&quot;</span>;</span><br><span class="line">    System.Diagnostics.Debug.WriteLine(line);</span><br><span class="line">  &#125;</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="获取当前项目的特定单位格式列表"><a href="#获取当前项目的特定单位格式列表" class="headerlink" title="获取当前项目的特定单位格式列表"></a>获取当前项目的特定单位格式列表</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//UnitFormatType.Angular, UnitFormatType.Area, UnitFormatType.Distance, </span></span><br><span class="line"><span class="comment">//UnitFormatType.Direction, UnitFormatType.Location, UnitFormatType.Page</span></span><br><span class="line"><span class="comment">//UnitFormatType.Symbol2D, UnitFormatType.Symbol3D</span></span><br><span class="line"><span class="keyword">var</span> units = DisplayUnitFormats.Instance.GetProjectUnitFormats(UnitFormatType.Distance);</span><br></pre></td></tr></table></figure>

<h3 id="获取当前项目的默认格式列表"><a href="#获取当前项目的默认格式列表" class="headerlink" title="获取当前项目的默认格式列表"></a>获取当前项目的默认格式列表</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> unit_formats = Enum.GetValues(<span class="keyword">typeof</span>(UnitFormatType))</span><br><span class="line">                      .OfType&lt;UnitFormatType&gt;().ToList();</span><br><span class="line">System.Diagnostics.Debug.WriteLine(<span class="string">&quot;Default project units\r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> unit_format <span class="keyword">in</span> unit_formats)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> default_unit = DisplayUnitFormats.Instance.GetDefaultProjectUnitFormat(unit_format);</span><br><span class="line">  <span class="keyword">var</span> line = <span class="string">$&quot;<span class="subst">&#123;unit_format.ToString()&#125;</span>: <span class="subst">&#123;default_unit.DisplayName&#125;</span>, <span class="subst">&#123;default_unit.UnitCode&#125;</span>&quot;</span>;</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(line);</span><br><span class="line">&#125;</span><br><span class="line">System.Diagnostics.Debug.WriteLine(<span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="获取当前项目的特定默认单位格式"><a href="#获取当前项目的特定默认单位格式" class="headerlink" title="获取当前项目的特定默认单位格式"></a>获取当前项目的特定默认单位格式</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//UnitFormatType.Angular, UnitFormatType.Area, UnitFormatType.Distance, </span></span><br><span class="line"><span class="comment">//UnitFormatType.Direction, UnitFormatType.Location, UnitFormatType.Page</span></span><br><span class="line"><span class="comment">//UnitFormatType.Symbol2D, UnitFormatType.Symbol3D</span></span><br><span class="line"><span class="keyword">var</span> default_unit = DisplayUnitFormats.Instance.GetDefaultProjectUnitFormat(</span><br><span class="line">                                                     UnitFormatType.Distance);</span><br></pre></td></tr></table></figure>

<h3 id="为当前项目设置特定的单位格式列表"><a href="#为当前项目设置特定的单位格式列表" class="headerlink" title="为当前项目设置特定的单位格式列表"></a>为当前项目设置特定的单位格式列表</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//UnitFormatType.Angular, UnitFormatType.Area, UnitFormatType.Distance, </span></span><br><span class="line"><span class="comment">//UnitFormatType.Direction, UnitFormatType.Location</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Get the full list of all available location units</span></span><br><span class="line"><span class="keyword">var</span> all_units = DisplayUnitFormats.Instance.GetPredefinedProjectUnitFormats(</span><br><span class="line">                                                      UnitFormatType.Location);</span><br><span class="line"><span class="comment">//keep units with an even factory code</span></span><br><span class="line"><span class="keyword">var</span> list_units = all_units.Where(du =&gt; du.UnitCode % <span class="number">2</span> == <span class="number">0</span>).ToList();</span><br><span class="line"></span><br><span class="line"><span class="comment">//set them as the new location unit collection. A new default is not being specified...</span></span><br><span class="line">DisplayUnitFormats.Instance.SetProjectUnitFormats(list_units);</span><br><span class="line"></span><br><span class="line"><span class="comment">//set them as the new location unit collection along with a new default</span></span><br><span class="line">DisplayUnitFormats.Instance.SetProjectUnitFormats(</span><br><span class="line">                                        list_units, list_units.First());</span><br><span class="line"></span><br><span class="line"><span class="comment">//Note: UnitFormatType.Page, UnitFormatType.Symbol2D, UnitFormatType.Symbol3D</span></span><br><span class="line"><span class="comment">//cannot be set.</span></span><br></pre></td></tr></table></figure>

<h3 id="设置项目单位格式的默认值"><a href="#设置项目单位格式的默认值" class="headerlink" title="设置项目单位格式的默认值"></a>设置项目单位格式的默认值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Must be on the QueuedTask.Run()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> unit_formats = Enum.GetValues(<span class="keyword">typeof</span>(UnitFormatType)).OfType&lt;UnitFormatType&gt;().ToList();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> unit_type <span class="keyword">in</span> unit_formats)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> current_default = DisplayUnitFormats.Instance.GetDefaultProjectUnitFormat(unit_type);</span><br><span class="line">  <span class="comment">//Arbitrarily pick the last unit in each unit format list</span></span><br><span class="line">  <span class="keyword">var</span> replacement = DisplayUnitFormats.Instance.GetProjectUnitFormats(unit_type).Last();</span><br><span class="line">  DisplayUnitFormats.Instance.SetDefaultProjectUnitFormat(replacement);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> line = <span class="string">$&quot;<span class="subst">&#123;current_default.DisplayName&#125;</span>, <span class="subst">&#123;current_default.UnitName&#125;</span>, <span class="subst">&#123;current_default.UnitCode&#125;</span>&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> line2 = <span class="string">$&quot;<span class="subst">&#123;replacement.DisplayName&#125;</span>, <span class="subst">&#123;replacement.UnitName&#125;</span>, <span class="subst">&#123;replacement.UnitCode&#125;</span>&quot;</span>;</span><br><span class="line"></span><br><span class="line">  System.Diagnostics.Debug.WriteLine(<span class="string">$&quot;Format: <span class="subst">&#123;unit_type.ToString()&#125;</span>&quot;</span>);</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(<span class="string">$&quot; Current default: <span class="subst">&#123;line&#125;</span>&quot;</span>);</span><br><span class="line">  System.Diagnostics.Debug.WriteLine(<span class="string">$&quot; Replacement default: <span class="subst">&#123;line2&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="更新项目的单位格式"><a href="#更新项目的单位格式" class="headerlink" title="更新项目的单位格式"></a>更新项目的单位格式</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UnitFormatType.Angular, UnitFormatType.Area, UnitFormatType.Distance, </span></span><br><span class="line"><span class="comment">//UnitFormatType.Direction, UnitFormatType.Location</span></span><br><span class="line"><span class="keyword">var</span> angle_units = DisplayUnitFormats.Instance.GetProjectUnitFormats(UnitFormatType.Angular);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Edit the display name of each unit - append the abbreviation</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> unit <span class="keyword">in</span> angle_units)</span><br><span class="line">&#123;</span><br><span class="line">  unit.DisplayName = <span class="string">$&quot;<span class="subst">&#123;unit.DisplayName&#125;</span> (<span class="subst">&#123;unit.Abbreviation&#125;</span>)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//apply the changes to the units and set the default to be the first entry</span></span><br><span class="line">DisplayUnitFormats.Instance.SetProjectUnitFormats(angle_units, angle_units.First());</span><br><span class="line"></span><br><span class="line"><span class="comment">//The project must be saved to persist the changes...</span></span><br></pre></td></tr></table></figure>

<h2 id="应用选项"><a href="#应用选项" class="headerlink" title="应用选项"></a>应用选项</h2><h3 id="获取常规选项"><a href="#获取常规选项" class="headerlink" title="获取常规选项"></a>获取常规选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> startMode = ApplicationOptions.GeneralOptions.StartupOption;</span><br><span class="line"><span class="keyword">var</span> aprx_path = ApplicationOptions.GeneralOptions.StartupProjectPath;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hf_option = ApplicationOptions.GeneralOptions.HomeFolderOption;</span><br><span class="line"><span class="keyword">var</span> folder = ApplicationOptions.GeneralOptions.CustomHomeFolder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> gdb_option = ApplicationOptions.GeneralOptions.DefaultGeodatabaseOption;</span><br><span class="line"><span class="keyword">var</span> def_gdb = ApplicationOptions.GeneralOptions.CustomDefaultGeodatabase;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> tbx_option = ApplicationOptions.GeneralOptions.DefaultToolboxOption;</span><br><span class="line"><span class="keyword">var</span> def_tbx = ApplicationOptions.GeneralOptions.CustomDefaultToolbox;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> create_in_folder = ApplicationOptions.GeneralOptions.ProjectCreateInFolder;</span><br></pre></td></tr></table></figure>

<h3 id="将“常规选项”设置为使用自定义设置"><a href="#将“常规选项”设置为使用自定义设置" class="headerlink" title="将“常规选项”设置为使用自定义设置"></a>将“常规选项”设置为使用自定义设置</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Set the application to use a custom project, home folder, gdb, and toolbox</span></span><br><span class="line"><span class="comment">//In each case, the custom _path_ must be set _first_ before </span></span><br><span class="line"><span class="comment">//setting the &quot;option&quot;. This ensures the application remains </span></span><br><span class="line"><span class="comment">//in a consistent state. This is the same behavior as on the Pro UI.</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.GeneralOptions.StartupProjectPath))</span><br><span class="line">  ApplicationOptions.GeneralOptions.StartupProjectPath = <span class="string">@&quot;D:\data\usa.aprx&quot;</span>;<span class="comment">//custom project path first</span></span><br><span class="line">ApplicationOptions.GeneralOptions.StartupOption = StartProjectMode.WithDefaultProject;<span class="comment">//option to use it second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.GeneralOptions.CustomHomeFolder))</span><br><span class="line">  ApplicationOptions.GeneralOptions.CustomHomeFolder = <span class="string">@&quot;D:\home_folder&quot;</span>;<span class="comment">//custom home folder first</span></span><br><span class="line">ApplicationOptions.GeneralOptions.HomeFolderOption = OptionSetting.UseCustom;<span class="comment">//option to use it second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.GeneralOptions.CustomDefaultGeodatabase))</span><br><span class="line">  ApplicationOptions.GeneralOptions.CustomDefaultGeodatabase = <span class="string">@&quot;D:\data\usa.gdb&quot;</span>;<span class="comment">//custom gdb path first</span></span><br><span class="line">ApplicationOptions.GeneralOptions.DefaultGeodatabaseOption = OptionSetting.UseCustom;<span class="comment">//option to use it second</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.GeneralOptions.CustomDefaultToolbox))</span><br><span class="line">  ApplicationOptions.GeneralOptions.CustomDefaultToolbox = <span class="string">@&quot;D:\data\usa.tbx&quot;</span>;<span class="comment">//custom toolbox path first</span></span><br><span class="line">ApplicationOptions.GeneralOptions.DefaultToolboxOption = OptionSetting.UseCustom;<span class="comment">//option to use it second</span></span><br></pre></td></tr></table></figure>

<h3 id="设置常规选项以使用默认值"><a href="#设置常规选项以使用默认值" class="headerlink" title="设置常规选项以使用默认值"></a>设置常规选项以使用默认值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Default options can be set regardless of the value of the &quot;companion&quot;</span></span><br><span class="line"><span class="comment">//path (to a project, folder, gdb, toolbox, etc.). The path value is ignored if</span></span><br><span class="line"><span class="comment">//the option setting does not use it. This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.GeneralOptions.StartupOption = StartProjectMode.ShowStartPage;</span><br><span class="line">ApplicationOptions.GeneralOptions.HomeFolderOption = OptionSetting.UseDefault;</span><br><span class="line">ApplicationOptions.GeneralOptions.DefaultGeodatabaseOption = OptionSetting.UseDefault;</span><br><span class="line">ApplicationOptions.GeneralOptions.DefaultToolboxOption = OptionSetting.UseDefault;<span class="comment">//set default option first</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//path values can (optionally) be set (back) to null if their </span></span><br><span class="line"><span class="comment">//&quot;companion&quot; option setting is the default option.</span></span><br><span class="line"><span class="keyword">if</span> (ApplicationOptions.GeneralOptions.StartupOption != StartProjectMode.WithDefaultProject)</span><br><span class="line">  ApplicationOptions.GeneralOptions.StartupProjectPath = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (ApplicationOptions.GeneralOptions.HomeFolderOption == OptionSetting.UseDefault)</span><br><span class="line">  ApplicationOptions.GeneralOptions.CustomHomeFolder = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (ApplicationOptions.GeneralOptions.DefaultGeodatabaseOption == OptionSetting.UseDefault)</span><br><span class="line">  ApplicationOptions.GeneralOptions.CustomDefaultGeodatabase = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (ApplicationOptions.GeneralOptions.DefaultToolboxOption == OptionSetting.UseDefault)</span><br><span class="line">  ApplicationOptions.GeneralOptions.CustomDefaultToolbox = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>

<h3 id="获取下载选项"><a href="#获取下载选项" class="headerlink" title="获取下载选项"></a>获取下载选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> staging = ApplicationOptions.DownloadOptions.StagingLocation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ppkx_loc = ApplicationOptions.DownloadOptions.UnpackPPKXLocation;</span><br><span class="line"><span class="keyword">var</span> ask_ppkx_loc = ApplicationOptions.DownloadOptions.AskForUnpackPPKXLocation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> other_loc = ApplicationOptions.DownloadOptions.UnpackOtherLocation;</span><br><span class="line"><span class="keyword">var</span> ask_other_loc = ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation;</span><br><span class="line"><span class="keyword">var</span> use_proj_folder = ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> offline_loc = ApplicationOptions.DownloadOptions.OfflineMapsLocation;</span><br><span class="line"><span class="keyword">var</span> ask_offline_loc = ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation;</span><br><span class="line"><span class="keyword">var</span> use_proj_folder_offline = ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation;</span><br></pre></td></tr></table></figure>

<h3 id="设置共享和发布的暂存位置"><a href="#设置共享和发布的暂存位置" class="headerlink" title="设置共享和发布的暂存位置"></a>设置共享和发布的暂存位置</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ApplicationOptions.DownloadOptions.StagingLocation = <span class="string">@&quot;D:\data\staging&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="设置-PPKX-的下载选项"><a href="#设置-PPKX-的下载选项" class="headerlink" title="设置 PPKX 的下载选项"></a>设置 PPKX 的下载选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Options are mutually exclusive.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Setting ApplicationOptions.DownloadOptions.AskForUnpackPPKXLocation = true</span></span><br><span class="line"><span class="comment">//superseeds any value in ApplicationOptions.DownloadOptions.UnpackPPKXLocation</span></span><br><span class="line"><span class="comment">//and will prompt the user on an unpack. The value of </span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.UnpackPPKXLocation will be unaffected</span></span><br><span class="line"><span class="comment">//and is ignored. This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.AskForUnpackPPKXLocation = <span class="literal">true</span>;<span class="comment">//override location</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//The default location is typically &lt;My Documents&gt;\ArcGIS\Packages</span></span><br><span class="line"><span class="comment">//Setting ApplicationOptions.DownloadOptions.UnpackPPKXLocation to any</span></span><br><span class="line"><span class="comment">//location overrides ApplicationOptions.DownloadOptions.AskForUnpackPPKXLocation</span></span><br><span class="line"><span class="comment">//and sets it to false. This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.UnpackPPKXLocation = <span class="string">@&quot;D:\data\for_ppkx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Or, if ApplicationOptions.DownloadOptions.UnpackPPKXLocation already</span></span><br><span class="line"><span class="comment">//contains a valid path, set ApplicationOptions.DownloadOptions.AskForUnpackPPKXLocation</span></span><br><span class="line"><span class="comment">//explicitly to false to use the UnpackPPKXLocation</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.DownloadOptions.UnpackPPKXLocation))</span><br><span class="line">  ApplicationOptions.DownloadOptions.AskForUnpackPPKXLocation = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<h3 id="设置解压缩的下载选项其他"><a href="#设置解压缩的下载选项其他" class="headerlink" title="设置解压缩的下载选项其他"></a>设置解压缩的下载选项其他</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UnpackOther settings control unpacking of anything _other than_</span></span><br><span class="line"><span class="comment">//a ppkx or aptx. Options are mutually exclusive.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Set ApplicationOptions.DownloadOptions.UnpackOtherLocation explicitly to</span></span><br><span class="line"><span class="comment">//toggle ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation and</span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation to false</span></span><br><span class="line"><span class="comment">//Note: default is typically &lt;My Documents&gt;\ArcGIS\Packages, _not_ null.</span></span><br><span class="line"><span class="comment">//This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.UnpackOtherLocation = <span class="string">@&quot;D:\data\for_other&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//or...to use a location already stored in UnpackOtherLocation as the</span></span><br><span class="line"><span class="comment">//default without changing it, </span></span><br><span class="line"><span class="comment">//set ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation and</span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation to false</span></span><br><span class="line"><span class="comment">//explicitly. This is the same behavior as on the Pro UI.</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.DownloadOptions.UnpackOtherLocation))</span><br><span class="line">&#123;</span><br><span class="line">  ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation = <span class="literal">false</span>;</span><br><span class="line">  ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Setting ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation to</span></span><br><span class="line"><span class="comment">//true overrides any UnpackOtherLocation value and sets </span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation to false.</span></span><br><span class="line"><span class="comment">//This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Setting ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation to</span></span><br><span class="line"><span class="comment">//true overrides any UnpackOtherLocation value and sets </span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.AskForUnpackOtherLocation to false.</span></span><br><span class="line"><span class="comment">//This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.UnpackOtherToProjectLocation = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<h3 id="设置离线地图的下载选项"><a href="#设置离线地图的下载选项" class="headerlink" title="设置离线地图的下载选项"></a>设置离线地图的下载选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//OfflineMaps settings control where map content that is taken</span></span><br><span class="line"><span class="comment">//offline is copied to on the local machine. Options are mutually exclusive.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Set ApplicationOptions.DownloadOptions.OfflineMapsLocation explicitly to</span></span><br><span class="line"><span class="comment">//toggle ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation and</span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation to false</span></span><br><span class="line"><span class="comment">//Note: default is typically &lt;My Documents&gt;\ArcGIS\OfflineMaps, _not_ null.</span></span><br><span class="line"><span class="comment">//This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.OfflineMapsLocation = <span class="string">@&quot;D:\data\for_offline&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//or...to use a location already stored in OfflineMapsLocation as the</span></span><br><span class="line"><span class="comment">//default without changing it, </span></span><br><span class="line"><span class="comment">//set ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation and</span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation to false</span></span><br><span class="line"><span class="comment">//explicitly.</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrEmpty(ApplicationOptions.DownloadOptions.OfflineMapsLocation))</span><br><span class="line">&#123;</span><br><span class="line">  ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation = <span class="literal">false</span>;</span><br><span class="line">  ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Setting ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation to</span></span><br><span class="line"><span class="comment">//true overrides any OfflineMapsLocation value and sets </span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation to false.</span></span><br><span class="line"><span class="comment">//This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Setting ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation to</span></span><br><span class="line"><span class="comment">//true overrides any OfflineMapsLocation value and sets </span></span><br><span class="line"><span class="comment">//ApplicationOptions.DownloadOptions.AskForOfflineMapsLocation to false.</span></span><br><span class="line"><span class="comment">//This is the same behavior as on the Pro UI.</span></span><br><span class="line">ApplicationOptions.DownloadOptions.OfflineMapsToProjectLocation = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>&#96;&#96;</p>
<h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1361151272@qq.com">shaozhy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://shaoshao.net.cn/2022/12/28/20221228134215000/">https://shaoshao.net.cn/2022/12/28/20221228134215000/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://shaoshao.net.cn" target="_blank">WineMonk</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/discover/tags/CSharp/">CSharp</a><a class="post-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></div><div class="post_share"><div class="social-share" data-image="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/28/20221228134536000/"><img class="prev-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ArcGIS Pro SDK 核心主机</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/28/20221228133712000/"><img class="next-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_04.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ArcGIS Pro SDK 框架</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/12/28/20221228133712000/" title="ArcGIS Pro SDK 框架"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_04.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 框架</div></div></a></div><div><a href="/2022/12/28/20221228134536000/" title="ArcGIS Pro SDK 核心主机"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 核心主机</div></div></a></div><div><a href="/2022/12/28/20221228134946000/" title="ArcGIS Pro SDK 编辑"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 编辑</div></div></a></div><div><a href="/2022/12/28/20221228135207000/" title="ArcGIS Pro SDK 地理数据库"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理数据库</div></div></a></div><div><a href="/2022/12/28/20221228135620000/" title="ArcGIS Pro SDK 地理处理"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理处理</div></div></a></div><div><a href="/2022/12/28/20221228135824000/" title="ArcGIS Pro SDK 图形图层"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_11.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 图形图层</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E5%AE%B9"><span class="toc-number">1.</span> <span class="toc-text">内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%A9%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.1.</span> <span class="toc-text">创建一个空项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%85%B7%E6%9C%89%E6%8C%87%E5%AE%9A%E5%90%8D%E7%A7%B0%E7%9A%84%E6%96%B0%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.2.</span> <span class="toc-text">创建具有指定名称的新项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Pro-%E7%9A%84%E9%BB%98%E8%AE%A4%E8%AE%BE%E7%BD%AE%E5%88%9B%E5%BB%BA%E6%96%B0%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.3.</span> <span class="toc-text">使用 Pro 的默认设置创建新项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.4.</span> <span class="toc-text">使用自定义模板文件新建项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-ArcGIS-Pro-%E6%8F%90%E4%BE%9B%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%88%9B%E5%BB%BA%E5%B7%A5%E7%A8%8B"><span class="toc-number">1.1.5.</span> <span class="toc-text">使用 ArcGIS Pro 提供的模板创建工程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E7%8E%B0%E6%9C%89%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.6.</span> <span class="toc-text">打开现有项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.7.</span> <span class="toc-text">获取当前项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">1.1.8.</span> <span class="toc-text">获取当前项目的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E7%9A%84%E9%BB%98%E8%AE%A4-gdb-%E8%B7%AF%E5%BE%84"><span class="toc-number">1.1.9.</span> <span class="toc-text">获取项目的默认 gdb 路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.10.</span> <span class="toc-text">保存项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E6%98%AF%E5%90%A6%E9%9C%80%E8%A6%81%E4%BF%9D%E5%AD%98%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.11.</span> <span class="toc-text">检查是否需要保存项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A6%E5%AD%98%E4%B8%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.12.</span> <span class="toc-text">另存为项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.1.13.</span> <span class="toc-text">关闭项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%90%91%E5%B7%A5%E7%A8%8B%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%9C%B0%E5%9B%BE"><span class="toc-number">1.1.14.</span> <span class="toc-text">如何向工程添加新地图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%A1%B9"><span class="toc-number">1.2.</span> <span class="toc-text">项目项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%9E%E6%8E%A5%E9%A1%B9%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.2.1.</span> <span class="toc-text">将文件夹连接项添加到当前项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E9%A1%B9%E7%9B%AE%E9%A1%B9"><span class="toc-number">1.2.2.</span> <span class="toc-text">获取所有项目项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%89%80%E6%9C%89%E2%80%9CMapProjectItems%E2%80%9D"><span class="toc-number">1.2.3.</span> <span class="toc-text">获取项目的所有“MapProjectItems”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E7%9A%84%E2%80%9CMapProjectItem%E2%80%9D"><span class="toc-number">1.2.4.</span> <span class="toc-text">获取特定的“MapProjectItem”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E2%80%9C%E6%A0%B7%E5%BC%8F%E9%A1%B9%E7%9B%AE%E9%A1%B9%E2%80%9D"><span class="toc-number">1.2.5.</span> <span class="toc-text">获取所有“样式项目项”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E7%9A%84%E2%80%9C%E6%A0%B7%E5%BC%8F%E9%A1%B9%E7%9B%AE%E9%A1%B9%E2%80%9D"><span class="toc-number">1.2.6.</span> <span class="toc-text">获取特定的“样式项目项”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E2%80%9C%E6%94%B6%E8%97%8F%E5%A4%B9%E2%80%9D%E6%A0%B7%E5%BC%8F%E9%A1%B9%E7%9B%AE%E9%A1%B9"><span class="toc-number">1.2.7.</span> <span class="toc-text">获取“收藏夹”样式项目项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E2%80%9CGDBProjectItems%E2%80%9D"><span class="toc-number">1.2.8.</span> <span class="toc-text">获取所有“GDBProjectItems”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E7%9A%84%E2%80%9CGDBProjectItem%E2%80%9D"><span class="toc-number">1.2.9.</span> <span class="toc-text">获取特定的“GDBProjectItem”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E2%80%9C%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9E%E6%8E%A5%E9%A1%B9%E7%9B%AE%E9%A1%B9%E2%80%9D"><span class="toc-number">1.2.10.</span> <span class="toc-text">获取所有“服务器连接项目项”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E7%9A%84%E2%80%9C%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9E%E6%8E%A5%E9%A1%B9%E7%9B%AE%E9%A1%B9%E2%80%9D"><span class="toc-number">1.2.11.</span> <span class="toc-text">获取特定的“服务器连接项目项”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.12.</span> <span class="toc-text">获取项目中的所有文件夹连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.13.</span> <span class="toc-text">获取特定文件夹连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E7%89%B9%E5%AE%9A%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.2.14.</span> <span class="toc-text">删除特定文件夹连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E7%9A%84%E2%80%9C%E5%B8%83%E5%B1%80%E9%A1%B9%E7%9B%AE%E9%A1%B9%E2%80%9D"><span class="toc-number">1.2.15.</span> <span class="toc-text">获取特定的“布局项目项”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%B8%83%E5%B1%80"><span class="toc-number">1.2.16.</span> <span class="toc-text">获取项目中的所有布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%89%B9%E5%AE%9A%E7%9A%84%E2%80%9C%E5%9C%B0%E7%90%86%E5%A4%84%E7%90%86%E9%A1%B9%E7%9B%AE%E9%A1%B9%E2%80%9D"><span class="toc-number">1.2.17.</span> <span class="toc-text">获取特定的“地理处理项目项”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%B7%A5%E7%A8%8B%E4%B8%AD%E7%9A%84%E6%89%80%E6%9C%89%E5%9C%B0%E7%90%86%E5%A4%84%E7%90%86%E5%B7%A5%E7%A8%8B%E9%A1%B9"><span class="toc-number">1.2.18.</span> <span class="toc-text">获取工程中的所有地理处理工程项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%90%9C%E7%B4%A2%E7%89%B9%E5%AE%9A%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.2.19.</span> <span class="toc-text">在项目中搜索特定项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%BB%98%E8%AE%A4%E9%A1%B9%E7%9B%AE%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">1.2.20.</span> <span class="toc-text">获取默认项目文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%B7%E6%96%B0%E6%96%87%E4%BB%B6%E5%A4%B9%E8%BF%9E%E6%8E%A5%E9%A1%B9%E7%9A%84%E5%AD%90%E9%A1%B9"><span class="toc-number">1.2.21.</span> <span class="toc-text">刷新文件夹连接项的子项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E7%B1%BB%E5%88%AB"><span class="toc-number">1.2.22.</span> <span class="toc-text">获取项目类别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%A1%B9%E7%9B%AE%E7%B1%BB%E5%88%AB"><span class="toc-number">1.2.23.</span> <span class="toc-text">使用项目类别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%A8%A1%E6%9D%BF%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.2.24.</span> <span class="toc-text">使用模板创建项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E9%A1%B9%E7%9B%AE%E5%AE%B9%E5%99%A8-%E7%94%A8%E4%BA%8E-SelectItemAsync"><span class="toc-number">1.2.25.</span> <span class="toc-text">选择项目容器 - 用于 SelectItemAsync</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%A1%B9%EF%BC%9A%E8%8E%B7%E5%8F%96%E9%A1%B9%E6%88%96%E6%9F%A5%E6%89%BE%E9%A1%B9"><span class="toc-number">1.2.26.</span> <span class="toc-text">项目项：获取项或查找项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E7%9B%AE%E5%BD%95%E7%AA%97%E6%A0%BC%E4%B8%AD%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.2.27.</span> <span class="toc-text">在目录窗格中选择一个项目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%85%E5%AE%B9"><span class="toc-number">1.3.</span> <span class="toc-text">地理数据库内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%AF%B9%E8%AF%9D%E6%A1%86%E4%B8%AD%E7%9A%84%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%85%E5%AE%B9"><span class="toc-number">1.3.1.</span> <span class="toc-text">浏览对话框中的地理数据库内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E4%B8%AD%E7%9A%84%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%85%E5%AE%B9"><span class="toc-number">1.3.2.</span> <span class="toc-text">目录中的地理数据库内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B6%E8%97%8F-%E5%A4%B9"><span class="toc-number">1.4.</span> <span class="toc-text">收藏 夹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%94%B6%E8%97%8F%E5%A4%B9-%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="toc-number">1.4.1.</span> <span class="toc-text">添加收藏夹 - 文件夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%94%B6%E8%97%8F%E5%A4%B9-%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE%E5%BA%93%E8%B7%AF%E5%BE%84"><span class="toc-number">1.4.2.</span> <span class="toc-text">插入收藏夹 - 地理数据库路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%94%B6%E8%97%8F%E5%A4%B9-%E8%AE%BE%E7%BD%AE%E9%A1%B9%E7%9B%AE%E9%A1%B9%E7%9A%84%E6%A0%B7%E5%BC%8F"><span class="toc-number">1.4.3.</span> <span class="toc-text">添加收藏夹 - 设置项目项的样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E6%8D%A2%E6%A0%87%E5%BF%97%E6%98%AF%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%89%80%E6%9C%89%E6%96%B0%E9%A1%B9%E7%9B%AE%E4%B8%BA%E6%94%B6%E8%97%8F%E5%A4%B9"><span class="toc-number">1.4.4.</span> <span class="toc-text">切换标志是添加到所有新项目为收藏夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%94%B6%E8%97%8F%E5%A4%B9%E9%9B%86%E5%B9%B6%E8%BF%AD%E4%BB%A3"><span class="toc-number">1.4.5.</span> <span class="toc-text">获取收藏夹集并迭代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E6%89%80%E6%9C%89%E6%94%B6%E8%97%8F%E5%A4%B9"><span class="toc-number">1.4.6.</span> <span class="toc-text">删除所有收藏夹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E8%97%8F%E5%A4%B9%E6%9B%B4%E6%94%B9%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.7.</span> <span class="toc-text">收藏夹更改事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.</span> <span class="toc-text">元数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%8E%B7%E5%8F%96%E5%85%B6-IMetadata-%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.5.1.</span> <span class="toc-text">项目：获取其 IMetadata 接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%8E%B7%E5%8F%96%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E8%8E%B7%E5%8F%96XML"><span class="toc-number">1.5.2.</span> <span class="toc-text">项目：获取项目的元数据：获取XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E8%AE%BE%E7%BD%AE%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E8%AE%BE%E7%BD%AEXML%E9%A1%B9"><span class="toc-number">1.5.3.</span> <span class="toc-text">项目：设置项目的元数据：设置XML项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E6%A3%80%E6%9F%A5%E5%85%83%E6%95%B0%E6%8D%AE%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E7%BC%96%E8%BE%91%EF%BC%9A%E5%8F%AF%E4%BB%A5%E7%BC%96%E8%BE%91"><span class="toc-number">1.5.4.</span> <span class="toc-text">项目：检查元数据是否可以编辑：可以编辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E4%BD%BF%E7%94%A8%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%BD%93%E5%89%8D%E5%B1%9E%E6%80%A7%E6%9B%B4%E6%96%B0%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%90%8C%E6%AD%A5"><span class="toc-number">1.5.5.</span> <span class="toc-text">项目：使用项目的当前属性更新元数据：同步</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E4%BB%8E%E6%BA%90%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E5%A4%8D%E5%88%B6%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%A4%8D%E5%88%B6%E5%85%83%E6%95%B0%E6%8D%AE%E4%BB%8E%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.5.6.</span> <span class="toc-text">项目：从源项目的元数据复制元数据：复制元数据从项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E4%BB%8E%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E4%B8%AD%E5%88%A0%E9%99%A4%E6%9F%90%E4%BA%9B%E5%86%85%E5%AE%B9%EF%BC%9A%E5%88%A0%E9%99%A4%E5%85%83%E6%95%B0%E6%8D%AE%E5%86%85%E5%AE%B9"><span class="toc-number">1.5.7.</span> <span class="toc-text">项目：从当前项目的元数据中删除某些内容：删除元数据内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%AF%BC%E5%85%A5%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E5%85%83%E6%95%B0%E6%8D%AE-%E8%BE%93%E5%85%A5%E8%B7%AF%E5%BE%84%E5%8F%AF%E4%BB%A5%E6%98%AF%E5%8C%85%E5%90%AB%E5%85%83%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%B7%AF%E5%BE%84%EF%BC%8C%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%98%AF-XML-%E6%96%87%E4%BB%B6%E7%9A%84-URI%EF%BC%9A%E5%AF%BC%E5%85%A5%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.8.</span> <span class="toc-text">项目：使用导入的元数据更新元数据 - 输入路径可以是包含元数据的项目的路径，也可以是 XML 文件的 URI：导入元数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%AF%BC%E5%85%A5%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%AF%BC%E5%85%A5%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.9.</span> <span class="toc-text">项目：使用导入的元数据更新元数据：导入元数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%BD%93%E5%89%8D%E9%80%89%E5%AE%9A%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.10.</span> <span class="toc-text">项目：导出当前选定项目的元数据：导出元数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%BD%93%E5%89%8D%E9%80%89%E5%AE%9A%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%AF%BC%E5%87%BA%E5%85%83%E6%95%B0%E6%8D%AE-1"><span class="toc-number">1.5.11.</span> <span class="toc-text">项目：导出当前选定项目的元数据：导出元数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%B0%86%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E5%8F%A6%E5%AD%98%E4%B8%BA-XML%EF%BC%9A%E5%B0%86%E5%85%83%E6%95%B0%E6%8D%AE%E5%8F%A6%E5%AD%98%E4%B8%BA-XML"><span class="toc-number">1.5.12.</span> <span class="toc-text">项目：将当前项目的元数据另存为 XML：将元数据另存为 XML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%B0%86%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%E5%8F%A6%E5%AD%98%E4%B8%BA-HTML%EF%BC%9A%E5%B0%86%E5%85%83%E6%95%B0%E6%8D%AE%E5%8F%A6%E5%AD%98%E4%B8%BAHTML"><span class="toc-number">1.5.13.</span> <span class="toc-text">项目：将当前项目的元数据另存为 HTML：将元数据另存为HTML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89-XSLT-%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E4%BF%9D%E5%AD%98%E5%85%83%E6%95%B0%E6%8D%AE%E4%BD%9C%E4%B8%BA%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89-XSLT"><span class="toc-number">1.5.14.</span> <span class="toc-text">项目：使用自定义 XSLT 保存当前项目的元数据：保存元数据作为使用自定义 XSLT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%EF%BC%9A%E5%8D%87%E7%BA%A7%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%8D%87%E7%BA%A7%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.15.</span> <span class="toc-text">项目：升级当前项目的元数据：升级元数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%8D%95%E4%BD%8D"><span class="toc-number">1.6.</span> <span class="toc-text">项目单位</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E5%8F%AF%E7%94%A8%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%AE%8C%E6%95%B4%E5%88%97%E8%A1%A8"><span class="toc-number">1.6.1.</span> <span class="toc-text">获取所有可用单位格式的完整列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F%E5%88%97%E8%A1%A8"><span class="toc-number">1.6.2.</span> <span class="toc-text">获取当前项目的单位格式列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%89%B9%E5%AE%9A%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F%E5%88%97%E8%A1%A8"><span class="toc-number">1.6.3.</span> <span class="toc-text">获取当前项目的特定单位格式列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E9%BB%98%E8%AE%A4%E6%A0%BC%E5%BC%8F%E5%88%97%E8%A1%A8"><span class="toc-number">1.6.4.</span> <span class="toc-text">获取当前项目的默认格式列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%89%B9%E5%AE%9A%E9%BB%98%E8%AE%A4%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.6.5.</span> <span class="toc-text">获取当前项目的特定默认单位格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BA%E5%BD%93%E5%89%8D%E9%A1%B9%E7%9B%AE%E8%AE%BE%E7%BD%AE%E7%89%B9%E5%AE%9A%E7%9A%84%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F%E5%88%97%E8%A1%A8"><span class="toc-number">1.6.6.</span> <span class="toc-text">为当前项目设置特定的单位格式列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E9%A1%B9%E7%9B%AE%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F%E7%9A%84%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">1.6.7.</span> <span class="toc-text">设置项目单位格式的默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%8D%95%E4%BD%8D%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.6.8.</span> <span class="toc-text">更新项目的单位格式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E9%80%89%E9%A1%B9"><span class="toc-number">1.7.</span> <span class="toc-text">应用选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%B8%B8%E8%A7%84%E9%80%89%E9%A1%B9"><span class="toc-number">1.7.1.</span> <span class="toc-text">获取常规选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E2%80%9C%E5%B8%B8%E8%A7%84%E9%80%89%E9%A1%B9%E2%80%9D%E8%AE%BE%E7%BD%AE%E4%B8%BA%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.7.2.</span> <span class="toc-text">将“常规选项”设置为使用自定义设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%B8%B8%E8%A7%84%E9%80%89%E9%A1%B9%E4%BB%A5%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">1.7.3.</span> <span class="toc-text">设置常规选项以使用默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8B%E8%BD%BD%E9%80%89%E9%A1%B9"><span class="toc-number">1.7.4.</span> <span class="toc-text">获取下载选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%85%B1%E4%BA%AB%E5%92%8C%E5%8F%91%E5%B8%83%E7%9A%84%E6%9A%82%E5%AD%98%E4%BD%8D%E7%BD%AE"><span class="toc-number">1.7.5.</span> <span class="toc-text">设置共享和发布的暂存位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE-PPKX-%E7%9A%84%E4%B8%8B%E8%BD%BD%E9%80%89%E9%A1%B9"><span class="toc-number">1.7.6.</span> <span class="toc-text">设置 PPKX 的下载选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%A7%A3%E5%8E%8B%E7%BC%A9%E7%9A%84%E4%B8%8B%E8%BD%BD%E9%80%89%E9%A1%B9%E5%85%B6%E4%BB%96"><span class="toc-number">1.7.7.</span> <span class="toc-text">设置解压缩的下载选项其他</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%A6%BB%E7%BA%BF%E5%9C%B0%E5%9B%BE%E7%9A%84%E4%B8%8B%E8%BD%BD%E9%80%89%E9%A1%B9"><span class="toc-number">1.7.8.</span> <span class="toc-text">设置离线地图的下载选项</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#-1"><span class="toc-number">3.</span> <span class="toc-text"></span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By shaozhy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="/img/icp.png"><span>冀ICP备2023009991号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'd990e8cbbd1dabc9c98e',
      clientSecret: '59676d5926f4df676ec1ba6b36395bf90a0aeb54',
      repo: 'WineMonk.github.io',
      owner: 'WineMonk',
      admin: ['WineMonk'],
      id: 'dfb9eec7355a3f81c1622314732028cb',
      updateCountCallback: commentCount
    },{"proxy":"https://vercel.prohibitorum.top/github_access_token"}))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="茶飘香,酒罢去,聚朋友,再回楼" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>