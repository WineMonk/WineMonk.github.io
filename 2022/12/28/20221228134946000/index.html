<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ArcGIS Pro SDK 编辑 | WineMonk</title><meta name="keywords" content="CSharp,ArcGIS Pro SDK"><meta name="author" content="shaozhy,1361151272@qq.com"><meta name="copyright" content="shaozhy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="编辑编辑操作方法编辑操作创建要素123456789101112131415161718192021222324252627var createFeatures &#x3D; new EditOperation();createFeatures.Name &#x3D; &quot;Create Features&quot;;&#x2F;&#x2F;Create a feature with a polygonvar token &#x3D; cre">
<meta property="og:type" content="article">
<meta property="og:title" content="ArcGIS Pro SDK 编辑">
<meta property="og:url" content="https://shaoshao.net.cn/2022/12/28/20221228134946000/index.html">
<meta property="og:site_name" content="WineMonk">
<meta property="og:description" content="编辑编辑操作方法编辑操作创建要素123456789101112131415161718192021222324252627var createFeatures &#x3D; new EditOperation();createFeatures.Name &#x3D; &quot;Create Features&quot;;&#x2F;&#x2F;Create a feature with a polygonvar token &#x3D; cre">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg">
<meta property="article:published_time" content="2022-12-28T05:49:46.000Z">
<meta property="article:modified_time" content="2023-04-14T01:28:34.000Z">
<meta property="article:author" content="shaozhy">
<meta property="article:tag" content="CSharp">
<meta property="article:tag" content="ArcGIS Pro SDK">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg"><link rel="shortcut icon" href="/cover/head_portrait.jpg"><link rel="canonical" href="https://shaoshao.net.cn/2022/12/28/20221228134946000/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ArcGIS Pro SDK 编辑',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-04-14 09:28:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://shaoshao.net.cn/images/blog/cover/headportrait/shsh_cn.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/discover/archives/"><div class="headline">文章</div><div class="length-num">170</div></a></div><div class="data-item"><a href="/discover/tags/"><div class="headline">标签</div><div class="length-num">108</div></a></div><div class="data-item"><a href="/discover/categories/"><div class="headline">分类</div><div class="length-num">80</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">WineMonk</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 发现</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/discover/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/discover/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/discover/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/discover/codingStandards/"><i class="fa-fw fas fa-code"></i><span> 军规</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/photo/"><i class="fa-fw fas fa-camera"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/guestbook/"><i class="fa-fw fa fa-commenting"></i><span> 留言</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ArcGIS Pro SDK 编辑</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-12-28T05:49:46.000Z" title="发表于 2022-12-28 13:49:46">2022-12-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-04-14T01:28:34.000Z" title="更新于 2023-04-14 09:28:34">2023-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/">GIS相关</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/discover/categories/GIS%E7%9B%B8%E5%85%B3/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>57分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="ArcGIS Pro SDK 编辑"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="编辑"><a href="#编辑" class="headerlink" title="编辑"></a>编辑</h1><h2 id="编辑操作方法"><a href="#编辑操作方法" class="headerlink" title="编辑操作方法"></a>编辑操作方法</h2><h3 id="编辑操作创建要素"><a href="#编辑操作创建要素" class="headerlink" title="编辑操作创建要素"></a>编辑操作创建要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> createFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">createFeatures.Name = <span class="string">&quot;Create Features&quot;</span>;</span><br><span class="line"><span class="comment">//Create a feature with a polygon</span></span><br><span class="line"><span class="keyword">var</span> token = createFeatures.Create(featureLayer, polygon);</span><br><span class="line"><span class="keyword">if</span> (createFeatures.IsSucceeded)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// token.ObjectID wll be populated with the objectID of the created feature after Execute has been successful</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Do a create features and set attributes</span></span><br><span class="line"><span class="keyword">var</span> attributes = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;();</span><br><span class="line">attributes.Add(<span class="string">&quot;SHAPE&quot;</span>, polygon);</span><br><span class="line">attributes.Add(<span class="string">&quot;NAME&quot;</span>, <span class="string">&quot;Corner Market&quot;</span>);</span><br><span class="line">attributes.Add(<span class="string">&quot;SIZE&quot;</span>, <span class="number">1200.5</span>);</span><br><span class="line">attributes.Add(<span class="string">&quot;DESCRIPTION&quot;</span>, <span class="string">&quot;Corner Market&quot;</span>);</span><br><span class="line"></span><br><span class="line">createFeatures.Create(featureLayer, attributes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create features using the current template</span></span><br><span class="line"><span class="comment">//Must be within a MapTool</span></span><br><span class="line">createFeatures.Create(<span class="keyword">this</span>.CurrentTemplate, polygon);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">createFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await createFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="使用当前模板创建要素"><a href="#使用当前模板创建要素" class="headerlink" title="使用当前模板创建要素"></a>使用当前模板创建要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> myTemplate = ArcGIS.Desktop.Editing.Templates.EditingTemplate.Current;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Create edit operation and execute</span></span><br><span class="line"><span class="keyword">var</span> op = <span class="keyword">new</span> ArcGIS.Desktop.Editing.EditOperation();</span><br><span class="line">op.Name = <span class="string">&quot;Create my feature&quot;</span>;</span><br><span class="line">op.Create(myTemplate, geometry);</span><br><span class="line">op.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="从修改后的检查器创建要素"><a href="#从修改后的检查器创建要素" class="headerlink" title="从修改后的检查器创建要素"></a>从修改后的检查器创建要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> insp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line">insp.Load(layer, <span class="number">86</span>);</span><br><span class="line"></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// modify attributes if necessary</span></span><br><span class="line">  <span class="comment">// insp[&quot;Field1&quot;] = newValue;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//Create new feature from an existing inspector (copying the feature)</span></span><br><span class="line">  <span class="keyword">var</span> createOp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.EditOperation();</span><br><span class="line">  createOp.Name = <span class="string">&quot;Create from insp&quot;</span>;</span><br><span class="line">  createOp.Create(insp.MapMember, insp.ToDictionary(a =&gt; a.FieldName, a =&gt; a.CurrentValue));</span><br><span class="line">  createOp.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="从-CSV-文件创建要素"><a href="#从-CSV-文件创建要素" class="headerlink" title="从 CSV 文件创建要素"></a>从 CSV 文件创建要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Run on MCT</span></span><br><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Create the edit operation</span></span><br><span class="line">  <span class="keyword">var</span> createOperation = <span class="keyword">new</span> ArcGIS.Desktop.Editing.EditOperation();</span><br><span class="line">  createOperation.Name = <span class="string">&quot;Generate points&quot;</span>;</span><br><span class="line">  createOperation.SelectNewFeatures = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// determine the shape field name - it may not be &#x27;Shape&#x27; </span></span><br><span class="line">  <span class="built_in">string</span> shapeField = layer.GetFeatureClass().GetDefinition().GetShapeField();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Loop through csv data</span></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> csvData)</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Create the point geometry</span></span><br><span class="line">    ArcGIS.Core.Geometry.MapPoint newMapPoint =</span><br><span class="line">        ArcGIS.Core.Geometry.MapPointBuilderEx.CreateMapPoint(item.X, item.Y);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// include the attributes via a dictionary</span></span><br><span class="line">    <span class="keyword">var</span> atts = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;();</span><br><span class="line">    atts.Add(<span class="string">&quot;StopOrder&quot;</span>, item.StopOrder);</span><br><span class="line">    atts.Add(<span class="string">&quot;FacilityID&quot;</span>, item.FacilityID);</span><br><span class="line">    atts.Add(shapeField, newMapPoint);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// queue feature creation</span></span><br><span class="line">    createOperation.Create(layer, atts);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// execute the edit (feature creation) operation</span></span><br><span class="line">  <span class="keyword">return</span> createOperation.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="编辑操作-使用表模板在表中创建行"><a href="#编辑操作-使用表模板在表中创建行" class="headerlink" title="编辑操作 使用表模板在表中创建行"></a>编辑操作 使用表模板在表中创建行</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tableTemplate = standaloneTable.GetTemplates().FirstOrDefault();</span><br><span class="line"><span class="keyword">var</span> createRow = <span class="keyword">new</span> EditOperation();</span><br><span class="line">createRow.Name = <span class="string">&quot;Create a row in a table&quot;</span>;</span><br><span class="line"><span class="comment">//Creating a new row in a standalone table using the table template of your choice</span></span><br><span class="line">createRow.Create(tableTemplate);</span><br><span class="line">createRow.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="编辑操作剪辑特征"><a href="#编辑操作剪辑特征" class="headerlink" title="编辑操作剪辑特征"></a>编辑操作剪辑特征</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> clipFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">clipFeatures.Name = <span class="string">&quot;Clip Features&quot;</span>;</span><br><span class="line">clipFeatures.Clip(featureLayer, oid, clipPoly, ClipMode.PreserveArea);</span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">clipFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await clipFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作切割要素"><a href="#编辑操作切割要素" class="headerlink" title="编辑操作切割要素"></a>编辑操作切割要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="keyword">select</span> = MapView.Active.SelectFeatures(clipPoly);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cutFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">cutFeatures.Name = <span class="string">&quot;Cut Features&quot;</span>;</span><br><span class="line">cutFeatures.Split(featureLayer, oid, cutLine);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Cut all the selected features in the active view</span></span><br><span class="line"><span class="comment">//Select using a polygon (for example)</span></span><br><span class="line"><span class="comment">//at 2.x - var kvps = MapView.Active.SelectFeatures(polygon).Select(</span></span><br><span class="line"><span class="comment">//      k =&gt; new KeyValuePair&lt;MapMember, List&lt;long&gt;&gt;(k.Key as MapMember, k.Value));</span></span><br><span class="line"><span class="comment">//cutFeatures.Split(kvps, cutLine);</span></span><br><span class="line"><span class="keyword">var</span> sset = MapView.Active.SelectFeatures(polygon);</span><br><span class="line">cutFeatures.Split(sset, cutLine);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">cutFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await cutFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作删除要素"><a href="#编辑操作删除要素" class="headerlink" title="编辑操作删除要素"></a>编辑操作删除要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> deleteFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">deleteFeatures.Name = <span class="string">&quot;Delete Features&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> table = MapView.Active.Map.StandaloneTables[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//Delete a row in a standalone table</span></span><br><span class="line">deleteFeatures.Delete(table, oid);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Delete all the selected features in the active view</span></span><br><span class="line"><span class="comment">//Select using a polygon (for example)</span></span><br><span class="line"><span class="comment">//at 2.x - var selection = MapView.Active.SelectFeatures(polygon).Select(</span></span><br><span class="line"><span class="comment">//      k =&gt; new KeyValuePair&lt;MapMember, List&lt;long&gt;&gt;(k.Key as MapMember, k.Value));</span></span><br><span class="line"><span class="comment">//deleteFeatures.Delete(selection);</span></span><br><span class="line"><span class="keyword">var</span> selection = MapView.Active.SelectFeatures(polygon);</span><br><span class="line">deleteFeatures.Delete(selection);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">deleteFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await deleteFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作重复要素"><a href="#编辑操作重复要素" class="headerlink" title="编辑操作重复要素"></a>编辑操作重复要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> duplicateFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  duplicateFeatures.Name = <span class="string">&quot;Duplicate Features&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Duplicate with an X and Y offset of 500 map units</span></span><br><span class="line">  <span class="comment">//At 2.x duplicateFeatures.Duplicate(featureLayer, oid, 500.0, 500.0, 0.0);</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//Execute to execute the operation</span></span><br><span class="line">  <span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">  <span class="keyword">var</span> insp2 = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp2.Load(featureLayer, oid);</span><br><span class="line">  <span class="keyword">var</span> geom = insp2[<span class="string">&quot;SHAPE&quot;</span>] <span class="keyword">as</span> Geometry;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> rtoken = duplicateFeatures.Create(insp2.MapMember, insp2.ToDictionary(a =&gt; a.FieldName, a =&gt; a.CurrentValue));</span><br><span class="line">  <span class="keyword">if</span> (duplicateFeatures.Execute())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> modifyOp = duplicateFeatures.CreateChainedOperation();</span><br><span class="line">    modifyOp.Modify(featureLayer, (<span class="built_in">long</span>)rtoken.ObjectID, GeometryEngine.Instance.Move(geom, <span class="number">500.0</span>, <span class="number">500.0</span>));</span><br><span class="line">    modifyOp.Execute();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="编辑操作分解特征"><a href="#编辑操作分解特征" class="headerlink" title="编辑操作分解特征"></a>编辑操作分解特征</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> explodeFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">explodeFeatures.Name = <span class="string">&quot;Explode Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Take a multipart and convert it into one feature per part</span></span><br><span class="line"><span class="comment">//Provide a list of ids to convert multiple</span></span><br><span class="line">explodeFeatures.Explode(featureLayer, <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;() &#123; oid &#125;, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">explodeFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await explodeFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作合并功能"><a href="#编辑操作合并功能" class="headerlink" title="编辑操作合并功能"></a>编辑操作合并功能</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mergeFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">mergeFeatures.Name = <span class="string">&quot;Merge Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Merge three features into a new feature using defaults</span></span><br><span class="line"><span class="comment">//defined in the current template</span></span><br><span class="line"><span class="comment">//At 2.x -</span></span><br><span class="line"><span class="comment">//mergeFeatures.Merge(this.CurrentTemplate as EditingFeatureTemplate, featureLayer, new List&lt;long&gt;() &#123; 10, 96, 12 &#125;);</span></span><br><span class="line">mergeFeatures.Merge(<span class="keyword">this</span>.CurrentTemplate <span class="keyword">as</span> EditingRowTemplate, featureLayer, <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;() &#123; <span class="number">10</span>, <span class="number">96</span>, <span class="number">12</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Merge three features into a new feature in the destination layer</span></span><br><span class="line">mergeFeatures.Merge(destinationLayer, featureLayer, <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;() &#123; <span class="number">10</span>, <span class="number">96</span>, <span class="number">12</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Use an inspector to set the new attributes of the merged feature</span></span><br><span class="line"><span class="keyword">var</span> inspector = <span class="keyword">new</span> Inspector();</span><br><span class="line">inspector.Load(featureLayer, oid);<span class="comment">//base attributes on an existing feature</span></span><br><span class="line"><span class="comment">//change attributes for the new feature</span></span><br><span class="line">inspector[<span class="string">&quot;NAME&quot;</span>] = <span class="string">&quot;New name&quot;</span>;</span><br><span class="line">inspector[<span class="string">&quot;DESCRIPTION&quot;</span>] = <span class="string">&quot;New description&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Merge features into a new feature in the same layer using the</span></span><br><span class="line"><span class="comment">//defaults set in the inspector</span></span><br><span class="line">mergeFeatures.Merge(featureLayer, <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;() &#123; <span class="number">10</span>, <span class="number">96</span>, <span class="number">12</span> &#125;, inspector);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">mergeFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await mergeFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作-修改单个特征"><a href="#编辑操作-修改单个特征" class="headerlink" title="编辑操作 修改单个特征"></a>编辑操作 修改单个特征</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> modifyFeature = <span class="keyword">new</span> EditOperation();</span><br><span class="line">modifyFeature.Name = <span class="string">&quot;Modify a feature&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//use an inspector</span></span><br><span class="line"><span class="keyword">var</span> modifyInspector = <span class="keyword">new</span> Inspector();</span><br><span class="line">modifyInspector.Load(featureLayer, oid);<span class="comment">//base attributes on an existing feature</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//change attributes for the new feature</span></span><br><span class="line">modifyInspector[<span class="string">&quot;SHAPE&quot;</span>] = polygon;<span class="comment">//Update the geometry</span></span><br><span class="line">modifyInspector[<span class="string">&quot;NAME&quot;</span>] = <span class="string">&quot;Updated name&quot;</span>;<span class="comment">//Update attribute(s)</span></span><br><span class="line"></span><br><span class="line">modifyFeature.Modify(modifyInspector);</span><br><span class="line"></span><br><span class="line"><span class="comment">//update geometry and attributes using overload</span></span><br><span class="line"><span class="keyword">var</span> featureAttributes = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt;();</span><br><span class="line">featureAttributes[<span class="string">&quot;NAME&quot;</span>] = <span class="string">&quot;Updated name&quot;</span>;<span class="comment">//Update attribute(s)</span></span><br><span class="line">modifyFeature.Modify(featureLayer, oid, polygon, featureAttributes);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">modifyFeature.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await modifyFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作-修改多个要素"><a href="#编辑操作-修改多个要素" class="headerlink" title="编辑操作 修改多个要素"></a>编辑操作 修改多个要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Search by attribute</span></span><br><span class="line"><span class="keyword">var</span> queryFilter = <span class="keyword">new</span> QueryFilter();</span><br><span class="line">queryFilter.WhereClause = <span class="string">&quot;OBJECTID &lt; 1000000&quot;</span>;</span><br><span class="line"><span class="comment">//Create list of oids to update</span></span><br><span class="line"><span class="keyword">var</span> oidSet = <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;();</span><br><span class="line"><span class="keyword">using</span> (<span class="keyword">var</span> rc = featureLayer.Search(queryFilter))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span> (rc.MoveNext())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> <span class="keyword">record</span> = rc.Current)</span><br><span class="line">    &#123;</span><br><span class="line">      oidSet.Add(<span class="keyword">record</span>.GetObjectID());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//create and execute the edit operation</span></span><br><span class="line"><span class="keyword">var</span> modifyFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">modifyFeatures.Name = <span class="string">&quot;Modify features&quot;</span>;</span><br><span class="line">modifyFeatures.ShowProgressor = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> muultipleFeaturesInsp = <span class="keyword">new</span> Inspector();</span><br><span class="line">muultipleFeaturesInsp.Load(featureLayer, oidSet);</span><br><span class="line">muultipleFeaturesInsp[<span class="string">&quot;MOMC&quot;</span>] = <span class="number">24</span>;</span><br><span class="line">modifyFeatures.Modify(muultipleFeaturesInsp);</span><br><span class="line">modifyFeatures.ExecuteAsync();</span><br></pre></td></tr></table></figure>

<h3 id="搜索图层要素并更新字段"><a href="#搜索图层要素并更新字段" class="headerlink" title="搜索图层要素并更新字段"></a>搜索图层要素并更新字段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//find layer</span></span><br><span class="line">  <span class="keyword">var</span> disLayer = ArcGIS.Desktop.Mapping.MapView.Active.Map.FindLayers(<span class="string">&quot;Distribution mains&quot;</span>).FirstOrDefault() <span class="keyword">as</span> BasicFeatureLayer;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Search by attribute</span></span><br><span class="line">  <span class="keyword">var</span> filter = <span class="keyword">new</span> ArcGIS.Core.Data.QueryFilter();</span><br><span class="line">  filter.WhereClause = <span class="string">&quot;CONTRACTOR = &#x27;KCGM&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> oids = <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;();</span><br><span class="line">  <span class="keyword">using</span> (<span class="keyword">var</span> rc = disLayer.Search(filter))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Create list of oids to update</span></span><br><span class="line">    <span class="keyword">while</span> (rc.MoveNext())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">using</span> (<span class="keyword">var</span> <span class="keyword">record</span> = rc.Current)</span><br><span class="line">      &#123;</span><br><span class="line">        oidSet.Add(<span class="keyword">record</span>.GetObjectID());</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Create edit operation </span></span><br><span class="line">  <span class="keyword">var</span> modifyOp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.EditOperation();</span><br><span class="line">  modifyOp.Name = <span class="string">&quot;Update date&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// load features into inspector and update field</span></span><br><span class="line">  <span class="keyword">var</span> dateInsp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line">  dateInsp.Load(disLayer, oids);</span><br><span class="line">  dateInsp[<span class="string">&quot;InspDate&quot;</span>] = <span class="string">&quot;9/21/2013&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// modify and execute</span></span><br><span class="line">  modifyOp.Modify(insp);</span><br><span class="line">  modifyOp.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="移动要素"><a href="#移动要素" class="headerlink" title="移动要素"></a>移动要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get all of the selected ObjectIDs from the layer.</span></span><br><span class="line"><span class="keyword">var</span> firstLayer = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault();</span><br><span class="line"><span class="keyword">var</span> selectionfromMap = firstLayer.GetSelection();</span><br><span class="line"></span><br><span class="line"><span class="comment">// set up a dictionary to store the layer and the object IDs of the selected features</span></span><br><span class="line"><span class="keyword">var</span> selectionDictionary = <span class="keyword">new</span> Dictionary&lt;MapMember, List&lt;<span class="built_in">long</span>&gt;&gt;();</span><br><span class="line">selectionDictionary.Add(firstLayer <span class="keyword">as</span> MapMember, selectionfromMap.GetObjectIDs().ToList());</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> moveFeature = <span class="keyword">new</span> EditOperation();</span><br><span class="line">moveFeature.Name = <span class="string">&quot;Move features&quot;</span>;</span><br><span class="line"><span class="comment">//at 2.x - moveFeature.Move(selectionDictionary, 10, 10);  //specify your units along axis to move the geometry</span></span><br><span class="line">moveFeature.Move(SelectionSet.FromDictionary(selectionDictionary), <span class="number">10</span>, <span class="number">10</span>);  <span class="comment">//specify your units along axis to move the geometry</span></span><br><span class="line"></span><br><span class="line">moveFeature.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="将要素移动到特定坐标"><a href="#将要素移动到特定坐标" class="headerlink" title="将要素移动到特定坐标"></a>将要素移动到特定坐标</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Get all of the selected ObjectIDs from the layer.</span></span><br><span class="line"><span class="keyword">var</span> abLayer = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault();</span><br><span class="line"><span class="keyword">var</span> mySelection = abLayer.GetSelection();</span><br><span class="line"><span class="keyword">var</span> selOid = mySelection.GetObjectIDs().FirstOrDefault();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> moveToPoint = <span class="keyword">new</span> MapPointBuilderEx(<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>, <span class="number">4.0</span>, MapView.Active.Map.SpatialReference); <span class="comment">//can pass in coordinates.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> modifyFeatureCoord = <span class="keyword">new</span> EditOperation();</span><br><span class="line">modifyFeatureCoord.Name = <span class="string">&quot;Move features&quot;</span>;</span><br><span class="line">modifyFeatureCoord.Modify(abLayer, selOid, moveToPoint.ToGeometry());  <span class="comment">//Modify the feature to the new geometry </span></span><br><span class="line">modifyFeatureCoord.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="编辑操作平面化要素"><a href="#编辑操作平面化要素" class="headerlink" title="编辑操作平面化要素"></a>编辑操作平面化要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// note - EditOperation.Planarize requires a standard license. </span></span><br><span class="line"><span class="comment">//  An exception will be thrown if Pro is running under a basic license. </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> planarizeFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">planarizeFeatures.Name = <span class="string">&quot;Planarize Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Planarize one or more features</span></span><br><span class="line">planarizeFeatures.Planarize(featureLayer, <span class="keyword">new</span> List&lt;<span class="built_in">long</span>&gt;() &#123; oid &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">planarizeFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await planarizeFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作并行偏移"><a href="#编辑操作并行偏移" class="headerlink" title="编辑操作并行偏移"></a>编辑操作并行偏移</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create parrallel features from the selected features</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//find the roads layer</span></span><br><span class="line"><span class="keyword">var</span> roadsLayer = MapView.Active.Map.FindLayers(<span class="string">&quot;Roads&quot;</span>).FirstOrDefault();</span><br><span class="line"></span><br><span class="line"><span class="comment">//instatiate paralleloffset builder and set parameters</span></span><br><span class="line"><span class="keyword">var</span> parOffsetBuilder = <span class="keyword">new</span> ParallelOffset.Builder()</span><br><span class="line">&#123;</span><br><span class="line">  Selection = MapView.Active.Map.GetSelection(),</span><br><span class="line">  Template = roadsLayer.GetTemplate(<span class="string">&quot;Freeway&quot;</span>),</span><br><span class="line">  Distance = <span class="number">200</span>,</span><br><span class="line">  Side = ParallelOffset.SideType.Both,</span><br><span class="line">  Corner = ParallelOffset.CornerType.Mitered,</span><br><span class="line">  Iterations = <span class="number">1</span>,</span><br><span class="line">  AlignConnected = <span class="literal">false</span>,</span><br><span class="line">  CopyToSeparateFeatures = <span class="literal">false</span>,</span><br><span class="line">  RemoveSelfIntersectingLoops = <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//create editoperation and execute</span></span><br><span class="line"><span class="keyword">var</span> parrallelOp = <span class="keyword">new</span> EditOperation();</span><br><span class="line">parrallelOp.Create(parOffsetBuilder);</span><br><span class="line">parrallelOp.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="编辑操作重塑特征"><a href="#编辑操作重塑特征" class="headerlink" title="编辑操作重塑特征"></a>编辑操作重塑特征</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reshapeFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">reshapeFeatures.Name = <span class="string">&quot;Reshape Features&quot;</span>;</span><br><span class="line"></span><br><span class="line">reshapeFeatures.Reshape(featureLayer, oid, modifyLine);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Reshape a set of features that intersect some geometry....</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//at 2.x - var selFeatures = MapView.Active.GetFeatures(modifyLine).Select(</span></span><br><span class="line"><span class="comment">//    k =&gt; new KeyValuePair&lt;MapMember, List&lt;long&gt;&gt;(k.Key as MapMember, k.Value));</span></span><br><span class="line"><span class="comment">//reshapeFeatures.Reshape(selFeatures, modifyLine);</span></span><br><span class="line"></span><br><span class="line">reshapeFeatures.Reshape(MapView.Active.GetFeatures(modifyLine), modifyLine);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">reshapeFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await reshapeFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作旋转要素"><a href="#编辑操作旋转要素" class="headerlink" title="编辑操作旋转要素"></a>编辑操作旋转要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rotateFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">rotateFeatures.Name = <span class="string">&quot;Rotate Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Rotate works on a selected set of features</span></span><br><span class="line"><span class="comment">//Get all features that intersect a polygon</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//at 2.x - var rotateSelection = MapView.Active.GetFeatures(polygon).Select(</span></span><br><span class="line"><span class="comment">//    k =&gt; new KeyValuePair&lt;MapMember, List&lt;long&gt;&gt;(k.Key as MapMember, k.Value));</span></span><br><span class="line"><span class="comment">//rotateFeatures.Rotate(rotateSelection, origin, Math.PI / 2);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Rotate selected features 90 deg about &quot;origin&quot;</span></span><br><span class="line">rotateFeatures.Rotate(MapView.Active.GetFeatures(polygon), origin, Math.PI / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">rotateFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await rotateFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作比例要素"><a href="#编辑操作比例要素" class="headerlink" title="编辑操作比例要素"></a>编辑操作比例要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> scaleFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">scaleFeatures.Name = <span class="string">&quot;Scale Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Rotate works on a selected set of features</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//var scaleSelection = MapView.Active.GetFeatures(polygon).Select(</span></span><br><span class="line"><span class="comment">//    k =&gt; new KeyValuePair&lt;MapMember, List&lt;long&gt;&gt;(k.Key as MapMember, k.Value));</span></span><br><span class="line"><span class="comment">//scaleFeatures.Scale(scaleSelection, origin, 2.0, 2.0, 0.0);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Scale the selected features by 2.0 in the X and Y direction</span></span><br><span class="line">scaleFeatures.Scale(MapView.Active.GetFeatures(polygon), origin, <span class="number">2.0</span>, <span class="number">2.0</span>, <span class="number">0.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">scaleFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await scaleFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作拆分要素"><a href="#编辑操作拆分要素" class="headerlink" title="编辑操作拆分要素"></a>编辑操作拆分要素</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> splitFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">splitFeatures.Name = <span class="string">&quot;Split Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> splitPoints = <span class="keyword">new</span> List&lt;MapPoint&gt;() &#123; mp1, mp2, mp3 &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Split the feature at 3 points</span></span><br><span class="line">splitFeatures.Split(featureLayer, oid, splitPoints);</span><br><span class="line"></span><br><span class="line"><span class="comment">// split using percentage</span></span><br><span class="line"><span class="keyword">var</span> splitByPercentage = <span class="keyword">new</span> SplitByPercentage() &#123; Percentage = <span class="number">33</span>, SplitFromStartPoint = <span class="literal">true</span> &#125;;</span><br><span class="line">splitFeatures.Split(featureLayer, oid, splitByPercentage);</span><br><span class="line"></span><br><span class="line"><span class="comment">// split using equal parts</span></span><br><span class="line"><span class="keyword">var</span> splitByEqualParts = <span class="keyword">new</span> SplitByEqualParts() &#123; NumParts = <span class="number">3</span> &#125;;</span><br><span class="line">splitFeatures.Split(featureLayer, oid, splitByEqualParts);</span><br><span class="line"></span><br><span class="line"><span class="comment">// split using single distance</span></span><br><span class="line"><span class="keyword">var</span> splitByDistance = <span class="keyword">new</span> SplitByDistance() &#123; Distance = <span class="number">27.3</span>, SplitFromStartPoint = <span class="literal">false</span> &#125;;</span><br><span class="line">splitFeatures.Split(featureLayer, oid, splitByDistance);</span><br><span class="line"></span><br><span class="line"><span class="comment">// split using varying distance</span></span><br><span class="line"><span class="keyword">var</span> distances = <span class="keyword">new</span> List&lt;<span class="built_in">double</span>&gt;() &#123; <span class="number">12.5</span>, <span class="number">38.2</span>, <span class="number">89.99</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> splitByVaryingDistance = <span class="keyword">new</span> SplitByVaryingDistance() &#123; Distances = distances, SplitFromStartPoint = <span class="literal">true</span>, ProportionRemainder = <span class="literal">true</span> &#125;;</span><br><span class="line">splitFeatures.Split(featureLayer, oid, splitByVaryingDistance);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">splitFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await splitAtPointsFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作变换特征"><a href="#编辑操作变换特征" class="headerlink" title="编辑操作变换特征"></a>编辑操作变换特征</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> transformFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">transformFeatures.Name = <span class="string">&quot;Transform Features&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Transform a selected set of features</span></span><br><span class="line"><span class="comment">//At 2.x - var transformSelection = MapView.Active.GetFeatures(polygon).Select(</span></span><br><span class="line"><span class="comment">//    k =&gt; new KeyValuePair&lt;MapMember, List&lt;long&gt;&gt;(k.Key as MapMember, k.Value));</span></span><br><span class="line"><span class="comment">//transformFeatures.Transform(transformSelection, linkLayer);</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>/Transform just a layer</span></span><br><span class="line"><span class="comment">//transformFeatures.Transform(featureLayer, linkLayer);</span></span><br><span class="line"><span class="comment"><span class="doctag">///</span>/Perform an affine transformation</span></span><br><span class="line"><span class="comment">//transformFeatures.TransformAffine(featureLayer, linkLayer);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> affine_transform = <span class="keyword">new</span> TransformByLinkLayer()</span><br><span class="line">&#123;</span><br><span class="line">  LinkLayer = linkLayer,</span><br><span class="line">  TransformType = TransformMethodType.Affine <span class="comment">//TransformMethodType.Similarity</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//Transform a selected set of features</span></span><br><span class="line">transformFeatures.Transform(MapView.Active.GetFeatures(polygon), affine_transform);</span><br><span class="line"><span class="comment">//Perform an affine transformation</span></span><br><span class="line">transformFeatures.Transform(featureLayer, affine_transform);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Execute to execute the operation</span></span><br><span class="line"><span class="comment">//Must be called within QueuedTask.Run</span></span><br><span class="line">transformFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await transformFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作橡皮板功能"><a href="#编辑操作橡皮板功能" class="headerlink" title="编辑操作橡皮板功能"></a>编辑操作橡皮板功能</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Perform rubbersheet by geometries</span></span><br><span class="line"><span class="keyword">var</span> rubbersheetMethod = <span class="keyword">new</span> RubbersheetByGeometries()</span><br><span class="line">&#123;</span><br><span class="line">  RubbersheetType = RubbersheetMethodType.Linear, <span class="comment">//The RubbersheetType can be Linear of NearestNeighbor</span></span><br><span class="line">  LinkLines = linkLines, <span class="comment">//IEnumerable list of link lines (polylines)</span></span><br><span class="line">  AnchorPoints = anchorPoints, <span class="comment">//IEnumerable list of anchor points (map points)</span></span><br><span class="line">  LimitedAdjustmentAreas = limitedAdjustmentAreas <span class="comment">//IEnumerable list of limited adjustment areas (polygons)</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rubbersheetOp = <span class="keyword">new</span> EditOperation();</span><br><span class="line"><span class="comment">//Performs linear rubbersheet transformation on the features belonging to &quot;layer&quot; that fall within the limited adjustment areas</span></span><br><span class="line">rubbersheetOp.Rubbersheet(layer, rubbersheetMethod);</span><br><span class="line"><span class="comment">//Execute the operation</span></span><br><span class="line">rubbersheetOp.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Alternatively, you can also perform rubbersheet by layer</span></span><br><span class="line"><span class="keyword">var</span> rubbersheetMethod2 = <span class="keyword">new</span> RubbersheetByLayers()</span><br><span class="line">&#123;</span><br><span class="line">  RubbersheetType = RubbersheetMethodType.NearestNeighbor, <span class="comment">//The RubbersheetType can be Linear of NearestNeighbor</span></span><br><span class="line">  LinkLayer = linkLayer,</span><br><span class="line">  AnchorPointLayer = anchorPointsLayer,</span><br><span class="line">  LimitedAdjustmentAreaLayer = limitedAdjustmentAreaLayer</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Performs nearest neighbor rubbersheet transformation on the features belonging to &quot;layer&quot; that fall within the limited adjustment areas</span></span><br><span class="line">rubbersheetOp.Rubbersheet(layer, rubbersheetMethod2);</span><br><span class="line"><span class="comment">//Execute the operation</span></span><br><span class="line">rubbersheetOp.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="编辑操作-执行剪辑、剪切和平坦化"><a href="#编辑操作-执行剪辑、剪切和平坦化" class="headerlink" title="编辑操作 执行剪辑、剪切和平坦化"></a>编辑操作 执行剪辑、剪切和平坦化</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Multiple operations can be performed by a single</span></span><br><span class="line"><span class="comment">//edit operation.</span></span><br><span class="line"><span class="keyword">var</span> clipCutPlanarizeFeatures = <span class="keyword">new</span> EditOperation();</span><br><span class="line">clipCutPlanarizeFeatures.Name = <span class="string">&quot;Clip, Cut, and Planarize Features&quot;</span>;</span><br><span class="line">clipCutPlanarizeFeatures.Clip(featureLayer, oid, clipPoly);</span><br><span class="line">clipCutPlanarizeFeatures.Split(featureLayer, oid, cutLine);</span><br><span class="line">clipCutPlanarizeFeatures.Planarize(featureLayer, oid);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Note: An edit operation is a single transaction. </span></span><br><span class="line"><span class="comment">//Execute the operations (in the order they were declared)</span></span><br><span class="line">clipCutPlanarizeFeatures.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await clipCutPlanarizeFeatures.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作链-编辑操作"><a href="#编辑操作链-编辑操作" class="headerlink" title="编辑操作链 编辑操作"></a>编辑操作链 编辑操作</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Chaining operations is a special case. Use &quot;Chained Operations&quot; when you require multiple transactions </span></span><br><span class="line"><span class="comment">//to be undo-able with a single &quot;Undo&quot;.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//The most common use case for operation chaining is creating a feature with an attachement. </span></span><br><span class="line"><span class="comment">//Adding an attachment requires the object id (of a new feature) has already been created. </span></span><br><span class="line"><span class="keyword">var</span> editOperation1 = <span class="keyword">new</span> EditOperation();</span><br><span class="line">editOperation1.Name = <span class="built_in">string</span>.Format(<span class="string">&quot;Create point in &#x27;&#123;0&#125;&#x27;&quot;</span>, CurrentTemplate.Layer.Name);</span><br><span class="line"></span><br><span class="line"><span class="built_in">long</span> newFeatureID = <span class="number">-1</span>;</span><br><span class="line"><span class="comment">//The Create operation has to execute so we can get an object_id</span></span><br><span class="line"><span class="keyword">var</span> token2 = editOperation1.Create(<span class="keyword">this</span>.CurrentTemplate, polygon);</span><br><span class="line"><span class="keyword">if</span> (editOperation1.IsSucceeded)</span><br><span class="line">&#123;</span><br><span class="line">  newFeatureID = (<span class="built_in">long</span>)token2.ObjectID;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Must be within a QueuedTask</span></span><br><span class="line">editOperation1.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await editOperation1.ExecuteAsync();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Now, because we have the object id, we can add the attachment.  As we are chaining it, adding the attachment </span></span><br><span class="line"><span class="comment">//can be undone as part of the &quot;Undo Create&quot; operation. In other words, only one undo operation will show on the </span></span><br><span class="line"><span class="comment">//Pro UI and not two.</span></span><br><span class="line"><span class="keyword">var</span> editOperation2 = editOperation1.CreateChainedOperation();</span><br><span class="line"><span class="comment">//Add the attachement using the new feature id</span></span><br><span class="line">editOperation2.AddAttachment(<span class="keyword">this</span>.CurrentTemplate.Layer, newFeatureID, <span class="string">@&quot;C:\data\images\Hydrant.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//editOperation1 and editOperation2 show up as a single Undo operation on the UI even though</span></span><br><span class="line"><span class="comment">//we had two transactions</span></span><br><span class="line"><span class="comment">//Must be within a QueuedTask</span></span><br><span class="line">editOperation2.Execute();</span><br><span class="line"></span><br><span class="line"><span class="comment">//or use async flavor</span></span><br><span class="line"><span class="comment">//await editOperation2.ExecuteAsync();</span></span><br></pre></td></tr></table></figure>

<h3 id="编辑操作通过行令牌添加附件"><a href="#编辑操作通过行令牌添加附件" class="headerlink" title="编辑操作通过行令牌添加附件"></a>编辑操作通过行令牌添加附件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ArcGIS Pro 2.5 extends the EditOperation.AddAttachment method to take a RowToken as a paramter.</span></span><br><span class="line"><span class="comment">//This allows you to create a feature, using EditOperation.CreateEx, and add an attachment in one transaction.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> editOpAttach = <span class="keyword">new</span> EditOperation();</span><br><span class="line">editOperation1.Name = <span class="built_in">string</span>.Format(<span class="string">&quot;Create point in &#x27;&#123;0&#125;&#x27;&quot;</span>, CurrentTemplate.Layer.Name);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> attachRowToken = editOpAttach.Create(<span class="keyword">this</span>.CurrentTemplate, polygon);</span><br><span class="line">editOpAttach.AddAttachment(attachRowToken, <span class="string">@&quot;c:\temp\image.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Must be within a QueuedTask</span></span><br><span class="line">editOpAttach.Execute();</span><br></pre></td></tr></table></figure>

<h3 id="SetOnUndone，-SetOnRedone，-SetOnComitted"><a href="#SetOnUndone，-SetOnRedone，-SetOnComitted" class="headerlink" title="SetOnUndone， SetOnRedone， SetOnComitted"></a>SetOnUndone， SetOnRedone， SetOnComitted</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SetOnUndone, SetOnRedone and SetOnComittedManage can be used to manage </span></span><br><span class="line"><span class="comment">// external actions(such as writing to a log table) that are associated with </span></span><br><span class="line"><span class="comment">// each edit operation.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//get selected feature and update attribute</span></span><br><span class="line"><span class="keyword">var</span> selectedFeatures = MapView.Active.Map.GetSelection();</span><br><span class="line"><span class="keyword">var</span> testInspector = <span class="keyword">new</span> Inspector();</span><br><span class="line">testInspector.Load(selectedFeatures.ToDictionary().Keys.First(), selectedFeatures.ToDictionary().Values.First());</span><br><span class="line">testInspector[<span class="string">&quot;Name&quot;</span>] = <span class="string">&quot;test&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//create and execute the edit operation</span></span><br><span class="line"><span class="keyword">var</span> updateTestField = <span class="keyword">new</span> EditOperation();</span><br><span class="line">updateTestField.Name = <span class="string">&quot;Update test field&quot;</span>;</span><br><span class="line">updateTestField.Modify(insp);</span><br><span class="line"></span><br><span class="line"><span class="comment">//actions for SetOn...</span></span><br><span class="line">updateTestField.SetOnUndone(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Sets an action that will be called when this operation is undone.</span></span><br><span class="line">  Debug.WriteLine(<span class="string">&quot;Operation is undone&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">updateTestField.SetOnRedone(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Sets an action that will be called when this editoperation is redone.</span></span><br><span class="line">  Debug.WriteLine(<span class="string">&quot;Operation is redone&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">updateTestField.SetOnComitted((<span class="built_in">bool</span> b) =&gt; <span class="comment">//called on edit session save(true)/discard(false).</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// Sets an action that will be called when this editoperation is committed.</span></span><br><span class="line">  Debug.WriteLine(<span class="string">&quot;Operation is committed&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">updateTestField.Execute();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="启用编辑"><a href="#启用编辑" class="headerlink" title="启用编辑"></a>启用编辑</h2><h3 id="启用编辑-1"><a href="#启用编辑-1" class="headerlink" title="启用编辑"></a>启用编辑</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if not editing</span></span><br><span class="line"><span class="keyword">if</span> (!Project.Current.IsEditingEnabled)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> res = MessageBox.Show(<span class="string">&quot;You must enable editing to use editing tools. Would you like to enable editing?&quot;</span>,</span><br><span class="line">                                                        <span class="string">&quot;Enable Editing?&quot;</span>, System.Windows.MessageBoxButton.YesNoCancel);</span><br><span class="line">  <span class="keyword">if</span> (res == System.Windows.MessageBoxResult.No ||</span><br><span class="line">                res == System.Windows.MessageBoxResult.Cancel)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Project.Current.SetIsEditingEnabledAsync(<span class="literal">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="禁用编辑"><a href="#禁用编辑" class="headerlink" title="禁用编辑"></a>禁用编辑</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// if editing</span></span><br><span class="line"><span class="keyword">if</span> (Project.Current.IsEditingEnabled)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> res = MessageBox.Show(<span class="string">&quot;Do you want to disable editing? Editing tools will be disabled&quot;</span>,</span><br><span class="line">                                                         <span class="string">&quot;Disable Editing?&quot;</span>, System.Windows.MessageBoxButton.YesNoCancel);</span><br><span class="line">  <span class="keyword">if</span> (res == System.Windows.MessageBoxResult.No ||</span><br><span class="line">                res == System.Windows.MessageBoxResult.Cancel)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//we must check for edits</span></span><br><span class="line">  <span class="keyword">if</span> (Project.Current.HasEdits)</span><br><span class="line">  &#123;</span><br><span class="line">    res = MessageBox.Show(<span class="string">&quot;Save edits?&quot;</span>, <span class="string">&quot;Save Edits?&quot;</span>, System.Windows.MessageBoxButton.YesNoCancel);</span><br><span class="line">    <span class="keyword">if</span> (res == System.Windows.MessageBoxResult.Cancel)</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (res == System.Windows.MessageBoxResult.No)</span><br><span class="line">      Project.Current.DiscardEditsAsync();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      Project.Current.SaveEditsAsync();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  Project.Current.SetIsEditingEnabledAsync(<span class="literal">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="地图拓扑"><a href="#地图拓扑" class="headerlink" title="地图拓扑"></a>地图拓扑</h2><h3 id="构建地图拓扑"><a href="#构建地图拓扑" class="headerlink" title="构建地图拓扑"></a>构建地图拓扑</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">async</span> Task <span class="title">BuildGraphWithActiveView</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Build the map topology graph</span></span><br><span class="line">    MapView.Active.BuildMapTopologyGraph&lt;TopologyDefinition&gt;(<span class="keyword">async</span> topologyGraph =&gt;</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//Getting the nodes and edges present in the graph</span></span><br><span class="line">      <span class="keyword">var</span> topologyGraphNodes = topologyGraph.GetNodes();</span><br><span class="line">      <span class="keyword">var</span> topologyGraphEdges = topologyGraph.GetEdges();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">foreach</span> (<span class="keyword">var</span> node <span class="keyword">in</span> topologyGraphNodes)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// do something with the node</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">foreach</span> (<span class="keyword">var</span> edge <span class="keyword">in</span> topologyGraphEdges)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// do something with the edge</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      MessageBox.Show(<span class="string">$&quot;Number of topo graph nodes are:  <span class="subst">&#123;topologyGraphNodes.Count&#125;</span>.\n Number of topo graph edges are <span class="subst">&#123;topologyGraphEdges.Count&#125;</span>.&quot;</span>, <span class="string">&quot;Map Topology Info&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="行事件"><a href="#行事件" class="headerlink" title="行事件"></a>行事件</h2><h3 id="订阅行事件"><a href="#订阅行事件" class="headerlink" title="订阅行事件"></a>订阅行事件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">SubscribeRowEvent</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Listen for row events on a layer</span></span><br><span class="line">    <span class="keyword">var</span> featLayer = MapView.Active.GetSelectedLayers().First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line">    <span class="keyword">var</span> layerTable = featLayer.GetTable();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//subscribe to row events</span></span><br><span class="line">    <span class="keyword">var</span> rowCreateToken = RowCreatedEvent.Subscribe(OnRowCreated, layerTable);</span><br><span class="line">    <span class="keyword">var</span> rowChangeToken = RowChangedEvent.Subscribe(OnRowChanged, layerTable);</span><br><span class="line">    <span class="keyword">var</span> rowDeleteToken = RowDeletedEvent.Subscribe(OnRowDeleted, layerTable);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnRowCreated</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnRowChanged</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnRowDeleted</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="在行事件中的映射中的单独表中创建记录"><a href="#在行事件中的映射中的单独表中创建记录" class="headerlink" title="在行事件中的映射中的单独表中创建记录"></a>在行事件中的映射中的单独表中创建记录</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use the EditOperation in the RowChangedEventArgs to append actions to be executed. </span></span><br><span class="line"><span class="comment">//  Your actions will become part of the operation and combined into one item on the undo stack</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HookRowCreatedEvent</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// subscribe to the RowCreatedEvent</span></span><br><span class="line">  Table table = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault().GetTable();</span><br><span class="line">  RowCreatedEvent.Subscribe(MyRowCreatedEvent, table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">MyRowCreatedEvent</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// RowEvent callbacks are always called on the QueuedTask so there is no need </span></span><br><span class="line">  <span class="comment">// to wrap your code within a QueuedTask.Run lambda.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the edit operation</span></span><br><span class="line">  <span class="keyword">var</span> parentEditOp = args.Operation;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set up some attributes</span></span><br><span class="line">  <span class="keyword">var</span> attribs = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; &#123; &#125;;</span><br><span class="line">  attribs.Add(<span class="string">&quot;Layer&quot;</span>, <span class="string">&quot;Parcels&quot;</span>);</span><br><span class="line">  attribs.Add(<span class="string">&quot;Description&quot;</span>, <span class="string">&quot;OID: &quot;</span> + args.Row.GetObjectID().ToString() + <span class="string">&quot; &quot;</span> + DateTime.Now.ToShortTimeString());</span><br><span class="line"></span><br><span class="line">  <span class="comment">//create a record in an audit table</span></span><br><span class="line">  <span class="keyword">var</span> sTable = MapView.Active.Map.FindStandaloneTables(<span class="string">&quot;EditHistory&quot;</span>).First();</span><br><span class="line">  <span class="keyword">var</span> table = sTable.GetTable();</span><br><span class="line">  parentEditOp.Create(table, attribs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="在行事件中的单独表中创建记录"><a href="#在行事件中的单独表中创建记录" class="headerlink" title="在行事件中的单独表中创建记录"></a>在行事件中的单独表中创建记录</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Use the EditOperation in the RowChangedEventArgs to append actions to be executed. </span></span><br><span class="line"><span class="comment">//  Your actions will become part of the operation and combined into one item on the undo stack</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HookCreatedEvent</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// subscribe to the RowCreatedEvent</span></span><br><span class="line">  Table table = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault().GetTable();</span><br><span class="line">  RowCreatedEvent.Subscribe(OnRowCreatedEvent, table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnRowCreatedEvent</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// RowEvent callbacks are always called on the QueuedTask so there is no need </span></span><br><span class="line">  <span class="comment">// to wrap your code within a QueuedTask.Run lambda.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// update a separate table not in the map when a row is created</span></span><br><span class="line">  <span class="comment">// You MUST use the ArcGIS.Core.Data API to edit the table. Do NOT</span></span><br><span class="line">  <span class="comment">// use a new edit operation in the RowEvent callbacks</span></span><br><span class="line">  <span class="keyword">try</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// get the edit operation</span></span><br><span class="line">    <span class="keyword">var</span> parentEditOp = args.Operation;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set up some attributes</span></span><br><span class="line">    <span class="keyword">var</span> attribs = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">object</span>&gt; &#123; &#125;;</span><br><span class="line">    attribs.Add(<span class="string">&quot;Description&quot;</span>, <span class="string">&quot;OID: &quot;</span> + args.Row.GetObjectID().ToString() + <span class="string">&quot; &quot;</span> + DateTime.Now.ToShortTimeString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">// update Notes table with information about the new feature</span></span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> geoDatabase = <span class="keyword">new</span> Geodatabase(<span class="keyword">new</span> FileGeodatabaseConnectionPath(<span class="keyword">new</span> Uri(Project.Current.DefaultGeodatabasePath))))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">using</span> (<span class="keyword">var</span> table = geoDatabase.OpenDataset&lt;Table&gt;(<span class="string">&quot;Notes&quot;</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        parentEditOp.Create(table, attribs);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">catch</span> (Exception e)</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBox.Show(<span class="string">$@&quot;Error in OnRowCreated for OID: <span class="subst">&#123;args.Row.GetObjectID()&#125;</span> : <span class="subst">&#123;e.ToString()&#125;</span>&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="修改行事件中的记录-使用-Row-Store"><a href="#修改行事件中的记录-使用-Row-Store" class="headerlink" title="修改行事件中的记录 - 使用 Row.Store"></a>修改行事件中的记录 - 使用 Row.Store</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HookRowChangedEvent</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// subscribe to the RowChangedEvent</span></span><br><span class="line">  Table table = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault().GetTable();</span><br><span class="line">  RowChangedEvent.Subscribe(OnRowChangedEvent, table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Guid _currentRowChangedGuid = Guid.Empty;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnRowChangedEvent</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// RowEvent callbacks are always called on the QueuedTask so there is no need </span></span><br><span class="line">  <span class="comment">// to wrap your code within a QueuedTask.Run lambda.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> row = args.Row;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// check for re-entry  (only if row.Store is called)</span></span><br><span class="line">  <span class="keyword">if</span> (_currentRowChangedGuid == args.Guid)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> fldIdx = row.FindField(<span class="string">&quot;POLICE_DISTRICT&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (fldIdx != <span class="number">-1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Validate any change to �police district�</span></span><br><span class="line">    <span class="comment">//   cancel the edit if validation on the field fails</span></span><br><span class="line">    <span class="keyword">if</span> (row.HasValueChanged(fldIdx))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// cancel edit with invalid district (5)</span></span><br><span class="line">      <span class="keyword">var</span> <span class="keyword">value</span> = row[<span class="string">&quot;POLICE_DISTRICT&quot;</span>].ToString();</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">value</span> == <span class="string">&quot;5&quot;</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">//Cancel edits with invalid �police district� values</span></span><br><span class="line">        args.CancelEdit(<span class="string">$&quot;Police district <span class="subst">&#123;row[<span class="string">&quot;POLICE_DISTRICT&quot;</span>]&#125;</span> is invalid&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// update the description field</span></span><br><span class="line">    row[<span class="string">&quot;Description&quot;</span>] = <span class="string">&quot;Row Changed&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  this update with cause another OnRowChanged event to occur</span></span><br><span class="line">    <span class="comment">//  keep track of the row guid to avoid recursion</span></span><br><span class="line">    _currentRowChangedGuid = args.Guid;</span><br><span class="line">    row.Store();</span><br><span class="line">    _currentRowChangedGuid = Guid.Empty;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="修改行事件中的记录-使用-EditOperation-Modify"><a href="#修改行事件中的记录-使用-EditOperation-Modify" class="headerlink" title="修改行事件中的记录 - 使用 EditOperation.Modify"></a>修改行事件中的记录 - 使用 EditOperation.Modify</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">HookChangedEvent</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// subscribe to the RowChangedEvent</span></span><br><span class="line">  Table table = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault().GetTable();</span><br><span class="line">  RowChangedEvent.Subscribe(MyRowChangedEvent, table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">MyRowChangedEvent</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// RowEvent callbacks are always called on the QueuedTask so there is no need </span></span><br><span class="line">  <span class="comment">// to wrap your code within a QueuedTask.Run lambda.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//example of modifying a field on a row that has been created</span></span><br><span class="line">  <span class="keyword">var</span> parentEditOp = args.Operation;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// avoid recursion</span></span><br><span class="line">  <span class="keyword">if</span> (_lastEdit != args.Guid)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//update field on change</span></span><br><span class="line">    parentEditOp.Modify(args.Row, <span class="string">&quot;ZONING&quot;</span>, <span class="string">&quot;New&quot;</span>);</span><br><span class="line"></span><br><span class="line">    _lastEdit = args.Guid;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="确定编辑时几何图形是否更改"><a href="#确定编辑时几何图形是否更改" class="headerlink" title="确定编辑时几何图形是否更改"></a>确定编辑时几何图形是否更改</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> FeatureLayer featureLayer;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DetermineGeometryChange</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  featureLayer = MapView.Active?.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault();</span><br><span class="line">  <span class="keyword">if</span> (featureLayer == <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Listen to the RowChangedEvent that occurs when a Row is changed.</span></span><br><span class="line">    ArcGIS.Desktop.Editing.Events.RowChangedEvent.Subscribe(OnRowChangedEvent2, featureLayer.GetTable());</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnRowChangedEvent2</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// RowEvent callbacks are always called on the QueuedTask so there is no need </span></span><br><span class="line">  <span class="comment">// to wrap your code within a QueuedTask.Run lambda.</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//Get the layer&#x27;s definition</span></span><br><span class="line">  <span class="keyword">var</span> lyrDefn = featureLayer.GetFeatureClass().GetDefinition();</span><br><span class="line">  <span class="comment">//Get the shape field of the feature class</span></span><br><span class="line">  <span class="built_in">string</span> shapeField = lyrDefn.GetShapeField();</span><br><span class="line">  <span class="comment">//Index of the shape field</span></span><br><span class="line">  <span class="keyword">var</span> shapeIndex = lyrDefn.FindField(shapeField);</span><br><span class="line">  <span class="comment">//Original geometry of the modified row</span></span><br><span class="line">  <span class="keyword">var</span> geomOrig = args.Row.GetOriginalValue(shapeIndex) <span class="keyword">as</span> Geometry;</span><br><span class="line">  <span class="comment">//New geometry of the modified row</span></span><br><span class="line">  <span class="keyword">var</span> geomNew = args.Row[shapeIndex] <span class="keyword">as</span> Geometry;</span><br><span class="line">  <span class="comment">//Compare the two</span></span><br><span class="line">  <span class="built_in">bool</span> shapeChanged = geomOrig.IsEqual(geomNew);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="取消删除"><a href="#取消删除" class="headerlink" title="取消删除"></a>取消删除</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">StopADelete</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// subscribe to the RowDeletedEvent for the appropriate table</span></span><br><span class="line">  Table table = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault().GetTable();</span><br><span class="line">  RowDeletedEvent.Subscribe(OnRowDeletedEvent, table);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">OnRowDeletedEvent</span>(<span class="params">RowChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// RowEvent callbacks are always called on the QueuedTask so there is no need </span></span><br><span class="line">  <span class="comment">// to wrap your code within a QueuedTask.Run lambda.</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> row = args.Row;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// cancel the delete if the feature is in Police District 5</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> fldIdx = row.FindField(<span class="string">&quot;POLICE_DISTRICT&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (fldIdx != <span class="number">-1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">value</span> = row[fldIdx].ToString();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">value</span> == <span class="string">&quot;5&quot;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">//cancel with dialog</span></span><br><span class="line">      <span class="comment">// Note - feature edits on Hosted and Standard Feature Services cannot be cancelled.</span></span><br><span class="line">      args.CancelEdit(<span class="string">&quot;Delete Event\nAre you sure&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// or cancel without a dialog</span></span><br><span class="line">      <span class="comment">// args.CancelEdit();</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="编辑已完成事件"><a href="#编辑已完成事件" class="headerlink" title="编辑已完成事件"></a>编辑已完成事件</h2><h3 id="订阅编辑已完成事件"><a href="#订阅编辑已完成事件" class="headerlink" title="订阅编辑已完成事件"></a>订阅编辑已完成事件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">subEditEvents</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//subscribe to editcompleted</span></span><br><span class="line">  <span class="keyword">var</span> eceToken = EditCompletedEvent.Subscribe(onEce);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Task <span class="title">onEce</span>(<span class="params">EditCompletedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//show number of edits</span></span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Creates: &quot;</span> + args.Creates.ToDictionary().Values.Sum(list =&gt; list.Count).ToString());</span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Modifies: &quot;</span> + args.Modifies.ToDictionary().Values.Sum(list =&gt; list.Count).ToString());</span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Deletes: &quot;</span> + args.Deletes.ToDictionary().Values.Sum(list =&gt; list.Count).ToString());</span><br><span class="line">  <span class="keyword">return</span> Task.FromResult(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="检查员"><a href="#检查员" class="headerlink" title="检查员"></a>检查员</h2><h3 id="将要素从图层加载到检查器中"><a href="#将要素从图层加载到检查器中" class="headerlink" title="将要素从图层加载到检查器中"></a>将要素从图层加载到检查器中</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the first feature layer in the map</span></span><br><span class="line"><span class="keyword">var</span> firstFeatureLayer = ArcGIS.Desktop.Mapping.MapView.Active.Map.GetLayersAsFlattenedList().</span><br><span class="line">    OfType&lt;ArcGIS.Desktop.Mapping.FeatureLayer&gt;().FirstOrDefault();</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an instance of the inspector class</span></span><br><span class="line"><span class="keyword">var</span> inspector = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line"><span class="comment">// load the feature with ObjectID &#x27;oid&#x27; into the inspector</span></span><br><span class="line"><span class="keyword">await</span> inspector.LoadAsync(firstFeatureLayer, oid);</span><br></pre></td></tr></table></figure>

<h3 id="将地图选择加载到检查器中"><a href="#将地图选择加载到检查器中" class="headerlink" title="将地图选择加载到检查器中"></a>将地图选择加载到检查器中</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the currently selected features in the map</span></span><br><span class="line"><span class="keyword">var</span> selectedFeatures = ArcGIS.Desktop.Mapping.MapView.Active.Map.GetSelection();</span><br><span class="line"><span class="comment">// get the first layer and its corresponding selected feature OIDs</span></span><br><span class="line"><span class="keyword">var</span> firstSelectionSet = selectedFeatures.ToDictionary().First();</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an instance of the inspector class</span></span><br><span class="line"><span class="keyword">var</span> inspector = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line"><span class="comment">// load the selected features into the inspector using a list of object IDs</span></span><br><span class="line"><span class="keyword">await</span> inspector.LoadAsync(firstSelectionSet.Key, firstSelectionSet.Value);</span><br></pre></td></tr></table></figure>

<h3 id="获取所选要素的属性值"><a href="#获取所选要素的属性值" class="headerlink" title="获取所选要素的属性值"></a>获取所选要素的属性值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the currently selected features in the map</span></span><br><span class="line">  <span class="keyword">var</span> selectedFeatures = ArcGIS.Desktop.Mapping.MapView.Active.Map.GetSelection();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the first layer and its corresponding selected feature OIDs</span></span><br><span class="line">  <span class="keyword">var</span> firstSelectionSet = selectedFeatures.ToDictionary().First();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// create an instance of the inspector class</span></span><br><span class="line">  <span class="keyword">var</span> inspector = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// load the selected features into the inspector using a list of object IDs</span></span><br><span class="line">  inspector.Load(firstSelectionSet.Key, firstSelectionSet.Value);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//get the value of</span></span><br><span class="line">  <span class="keyword">var</span> pscode = inspector[<span class="string">&quot;STATE_NAME&quot;</span>];</span><br><span class="line">  <span class="keyword">var</span> myGeometry = inspector.Shape;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将地图选择加载到检查器并更改属性"><a href="#将地图选择加载到检查器并更改属性" class="headerlink" title="将地图选择加载到检查器并更改属性"></a>将地图选择加载到检查器并更改属性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get the currently selected features in the map</span></span><br><span class="line"><span class="keyword">var</span> selectedFeatures = ArcGIS.Desktop.Mapping.MapView.Active.Map.GetSelection();</span><br><span class="line"><span class="comment">// get the first layer and its corresponding selected feature OIDs</span></span><br><span class="line"><span class="keyword">var</span> firstSelectionSet = selectedFeatures.ToDictionary().First();</span><br><span class="line"></span><br><span class="line"><span class="comment">// create an instance of the inspector class</span></span><br><span class="line"><span class="keyword">var</span> inspector = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line"><span class="comment">// load the selected features into the inspector using a list of object IDs</span></span><br><span class="line"><span class="keyword">await</span> inspector.LoadAsync(firstSelectionSet.Key, firstSelectionSet.Value);</span><br><span class="line"></span><br><span class="line"><span class="comment">// assign the new attribute value to the field &quot;Description&quot;</span></span><br><span class="line"><span class="comment">// if more than one features are loaded, the change applies to all features</span></span><br><span class="line">inspector[<span class="string">&quot;Description&quot;</span>] = <span class="string">&quot;The new value.&quot;</span>;</span><br><span class="line"><span class="comment">// apply the changes as an edit operation - but with no undo/redo</span></span><br><span class="line"><span class="keyword">await</span> inspector.ApplyAsync();</span><br></pre></td></tr></table></figure>

<h3 id="使用检查器获取图层方案"><a href="#使用检查器获取图层方案" class="headerlink" title="使用检查器获取图层方案"></a>使用检查器获取图层方案</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> firstFeatureLayer = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;ArcGIS.Desktop.Mapping.FeatureLayer&gt;().FirstOrDefault();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// create an instance of the inspector class</span></span><br><span class="line">  <span class="keyword">var</span> inspector = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// load the layer</span></span><br><span class="line">  inspector.LoadSchema(firstFeatureLayer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// iterate through the attributes, looking at properties</span></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> attribute <span class="keyword">in</span> inspector)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> fldName = attribute.FieldName;</span><br><span class="line">    <span class="keyword">var</span> fldAlias = attribute.FieldAlias;</span><br><span class="line">    <span class="keyword">var</span> fldType = attribute.FieldType;</span><br><span class="line">    <span class="built_in">int</span> idxFld = attribute.FieldIndex;</span><br><span class="line">    <span class="keyword">var</span> fld = attribute.GetField();</span><br><span class="line">    <span class="keyword">var</span> isNullable = attribute.IsNullable;</span><br><span class="line">    <span class="keyword">var</span> isEditable = attribute.IsEditable;</span><br><span class="line">    <span class="keyword">var</span> isVisible = attribute.IsVisible;</span><br><span class="line">    <span class="keyword">var</span> isSystemField = attribute.IsSystemField;</span><br><span class="line">    <span class="keyword">var</span> isGeometryField = attribute.IsGeometryField;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="检查器-添加验证"><a href="#检查器-添加验证" class="headerlink" title="检查器.添加验证"></a>检查器.添加验证</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">insp.LoadSchema(featLayer);</span><br><span class="line"><span class="keyword">var</span> attrib = insp.Where(a =&gt; a.FieldName == <span class="string">&quot;Mineral&quot;</span>).First();</span><br><span class="line"></span><br><span class="line">attrib.AddValidate(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (attrib.CurrentValue.ToString() == <span class="string">&quot;Salt&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> Enumerable.Empty&lt;ArcGIS.Desktop.Editing.Attributes.Attribute.ValidationError&gt;();</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="keyword">new</span>[] &#123; ArcGIS.Desktop.Editing.Attributes.Attribute.ValidationError.Create(<span class="string">&quot;Error&quot;</span>, ArcGIS.Desktop.Editing.Attributes.Severity.Low) &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="访问-Blob-字段"><a href="#访问-Blob-字段" class="headerlink" title="访问 Blob 字段"></a>访问 Blob 字段</h2><h3 id="使用属性检查器读取和写入-Blob-字段"><a href="#使用属性检查器读取和写入-Blob-字段" class="headerlink" title="使用属性检查器读取和写入 Blob 字段"></a>使用属性检查器读取和写入 Blob 字段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//get selected feature into inspector</span></span><br><span class="line">  <span class="keyword">var</span> selectedFeatures = MapView.Active.Map.GetSelection();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp.Load(selectedFeatures.ToDictionary().Keys.First(), selectedFeatures.ToDictionary().Values.First());</span><br><span class="line"></span><br><span class="line">  <span class="comment">//read a blob field and save to a file</span></span><br><span class="line">  <span class="keyword">var</span> msw = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">  msw = insp[<span class="string">&quot;Blobfield&quot;</span>] <span class="keyword">as</span> MemoryStream;</span><br><span class="line">  <span class="keyword">using</span> (FileStream file = <span class="keyword">new</span> FileStream(<span class="string">@&quot;d:\temp\blob.jpg&quot;</span>, FileMode.Create, FileAccess.Write))</span><br><span class="line">  &#123;</span><br><span class="line">    msw.WriteTo(file);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//read file into memory stream</span></span><br><span class="line">  <span class="keyword">var</span> msr = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">  <span class="keyword">using</span> (FileStream file = <span class="keyword">new</span> FileStream(<span class="string">@&quot;d:\images\Hydrant.jpg&quot;</span>, FileMode.Open, FileAccess.Read))</span><br><span class="line">  &#123;</span><br><span class="line">    file.CopyTo(msr);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//put the memory stream in the blob field and save to feature</span></span><br><span class="line">  <span class="keyword">var</span> op = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  op.Name = <span class="string">&quot;Blob Inspector&quot;</span>;</span><br><span class="line">  insp[<span class="string">&quot;Blobfield&quot;</span>] = msr;</span><br><span class="line">  op.Modify(insp);</span><br><span class="line">  op.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="在回调中使用行游标读取和写入-Blob-字段"><a href="#在回调中使用行游标读取和写入-Blob-字段" class="headerlink" title="在回调中使用行游标读取和写入 Blob 字段"></a>在回调中使用行游标读取和写入 Blob 字段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> editOp = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  editOp.Name = <span class="string">&quot;Blob Cursor&quot;</span>;</span><br><span class="line">  <span class="keyword">var</span> featLayer = MapView.Active.Map.FindLayers(<span class="string">&quot;Hydrant&quot;</span>).First() <span class="keyword">as</span> FeatureLayer;</span><br><span class="line"></span><br><span class="line">  editOp.Callback((context) =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">using</span> (<span class="keyword">var</span> rc = featLayer.GetTable().Search(<span class="literal">null</span>, <span class="literal">false</span>))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">while</span> (rc.MoveNext())</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">using</span> (<span class="keyword">var</span> <span class="keyword">record</span> = rc.Current)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">//read the blob field and save to a file</span></span><br><span class="line">          <span class="keyword">var</span> msw = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">          msw = <span class="keyword">record</span>[&quot;<span class="title">BlobField</span>&quot;] <span class="title">as</span> <span class="title">MemoryStream</span>;</span><br><span class="line">          <span class="keyword">using</span> (FileStream file = <span class="keyword">new</span> FileStream(<span class="string">@&quot;d:\temp\blob.jpg&quot;</span>, FileMode.Create, FileAccess.Write))</span><br><span class="line">          &#123;</span><br><span class="line">            msw.WriteTo(file);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">//read file into memory stream</span></span><br><span class="line">          <span class="keyword">var</span> msr = <span class="keyword">new</span> MemoryStream();</span><br><span class="line">          <span class="keyword">using</span> (FileStream file = <span class="keyword">new</span> FileStream(<span class="string">@&quot;d:\images\Hydrant.jpg&quot;</span>, FileMode.Open, FileAccess.Read))</span><br><span class="line">          &#123;</span><br><span class="line">            file.CopyTo(msr);</span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="comment">//put the memory stream in the blob field and save to feature</span></span><br><span class="line">          <span class="keyword">record</span>[&quot;<span class="title">BlobField</span>&quot;] = msr;</span><br><span class="line">          <span class="keyword">record</span>.Store();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, featLayer.GetTable());</span><br><span class="line">  editOp.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="访问栅格字段"><a href="#访问栅格字段" class="headerlink" title="访问栅格字段"></a>访问栅格字段</h2><h3 id="从栅格字段读取"><a href="#从栅格字段读取" class="headerlink" title="从栅格字段读取"></a>从栅格字段读取</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> sel = MapView.Active.Map.GetSelection();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Read a raster from a raster field as an InteropBitmap</span></span><br><span class="line">  <span class="comment">//the bitmap can then be used as an imagesource or written to disk</span></span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line">  insp.Load(sel.ToDictionary().Keys.First(), sel.ToDictionary().Values.First());</span><br><span class="line">  <span class="keyword">var</span> ibmp = insp[<span class="string">&quot;Photo&quot;</span>] <span class="keyword">as</span> System.Windows.Interop.InteropBitmap;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将图像写入栅格字段"><a href="#将图像写入栅格字段" class="headerlink" title="将图像写入栅格字段"></a>将图像写入栅格字段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> sel = MapView.Active.Map.GetSelection();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Insert an image into a raster field</span></span><br><span class="line">  <span class="comment">//Image will be written with no compression</span></span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line">  insp.Load(sel.ToDictionary().Keys.First(), sel.ToDictionary().Values.First());</span><br><span class="line">  insp[<span class="string">&quot;Photo&quot;</span>] = <span class="string">@&quot;e:\temp\Hydrant.jpg&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> op = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  op.Name = <span class="string">&quot;Raster Inspector&quot;</span>;</span><br><span class="line">  op.Modify(insp);</span><br><span class="line">  op.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将压缩图像写入栅格字段"><a href="#将压缩图像写入栅格字段" class="headerlink" title="将压缩图像写入栅格字段"></a>将压缩图像写入栅格字段</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Open the raster dataset on disk and create a compressed raster value dataset object</span></span><br><span class="line">  <span class="keyword">var</span> dataStore = <span class="keyword">new</span> ArcGIS.Core.Data.FileSystemDatastore(<span class="keyword">new</span> ArcGIS.Core.Data.FileSystemConnectionPath(<span class="keyword">new</span> System.Uri(<span class="string">@&quot;e:\temp&quot;</span>), ArcGIS.Core.Data.FileSystemDatastoreType.Raster));</span><br><span class="line">  <span class="keyword">using</span> (<span class="keyword">var</span> fileRasterDataset = dataStore.OpenDataset&lt;ArcGIS.Core.Data.Raster.RasterDataset&gt;(<span class="string">&quot;Hydrant.jpg&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> storageDef = <span class="keyword">new</span> ArcGIS.Core.Data.Raster.RasterStorageDef();</span><br><span class="line">    storageDef.SetCompressionType(ArcGIS.Core.Data.Raster.RasterCompressionType.JPEG);</span><br><span class="line">    storageDef.SetCompressionQuality(<span class="number">90</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> rv = <span class="keyword">new</span> ArcGIS.Core.Data.Raster.RasterValue();</span><br><span class="line">    rv.SetRasterDataset(fileRasterDataset);</span><br><span class="line">    rv.SetRasterStorageDef(storageDef);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> sel = MapView.Active.Map.GetSelection();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//insert a raster value object into the raster field</span></span><br><span class="line">    <span class="keyword">var</span> insp = <span class="keyword">new</span> ArcGIS.Desktop.Editing.Attributes.Inspector();</span><br><span class="line">    insp.Load(sel.ToDictionary().Keys.First(), sel.ToDictionary().Values.First());</span><br><span class="line">    insp[<span class="string">&quot;Photo&quot;</span>] = rv;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> op = <span class="keyword">new</span> EditOperation();</span><br><span class="line">    op.Name = <span class="string">&quot;Raster Inspector&quot;</span>;</span><br><span class="line">    op.Modify(insp);</span><br><span class="line">    op.Execute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="使用草图"><a href="#使用草图" class="headerlink" title="使用草图"></a>使用草图</h2><h3 id="切换草图选择模式"><a href="#切换草图选择模式" class="headerlink" title="切换草图选择模式"></a>切换草图选择模式</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UseSelection = true; (UseSelection must be set to true in the tool constructor or tool activate)</span></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">bool</span> _inSelMode = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">IsShiftKey</span>(<span class="params">MapViewKeyEventArgs k</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> (k.Key == System.Windows.Input.Key.LeftShift ||</span><br><span class="line">         k.Key == System.Windows.Input.Key.RightShift);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnToolKeyDown</span>(<span class="params">MapViewKeyEventArgs k</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//toggle sketch selection mode with a custom key</span></span><br><span class="line">  <span class="keyword">if</span> (k.Key == System.Windows.Input.Key.W)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (!_inSelMode)</span><br><span class="line">    &#123;</span><br><span class="line">      k.Handled = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Toggle the tool to select mode.</span></span><br><span class="line">      <span class="comment">//  The sketch is saved if UseSelection = true;</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">await</span> ActivateSelectAsync(<span class="literal">true</span>))</span><br><span class="line">        _inSelMode = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (!_inSelMode)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//disable effect of Shift in the base class.</span></span><br><span class="line">    <span class="comment">//Mark the key event as handled to prevent further processing</span></span><br><span class="line">    k.Handled = IsShiftKey(k);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnToolKeyUp</span>(<span class="params">MapViewKeyEventArgs k</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (k.Key == System.Windows.Input.Key.W)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (_inSelMode)</span><br><span class="line">    &#123;</span><br><span class="line">      _inSelMode = <span class="literal">false</span>;</span><br><span class="line">      k.Handled = <span class="literal">true</span>;<span class="comment">//process this one</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// Toggle back to sketch mode. If UseSelection = true</span></span><br><span class="line">      <span class="comment">//   the sketch will be restored</span></span><br><span class="line">      ActivateSelectAsync(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (_inSelMode)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//disable effect of Shift in the base class.</span></span><br><span class="line">    <span class="comment">//Mark the key event as handled to prevent further processing</span></span><br><span class="line">    k.Handled = IsShiftKey(k);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="聆听草图修改事件"><a href="#聆听草图修改事件" class="headerlink" title="聆听草图修改事件"></a>聆听草图修改事件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SketchModified event is fired by </span></span><br><span class="line"><span class="comment">//  - COTS construction tools (except annotation, dimension geometry types), </span></span><br><span class="line"><span class="comment">//  - Edit Vertices, Reshape, Align Features</span></span><br><span class="line"><span class="comment">//  - 3rd party tools with FireSketchEvents = true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Subscribe the sketch modified event</span></span><br><span class="line"><span class="comment">//ArcGIS.Desktop.Mapping.Events.SketchModifiedEvent.Subscribe(OnSketchModified);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSketchModified</span>(<span class="params">ArcGIS.Desktop.Mapping.Events.SketchModifiedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// if not an undo operation</span></span><br><span class="line">  <span class="keyword">if</span> (!args.IsUndo)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// what was the sketch before the change?</span></span><br><span class="line">    <span class="keyword">var</span> prevSketch = args.PreviousSketch;</span><br><span class="line">    <span class="comment">// what is the current sketch?</span></span><br><span class="line">    <span class="keyword">var</span> currentSketch = args.CurrentSketch;</span><br><span class="line">    <span class="keyword">if</span> (currentSketch <span class="keyword">is</span> Polyline polyline)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// Examine the current (last) vertex in the line sketch</span></span><br><span class="line">      <span class="keyword">var</span> lastSketchPoint = polyline.Points.Last();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// do something with the last point</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="收听草图完成前事件并修改草图"><a href="#收听草图完成前事件并修改草图" class="headerlink" title="收听草图完成前事件并修改草图"></a>收听草图完成前事件并修改草图</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BeforeSketchCompleted event is fired by </span></span><br><span class="line"><span class="comment">//  - COTS construction tools (except annotation, dimension geometry types), </span></span><br><span class="line"><span class="comment">//  - Edit Vertices, Reshape, Align Features</span></span><br><span class="line"><span class="comment">//  - 3rd party tools with FireSketchEvents = true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Subscribe to the before sketch completed event</span></span><br><span class="line"><span class="comment">//ArcGIS.Desktop.Mapping.Events.BeforeSketchCompletedEvent.Subscribe(OnBeforeSketchCompleted);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> Task <span class="title">OnBeforeSketchCompleted</span>(<span class="params">BeforeSketchCompletedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//assign sketch Z values from default surface and set the sketch geometry</span></span><br><span class="line">  <span class="keyword">var</span> modifiedSketch = args.MapView.Map.GetZsFromSurfaceAsync(args.Sketch).Result;</span><br><span class="line">  args.SetSketchGeometry(modifiedSketch.Geometry);</span><br><span class="line">  <span class="keyword">return</span> Task.CompletedTask;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="收听草图完成事件"><a href="#收听草图完成事件" class="headerlink" title="收听草图完成事件"></a>收听草图完成事件</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SketchCompleted event is fired by </span></span><br><span class="line"><span class="comment">//  - COTS construction tools (except annotation, dimension geometry types), </span></span><br><span class="line"><span class="comment">//  - Edit Vertices, Reshape, Align Features</span></span><br><span class="line"><span class="comment">//  - 3rd party tools with FireSketchEvents = true</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Subscribe to the sketch completed event</span></span><br><span class="line"><span class="comment">//ArcGIS.Desktop.Mapping.Events.SketchCompletedEvent.Subscribe(OnSketchCompleted);</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnSketchCompleted</span>(<span class="params">SketchCompletedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// get the sketch</span></span><br><span class="line">  <span class="keyword">var</span> finalSketch = args.Sketch;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// do something with the sketch - audit trail perhaps</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="触发草图事件的自定义构造工具"><a href="#触发草图事件的自定义构造工具" class="headerlink" title="触发草图事件的自定义构造工具"></a>触发草图事件的自定义构造工具</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">ConstructionTool1</span> : <span class="title">MapTool</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">ConstructionTool1</span>()</span></span><br><span class="line">  &#123;</span><br><span class="line">    IsSketchTool = <span class="literal">true</span>;</span><br><span class="line">    UseSnapping = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// Select the type of construction tool you wish to implement.  </span></span><br><span class="line">    <span class="comment">// Make sure that the tool is correctly registered with the correct component category type in the daml </span></span><br><span class="line">    SketchType = SketchGeometryType.Line;</span><br><span class="line">    <span class="comment">//Gets or sets whether the sketch is for creating a feature and should use the CurrentTemplate.</span></span><br><span class="line">    UsesCurrentTemplate = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set FireSketchEvents property to true</span></span><br><span class="line">    FireSketchEvents = <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//  ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义自定义草图工具的草图符号"><a href="#自定义自定义草图工具的草图符号" class="headerlink" title="自定义自定义草图工具的草图符号"></a>自定义自定义草图工具的草图符号</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Custom tools have the ability to change the symbology used when sketching a new feature. </span></span><br><span class="line"><span class="comment">//Both the Sketch Segment Symbol and the Vertex Symbol can be modified using the correct set method. </span></span><br><span class="line"><span class="comment">//This is set in the activate method for the tool.</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> Task <span class="title">OnToolActivateAsync</span>(<span class="params"><span class="built_in">bool</span> active</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//Getting the current symbology options of the segment</span></span><br><span class="line">    <span class="keyword">var</span> segmentOptions = GetSketchSegmentSymbolOptions();</span><br><span class="line">    <span class="comment">//Modifying the primary and secondary color and the width of the segment symbology options</span></span><br><span class="line">    <span class="keyword">var</span> deepPurple = <span class="keyword">new</span> CIMRGBColor();</span><br><span class="line">    deepPurple.R = <span class="number">75</span>;</span><br><span class="line">    deepPurple.G = <span class="number">0</span>;</span><br><span class="line">    deepPurple.B = <span class="number">110</span>;</span><br><span class="line">    segmentOptions.PrimaryColor = deepPurple;</span><br><span class="line">    segmentOptions.Width = <span class="number">4</span>;</span><br><span class="line">    segmentOptions.HasSecondaryColor = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">var</span> pink = <span class="keyword">new</span> CIMRGBColor();</span><br><span class="line">    pink.R = <span class="number">219</span>;</span><br><span class="line">    pink.G = <span class="number">48</span>;</span><br><span class="line">    pink.B = <span class="number">130</span>;</span><br><span class="line">    segmentOptions.SecondaryColor = pink;</span><br><span class="line">    <span class="comment">//Creating a new vertex symbol options instance with the values you want</span></span><br><span class="line">    <span class="keyword">var</span> vertexOptions = <span class="keyword">new</span> VertexSymbolOptions(VertexSymbolType.RegularUnselected);</span><br><span class="line">    <span class="keyword">var</span> yellow = <span class="keyword">new</span> CIMRGBColor();</span><br><span class="line">    yellow.R = <span class="number">255</span>;</span><br><span class="line">    yellow.G = <span class="number">215</span>;</span><br><span class="line">    yellow.B = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> purple = <span class="keyword">new</span> CIMRGBColor();</span><br><span class="line">    purple.R = <span class="number">148</span>;</span><br><span class="line">    purple.G = <span class="number">0</span>;</span><br><span class="line">    purple.B = <span class="number">211</span>;</span><br><span class="line">    vertexOptions.AngleRotation = <span class="number">45</span>;</span><br><span class="line">    vertexOptions.Color = yellow;</span><br><span class="line">    vertexOptions.MarkerType = VertexMarkerType.Star;</span><br><span class="line">    vertexOptions.OutlineColor = purple;</span><br><span class="line">    vertexOptions.OutlineWidth = <span class="number">3</span>;</span><br><span class="line">    vertexOptions.Size = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Setting the value of the segment symbol options</span></span><br><span class="line">    SetSketchSegmentSymbolOptions(segmentOptions);</span><br><span class="line">    <span class="comment">//Setting the value of the vertex symbol options of the regular unselected vertices using the vertexOptions instance created above.</span></span><br><span class="line">    SetSketchVertexSymbolOptions(VertexSymbolType.RegularUnselected, vertexOptions);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">base</span>.OnToolActivateAsync(active);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="捕捉"><a href="#捕捉" class="headerlink" title="捕捉"></a>捕捉</h2><h3 id="配置捕捉-打开或关闭捕捉"><a href="#配置捕捉-打开或关闭捕捉" class="headerlink" title="配置捕捉 - 打开或关闭捕捉"></a>配置捕捉 - 打开或关闭捕捉</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//enable snapping</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.IsEnabled = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// disable snapping</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.IsEnabled = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<h3 id="配置捕捉-应用程序捕捉模式"><a href="#配置捕捉-应用程序捕捉模式" class="headerlink" title="配置捕捉 - 应用程序捕捉模式"></a>配置捕捉 - 应用程序捕捉模式</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set only Point and Edge snapping modes, clear everything else</span></span><br><span class="line"><span class="comment">//At 2.x - ArcGIS.Desktop.Mapping.Snapping.SetSnapModes(SnapMode.Point, SnapMode.Edge);</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapModes(</span><br><span class="line">  <span class="keyword">new</span> List&lt;SnapMode&gt;() &#123; SnapMode.Point, SnapMode.Edge &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// clear all snap modes</span></span><br><span class="line"><span class="comment">//At 2.x - ArcGIS.Desktop.Mapping.Snapping.SetSnapModes();</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapModes(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// set snap modes one at a time</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapMode(SnapMode.Edge, <span class="literal">true</span>);</span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapMode(SnapMode.End, <span class="literal">true</span>);</span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapMode(SnapMode.Intersection, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get current snap modes</span></span><br><span class="line"><span class="keyword">var</span> snapModes = ArcGIS.Desktop.Mapping.Snapping.SnapModes;</span><br><span class="line"></span><br><span class="line"><span class="comment">// get state of a specific snap mode</span></span><br><span class="line"><span class="built_in">bool</span> isOn = ArcGIS.Desktop.Mapping.Snapping.GetSnapMode(SnapMode.Vertex);</span><br></pre></td></tr></table></figure>

<h3 id="配置捕捉-图层捕捉可捕捉性"><a href="#配置捕捉-图层捕捉可捕捉性" class="headerlink" title="配置捕捉 - 图层捕捉可捕捉性"></a>配置捕捉 - 图层捕捉可捕捉性</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// is the layer snappable?</span></span><br><span class="line"><span class="built_in">bool</span> isSnappable = fLayer.IsSnappable;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set snappability for a specific layer - needs to run on the MCT</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// use an extension method</span></span><br><span class="line">  fLayer.SetSnappable(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// or use the CIM directly</span></span><br><span class="line">  <span class="comment">//var layerDef = fLayer.GetDefinition() as ArcGIS.Core.CIM.CIMGeoFeatureLayerBase;</span></span><br><span class="line">  <span class="comment">//layerDef.Snappable = true;</span></span><br><span class="line">  <span class="comment">//fLayer.SetDefinition(layerDef);</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// turn all layers snappability off</span></span><br><span class="line">layerList = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;();</span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> layer <span class="keyword">in</span> layerList)</span><br><span class="line">  &#123;</span><br><span class="line">    layer.SetSnappable(<span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="配置捕捉-图层捕捉模式"><a href="#配置捕捉-图层捕捉模式" class="headerlink" title="配置捕捉 - 图层捕捉模式"></a>配置捕捉 - 图层捕捉模式</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">layerList = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// configure by layer</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> layer <span class="keyword">in</span> layerList)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// find the state of the snapModes for the layer</span></span><br><span class="line">  <span class="keyword">var</span> lsm = ArcGIS.Desktop.Mapping.Snapping.GetLayerSnapModes(layer);</span><br><span class="line">  <span class="built_in">bool</span> vertexOn = lsm.Vertex;</span><br><span class="line">  <span class="comment">// or use </span></span><br><span class="line">  vertexOn = lsm.GetSnapMode(SnapMode.Vertex);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> edgeOn = lsm.Edge;</span><br><span class="line">  <span class="comment">// or use </span></span><br><span class="line">  edgeOn = lsm.GetSnapMode(SnapMode.Edge);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">bool</span> endOn = lsm.End;</span><br><span class="line">  <span class="comment">// or use </span></span><br><span class="line">  endOn = lsm.GetSnapMode(SnapMode.End);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// update a few snapModes </span></span><br><span class="line">  <span class="comment">//   turn Vertex off</span></span><br><span class="line">  lsm.SetSnapMode(SnapMode.Vertex, <span class="literal">false</span>);</span><br><span class="line">  <span class="comment">// intersections on</span></span><br><span class="line">  lsm.SetSnapMode(SnapMode.Intersection, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// and set back to the layer</span></span><br><span class="line">  ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(layer, lsm);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// assign a single snap mode at once</span></span><br><span class="line">  ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(layer, SnapMode.Vertex, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// turn ALL snapModes on</span></span><br><span class="line">  ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(layer, <span class="literal">true</span>);</span><br><span class="line">  <span class="comment">// turn ALL snapModes off</span></span><br><span class="line">  ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(layer, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// configure for a set of layers</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// set Vertex, edge, end on for a set of layers, other snapModes false</span></span><br><span class="line"><span class="keyword">var</span> vee = <span class="keyword">new</span> LayerSnapModes(<span class="literal">false</span>);</span><br><span class="line">vee.Vertex = <span class="literal">true</span>;</span><br><span class="line">vee.Edge = <span class="literal">true</span>;</span><br><span class="line">vee.End = <span class="literal">true</span>;</span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(layerList, vee);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ensure intersection is on for a set of layers without changing any other snapModes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// get the layer snapModes for the set of layers</span></span><br><span class="line"><span class="keyword">var</span> dictLSM = ArcGIS.Desktop.Mapping.Snapping.GetLayerSnapModes(layerList);</span><br><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> layer <span class="keyword">in</span> dictLSM.Keys)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> lsm = dictLSM[layer];</span><br><span class="line">  lsm.Intersection = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(dictLSM);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// set all snapModes off for a list of layers</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(layerList, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<h3 id="配置捕捉-组合示例"><a href="#配置捕捉-组合示例" class="headerlink" title="配置捕捉 - 组合示例"></a>配置捕捉 - 组合示例</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// interested in only snapping to the vertices of a specific layer of interest and not the vertices of other layers</span></span><br><span class="line"><span class="comment">//  all other snapModes should be off.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// snapping must be on</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.IsEnabled = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// turn all application snapModes off</span></span><br><span class="line"><span class="comment">//At 2.x - ArcGIS.Desktop.Mapping.Snapping.SetSnapModes();</span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapModes(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// set application snapMode vertex on </span></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetSnapMode(SnapMode.Vertex, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ensure layer snapping is on</span></span><br><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  fLayer.SetSnappable(<span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// set vertex snapping only</span></span><br><span class="line"><span class="keyword">var</span> vertexOnly = <span class="keyword">new</span> LayerSnapModes(<span class="literal">false</span>);</span><br><span class="line">vertexOnly.Vertex = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// set vertex only for the specific layer, clearing all others</span></span><br><span class="line"><span class="keyword">var</span> dict = <span class="keyword">new</span> Dictionary&lt;Layer, LayerSnapModes&gt;();</span><br><span class="line">dict.Add(fLayer, vertexOnly);</span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetLayerSnapModes(dict, <span class="literal">true</span>);  <span class="comment">// true = reset other layers</span></span><br></pre></td></tr></table></figure>

<h3 id="捕捉选项"><a href="#捕捉选项" class="headerlink" title="捕捉选项"></a>捕捉选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Set snapping options via get/set options</span></span><br><span class="line"><span class="keyword">var</span> snapOptions = ArcGIS.Desktop.Mapping.Snapping.GetOptions(myMap);</span><br><span class="line"><span class="comment">//At 2.x - snapOptions.SnapToSketchEnabled = true;</span></span><br><span class="line">snapOptions.IsSnapToSketchEnabled = <span class="literal">true</span>;</span><br><span class="line">snapOptions.XYTolerance = <span class="number">100</span>;</span><br><span class="line"><span class="comment">//At 2.x - snapOptions.ZToleranceEnabled = true;</span></span><br><span class="line">snapOptions.IsZToleranceEnabled = <span class="literal">true</span>;</span><br><span class="line">snapOptions.ZTolerance = <span class="number">0.6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//turn on snap tip display parts</span></span><br><span class="line">snapOptions.SnapTipDisplayParts = (<span class="built_in">int</span>)SnapTipDisplayPart.SnapTipDisplayLayer + (<span class="built_in">int</span>)SnapTipDisplayPart.SnapTipDisplayType;</span><br><span class="line"></span><br><span class="line"><span class="comment">//turn off all snaptips</span></span><br><span class="line"><span class="comment">//snapOptions.SnapTipDisplayParts = (int)SnapTipDisplayPart.SnapTipDisplayNone;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//turn on layer display only</span></span><br><span class="line"><span class="comment">//snapOptions.SnapTipDisplayParts = (int)SnapTipDisplayPart.SnapTipDisplayLayer;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//At 2.x - snapOptions.GeometricFeedbackColor = ColorFactory.Instance.RedRGB;</span></span><br><span class="line">snapOptions.SnapTipColor = ColorFactory.Instance.RedRGB;</span><br><span class="line"></span><br><span class="line">ArcGIS.Desktop.Mapping.Snapping.SetOptions(myMap, snapOptions);</span><br></pre></td></tr></table></figure>

<h2 id="撤消-x2F-重做"><a href="#撤消-x2F-重做" class="headerlink" title="撤消&#x2F;重做"></a>撤消&#x2F;重做</h2><h3 id="撤消-x2F-重做最近的操作"><a href="#撤消-x2F-重做最近的操作" class="headerlink" title="撤消&#x2F;重做最近的操作"></a>撤消&#x2F;重做最近的操作</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//undo</span></span><br><span class="line"><span class="keyword">if</span> (MapView.Active.Map.OperationManager.CanUndo)</span><br><span class="line">  MapView.Active.Map.OperationManager.UndoAsync();<span class="comment">//await as needed</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//redo</span></span><br><span class="line"><span class="keyword">if</span> (MapView.Active.Map.OperationManager.CanRedo)</span><br><span class="line">  MapView.Active.Map.OperationManager.RedoAsync();<span class="comment">//await as needed</span></span><br></pre></td></tr></table></figure>

<h2 id="编辑模板"><a href="#编辑模板" class="headerlink" title="编辑模板"></a>编辑模板</h2><h3 id="在图层上按名称查找编辑模板"><a href="#在图层上按名称查找编辑模板" class="headerlink" title="在图层上按名称查找编辑模板"></a>在图层上按名称查找编辑模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//get the templates</span></span><br><span class="line">  <span class="keyword">var</span> map = ArcGIS.Desktop.Mapping.MapView.Active.Map;</span><br><span class="line">  <span class="keyword">if</span> (map == <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> mainTemplate = map.FindLayers(<span class="string">&quot;main&quot;</span>).FirstOrDefault()?.GetTemplate(<span class="string">&quot;Distribution&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> mhTemplate = map.FindLayers(<span class="string">&quot;Manhole&quot;</span>).FirstOrDefault()?.GetTemplate(<span class="string">&quot;Active&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="查找属于独立表的表模板"><a href="#查找属于独立表的表模板" class="headerlink" title="查找属于独立表的表模板"></a>查找属于独立表的表模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> map = ArcGIS.Desktop.Mapping.MapView.Active.Map;</span><br><span class="line">  <span class="keyword">if</span> (map == <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  <span class="comment">//Get a particular table template</span></span><br><span class="line">  <span class="keyword">var</span> tableTemplate = map.FindStandaloneTables(<span class="string">&quot;Address Points&quot;</span>).FirstOrDefault()?.GetTemplate(<span class="string">&quot;Residences&quot;</span>);</span><br><span class="line">  <span class="comment">//Get all the templates of a standalone table</span></span><br><span class="line">  <span class="keyword">var</span> ownersTableTemplates = map.FindStandaloneTables(<span class="string">&quot;Owners&quot;</span>).FirstOrDefault()?.GetTemplates();</span><br><span class="line">  <span class="keyword">var</span> statisticsTableTemplates = MapView.Active.Map.GetStandaloneTablesAsFlattenedList().First(l =&gt; l.Name.Equals(<span class="string">&quot;Trading Statistics&quot;</span>)).GetTemplates();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="当前模板"><a href="#当前模板" class="headerlink" title="当前模板"></a>当前模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EditingTemplate template = EditingTemplate.Current;</span><br></pre></td></tr></table></figure>

<h3 id="更改模板的默认编辑工具"><a href="#更改模板的默认编辑工具" class="headerlink" title="更改模板的默认编辑工具"></a>更改模板的默认编辑工具</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Task <span class="title">ChangeTemplateDefaultToolAsync</span>(<span class="params">ArcGIS.Desktop.Mapping.FeatureLayer flayer,</span></span></span><br><span class="line"><span class="params"><span class="function">                  <span class="built_in">string</span> toolContentGUID, <span class="built_in">string</span> templateName</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> ArcGIS.Desktop.Framework.Threading.Tasks.QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// retrieve the edit template form the layer by name</span></span><br><span class="line">    <span class="keyword">var</span> template = flayer?.GetTemplate(templateName) <span class="keyword">as</span> ArcGIS.Desktop.Editing.Templates.EditingTemplate;</span><br><span class="line">    <span class="comment">// get the definition of the layer</span></span><br><span class="line">    <span class="keyword">var</span> layerDef = flayer?.GetDefinition() <span class="keyword">as</span> ArcGIS.Core.CIM.CIMFeatureLayer;</span><br><span class="line">    <span class="keyword">if</span> ((template == <span class="literal">null</span>) || (layerDef == <span class="literal">null</span>))</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (template.DefaultToolID != <span class="keyword">this</span>.ID)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">bool</span> updateLayerDef = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (layerDef.AutoGenerateFeatureTemplates)</span><br><span class="line">      &#123;</span><br><span class="line">        layerDef.AutoGenerateFeatureTemplates = <span class="literal">false</span>;</span><br><span class="line">        updateLayerDef = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// retrieve the CIM edit template definition</span></span><br><span class="line">      <span class="keyword">var</span> templateDef = template.GetDefinition();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// assign the GUID from the tool DAML definition, for example</span></span><br><span class="line">      <span class="comment">// &lt;tool id=&quot;TestConstructionTool_SampleSDKTool&quot; categoryRefID=&quot;esri_editing_construction_polyline&quot; ….&gt;</span></span><br><span class="line">      <span class="comment">//   &lt;tooltip heading=&quot;&quot;&gt;Tooltip text&lt;disabledText /&gt;&lt;/tooltip&gt;</span></span><br><span class="line">      <span class="comment">//   &lt;content guid=&quot;e58239b3-9c69-49e5-ad4d-bb2ba29ff3ea&quot; /&gt;</span></span><br><span class="line">      <span class="comment">// &lt;/tool&gt;</span></span><br><span class="line">      <span class="comment">// then the toolContentGUID would be &quot;e58239b3-9c69-49e5-ad4d-bb2ba29ff3ea&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">//At 2.x -</span></span><br><span class="line">      <span class="comment">//templateDef.ToolProgID = toolContentGUID;</span></span><br><span class="line">      templateDef.DefaultToolGUID = toolContentGUID;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// set the definition back to </span></span><br><span class="line">      template.SetDefinition(templateDef);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// update the layer definition too</span></span><br><span class="line">      <span class="keyword">if</span> (updateLayerDef)</span><br><span class="line">        flayer.SetDefinition(layerDef);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="隐藏或显示模板上的编辑工具"><a href="#隐藏或显示模板上的编辑工具" class="headerlink" title="隐藏或显示模板上的编辑工具"></a>隐藏或显示模板上的编辑工具</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//hide all tools except line tool on layer</span></span><br><span class="line">  <span class="keyword">var</span> featLayer = MapView.Active.Map.FindLayers(<span class="string">&quot;Roads&quot;</span>).First();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> editTemplates = featLayer.GetTemplates();</span><br><span class="line">  <span class="keyword">var</span> newCIMEditingTemplates = <span class="keyword">new</span> List&lt;CIMEditingTemplate&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">foreach</span> (<span class="keyword">var</span> et <span class="keyword">in</span> editTemplates)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">//initialize template by activating default tool</span></span><br><span class="line">    et.ActivateDefaultToolAsync();</span><br><span class="line">    <span class="keyword">var</span> cimEditTemplate = et.GetDefinition();</span><br><span class="line">    <span class="comment">//get the visible tools on this template</span></span><br><span class="line">    <span class="keyword">var</span> allTools = et.ToolIDs.ToList();</span><br><span class="line">    <span class="comment">//add the hidden tools on this template</span></span><br><span class="line">    allTools.AddRange(cimEditTemplate.GetExcludedToolIDs().ToList());</span><br><span class="line">    <span class="comment">//hide all the tools then allow the line tool</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">//At 2.x -</span></span><br><span class="line">    <span class="comment">//allTools.AddRange(cimEditTemplate.GetExcludedToolDamlIds().ToList());</span></span><br><span class="line">    allTools.AddRange(cimEditTemplate.GetExcludedToolIDs().ToList());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//At 2.x - </span></span><br><span class="line">    <span class="comment">//cimEditTemplate.SetExcludedToolDamlIds(allTools.ToArray());</span></span><br><span class="line">    <span class="comment">//cimEditTemplate.AllowToolDamlID(&quot;esri_editing_SketchLineTool&quot;);</span></span><br><span class="line">    </span><br><span class="line">    cimEditTemplate.SetExcludedToolIDs(allTools.ToArray());</span><br><span class="line">    cimEditTemplate.AllowToolID(<span class="string">&quot;esri_editing_SketchLineTool&quot;</span>);</span><br><span class="line">    newCIMEditingTemplates.Add(cimEditTemplate);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//update the layer templates</span></span><br><span class="line">  <span class="keyword">var</span> layerDef = featLayer.GetDefinition() <span class="keyword">as</span> CIMFeatureLayer;</span><br><span class="line">  <span class="comment">// Set AutoGenerateFeatureTemplates to false for template changes to stick</span></span><br><span class="line">  layerDef.AutoGenerateFeatureTemplates = <span class="literal">false</span>;</span><br><span class="line">  layerDef.FeatureTemplates = newCIMEditingTemplates.ToArray();</span><br><span class="line">  featLayer.SetDefinition(layerDef);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用图层创建新模板。创建模板"><a href="#使用图层创建新模板。创建模板" class="headerlink" title="使用图层创建新模板。创建模板"></a>使用图层创建新模板。创建模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> layer = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;FeatureLayer&gt;().FirstOrDefault();</span><br><span class="line"><span class="keyword">if</span> (layer == <span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp.LoadSchema(layer);</span><br><span class="line"></span><br><span class="line">  insp[<span class="string">&quot;Field1&quot;</span>] = value1;</span><br><span class="line">  insp[<span class="string">&quot;Field2&quot;</span>] = value2;</span><br><span class="line">  insp[<span class="string">&quot;Field3&quot;</span>] = value3;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> tags = <span class="keyword">new</span>[] &#123; <span class="string">&quot;Polygon&quot;</span>, <span class="string">&quot;tag1&quot;</span>, <span class="string">&quot;tag2&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set defaultTool using a daml-id </span></span><br><span class="line">  <span class="built_in">string</span> defaultTool = <span class="string">&quot;esri_editing_SketchCirclePolygonTool&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// tool filter is the tools to filter OUT</span></span><br><span class="line">  <span class="keyword">var</span> toolFilter = <span class="keyword">new</span>[] &#123; <span class="string">&quot;esri_editing_SketchTracePolygonTool&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// create a new template  </span></span><br><span class="line">  <span class="keyword">var</span> newTemplate = layer.CreateTemplate(<span class="string">&quot;My new template&quot;</span>, <span class="string">&quot;description&quot;</span>, insp, defaultTool, tags, toolFilter);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="使用表创建新表模板。创建模板"><a href="#使用表创建新表模板。创建模板" class="headerlink" title="使用表创建新表模板。创建模板"></a>使用表创建新表模板。创建模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> table = MapView.Active.Map.GetStandaloneTablesAsFlattenedList().FirstOrDefault();</span><br><span class="line"><span class="keyword">if</span> (table == <span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> tableTemplate = table.GetTemplate(<span class="string">&quot;Template1&quot;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> definition = tableTemplate.GetDefinition();</span><br><span class="line">  definition.Description = <span class="string">&quot;New definition&quot;</span>;</span><br><span class="line">  definition.Name = <span class="string">&quot;New name&quot;</span>;</span><br><span class="line">  <span class="comment">//Create new table template using this definition</span></span><br><span class="line">  table.CreateTemplate(definition);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//You can also create a new table template using this extension method. You can use this method the same way you use the layer.CreateTemplate method.</span></span><br><span class="line">  table.CreateTemplate(<span class="string">&quot;New template name&quot;</span>, <span class="string">&quot;Template description&quot;</span>, tags: <span class="keyword">new</span> <span class="built_in">string</span>[] &#123; <span class="string">&quot;tag 1&quot;</span>, <span class="string">&quot;tag 2&quot;</span> &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="更新表模板"><a href="#更新表模板" class="headerlink" title="更新表模板"></a>更新表模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> tableTemplate = table.GetTemplate(<span class="string">&quot;Template1&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> definition = tableTemplate.GetDefinition();</span><br><span class="line">  definition.Description = <span class="string">&quot;New definition&quot;</span>;</span><br><span class="line">  definition.Name = <span class="string">&quot;New name&quot;</span>;</span><br><span class="line">  <span class="comment">// update the definition</span></span><br><span class="line">  tableTemplate.SetDefinition(definition);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="创建注释模板"><a href="#创建注释模板" class="headerlink" title="创建注释模板"></a>创建注释模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get an anno layer</span></span><br><span class="line">AnnotationLayer annoLayer = MapView.Active.Map.GetLayersAsFlattenedList().OfType&lt;AnnotationLayer&gt;().FirstOrDefault();</span><br><span class="line"><span class="keyword">if</span> (annoLayer == <span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  Inspector insp = <span class="literal">null</span>;</span><br><span class="line">  <span class="comment">// get the anno feature class</span></span><br><span class="line">  <span class="keyword">var</span> fc = annoLayer.GetFeatureClass() <span class="keyword">as</span> ArcGIS.Core.Data.Mapping.AnnotationFeatureClass;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the featureclass CIM definition which contains the labels, symbols</span></span><br><span class="line">  <span class="keyword">var</span> cimDefinition = fc.GetDefinition() <span class="keyword">as</span> ArcGIS.Core.Data.Mapping.AnnotationFeatureClassDefinition;</span><br><span class="line">  <span class="keyword">var</span> labels = cimDefinition.GetLabelClassCollection();</span><br><span class="line">  <span class="keyword">var</span> symbols = cimDefinition.GetSymbolCollection();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// make sure there are labels, symbols</span></span><br><span class="line">  <span class="keyword">if</span> ((labels.Count == <span class="number">0</span>) || (symbols.Count == <span class="number">0</span>))</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// find the label class required</span></span><br><span class="line">  <span class="comment">//   typically you would use a subtype name or some other characteristic</span></span><br><span class="line">  <span class="comment">// in this case lets just use the first one</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> label = labels[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// each label has a textSymbol</span></span><br><span class="line">  <span class="comment">// the symbolName *should* be the symbolID to be used</span></span><br><span class="line">  <span class="keyword">var</span> symbolName = label.TextSymbol.SymbolName;</span><br><span class="line">  <span class="built_in">int</span> symbolID = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">int</span>.TryParse(symbolName, <span class="keyword">out</span> symbolID))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// int.TryParse fails - attempt to find the symbolName in the symbol collection</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">var</span> symbol <span class="keyword">in</span> symbols)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> (symbol.Name == symbolName)</span><br><span class="line">      &#123;</span><br><span class="line">        symbolID = symbol.ID;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// no symbol?</span></span><br><span class="line">  <span class="keyword">if</span> (symbolID == <span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// load the schema</span></span><br><span class="line">  insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp.LoadSchema(annoLayer);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ok to assign these fields using the inspector[fieldName] methodology</span></span><br><span class="line">  <span class="comment">//   these fields are guaranteed to exist in the annotation schema</span></span><br><span class="line">  insp[<span class="string">&quot;AnnotationClassID&quot;</span>] = label.ID;</span><br><span class="line">  insp[<span class="string">&quot;SymbolID&quot;</span>] = symbolID;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set up some additional annotation properties</span></span><br><span class="line">  AnnotationProperties annoProperties = insp.GetAnnotationProperties();</span><br><span class="line">  annoProperties.FontSize = <span class="number">36</span>;</span><br><span class="line">  annoProperties.TextString = <span class="string">&quot;My Annotation feature&quot;</span>;</span><br><span class="line">  annoProperties.VerticalAlignment = VerticalAlignment.Top;</span><br><span class="line">  annoProperties.HorizontalAlignment = HorizontalAlignment.Justify;</span><br><span class="line"></span><br><span class="line">  insp.SetAnnotationProperties(annoProperties);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> tags = <span class="keyword">new</span>[] &#123; <span class="string">&quot;Annotation&quot;</span>, <span class="string">&quot;tag1&quot;</span>, <span class="string">&quot;tag2&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// use daml-id rather than guid</span></span><br><span class="line">  <span class="built_in">string</span> defaultTool = <span class="string">&quot;esri_editing_SketchStraightAnnoTool&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// tool filter is the tools to filter OUT</span></span><br><span class="line">  <span class="keyword">var</span> toolFilter = <span class="keyword">new</span>[] &#123; <span class="string">&quot;esri_editing_SketchCurvedAnnoTool&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// create a new template </span></span><br><span class="line">  <span class="keyword">var</span> newTemplate = annoLayer.CreateTemplate(<span class="string">&quot;new anno template&quot;</span>, <span class="string">&quot;description&quot;</span>, insp, defaultTool, tags, toolFilter);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="删除表模板"><a href="#删除表模板" class="headerlink" title="删除表模板"></a>删除表模板</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> table = MapView.Active.Map.GetStandaloneTablesAsFlattenedList().FirstOrDefault();</span><br><span class="line"><span class="keyword">if</span> (table == <span class="literal">null</span>)</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> tableTemplate = table.GetTemplate(<span class="string">&quot;Template1&quot;</span>);</span><br><span class="line">  <span class="comment">//Removing a table template</span></span><br><span class="line">  table.RemoveTemplate(tableTemplate);</span><br><span class="line">  <span class="comment">//Removing a template by name</span></span><br><span class="line">  table.RemoveTemplate(<span class="string">&quot;Template2&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="活动模板已更改"><a href="#活动模板已更改" class="headerlink" title="活动模板已更改"></a>活动模板已更改</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ArcGIS.Desktop.Editing.Events.ActiveTemplateChangedEvent.Subscribe(OnActiveTemplateChanged);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">async</span> <span class="keyword">void</span> <span class="title">OnActiveTemplateChanged</span>(<span class="params">ArcGIS.Desktop.Editing.Events.ActiveTemplateChangedEventArgs args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// return if incoming template is null</span></span><br><span class="line">  <span class="keyword">if</span> (args.IncomingTemplate == <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Activate two-point line tool for Freeway template in the Layers map</span></span><br><span class="line">  <span class="keyword">if</span> (args.IncomingTemplate.Name == <span class="string">&quot;Freeway&quot;</span> &amp;&amp; args.IncomingMapView.Map.Name == <span class="string">&quot;Layers&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> args.IncomingTemplate.ActivateToolAsync(<span class="string">&quot;esri_editing_SketchTwoPointLineTool&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><h3 id="注释构建工具"><a href="#注释构建工具" class="headerlink" title="注释构建工具"></a>注释构建工具</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//In your config.daml...set the categoryRefID</span></span><br><span class="line"><span class="comment">//&lt;tool id=&quot;...&quot; categoryRefID=&quot;esri_editing_construction_annotation&quot; caption=&quot;Create Anno&quot; ...&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Sketch type Point or Line or BezierLine in the constructor...</span></span><br><span class="line"><span class="comment">//internal class AnnoConstructionTool : MapTool  &#123;</span></span><br><span class="line"><span class="comment">//  public AnnoConstructionTool()  &#123;</span></span><br><span class="line"><span class="comment">//    IsSketchTool = true;</span></span><br><span class="line"><span class="comment">//    UseSnapping = true;</span></span><br><span class="line"><span class="comment">//    SketchType = SketchGeometryType.Point;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">async</span> <span class="keyword">override</span> Task&lt;<span class="built_in">bool</span>&gt; <span class="title">OnSketchCompleteAsync</span>(<span class="params">Geometry geometry</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (CurrentTemplate == <span class="literal">null</span> || geometry == <span class="literal">null</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Create an edit operation</span></span><br><span class="line">  <span class="keyword">var</span> createOperation = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  createOperation.Name = <span class="built_in">string</span>.Format(<span class="string">&quot;Create &#123;0&#125;&quot;</span>, CurrentTemplate.Layer.Name);</span><br><span class="line">  createOperation.SelectNewFeatures = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> insp = CurrentTemplate.Inspector;</span><br><span class="line">  <span class="keyword">var</span> result = <span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// get the annotation properties class</span></span><br><span class="line">    AnnotationProperties annoProperties = insp.GetAnnotationProperties();</span><br><span class="line">    <span class="comment">// set custom annotation properties</span></span><br><span class="line">    annoProperties.TextString = <span class="string">&quot;my custom text&quot;</span>;</span><br><span class="line">    annoProperties.Color = ColorFactory.Instance.RedRGB;</span><br><span class="line">    annoProperties.FontSize = <span class="number">24</span>;</span><br><span class="line">    annoProperties.FontName = <span class="string">&quot;Arial&quot;</span>;</span><br><span class="line">    annoProperties.HorizontalAlignment = ArcGIS.Core.CIM.HorizontalAlignment.Right;</span><br><span class="line">    annoProperties.Shape = geometry;</span><br><span class="line">    <span class="comment">// assign annotation properties back to the inspector</span></span><br><span class="line">    insp.SetAnnotationProperties(annoProperties);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Queue feature creation</span></span><br><span class="line">    createOperation.Create(CurrentTemplate.Layer, insp);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Execute the operation</span></span><br><span class="line">    <span class="keyword">return</span> createOperation.Execute();</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="以编程方式启动编辑批注"><a href="#以编程方式启动编辑批注" class="headerlink" title="以编程方式启动编辑批注"></a>以编程方式启动编辑批注</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> plugin = FrameworkApplication.GetPlugInWrapper(<span class="string">&quot;esri_editing_EditVerticesText&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (plugin.Enabled)</span><br><span class="line">  ((ICommand)plugin).Execute(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure>

<h3 id="更新批注文本"><a href="#更新批注文本" class="headerlink" title="更新批注文本"></a>更新批注文本</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//annoLayer is ~your~ Annotation layer...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// use the inspector methodology</span></span><br><span class="line">  <span class="comment">//at 2.x - var insp = new Inspector(true);</span></span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp.Load(annoLayer, oid);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// get the annotation properties</span></span><br><span class="line">  AnnotationProperties annoProperties = insp.GetAnnotationProperties();</span><br><span class="line">  <span class="comment">// set the attribute</span></span><br><span class="line">  annoProperties.TextString = <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">  <span class="comment">// assign the annotation proeprties back to the inspector</span></span><br><span class="line">  insp.SetAnnotationProperties(annoProperties);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//create and execute the edit operation</span></span><br><span class="line">  EditOperation op = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  op.Name = <span class="string">&quot;Update annotation&quot;</span>;</span><br><span class="line">  op.Modify(insp);</span><br><span class="line">  op.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="修改批注形状"><a href="#修改批注形状" class="headerlink" title="修改批注形状"></a>修改批注形状</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Don&#x27;t use &#x27;Shape&#x27;....Shape is the bounding box of the annotation text. This is NOT what you want...</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">//var insp = new Inspector();</span></span><br><span class="line">  <span class="comment">//insp.Load(annoLayer, oid);</span></span><br><span class="line">  <span class="comment">//var shape = insp[&quot;SHAPE&quot;] as Polygon;</span></span><br><span class="line">  <span class="comment">//...wrong shape...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//Instead, we must use the AnnotationProperties</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//annoLayer is ~your~ Annotation layer</span></span><br><span class="line">  <span class="comment">//at 2.x - var insp = new Inspector(true);</span></span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp.Load(annoLayer, oid);</span><br><span class="line"></span><br><span class="line">  AnnotationProperties annoProperties = insp.GetAnnotationProperties();</span><br><span class="line">  <span class="keyword">var</span> shape = annoProperties.Shape;</span><br><span class="line">  <span class="keyword">if</span> (shape.GeometryType != GeometryType.GeometryBag)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">var</span> newGeometry = GeometryEngine.Instance.Move(shape, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line">    annoProperties.Shape = newGeometry;</span><br><span class="line">    insp.SetAnnotationProperties(annoProperties);</span><br><span class="line"></span><br><span class="line">    EditOperation op = <span class="keyword">new</span> EditOperation();</span><br><span class="line">    op.Name = <span class="string">&quot;Change annotation angle&quot;</span>;</span><br><span class="line">    op.Modify(insp);</span><br><span class="line">    op.Execute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="修改批注文本图形"><a href="#修改批注文本图形" class="headerlink" title="修改批注文本图形"></a>修改批注文本图形</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> selection = annoLayer.GetSelection();</span><br><span class="line">  <span class="keyword">if</span> (selection.GetCount() == <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// use the first selelcted feature </span></span><br><span class="line">  <span class="comment">//at 2.x - var insp = new Inspector(true);</span></span><br><span class="line">  <span class="keyword">var</span> insp = <span class="keyword">new</span> Inspector();</span><br><span class="line">  insp.Load(annoLayer, selection.GetObjectIDs().FirstOrDefault());</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getAnnoProperties should return null if not an annotation feature</span></span><br><span class="line">  AnnotationProperties annoProperties = insp.GetAnnotationProperties();</span><br><span class="line">  <span class="comment">// get the textGraphic</span></span><br><span class="line">  CIMTextGraphic textGraphic = annoProperties.TextGraphic;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// change text</span></span><br><span class="line">  textGraphic.Text = <span class="string">&quot;Hello world&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// set x,y offset via the symbol</span></span><br><span class="line">  <span class="keyword">var</span> symbol = textGraphic.Symbol.Symbol;</span><br><span class="line">  <span class="keyword">var</span> textSymbol = symbol <span class="keyword">as</span> CIMTextSymbol;</span><br><span class="line">  textSymbol.OffsetX = <span class="number">2</span>;</span><br><span class="line">  textSymbol.OffsetY = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">  textSymbol.HorizontalAlignment = HorizontalAlignment.Center;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// load the updated textGraphic</span></span><br><span class="line">  annoProperties.LoadFromTextGraphic(textGraphic);</span><br><span class="line">  <span class="comment">// assign the annotation properties back </span></span><br><span class="line">  insp.SetAnnotationProperties(annoProperties);</span><br><span class="line"></span><br><span class="line">  EditOperation op = <span class="keyword">new</span> EditOperation();</span><br><span class="line">  op.Name = <span class="string">&quot;modify symbol&quot;</span>;</span><br><span class="line">  op.Modify(insp);</span><br><span class="line">  <span class="built_in">bool</span> result = op.Execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="ProSnippet-组-：-接地到网格"><a href="#ProSnippet-组-：-接地到网格" class="headerlink" title="ProSnippet 组 ： 接地到网格"></a>ProSnippet 组 ： 接地到网格</h3><h3 id="G2G-设置"><a href="#G2G-设置" class="headerlink" title="G2G 设置"></a>G2G 设置</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CIMGroundToGridCorrection correction = <span class="literal">null</span>;</span><br><span class="line"><span class="built_in">bool</span> isCorecting = correction.IsCorrecting();   <span class="comment">// equivalent to correction != null &amp;&amp; correction.Enabled;</span></span><br><span class="line"><span class="built_in">bool</span> UsingOffset = correction.UsingDirectionOffset();   <span class="comment">// equivalent to correction.IsCorrecting() &amp;&amp; correction.UseDirection;</span></span><br><span class="line"><span class="built_in">double</span> dOffset = correction.GetDirectionOffset(); <span class="comment">// equivalent to correction.UsingDirectionOffset() ? correction.Direction : DefaultDirectionOffset;</span></span><br><span class="line"><span class="built_in">bool</span> usingDistanceFactor = correction.UsingDistanceFactor();  <span class="comment">// equivalent to correction.IsCorrecting() &amp;&amp; correction.UseScale;</span></span><br><span class="line"><span class="built_in">bool</span> usingElevation = correction.UsingElevationMode(); <span class="comment">// equivalent to correction.UsingDistanceFactor() &amp;&amp; c.ScaleType == GroundToGridScaleType.ComputeUsingElevation;</span></span><br><span class="line"><span class="built_in">bool</span> usingSFactor = correction.UsingConstantScaleFactor();  <span class="comment">//; equivalent to correction.UsingDistanceFactor() &amp;&amp; correction.ScaleType == GroundToGridScaleType.ConstantFactor;</span></span><br><span class="line"><span class="built_in">double</span> dSFactor = correction.GetConstantScaleFactor(); <span class="comment">// equivalent to correctionc.UsingDistanceFactor() ? correction.ConstantScaleFactor : DefaultConstantScaleFactor;</span></span><br></pre></td></tr></table></figure>

<h2 id="编辑选项"><a href="#编辑选项" class="headerlink" title="编辑选项"></a>编辑选项</h2><h3 id="获取-x2F-设置编辑选项"><a href="#获取-x2F-设置编辑选项" class="headerlink" title="获取&#x2F;设置编辑选项"></a>获取&#x2F;设置编辑选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//toggle, switch option values</span></span><br><span class="line"><span class="keyword">var</span> options = ApplicationOptions.EditingOptions;</span><br><span class="line"></span><br><span class="line">options.EnforceAttributeValidation = !options.EnforceAttributeValidation;</span><br><span class="line">options.WarnOnSubtypeChange = !options.WarnOnSubtypeChange;</span><br><span class="line">options.InitializeDefaultValuesOnSubtypeChange = !options.InitializeDefaultValuesOnSubtypeChange;</span><br><span class="line">options.UncommitedAttributeEdits = (options.UncommitedAttributeEdits == </span><br><span class="line">  UncommitedEditMode.AlwaysPrompt) ? UncommitedEditMode.Apply : UncommitedEditMode.AlwaysPrompt;</span><br><span class="line"></span><br><span class="line">options.StretchGeometry = !options.StretchGeometry;</span><br><span class="line">options.StretchTopology = !options.StretchTopology;</span><br><span class="line">options.UncommitedGeometryEdits = (options.UncommitedGeometryEdits == </span><br><span class="line">  UncommitedEditMode.AlwaysPrompt) ? UncommitedEditMode.Apply : UncommitedEditMode.AlwaysPrompt;</span><br><span class="line"></span><br><span class="line">options.ActivateMoveAfterPaste = !options.ActivateMoveAfterPaste;</span><br><span class="line">options.ShowFeatureSketchSymbology = !options.ShowFeatureSketchSymbology;</span><br><span class="line">options.FinishSketchOnDoubleClick = !options.FinishSketchOnDoubleClick;</span><br><span class="line">options.AllowVertexEditingWhileSketching = !options.AllowVertexEditingWhileSketching;</span><br><span class="line">options.ShowDeleteDialog = !options.ShowDeleteDialog;</span><br><span class="line">options.EnableStereoEscape = !options.EnableStereoEscape;</span><br><span class="line">options.DragSketch = !options.DragSketch;</span><br><span class="line">options.ShowDynamicConstraints = !options.ShowDynamicConstraints;</span><br><span class="line">options.IsDeflectionDefaultDirectionConstraint = </span><br><span class="line">  !options.IsDeflectionDefaultDirectionConstraint;</span><br><span class="line">options.IsDirectionDefaultInputConstraint = !options.IsDirectionDefaultInputConstraint;</span><br><span class="line">options.ShowEditingToolbar = !options.ShowEditingToolbar;</span><br><span class="line">options.ToolbarPosition = (options.ToolbarPosition == ToolbarPosition.Bottom) ? </span><br><span class="line">          ToolbarPosition.Right : ToolbarPosition.Bottom;</span><br><span class="line">options.ToolbarSize = (options.ToolbarSize == ToolbarSize.Medium) ? </span><br><span class="line">          ToolbarSize.Small : ToolbarSize.Medium;</span><br><span class="line">options.MagnifyToolbar = !options.MagnifyToolbar;</span><br><span class="line"></span><br><span class="line">options.EnableEditingFromEditTab = !options.EnableEditingFromEditTab;</span><br><span class="line">options.AutomaticallySaveEdits = !options.AutomaticallySaveEdits;</span><br><span class="line">options.AutoSaveByTime = !options.AutoSaveByTime;</span><br><span class="line">options.SaveEditsInterval = (options.AutomaticallySaveEdits) ? <span class="number">20</span> : <span class="number">10</span>;</span><br><span class="line">options.SaveEditsOperations = (options.AutomaticallySaveEdits) ? <span class="number">60</span> : <span class="number">30</span>;</span><br><span class="line">options.SaveEditsOnProjectSave = !options.SaveEditsOnProjectSave;</span><br><span class="line">options.ShowSaveEditsDialog = !options.ShowSaveEditsDialog;</span><br><span class="line">options.ShowDiscardEditsDialog = !options.ShowDiscardEditsDialog;</span><br><span class="line">options.DeactivateToolOnSaveOrDiscard = !options.DeactivateToolOnSaveOrDiscard;</span><br><span class="line">options.NewLayersEditable = !options.NewLayersEditable;</span><br></pre></td></tr></table></figure>

<h3 id="获取草图折点符号系统选项"><a href="#获取草图折点符号系统选项" class="headerlink" title="获取草图折点符号系统选项"></a>获取草图折点符号系统选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> options = ApplicationOptions.EditingOptions;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Must use QueuedTask</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//There are 4 vertex symbol settings - selected, unselected and the</span></span><br><span class="line">  <span class="comment">//current vertex selected and unselected.</span></span><br><span class="line">  <span class="keyword">var</span> reg_select = options.GetVertexSymbolOptions(VertexSymbolType.RegularSelected);</span><br><span class="line">  <span class="keyword">var</span> reg_unsel = options.GetVertexSymbolOptions(VertexSymbolType.RegularUnselected);</span><br><span class="line">  <span class="keyword">var</span> curr_sel = options.GetVertexSymbolOptions(VertexSymbolType.CurrentSelected);</span><br><span class="line">  <span class="keyword">var</span> curr_unsel = options.GetVertexSymbolOptions(VertexSymbolType.CurrentUnselected);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//to convert the options to a symbol use</span></span><br><span class="line">  <span class="comment">//GetPointSymbol</span></span><br><span class="line">  <span class="keyword">var</span> reg_sel_pt_symbol = reg_select.GetPointSymbol();</span><br><span class="line">  <span class="comment">//ditto for reg_unsel, curr_sel, curr_unsel</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="获取草图线段符号系统选项"><a href="#获取草图线段符号系统选项" class="headerlink" title="获取草图线段符号系统选项"></a>获取草图线段符号系统选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var options = ApplicationOptions.EditingOptions;</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> seg_options = options.GetSegmentSymbolOptions();</span><br><span class="line">  <span class="comment">//to convert the options to a symbol use</span></span><br><span class="line">  <span class="comment">//SymbolFactory. Note: this is approximate....sketch isn&#x27;t using the</span></span><br><span class="line">  <span class="comment">//CIM directly for segments</span></span><br><span class="line">  <span class="keyword">var</span> layers = <span class="keyword">new</span> List&lt;CIMSymbolLayer&gt;();</span><br><span class="line">  <span class="keyword">var</span> stroke0 = SymbolFactory.Instance.ConstructStroke(seg_options.PrimaryColor, </span><br><span class="line">    seg_options.Width, SimpleLineStyle.Dash);</span><br><span class="line">  layers.Add(stroke0);</span><br><span class="line">  <span class="keyword">if</span> (seg_options.HasSecondaryColor) &#123;</span><br><span class="line">    <span class="keyword">var</span> stroke1 = SymbolFactory.Instance.ConstructStroke(</span><br><span class="line">      seg_options.SecondaryColor, seg_options.Width, SimpleLineStyle.Solid);</span><br><span class="line">    layers.Add(stroke1);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//segment symbology only</span></span><br><span class="line">  <span class="keyword">var</span> sketch_line = <span class="keyword">new</span> CIMLineSymbol() &#123;</span><br><span class="line">    SymbolLayers = layers.ToArray()</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="设置草图顶点符号选项"><a href="#设置草图顶点符号选项" class="headerlink" title="设置草图顶点符号选项"></a>设置草图顶点符号选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var options = ApplicationOptions.EditingOptions;</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//change the regular unselected vertex symbol</span></span><br><span class="line">  <span class="comment">//default is a green, hollow, square, 5pts. Change to</span></span><br><span class="line">  <span class="comment">//Blue outline diamond, 10 pts</span></span><br><span class="line">  <span class="keyword">var</span> vertexSymbol = <span class="keyword">new</span> VertexSymbolOptions(VertexSymbolType.RegularUnselected);</span><br><span class="line">  vertexSymbol.OutlineColor = ColorFactory.Instance.BlueRGB;</span><br><span class="line">  vertexSymbol.MarkerType = VertexMarkerType.Diamond;</span><br><span class="line">  vertexSymbol.Size = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Are these valid?</span></span><br><span class="line">  <span class="keyword">if</span> (options.CanSetVertexSymbolOptions(</span><br><span class="line">       VertexSymbolType.RegularUnselected, vertexSymbol)) &#123;</span><br><span class="line">    <span class="comment">//apply them</span></span><br><span class="line">    options.SetVertexSymbolOptions(VertexSymbolType.RegularUnselected, vertexSymbol);</span><br><span class="line">          &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="设置草图线段符号选项"><a href="#设置草图线段符号选项" class="headerlink" title="设置草图线段符号选项"></a>设置草图线段符号选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var options = ApplicationOptions.EditingOptions;</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//change the segment symbol primary color to green and</span></span><br><span class="line">  <span class="comment">//width to 1 pt</span></span><br><span class="line">  <span class="keyword">var</span> segSymbol = options.GetSegmentSymbolOptions();</span><br><span class="line">  segSymbol.PrimaryColor = ColorFactory.Instance.GreenRGB;</span><br><span class="line">  segSymbol.Width = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//Are these valid?</span></span><br><span class="line">  <span class="keyword">if</span> (options.CanSetSegmentSymbolOptions(segSymbol)) &#123;</span><br><span class="line">    <span class="comment">//apply them</span></span><br><span class="line">    options.SetSegmentSymbolOptions(segSymbol);</span><br><span class="line">          &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将草图顶点符号设置回默认值"><a href="#将草图顶点符号设置回默认值" class="headerlink" title="将草图顶点符号设置回默认值"></a>将草图顶点符号设置回默认值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var options = ApplicationOptions.EditingOptions;</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//ditto for reg selected and current selected, unselected</span></span><br><span class="line">  <span class="keyword">var</span> def_reg_unsel = </span><br><span class="line">    options.GetDefaultVertexSymbolOptions(VertexSymbolType.RegularUnselected);</span><br><span class="line">  <span class="comment">//apply default</span></span><br><span class="line">  options.SetVertexSymbolOptions(</span><br><span class="line">    VertexSymbolType.RegularUnselected, def_reg_unsel);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="将草图线段符号设置回默认值"><a href="#将草图线段符号设置回默认值" class="headerlink" title="将草图线段符号设置回默认值"></a>将草图线段符号设置回默认值</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var options = ApplicationOptions.EditingOptions;</span></span><br><span class="line">QueuedTask.Run(() =&gt;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">var</span> def_seg = options.GetDefaultSegmentSymbolOptions();</span><br><span class="line">  options.SetSegmentSymbolOptions(def_seg);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="版本控制选项"><a href="#版本控制选项" class="headerlink" title="版本控制选项"></a>版本控制选项</h2><h3 id="获取和设置版本控制选项"><a href="#获取和设置版本控制选项" class="headerlink" title="获取和设置版本控制选项"></a>获取和设置版本控制选项</h3><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vOptions = ApplicationOptions.VersioningOptions;</span><br><span class="line"></span><br><span class="line">vOptions.DefineConflicts = (vOptions.DefineConflicts == ConflictDetectionType.ByRow) ? </span><br><span class="line">  ConflictDetectionType.ByColumn : ConflictDetectionType.ByRow;</span><br><span class="line">vOptions.ConflictResolution = (</span><br><span class="line">  vOptions.ConflictResolution == ConflictResolutionType.FavorEditVersion) ? </span><br><span class="line">    ConflictResolutionType.FavorTargetVersion : ConflictResolutionType.FavorEditVersion;</span><br><span class="line">vOptions.ShowConflictsDialog = !vOptions.ShowConflictsDialog;</span><br><span class="line">vOptions.ShowReconcileDialog = !vOptions.ShowReconcileDialog;</span><br></pre></td></tr></table></figure>

<h4 id="创建注记构造工具"><a href="#创建注记构造工具" class="headerlink" title="创建注记构造工具"></a><a target="_blank" rel="noopener" href="https://github.com/Esri/arcgis-pro-sdk/wiki/ProSnippets-Annotation#create-annotation-construction-tool">创建注记构造工具</a></h4><h4 id="通过属性更新批注文本。警告：TEXTSTRING-Anno-属性必须存在"><a href="#通过属性更新批注文本。警告：TEXTSTRING-Anno-属性必须存在" class="headerlink" title="通过属性更新批注文本。警告：TEXTSTRING Anno 属性必须存在"></a><a target="_blank" rel="noopener" href="https://github.com/Esri/arcgis-pro-sdk/wiki/ProSnippets-Annotation#update-annotation-text-via-attribute-caveat-the-textstring-anno-attribute-must-exist">通过属性更新批注文本。警告：TEXTSTRING Anno 属性必须存在</a></h4><h4 id="旋转或移动批注"><a href="#旋转或移动批注" class="headerlink" title="旋转或移动批注"></a><a target="_blank" rel="noopener" href="https://github.com/Esri/arcgis-pro-sdk/wiki/ProSnippets-Annotation#rotate-or-move-the-annotation">旋转或移动批注</a></h4><h4 id="更改批注文本图形"><a href="#更改批注文本图形" class="headerlink" title="更改批注文本图形"></a><a target="_blank" rel="noopener" href="https://github.com/Esri/arcgis-pro-sdk/wiki/ProSnippets-Annotation#change-annotation-text-graphic">更改批注文本图形</a></h4><h2 id="公共设施网络"><a href="#公共设施网络" class="headerlink" title="公共设施网络"></a>公共设施网络</h2><h4 id="创建公共设施网络关联"><a href="#创建公共设施网络关联" class="headerlink" title="创建公共设施网络关联"></a><a target="_blank" rel="noopener" href="https://github.com/Esri/arcgis-pro-sdk/wiki/ProSnippets-UtilityNetwork#create-a-utility-network-association">创建公共设施网络关联</a></h4><h4 id="在单个编辑操作中创建公共设施网络要素和关联"><a href="#在单个编辑操作中创建公共设施网络要素和关联" class="headerlink" title="在单个编辑操作中创建公共设施网络要素和关联"></a><a target="_blank" rel="noopener" href="https://github.com/Esri/arcgis-pro-sdk/wiki/ProSnippets-UtilityNetwork#create-utility-network-features-and-associations-in-a-single-edit-operation">在单个编辑操作中创建公共设施网络要素和关联</a></h4><p>tion)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:1361151272@qq.com">shaozhy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://shaoshao.net.cn/2022/12/28/20221228134946000/">https://shaoshao.net.cn/2022/12/28/20221228134946000/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://shaoshao.net.cn" target="_blank">WineMonk</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/discover/tags/CSharp/">CSharp</a><a class="post-meta__tags" href="/discover/tags/ArcGIS-Pro-SDK/">ArcGIS Pro SDK</a></div><div class="post_share"><div class="social-share" data-image="https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://shaoshao.net.cn/images/blog/cover/payqr/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/12/28/20221228135207000/"><img class="prev-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ArcGIS Pro SDK 地理数据库</div></div></a></div><div class="next-post pull-right"><a href="/2022/12/28/20221228134536000/"><img class="next-cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">ArcGIS Pro SDK 核心主机</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/12/28/20221228134215000/" title="ArcGIS Pro SDK 内容"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_05.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 内容</div></div></a></div><div><a href="/2022/12/28/20221228134536000/" title="ArcGIS Pro SDK 核心主机"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_06.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 核心主机</div></div></a></div><div><a href="/2022/12/28/20221228133712000/" title="ArcGIS Pro SDK 框架"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_04.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 框架</div></div></a></div><div><a href="/2022/12/28/20221228135620000/" title="ArcGIS Pro SDK 地理处理"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_10.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理处理</div></div></a></div><div><a href="/2022/12/28/20221228135824000/" title="ArcGIS Pro SDK 图形图层"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_11.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 图形图层</div></div></a></div><div><a href="/2022/12/28/20221228135207000/" title="ArcGIS Pro SDK 地理数据库"><img class="cover" src="https://shaoshao.net.cn/images/blog/cover/current/post_08.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-12-28</div><div class="title">ArcGIS Pro SDK 地理数据库</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BC%96%E8%BE%91"><span class="toc-number">1.</span> <span class="toc-text">编辑</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">编辑操作方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%88%9B%E5%BB%BA%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.1.</span> <span class="toc-text">编辑操作创建要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%BD%93%E5%89%8D%E6%A8%A1%E6%9D%BF%E5%88%9B%E5%BB%BA%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.2.</span> <span class="toc-text">使用当前模板创建要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E4%BF%AE%E6%94%B9%E5%90%8E%E7%9A%84%E6%A3%80%E6%9F%A5%E5%99%A8%E5%88%9B%E5%BB%BA%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.3.</span> <span class="toc-text">从修改后的检查器创建要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E-CSV-%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.4.</span> <span class="toc-text">从 CSV 文件创建要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C-%E4%BD%BF%E7%94%A8%E8%A1%A8%E6%A8%A1%E6%9D%BF%E5%9C%A8%E8%A1%A8%E4%B8%AD%E5%88%9B%E5%BB%BA%E8%A1%8C"><span class="toc-number">1.1.5.</span> <span class="toc-text">编辑操作 使用表模板在表中创建行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%89%AA%E8%BE%91%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.6.</span> <span class="toc-text">编辑操作剪辑特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%88%87%E5%89%B2%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.7.</span> <span class="toc-text">编辑操作切割要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%88%A0%E9%99%A4%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.8.</span> <span class="toc-text">编辑操作删除要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E9%87%8D%E5%A4%8D%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.9.</span> <span class="toc-text">编辑操作重复要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%88%86%E8%A7%A3%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.10.</span> <span class="toc-text">编辑操作分解特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%90%88%E5%B9%B6%E5%8A%9F%E8%83%BD"><span class="toc-number">1.1.11.</span> <span class="toc-text">编辑操作合并功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C-%E4%BF%AE%E6%94%B9%E5%8D%95%E4%B8%AA%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.12.</span> <span class="toc-text">编辑操作 修改单个特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C-%E4%BF%AE%E6%94%B9%E5%A4%9A%E4%B8%AA%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.13.</span> <span class="toc-text">编辑操作 修改多个要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E5%9B%BE%E5%B1%82%E8%A6%81%E7%B4%A0%E5%B9%B6%E6%9B%B4%E6%96%B0%E5%AD%97%E6%AE%B5"><span class="toc-number">1.1.14.</span> <span class="toc-text">搜索图层要素并更新字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.15.</span> <span class="toc-text">移动要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E8%A6%81%E7%B4%A0%E7%A7%BB%E5%8A%A8%E5%88%B0%E7%89%B9%E5%AE%9A%E5%9D%90%E6%A0%87"><span class="toc-number">1.1.16.</span> <span class="toc-text">将要素移动到特定坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%B9%B3%E9%9D%A2%E5%8C%96%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.17.</span> <span class="toc-text">编辑操作平面化要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%B9%B6%E8%A1%8C%E5%81%8F%E7%A7%BB"><span class="toc-number">1.1.18.</span> <span class="toc-text">编辑操作并行偏移</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E9%87%8D%E5%A1%91%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.19.</span> <span class="toc-text">编辑操作重塑特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E6%97%8B%E8%BD%AC%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.20.</span> <span class="toc-text">编辑操作旋转要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E6%AF%94%E4%BE%8B%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.21.</span> <span class="toc-text">编辑操作比例要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E6%8B%86%E5%88%86%E8%A6%81%E7%B4%A0"><span class="toc-number">1.1.22.</span> <span class="toc-text">编辑操作拆分要素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E5%8F%98%E6%8D%A2%E7%89%B9%E5%BE%81"><span class="toc-number">1.1.23.</span> <span class="toc-text">编辑操作变换特征</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E6%A9%A1%E7%9A%AE%E6%9D%BF%E5%8A%9F%E8%83%BD"><span class="toc-number">1.1.24.</span> <span class="toc-text">编辑操作橡皮板功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C-%E6%89%A7%E8%A1%8C%E5%89%AA%E8%BE%91%E3%80%81%E5%89%AA%E5%88%87%E5%92%8C%E5%B9%B3%E5%9D%A6%E5%8C%96"><span class="toc-number">1.1.25.</span> <span class="toc-text">编辑操作 执行剪辑、剪切和平坦化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E9%93%BE-%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C"><span class="toc-number">1.1.26.</span> <span class="toc-text">编辑操作链 编辑操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E9%80%9A%E8%BF%87%E8%A1%8C%E4%BB%A4%E7%89%8C%E6%B7%BB%E5%8A%A0%E9%99%84%E4%BB%B6"><span class="toc-number">1.1.27.</span> <span class="toc-text">编辑操作通过行令牌添加附件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SetOnUndone%EF%BC%8C-SetOnRedone%EF%BC%8C-SetOnComitted"><span class="toc-number">1.1.28.</span> <span class="toc-text">SetOnUndone， SetOnRedone， SetOnComitted</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E7%94%A8%E7%BC%96%E8%BE%91"><span class="toc-number">1.2.</span> <span class="toc-text">启用编辑</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E7%94%A8%E7%BC%96%E8%BE%91-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">启用编辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%81%E7%94%A8%E7%BC%96%E8%BE%91"><span class="toc-number">1.2.2.</span> <span class="toc-text">禁用编辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E6%8B%93%E6%89%91"><span class="toc-number">1.3.</span> <span class="toc-text">地图拓扑</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%9C%B0%E5%9B%BE%E6%8B%93%E6%89%91"><span class="toc-number">1.3.1.</span> <span class="toc-text">构建地图拓扑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%8C%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">行事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E9%98%85%E8%A1%8C%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.4.1.</span> <span class="toc-text">订阅行事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E8%A1%8C%E4%BA%8B%E4%BB%B6%E4%B8%AD%E7%9A%84%E6%98%A0%E5%B0%84%E4%B8%AD%E7%9A%84%E5%8D%95%E7%8B%AC%E8%A1%A8%E4%B8%AD%E5%88%9B%E5%BB%BA%E8%AE%B0%E5%BD%95"><span class="toc-number">1.4.2.</span> <span class="toc-text">在行事件中的映射中的单独表中创建记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E8%A1%8C%E4%BA%8B%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%8D%95%E7%8B%AC%E8%A1%A8%E4%B8%AD%E5%88%9B%E5%BB%BA%E8%AE%B0%E5%BD%95"><span class="toc-number">1.4.3.</span> <span class="toc-text">在行事件中的单独表中创建记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%8C%E4%BA%8B%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%AE%B0%E5%BD%95-%E4%BD%BF%E7%94%A8-Row-Store"><span class="toc-number">1.4.4.</span> <span class="toc-text">修改行事件中的记录 - 使用 Row.Store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%8C%E4%BA%8B%E4%BB%B6%E4%B8%AD%E7%9A%84%E8%AE%B0%E5%BD%95-%E4%BD%BF%E7%94%A8-EditOperation-Modify"><span class="toc-number">1.4.5.</span> <span class="toc-text">修改行事件中的记录 - 使用 EditOperation.Modify</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9A%E7%BC%96%E8%BE%91%E6%97%B6%E5%87%A0%E4%BD%95%E5%9B%BE%E5%BD%A2%E6%98%AF%E5%90%A6%E6%9B%B4%E6%94%B9"><span class="toc-number">1.4.6.</span> <span class="toc-text">确定编辑时几何图形是否更改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E5%88%A0%E9%99%A4"><span class="toc-number">1.4.7.</span> <span class="toc-text">取消删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%B7%B2%E5%AE%8C%E6%88%90%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.5.</span> <span class="toc-text">编辑已完成事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A2%E9%98%85%E7%BC%96%E8%BE%91%E5%B7%B2%E5%AE%8C%E6%88%90%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.5.1.</span> <span class="toc-text">订阅编辑已完成事件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%91%98"><span class="toc-number">1.6.</span> <span class="toc-text">检查员</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E8%A6%81%E7%B4%A0%E4%BB%8E%E5%9B%BE%E5%B1%82%E5%8A%A0%E8%BD%BD%E5%88%B0%E6%A3%80%E6%9F%A5%E5%99%A8%E4%B8%AD"><span class="toc-number">1.6.1.</span> <span class="toc-text">将要素从图层加载到检查器中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E9%80%89%E6%8B%A9%E5%8A%A0%E8%BD%BD%E5%88%B0%E6%A3%80%E6%9F%A5%E5%99%A8%E4%B8%AD"><span class="toc-number">1.6.2.</span> <span class="toc-text">将地图选择加载到检查器中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E9%80%89%E8%A6%81%E7%B4%A0%E7%9A%84%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="toc-number">1.6.3.</span> <span class="toc-text">获取所选要素的属性值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9C%B0%E5%9B%BE%E9%80%89%E6%8B%A9%E5%8A%A0%E8%BD%BD%E5%88%B0%E6%A3%80%E6%9F%A5%E5%99%A8%E5%B9%B6%E6%9B%B4%E6%94%B9%E5%B1%9E%E6%80%A7"><span class="toc-number">1.6.4.</span> <span class="toc-text">将地图选择加载到检查器并更改属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%A3%80%E6%9F%A5%E5%99%A8%E8%8E%B7%E5%8F%96%E5%9B%BE%E5%B1%82%E6%96%B9%E6%A1%88"><span class="toc-number">1.6.5.</span> <span class="toc-text">使用检查器获取图层方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%99%A8-%E6%B7%BB%E5%8A%A0%E9%AA%8C%E8%AF%81"><span class="toc-number">1.6.6.</span> <span class="toc-text">检查器.添加验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE-Blob-%E5%AD%97%E6%AE%B5"><span class="toc-number">1.7.</span> <span class="toc-text">访问 Blob 字段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%B1%9E%E6%80%A7%E6%A3%80%E6%9F%A5%E5%99%A8%E8%AF%BB%E5%8F%96%E5%92%8C%E5%86%99%E5%85%A5-Blob-%E5%AD%97%E6%AE%B5"><span class="toc-number">1.7.1.</span> <span class="toc-text">使用属性检查器读取和写入 Blob 字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%9B%9E%E8%B0%83%E4%B8%AD%E4%BD%BF%E7%94%A8%E8%A1%8C%E6%B8%B8%E6%A0%87%E8%AF%BB%E5%8F%96%E5%92%8C%E5%86%99%E5%85%A5-Blob-%E5%AD%97%E6%AE%B5"><span class="toc-number">1.7.2.</span> <span class="toc-text">在回调中使用行游标读取和写入 Blob 字段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%A0%85%E6%A0%BC%E5%AD%97%E6%AE%B5"><span class="toc-number">1.8.</span> <span class="toc-text">访问栅格字段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%A0%85%E6%A0%BC%E5%AD%97%E6%AE%B5%E8%AF%BB%E5%8F%96"><span class="toc-number">1.8.1.</span> <span class="toc-text">从栅格字段读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9B%BE%E5%83%8F%E5%86%99%E5%85%A5%E6%A0%85%E6%A0%BC%E5%AD%97%E6%AE%B5"><span class="toc-number">1.8.2.</span> <span class="toc-text">将图像写入栅格字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%8E%8B%E7%BC%A9%E5%9B%BE%E5%83%8F%E5%86%99%E5%85%A5%E6%A0%85%E6%A0%BC%E5%AD%97%E6%AE%B5"><span class="toc-number">1.8.3.</span> <span class="toc-text">将压缩图像写入栅格字段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%8D%89%E5%9B%BE"><span class="toc-number">1.9.</span> <span class="toc-text">使用草图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E6%8D%A2%E8%8D%89%E5%9B%BE%E9%80%89%E6%8B%A9%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.9.1.</span> <span class="toc-text">切换草图选择模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%86%E5%90%AC%E8%8D%89%E5%9B%BE%E4%BF%AE%E6%94%B9%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.9.2.</span> <span class="toc-text">聆听草图修改事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E5%90%AC%E8%8D%89%E5%9B%BE%E5%AE%8C%E6%88%90%E5%89%8D%E4%BA%8B%E4%BB%B6%E5%B9%B6%E4%BF%AE%E6%94%B9%E8%8D%89%E5%9B%BE"><span class="toc-number">1.9.3.</span> <span class="toc-text">收听草图完成前事件并修改草图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E5%90%AC%E8%8D%89%E5%9B%BE%E5%AE%8C%E6%88%90%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.9.4.</span> <span class="toc-text">收听草图完成事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E8%8D%89%E5%9B%BE%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%87%AA%E5%AE%9A%E4%B9%89%E6%9E%84%E9%80%A0%E5%B7%A5%E5%85%B7"><span class="toc-number">1.9.5.</span> <span class="toc-text">触发草图事件的自定义构造工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8D%89%E5%9B%BE%E5%B7%A5%E5%85%B7%E7%9A%84%E8%8D%89%E5%9B%BE%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.9.6.</span> <span class="toc-text">自定义自定义草图工具的草图符号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%95%E6%8D%89"><span class="toc-number">1.10.</span> <span class="toc-text">捕捉</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%8D%95%E6%8D%89-%E6%89%93%E5%BC%80%E6%88%96%E5%85%B3%E9%97%AD%E6%8D%95%E6%8D%89"><span class="toc-number">1.10.1.</span> <span class="toc-text">配置捕捉 - 打开或关闭捕捉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%8D%95%E6%8D%89-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%8D%95%E6%8D%89%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.10.2.</span> <span class="toc-text">配置捕捉 - 应用程序捕捉模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%8D%95%E6%8D%89-%E5%9B%BE%E5%B1%82%E6%8D%95%E6%8D%89%E5%8F%AF%E6%8D%95%E6%8D%89%E6%80%A7"><span class="toc-number">1.10.3.</span> <span class="toc-text">配置捕捉 - 图层捕捉可捕捉性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%8D%95%E6%8D%89-%E5%9B%BE%E5%B1%82%E6%8D%95%E6%8D%89%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.10.4.</span> <span class="toc-text">配置捕捉 - 图层捕捉模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%8D%95%E6%8D%89-%E7%BB%84%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.10.5.</span> <span class="toc-text">配置捕捉 - 组合示例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%95%E6%8D%89%E9%80%89%E9%A1%B9"><span class="toc-number">1.10.6.</span> <span class="toc-text">捕捉选项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%92%A4%E6%B6%88-x2F-%E9%87%8D%E5%81%9A"><span class="toc-number">1.11.</span> <span class="toc-text">撤消&#x2F;重做</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%92%A4%E6%B6%88-x2F-%E9%87%8D%E5%81%9A%E6%9C%80%E8%BF%91%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">1.11.1.</span> <span class="toc-text">撤消&#x2F;重做最近的操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.</span> <span class="toc-text">编辑模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%9B%BE%E5%B1%82%E4%B8%8A%E6%8C%89%E5%90%8D%E7%A7%B0%E6%9F%A5%E6%89%BE%E7%BC%96%E8%BE%91%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.1.</span> <span class="toc-text">在图层上按名称查找编辑模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E6%89%BE%E5%B1%9E%E4%BA%8E%E7%8B%AC%E7%AB%8B%E8%A1%A8%E7%9A%84%E8%A1%A8%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.2.</span> <span class="toc-text">查找属于独立表的表模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.3.</span> <span class="toc-text">当前模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E6%A8%A1%E6%9D%BF%E7%9A%84%E9%BB%98%E8%AE%A4%E7%BC%96%E8%BE%91%E5%B7%A5%E5%85%B7"><span class="toc-number">1.12.4.</span> <span class="toc-text">更改模板的默认编辑工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E8%97%8F%E6%88%96%E6%98%BE%E7%A4%BA%E6%A8%A1%E6%9D%BF%E4%B8%8A%E7%9A%84%E7%BC%96%E8%BE%91%E5%B7%A5%E5%85%B7"><span class="toc-number">1.12.5.</span> <span class="toc-text">隐藏或显示模板上的编辑工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%9B%BE%E5%B1%82%E5%88%9B%E5%BB%BA%E6%96%B0%E6%A8%A1%E6%9D%BF%E3%80%82%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.6.</span> <span class="toc-text">使用图层创建新模板。创建模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%A1%A8%E5%88%9B%E5%BB%BA%E6%96%B0%E8%A1%A8%E6%A8%A1%E6%9D%BF%E3%80%82%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.7.</span> <span class="toc-text">使用表创建新表模板。创建模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.8.</span> <span class="toc-text">更新表模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%B3%A8%E9%87%8A%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.9.</span> <span class="toc-text">创建注释模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8%E6%A8%A1%E6%9D%BF"><span class="toc-number">1.12.10.</span> <span class="toc-text">删除表模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B4%BB%E5%8A%A8%E6%A8%A1%E6%9D%BF%E5%B7%B2%E6%9B%B4%E6%94%B9"><span class="toc-number">1.12.11.</span> <span class="toc-text">活动模板已更改</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E8%A7%A3"><span class="toc-number">1.13.</span> <span class="toc-text">注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7"><span class="toc-number">1.13.1.</span> <span class="toc-text">注释构建工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E7%BC%96%E7%A8%8B%E6%96%B9%E5%BC%8F%E5%90%AF%E5%8A%A8%E7%BC%96%E8%BE%91%E6%89%B9%E6%B3%A8"><span class="toc-number">1.13.2.</span> <span class="toc-text">以编程方式启动编辑批注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E6%89%B9%E6%B3%A8%E6%96%87%E6%9C%AC"><span class="toc-number">1.13.3.</span> <span class="toc-text">更新批注文本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%89%B9%E6%B3%A8%E5%BD%A2%E7%8A%B6"><span class="toc-number">1.13.4.</span> <span class="toc-text">修改批注形状</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%89%B9%E6%B3%A8%E6%96%87%E6%9C%AC%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.13.5.</span> <span class="toc-text">修改批注文本图形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProSnippet-%E7%BB%84-%EF%BC%9A-%E6%8E%A5%E5%9C%B0%E5%88%B0%E7%BD%91%E6%A0%BC"><span class="toc-number">1.13.6.</span> <span class="toc-text">ProSnippet 组 ： 接地到网格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#G2G-%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.13.7.</span> <span class="toc-text">G2G 设置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E9%80%89%E9%A1%B9"><span class="toc-number">1.14.</span> <span class="toc-text">编辑选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96-x2F-%E8%AE%BE%E7%BD%AE%E7%BC%96%E8%BE%91%E9%80%89%E9%A1%B9"><span class="toc-number">1.14.1.</span> <span class="toc-text">获取&#x2F;设置编辑选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%8D%89%E5%9B%BE%E6%8A%98%E7%82%B9%E7%AC%A6%E5%8F%B7%E7%B3%BB%E7%BB%9F%E9%80%89%E9%A1%B9"><span class="toc-number">1.14.2.</span> <span class="toc-text">获取草图折点符号系统选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%8D%89%E5%9B%BE%E7%BA%BF%E6%AE%B5%E7%AC%A6%E5%8F%B7%E7%B3%BB%E7%BB%9F%E9%80%89%E9%A1%B9"><span class="toc-number">1.14.3.</span> <span class="toc-text">获取草图线段符号系统选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%8D%89%E5%9B%BE%E9%A1%B6%E7%82%B9%E7%AC%A6%E5%8F%B7%E9%80%89%E9%A1%B9"><span class="toc-number">1.14.4.</span> <span class="toc-text">设置草图顶点符号选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%8D%89%E5%9B%BE%E7%BA%BF%E6%AE%B5%E7%AC%A6%E5%8F%B7%E9%80%89%E9%A1%B9"><span class="toc-number">1.14.5.</span> <span class="toc-text">设置草图线段符号选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E8%8D%89%E5%9B%BE%E9%A1%B6%E7%82%B9%E7%AC%A6%E5%8F%B7%E8%AE%BE%E7%BD%AE%E5%9B%9E%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">1.14.6.</span> <span class="toc-text">将草图顶点符号设置回默认值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E8%8D%89%E5%9B%BE%E7%BA%BF%E6%AE%B5%E7%AC%A6%E5%8F%B7%E8%AE%BE%E7%BD%AE%E5%9B%9E%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="toc-number">1.14.7.</span> <span class="toc-text">将草图线段符号设置回默认值</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E9%80%89%E9%A1%B9"><span class="toc-number">1.15.</span> <span class="toc-text">版本控制选项</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%92%8C%E8%AE%BE%E7%BD%AE%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E9%80%89%E9%A1%B9"><span class="toc-number">1.15.1.</span> <span class="toc-text">获取和设置版本控制选项</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%B3%A8%E8%AE%B0%E6%9E%84%E9%80%A0%E5%B7%A5%E5%85%B7"><span class="toc-number">1.15.1.1.</span> <span class="toc-text">创建注记构造工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E5%B1%9E%E6%80%A7%E6%9B%B4%E6%96%B0%E6%89%B9%E6%B3%A8%E6%96%87%E6%9C%AC%E3%80%82%E8%AD%A6%E5%91%8A%EF%BC%9ATEXTSTRING-Anno-%E5%B1%9E%E6%80%A7%E5%BF%85%E9%A1%BB%E5%AD%98%E5%9C%A8"><span class="toc-number">1.15.1.2.</span> <span class="toc-text">通过属性更新批注文本。警告：TEXTSTRING Anno 属性必须存在</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E6%88%96%E7%A7%BB%E5%8A%A8%E6%89%B9%E6%B3%A8"><span class="toc-number">1.15.1.3.</span> <span class="toc-text">旋转或移动批注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%94%B9%E6%89%B9%E6%B3%A8%E6%96%87%E6%9C%AC%E5%9B%BE%E5%BD%A2"><span class="toc-number">1.15.1.4.</span> <span class="toc-text">更改批注文本图形</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E8%AE%BE%E6%96%BD%E7%BD%91%E7%BB%9C"><span class="toc-number">1.16.</span> <span class="toc-text">公共设施网络</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%85%AC%E5%85%B1%E8%AE%BE%E6%96%BD%E7%BD%91%E7%BB%9C%E5%85%B3%E8%81%94"><span class="toc-number">1.16.0.1.</span> <span class="toc-text">创建公共设施网络关联</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E5%8D%95%E4%B8%AA%E7%BC%96%E8%BE%91%E6%93%8D%E4%BD%9C%E4%B8%AD%E5%88%9B%E5%BB%BA%E5%85%AC%E5%85%B1%E8%AE%BE%E6%96%BD%E7%BD%91%E7%BB%9C%E8%A6%81%E7%B4%A0%E5%92%8C%E5%85%B3%E8%81%94"><span class="toc-number">1.16.0.2.</span> <span class="toc-text">在单个编辑操作中创建公共设施网络要素和关联</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://shaoshao.net.cn/images/blog/cover/current/post_07.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By shaozhy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/"><img class="icp-icon" src="/img/icp.png"><span>冀ICP备2023009991号-1</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: 'd990e8cbbd1dabc9c98e',
      clientSecret: '59676d5926f4df676ec1ba6b36395bf90a0aeb54',
      repo: 'WineMonk.github.io',
      owner: 'WineMonk',
      admin: ['WineMonk'],
      id: '47004fea11242d379a9dcdc8f575f22c',
      updateCountCallback: commentCount
    },{"proxy":"https://vercel.prohibitorum.top/github_access_token"}))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="茶飘香,酒罢去,聚朋友,再回楼" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>